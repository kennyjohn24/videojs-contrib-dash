/*! @name videojs-contrib-dash @version 5.1.1 @license Apache-2.0 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("video.js"),require("global/window"),require("global/document")):"function"==typeof define&&define.amd?define(["video.js","global/window","global/document"],t):e.videojsDash=t(e.videojs,e.window,e.document)}(this,function(l,u,r){"use strict";l=l&&l.hasOwnProperty("default")?l.default:l,u=u&&u.hasOwnProperty("default")?u.default:u,r=r&&r.hasOwnProperty("default")?r.default:r;var e="undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{};function n(){throw new Error("setTimeout has not been defined")}function i(){throw new Error("clearTimeout has not been defined")}var o=n,c=i;function f(t){if(o===setTimeout)return setTimeout(t,0);if((o===n||!o)&&setTimeout)return o=setTimeout,setTimeout(t,0);try{return o(t,0)}catch(e){try{return o.call(null,t,0)}catch(e){return o.call(this,t,0)}}}"function"==typeof e.setTimeout&&(o=setTimeout),"function"==typeof e.clearTimeout&&(c=clearTimeout);var d,g=[],h=!1,m=-1;function p(){h&&d&&(h=!1,d.length?g=d.concat(g):m=-1,g.length&&y())}function y(){if(!h){var e=f(p);h=!0;for(var t=g.length;t;){for(d=g,g=[];++m<t;)d&&d[m].run();m=-1,t=g.length}d=null,h=!1,function(t){if(c===clearTimeout)return clearTimeout(t);if((c===i||!c)&&clearTimeout)return c=clearTimeout,clearTimeout(t);try{c(t)}catch(e){try{return c.call(null,t)}catch(e){return c.call(this,t)}}}(e)}}function ae(e){var t=new Array(arguments.length-1);if(1<arguments.length)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];g.push(new E(e,t)),1!==g.length||h||f(y)}function E(e,t){this.fun=e,this.array=t}E.prototype.run=function(){this.fun.apply(null,this.array)};function t(){}var _=t,v=t,T=t,b=t,S=t,A=t,R=t;var I=e.performance||{},w=I.now||I.mozNow||I.msNow||I.oNow||I.webkitNow||function(){return(new Date).getTime()};var C=new Date;var ie={nextTick:ae,title:"browser",browser:!0,env:{},argv:[],version:"",versions:{},on:_,addListener:v,once:T,off:b,removeListener:S,removeAllListeners:A,emit:R,binding:function(e){throw new Error("process.binding is not supported")},cwd:function(){return"/"},chdir:function(e){throw new Error("process.chdir is not supported")},umask:function(){return 0},hrtime:function(e){var t=.001*w.call(I),r=Math.floor(t),t=Math.floor(t%1*1e9);return e&&(r-=e[0],(t-=e[1])<0&&(r--,t+=1e9)),[r,t]},platform:"browser",release:{},config:{},uptime:function(){return(new Date-C)/1e3}},N=[],D=[],M="undefined"!=typeof Uint8Array?Uint8Array:Array,O=!1;function P(){O=!0;for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",t=0,r=e.length;t<r;++t)N[t]=e[t],D[e.charCodeAt(t)]=t;D["-".charCodeAt(0)]=62,D["_".charCodeAt(0)]=63}function L(e,t,r){for(var n,a=[],i=t;i<r;i+=3)n=(e[i]<<16)+(e[i+1]<<8)+e[i+2],a.push(N[(n=n)>>18&63]+N[n>>12&63]+N[n>>6&63]+N[63&n]);return a.join("")}function F(e){var t;O||P();for(var r=e.length,n=r%3,a="",i=[],o=0,s=r-n;o<s;o+=16383)i.push(L(e,o,s<o+16383?s:o+16383));return 1==n?(t=e[r-1],a+=N[t>>2],a+=N[t<<4&63],a+="=="):2==n&&(t=(e[r-2]<<8)+e[r-1],a+=N[t>>10],a+=N[t>>4&63],a+=N[t<<2&63],a+="="),i.push(a),i.join("")}function x(e,t,r,n,a){var i,o,s=8*a-n-1,l=(1<<s)-1,u=l>>1,c=-7,f=r?a-1:0,d=r?-1:1,r=e[t+f];for(f+=d,i=r&(1<<-c)-1,r>>=-c,c+=s;0<c;i=256*i+e[t+f],f+=d,c-=8);for(o=i&(1<<-c)-1,i>>=-c,c+=n;0<c;o=256*o+e[t+f],f+=d,c-=8);if(0===i)i=1-u;else{if(i===l)return o?NaN:1/0*(r?-1:1);o+=Math.pow(2,n),i-=u}return(r?-1:1)*o*Math.pow(2,i-n)}function j(e,t,r,n,a,i){var o,s,l=8*i-a-1,u=(1<<l)-1,c=u>>1,f=23===a?Math.pow(2,-24)-Math.pow(2,-77):0,d=n?0:i-1,g=n?1:-1,i=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,o=u):(o=Math.floor(Math.log(t)/Math.LN2),t*(n=Math.pow(2,-o))<1&&(o--,n*=2),2<=(t+=1<=o+c?f/n:f*Math.pow(2,1-c))*n&&(o++,n/=2),u<=o+c?(s=0,o=u):1<=o+c?(s=(t*n-1)*Math.pow(2,a),o+=c):(s=t*Math.pow(2,c-1)*Math.pow(2,a),o=0));8<=a;e[r+d]=255&s,d+=g,s/=256,a-=8);for(o=o<<a|s,l+=a;0<l;e[r+d]=255&o,d+=g,o/=256,l-=8);e[r+d-g]|=128*i}var k={}.toString,U=Array.isArray||function(e){return"[object Array]"==k.call(e)};function B(){return q.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function G(e,t){if(B()<t)throw new RangeError("Invalid typed array length");return q.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t)).__proto__=q.prototype:(e=null===e?new q(t):e).length=t,e}function q(e,t,r){if(!(q.TYPED_ARRAY_SUPPORT||this instanceof q))return new q(e,t,r);if("number"!=typeof e)return H(this,e,t,r);if("string"==typeof t)throw new Error("If encoding is specified then the first argument must be a string");return V(this,e)}function H(e,t,r,n){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?function(e,t,r,n){if(t.byteLength,r<0||t.byteLength<r)throw new RangeError("'offset' is out of bounds");if(t.byteLength<r+(n||0))throw new RangeError("'length' is out of bounds");t=void 0===r&&void 0===n?new Uint8Array(t):void 0===n?new Uint8Array(t,r):new Uint8Array(t,r,n);q.TYPED_ARRAY_SUPPORT?(e=t).__proto__=q.prototype:e=K(e,t);return e}(e,t,r,n):"string"==typeof t?function(e,t,r){"string"==typeof r&&""!==r||(r="utf8");if(!q.isEncoding(r))throw new TypeError('"encoding" must be a valid string encoding');var n=0|X(t,r),r=(e=G(e,n)).write(t,r);r!==n&&(e=e.slice(0,r));return e}(e,t,r):function(e,t){if(W(t)){var r=0|z(t.length);return 0===(e=G(e,r)).length?e:(t.copy(e,0,0,r),e)}if(t){if("undefined"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!=typeof t.length||function(e){return e!=e}(t.length)?G(e,0):K(e,t);if("Buffer"===t.type&&U(t.data))return K(e,t.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(e,t)}function Y(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function V(e,t){if(Y(t),e=G(e,t<0?0:0|z(t)),!q.TYPED_ARRAY_SUPPORT)for(var r=0;r<t;++r)e[r]=0;return e}function K(e,t){var r=t.length<0?0:0|z(t.length);e=G(e,r);for(var n=0;n<r;n+=1)e[n]=255&t[n];return e}function z(e){if(e>=B())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+B().toString(16)+" bytes");return 0|e}function W(e){return null!=e&&e._isBuffer}function X(e,t){if(W(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;var r=(e="string"!=typeof e?""+e:e).length;if(0===r)return 0;for(var n=!1;;)switch(t){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":case void 0:return he(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return me(e).length;default:if(n)return he(e).length;t=(""+t).toLowerCase(),n=!0}}function Q(e,t,r){var n,a,i,o=!1;if((t=void 0===t||t<0?0:t)>this.length)return"";if((r=void 0===r||r>this.length?this.length:r)<=0)return"";if((r>>>=0)<=(t>>>=0))return"";for(e=e||"utf8";;)switch(e){case"hex":return function(e,t,r){var n=e.length;(!t||t<0)&&(t=0);(!r||r<0||n<r)&&(r=n);for(var a="",i=t;i<r;++i)a+=function(e){return e<16?"0"+e.toString(16):e.toString(16)}(e[i]);return a}(this,t,r);case"utf8":case"utf-8":return re(this,t,r);case"ascii":return function(e,t,r){var n="";r=Math.min(e.length,r);for(var a=t;a<r;++a)n+=String.fromCharCode(127&e[a]);return n}(this,t,r);case"latin1":case"binary":return function(e,t,r){var n="";r=Math.min(e.length,r);for(var a=t;a<r;++a)n+=String.fromCharCode(e[a]);return n}(this,t,r);case"base64":return n=this,i=r,0===(a=t)&&i===n.length?F(n):F(n.slice(a,i));case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return function(e,t,r){for(var n=e.slice(t,r),a="",i=0;i<n.length;i+=2)a+=String.fromCharCode(n[i]+256*n[i+1]);return a}(this,t,r);default:if(o)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),o=!0}}function J(e,t,r){var n=e[t];e[t]=e[r],e[r]=n}function $(e,t,r,n,a){if(0===e.length)return-1;if("string"==typeof r?(n=r,r=0):2147483647<r?r=2147483647:r<-2147483648&&(r=-2147483648),r=+r,(r=(r=isNaN(r)?a?0:e.length-1:r)<0?e.length+r:r)>=e.length){if(a)return-1;r=e.length-1}else if(r<0){if(!a)return-1;r=0}if(W(t="string"==typeof t?q.from(t,n):t))return 0===t.length?-1:Z(e,t,r,n,a);if("number"==typeof t)return t&=255,q.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?(a?Uint8Array.prototype.indexOf:Uint8Array.prototype.lastIndexOf).call(e,t,r):Z(e,[t],r,n,a);throw new TypeError("val must be string, number or Buffer")}function Z(e,t,r,n,a){var i=1,o=e.length,s=t.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(e.length<2||t.length<2)return-1;o/=i=2,s/=2,r/=2}function l(e,t){return 1===i?e[t]:e.readUInt16BE(t*i)}if(a)for(var u=-1,c=r;c<o;c++)if(l(e,c)===l(t,-1===u?0:c-u)){if(c-(u=-1===u?c:u)+1===s)return u*i}else-1!==u&&(c-=c-u),u=-1;else for(c=r=o<r+s?o-s:r;0<=c;c--){for(var f=!0,d=0;d<s;d++)if(l(e,c+d)!==l(t,d)){f=!1;break}if(f)return c}return-1}function ee(e,t,r,n){return pe(function(e){for(var t=[],r=0;r<e.length;++r)t.push(255&e.charCodeAt(r));return t}(t),e,r,n)}function te(e,t,r,n){return pe(function(e,t){for(var r,n,a=[],i=0;i<e.length&&!((t-=2)<0);++i)n=e.charCodeAt(i),r=n>>8,n=n%256,a.push(n),a.push(r);return a}(t,e.length-r),e,r,n)}function re(e,t,r){r=Math.min(e.length,r);for(var n=[],a=t;a<r;){var i,o,s,l,u=e[a],c=null,f=239<u?4:223<u?3:191<u?2:1;if(a+f<=r)switch(f){case 1:u<128&&(c=u);break;case 2:128==(192&(i=e[a+1]))&&127<(l=(31&u)<<6|63&i)&&(c=l);break;case 3:i=e[a+1],o=e[a+2],128==(192&i)&&128==(192&o)&&2047<(l=(15&u)<<12|(63&i)<<6|63&o)&&(l<55296||57343<l)&&(c=l);break;case 4:i=e[a+1],o=e[a+2],s=e[a+3],128==(192&i)&&128==(192&o)&&128==(192&s)&&65535<(l=(15&u)<<18|(63&i)<<12|(63&o)<<6|63&s)&&l<1114112&&(c=l)}null===c?(c=65533,f=1):65535<c&&(c-=65536,n.push(c>>>10&1023|55296),c=56320|1023&c),n.push(c),a+=f}return function(e){var t=e.length;if(t<=ne)return String.fromCharCode.apply(String,e);var r="",n=0;for(;n<t;)r+=String.fromCharCode.apply(String,e.slice(n,n+=ne));return r}(n)}q.TYPED_ARRAY_SUPPORT=void 0===e.TYPED_ARRAY_SUPPORT||e.TYPED_ARRAY_SUPPORT,q.poolSize=8192,q._augment=function(e){return e.__proto__=q.prototype,e},q.from=function(e,t,r){return H(null,e,t,r)},q.TYPED_ARRAY_SUPPORT&&(q.prototype.__proto__=Uint8Array.prototype,q.__proto__=Uint8Array),q.alloc=function(e,t,r){return n=null,t=t,r=r,Y(e=e),!(e<=0)&&void 0!==t?"string"==typeof r?G(n,e).fill(t,r):G(n,e).fill(t):G(n,e);var n},q.allocUnsafe=function(e){return V(null,e)},q.allocUnsafeSlow=function(e){return V(null,e)},q.isBuffer=ye,q.compare=function(e,t){if(!W(e)||!W(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var r=e.length,n=t.length,a=0,i=Math.min(r,n);a<i;++a)if(e[a]!==t[a]){r=e[a],n=t[a];break}return r<n?-1:n<r?1:0},q.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},q.concat=function(e,t){if(!U(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return q.alloc(0);if(void 0===t)for(a=t=0;a<e.length;++a)t+=e[a].length;for(var r=q.allocUnsafe(t),n=0,a=0;a<e.length;++a){var i=e[a];if(!W(i))throw new TypeError('"list" argument must be an Array of Buffers');i.copy(r,n),n+=i.length}return r},q.byteLength=X,q.prototype._isBuffer=!0,q.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)J(this,t,t+1);return this},q.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)J(this,t,t+3),J(this,t+1,t+2);return this},q.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)J(this,t,t+7),J(this,t+1,t+6),J(this,t+2,t+5),J(this,t+3,t+4);return this},q.prototype.toString=function(){var e=0|this.length;return 0==e?"":0===arguments.length?re(this,0,e):Q.apply(this,arguments)},q.prototype.equals=function(e){if(!W(e))throw new TypeError("Argument must be a Buffer");return this===e||0===q.compare(this,e)},q.prototype.inspect=function(){var e="";return 0<this.length&&(e=this.toString("hex",0,50).match(/.{2}/g).join(" "),50<this.length&&(e+=" ... ")),"<Buffer "+e+">"},q.prototype.compare=function(e,t,r,n,a){if(!W(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===r&&(r=e?e.length:0),void 0===n&&(n=0),void 0===a&&(a=this.length),t<0||r>e.length||n<0||a>this.length)throw new RangeError("out of range index");if(a<=n&&r<=t)return 0;if(a<=n)return-1;if(r<=t)return 1;if(this===e)return 0;for(var i=(a>>>=0)-(n>>>=0),o=(r>>>=0)-(t>>>=0),s=Math.min(i,o),l=this.slice(n,a),u=e.slice(t,r),c=0;c<s;++c)if(l[c]!==u[c]){i=l[c],o=u[c];break}return i<o?-1:o<i?1:0},q.prototype.includes=function(e,t,r){return-1!==this.indexOf(e,t,r)},q.prototype.indexOf=function(e,t,r){return $(this,e,t,r,!0)},q.prototype.lastIndexOf=function(e,t,r){return $(this,e,t,r,!1)},q.prototype.write=function(e,t,r,n){if(void 0===t)n="utf8",r=this.length,t=0;else if(void 0===r&&"string"==typeof t)n=t,r=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(r)?(r|=0,void 0===n&&(n="utf8")):(n=r,r=void 0)}var a=this.length-t;if((void 0===r||a<r)&&(r=a),0<e.length&&(r<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");n=n||"utf8";for(var i,o,s,l=!1;;)switch(n){case"hex":return function(e,t,r,n){r=Number(r)||0;var a=e.length-r;if((!n||a<(n=Number(n)))&&(n=a),(a=t.length)%2!=0)throw new TypeError("Invalid hex string");a/2<n&&(n=a/2);for(var i=0;i<n;++i){var o=parseInt(t.substr(2*i,2),16);if(isNaN(o))return i;e[r+i]=o}return i}(this,e,t,r);case"utf8":case"utf-8":return o=t,s=r,pe(he(e,(i=this).length-o),i,o,s);case"ascii":return ee(this,e,t,r);case"latin1":case"binary":return ee(this,e,t,r);case"base64":return i=this,o=t,s=r,pe(me(e),i,o,s);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return te(this,e,t,r);default:if(l)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),l=!0}},q.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var ne=4096;function oe(e,t,r){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(r<e+t)throw new RangeError("Trying to access beyond buffer length")}function se(e,t,r,n,a,i){if(!W(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(a<t||t<i)throw new RangeError('"value" argument is out of bounds');if(r+n>e.length)throw new RangeError("Index out of range")}function le(e,t,r,n){t<0&&(t=65535+t+1);for(var a=0,i=Math.min(e.length-r,2);a<i;++a)e[r+a]=(t&255<<8*(n?a:1-a))>>>8*(n?a:1-a)}function ue(e,t,r,n){t<0&&(t=4294967295+t+1);for(var a=0,i=Math.min(e.length-r,4);a<i;++a)e[r+a]=t>>>8*(n?a:3-a)&255}function ce(e,t,r,n){if(r+n>e.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function fe(e,t,r,n,a){return a||ce(e,0,r,4),j(e,t,r,n,23,4),r+4}function de(e,t,r,n,a){return a||ce(e,0,r,8),j(e,t,r,n,52,8),r+8}q.prototype.slice=function(e,t){var r=this.length;if((e=~~e)<0?(e+=r)<0&&(e=0):r<e&&(e=r),(t=void 0===t?r:~~t)<0?(t+=r)<0&&(t=0):r<t&&(t=r),t<e&&(t=e),q.TYPED_ARRAY_SUPPORT)(a=this.subarray(e,t)).__proto__=q.prototype;else for(var n=t-e,a=new q(n,void 0),i=0;i<n;++i)a[i]=this[i+e];return a},q.prototype.readUIntLE=function(e,t,r){e|=0,t|=0,r||oe(e,t,this.length);for(var n=this[e],a=1,i=0;++i<t&&(a*=256);)n+=this[e+i]*a;return n},q.prototype.readUIntBE=function(e,t,r){e|=0,t|=0,r||oe(e,t,this.length);for(var n=this[e+--t],a=1;0<t&&(a*=256);)n+=this[e+--t]*a;return n},q.prototype.readUInt8=function(e,t){return t||oe(e,1,this.length),this[e]},q.prototype.readUInt16LE=function(e,t){return t||oe(e,2,this.length),this[e]|this[e+1]<<8},q.prototype.readUInt16BE=function(e,t){return t||oe(e,2,this.length),this[e]<<8|this[e+1]},q.prototype.readUInt32LE=function(e,t){return t||oe(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},q.prototype.readUInt32BE=function(e,t){return t||oe(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},q.prototype.readIntLE=function(e,t,r){e|=0,t|=0,r||oe(e,t,this.length);for(var n=this[e],a=1,i=0;++i<t&&(a*=256);)n+=this[e+i]*a;return(a*=128)<=n&&(n-=Math.pow(2,8*t)),n},q.prototype.readIntBE=function(e,t,r){e|=0,t|=0,r||oe(e,t,this.length);for(var n=t,a=1,i=this[e+--n];0<n&&(a*=256);)i+=this[e+--n]*a;return(a*=128)<=i&&(i-=Math.pow(2,8*t)),i},q.prototype.readInt8=function(e,t){return t||oe(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},q.prototype.readInt16LE=function(e,t){t||oe(e,2,this.length);e=this[e]|this[e+1]<<8;return 32768&e?4294901760|e:e},q.prototype.readInt16BE=function(e,t){t||oe(e,2,this.length);e=this[e+1]|this[e]<<8;return 32768&e?4294901760|e:e},q.prototype.readInt32LE=function(e,t){return t||oe(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},q.prototype.readInt32BE=function(e,t){return t||oe(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},q.prototype.readFloatLE=function(e,t){return t||oe(e,4,this.length),x(this,e,!0,23,4)},q.prototype.readFloatBE=function(e,t){return t||oe(e,4,this.length),x(this,e,!1,23,4)},q.prototype.readDoubleLE=function(e,t){return t||oe(e,8,this.length),x(this,e,!0,52,8)},q.prototype.readDoubleBE=function(e,t){return t||oe(e,8,this.length),x(this,e,!1,52,8)},q.prototype.writeUIntLE=function(e,t,r,n){e=+e,t|=0,r|=0,n||se(this,e,t,r,Math.pow(2,8*r)-1,0);var a=1,i=0;for(this[t]=255&e;++i<r&&(a*=256);)this[t+i]=e/a&255;return t+r},q.prototype.writeUIntBE=function(e,t,r,n){e=+e,t|=0,r|=0,n||se(this,e,t,r,Math.pow(2,8*r)-1,0);var a=r-1,i=1;for(this[t+a]=255&e;0<=--a&&(i*=256);)this[t+a]=e/i&255;return t+r},q.prototype.writeUInt8=function(e,t,r){return e=+e,t|=0,r||se(this,e,t,1,255,0),q.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},q.prototype.writeUInt16LE=function(e,t,r){return e=+e,t|=0,r||se(this,e,t,2,65535,0),q.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):le(this,e,t,!0),t+2},q.prototype.writeUInt16BE=function(e,t,r){return e=+e,t|=0,r||se(this,e,t,2,65535,0),q.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):le(this,e,t,!1),t+2},q.prototype.writeUInt32LE=function(e,t,r){return e=+e,t|=0,r||se(this,e,t,4,4294967295,0),q.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):ue(this,e,t,!0),t+4},q.prototype.writeUInt32BE=function(e,t,r){return e=+e,t|=0,r||se(this,e,t,4,4294967295,0),q.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):ue(this,e,t,!1),t+4},q.prototype.writeIntLE=function(e,t,r,n){e=+e,t|=0,n||se(this,e,t,r,(n=Math.pow(2,8*r-1))-1,-n);var a=0,i=1,o=0;for(this[t]=255&e;++a<r&&(i*=256);)e<0&&0===o&&0!==this[t+a-1]&&(o=1),this[t+a]=(e/i>>0)-o&255;return t+r},q.prototype.writeIntBE=function(e,t,r,n){e=+e,t|=0,n||se(this,e,t,r,(n=Math.pow(2,8*r-1))-1,-n);var a=r-1,i=1,o=0;for(this[t+a]=255&e;0<=--a&&(i*=256);)e<0&&0===o&&0!==this[t+a+1]&&(o=1),this[t+a]=(e/i>>0)-o&255;return t+r},q.prototype.writeInt8=function(e,t,r){return e=+e,t|=0,r||se(this,e,t,1,127,-128),(e=!q.TYPED_ARRAY_SUPPORT?Math.floor(e):e)<0&&(e=255+e+1),this[t]=255&e,t+1},q.prototype.writeInt16LE=function(e,t,r){return e=+e,t|=0,r||se(this,e,t,2,32767,-32768),q.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):le(this,e,t,!0),t+2},q.prototype.writeInt16BE=function(e,t,r){return e=+e,t|=0,r||se(this,e,t,2,32767,-32768),q.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):le(this,e,t,!1),t+2},q.prototype.writeInt32LE=function(e,t,r){return e=+e,t|=0,r||se(this,e,t,4,2147483647,-2147483648),q.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):ue(this,e,t,!0),t+4},q.prototype.writeInt32BE=function(e,t,r){return e=+e,t|=0,r||se(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),q.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):ue(this,e,t,!1),t+4},q.prototype.writeFloatLE=function(e,t,r){return fe(this,e,t,!0,r)},q.prototype.writeFloatBE=function(e,t,r){return fe(this,e,t,!1,r)},q.prototype.writeDoubleLE=function(e,t,r){return de(this,e,t,!0,r)},q.prototype.writeDoubleBE=function(e,t,r){return de(this,e,t,!1,r)},q.prototype.copy=function(e,t,r,n){if(r=r||0,n||0===n||(n=this.length),t=(t=t>=e.length?e.length:t)||0,(n=0<n&&n<r?r:n)===r)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("sourceStart out of bounds");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length);var a,i=(n=e.length-t<n-r?e.length-t+r:n)-r;if(this===e&&r<t&&t<n)for(a=i-1;0<=a;--a)e[a+t]=this[a+r];else if(i<1e3||!q.TYPED_ARRAY_SUPPORT)for(a=0;a<i;++a)e[a+t]=this[a+r];else Uint8Array.prototype.set.call(e,this.subarray(r,r+i),t);return i},q.prototype.fill=function(e,t,r,n){if("string"==typeof e){var a;if("string"==typeof t?(n=t,t=0,r=this.length):"string"==typeof r&&(n=r,r=this.length),1!==e.length||(a=e.charCodeAt(0))<256&&(e=a),void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!q.isEncoding(n))throw new TypeError("Unknown encoding: "+n)}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<r)throw new RangeError("Out of range index");if(r<=t)return this;if(t>>>=0,r=void 0===r?this.length:r>>>0,"number"==typeof(e=e||0))for(s=t;s<r;++s)this[s]=e;else for(var i=W(e)?e:he(new q(e,n).toString()),o=i.length,s=0;s<r-t;++s)this[s+t]=i[s%o];return this};var ge=/[^+\/0-9A-Za-z-_]/g;function he(e,t){var r;t=t||1/0;for(var n=e.length,a=null,i=[],o=0;o<n;++o){if(55295<(r=e.charCodeAt(o))&&r<57344){if(!a){if(56319<r){-1<(t-=3)&&i.push(239,191,189);continue}if(o+1===n){-1<(t-=3)&&i.push(239,191,189);continue}a=r;continue}if(r<56320){-1<(t-=3)&&i.push(239,191,189),a=r;continue}r=65536+(a-55296<<10|r-56320)}else a&&-1<(t-=3)&&i.push(239,191,189);if(a=null,r<128){if(--t<0)break;i.push(r)}else if(r<2048){if((t-=2)<0)break;i.push(r>>6|192,63&r|128)}else if(r<65536){if((t-=3)<0)break;i.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;i.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return i}function me(e){return function(e){var t;O||P();var r=e.length;if(0<r%4)throw new Error("Invalid string. Length must be a multiple of 4");for(var n="="===e[r-2]?2:"="===e[r-1]?1:0,a=new M(3*r/4-n),i=0<n?r-4:r,o=0,s=0;s<i;s+=4,0)t=D[e.charCodeAt(s)]<<18|D[e.charCodeAt(s+1)]<<12|D[e.charCodeAt(s+2)]<<6|D[e.charCodeAt(s+3)],a[o++]=t>>16&255,a[o++]=t>>8&255,a[o++]=255&t;return 2==n?(t=D[e.charCodeAt(s)]<<2|D[e.charCodeAt(s+1)]>>4,a[o++]=255&t):1==n&&(t=D[e.charCodeAt(s)]<<10|D[e.charCodeAt(s+1)]<<4|D[e.charCodeAt(s+2)]>>2,a[o++]=t>>8&255,a[o++]=255&t),a}(function(e){var t;if((e=((t=e).trim?t.trim():t.replace(/^\s+|\s+$/g,"")).replace(ge,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function pe(e,t,r,n){for(var a=0;a<n&&!(a+r>=t.length||a>=e.length);++a)t[a+r]=e[a];return a}function ye(e){return null!=e&&(!!e._isBuffer||Ee(e)||"function"==typeof(e=e).readFloatLE&&"function"==typeof e.slice&&Ee(e.slice(0,0)))}function Ee(e){return!!e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)}var _e,ve,Te=(function(e){var t;self,t=()=>(()=>{var r={"./externals/base64.js":(e,t)=>{var i,o,r,n={encode:function(e){for(var t=[],r=0;r<e.length;++r){var n=e.charCodeAt(r);n<128?t.push(n):(n<2048?t.push(192|n>>6):(n<65536?t.push(224|n>>12):(t.push(240|n>>18),t.push(128|63&n>>12)),t.push(128|63&n>>6)),t.push(128|63&n))}return t},decode:function(e){for(var t=[],r=0;r<e.length;){var n=e[r++];n<128||(n<224?n=(31&n)<<6:(n<240?n=(15&n)<<12:(n=(7&n)<<18,n|=(63&e[r++])<<12),n|=(63&e[r++])<<6),n|=63&e[r++]),t.push(String.fromCharCode(n))}return t.join("")}},l={};function u(e){for(var t=0,r=[],n=0|e.length/3;0<n--;){var a=(e[t]<<16)+(e[t+1]<<8)+e[t+2];t+=3,r.push(i.charAt(63&a>>18)),r.push(i.charAt(63&a>>12)),r.push(i.charAt(63&a>>6)),r.push(i.charAt(63&a))}return 2==e.length-t?(a=(e[t]<<16)+(e[t+1]<<8),r.push(i.charAt(63&a>>18)),r.push(i.charAt(63&a>>12)),r.push(i.charAt(63&a>>6)),r.push("=")):1==e.length-t&&(a=e[t]<<16,r.push(i.charAt(63&a>>18)),r.push(i.charAt(63&a>>12)),r.push("==")),r.join("")}function c(e){for(var t=0,r=[],n=0|e.length/4;0<n--;){var a=(o[e.charCodeAt(t)]<<18)+(o[e.charCodeAt(t+1)]<<12)+(o[e.charCodeAt(t+2)]<<6)+o[e.charCodeAt(t+3)];r.push(255&a>>16),r.push(255&a>>8),r.push(255&a),t+=4}return r&&("="==e.charAt(t-2)?(r.pop(),r.pop()):"="==e.charAt(t-1)&&r.pop()),r}i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",o=function(){for(var e=[],t=0;t<i.length;++t)e[i.charCodeAt(t)]=t;return e["=".charCodeAt(0)]=0,e}(),r={encode:function(e){for(var t=[],r=0;r<e.length;++r)t.push(e.charCodeAt(r));return t},decode:function(e){for(var t=0;t<s.length;++t)a[t]=String.fromCharCode(a[t]);return a.join("")}},l.decodeArray=function(e){e=c(e);return new Uint8Array(e)},l.encodeASCII=function(e){e=r.encode(e);return u(e)},l.decodeASCII=function(e){e=c(e);return r.decode(e)},l.encode=function(e){e=n.encode(e);return u(e)},l.decode=function(e){e=c(e);return n.decode(e)},t.decode=l.decode,t.decodeArray=l.decodeArray,t.encode=l.encode,t.encodeASCII=l.encodeASCII},"./externals/cea608-parser.js":(e,t)=>{function o(e){var t=e;return c.hasOwnProperty(e)&&(t=c[e]),String.fromCharCode(t)}function s(e){for(var t=[],r=0;r<e.length;r++)t.push(e[r].toString(16));return t}function l(e,t,r,n,a){this.foreground=e||"white",this.underline=t||!1,this.italics=r||!1,this.background=n||"black",this.flash=a||!1}function r(e,t,r,n,a,i){this.uchar=e||" ",this.penState=new l(t,r,n,a,i)}function n(){this.chars=[];for(var e=0;e<32;e++)this.chars.push(new r);this.pos=0,this.currPenState=new l}function a(){this.rows=[];for(var e=0;e<15;e++)this.rows.push(new n);this.currRow=14,this.nrRollUpRows=null,this.reset()}function i(e,t){this.chNr=e,this.outputFilter=t,this.mode=null,this.verbose=0,this.displayedMemory=new a,this.nonDisplayedMemory=new a,this.lastOutputScreen=new a,this.currRollUpRow=this.displayedMemory.rows[14],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null}function u(e,t,r){this.field=e||1,this.outputs=[t,r],this.channels=[new i(1,t),new i(2,r)],this.currChNr=-1,this.lastCmdA=null,this.lastCmdB=null,this.bufferedData=[],this.startTime=null,this.lastTime=null,this.dataCounters={padding:0,char:0,cmd:0,other:0}}var c,f,d,g,h,m,p;t=t,c={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},f={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},d={17:2,18:4,21:6,22:8,23:10,19:13,20:15},g={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},h={25:2,26:4,29:6,30:8,31:10,27:13,28:15},m=["white","green","blue","cyan","red","yellow","magenta","black","transparent"],p={verboseFilter:{DATA:3,DEBUG:3,INFO:2,WARNING:2,TEXT:1,ERROR:0},time:null,verboseLevel:0,setTime:function(e){this.time=e},log:function(e,t){var r=this.verboseFilter[e];this.verboseLevel>=r&&console.log(this.time+" ["+e+"] "+t)}},l.prototype={reset:function(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1},setStyles:function(e){for(var t=["foreground","underline","italics","background","flash"],r=0;r<t.length;r++){var n=t[r];e.hasOwnProperty(n)&&(this[n]=e[n])}},isDefault:function(){return"white"===this.foreground&&!this.underline&&!this.italics&&"black"===this.background&&!this.flash},equals:function(e){return this.foreground===e.foreground&&this.underline===e.underline&&this.italics===e.italics&&this.background===e.background&&this.flash===e.flash},copy:function(e){this.foreground=e.foreground,this.underline=e.underline,this.italics=e.italics,this.background=e.background,this.flash=e.flash},toString:function(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash}},r.prototype={reset:function(){this.uchar=" ",this.penState.reset()},setChar:function(e,t){this.uchar=e,this.penState.copy(t)},setPenState:function(e){this.penState.copy(e)},equals:function(e){return this.uchar===e.uchar&&this.penState.equals(e.penState)},copy:function(e){this.uchar=e.uchar,this.penState.copy(e.penState)},isEmpty:function(){return" "===this.uchar&&this.penState.isDefault()}},n.prototype={equals:function(e){for(var t=!0,r=0;r<32;r++)if(!this.chars[r].equals(e.chars[r])){t=!1;break}return t},copy:function(e){for(var t=0;t<32;t++)this.chars[t].copy(e.chars[t])},isEmpty:function(){for(var e=!0,t=0;t<32;t++)if(!this.chars[t].isEmpty()){e=!1;break}return e},setCursor:function(e){this.pos!==e&&(this.pos=e),this.pos<0?(p.log("ERROR","Negative cursor position "+this.pos),this.pos=0):32<this.pos&&(p.log("ERROR","Too large cursor position "+this.pos),this.pos=32)},moveCursor:function(e){var t=this.pos+e;if(1<e)for(var r=this.pos+1;r<t+1;r++)this.chars[r].setPenState(this.currPenState);this.setCursor(t)},backSpace:function(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)},insertChar:function(e){144<=e&&this.backSpace();var t=o(e);32<=this.pos?p.log("ERROR","Cannot insert "+e.toString(16)+" ("+t+") at position "+this.pos+". Skipping it!"):(this.chars[this.pos].setChar(t,this.currPenState),this.moveCursor(1))},clearFromPos:function(e){for(var t=e;t<32;t++)this.chars[t].reset()},clear:function(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()},clearToEndOfRow:function(){this.clearFromPos(this.pos)},getTextString:function(){for(var e=[],t=!0,r=0;r<32;r++){var n=this.chars[r].uchar;" "!==n&&(t=!1),e.push(n)}return t?"":e.join("")},setPenStyles:function(e){this.currPenState.setStyles(e),this.chars[this.pos].setPenState(this.currPenState)}},a.prototype={reset:function(){for(var e=0;e<15;e++)this.rows[e].clear();this.currRow=14},equals:function(e){for(var t=!0,r=0;r<15;r++)if(!this.rows[r].equals(e.rows[r])){t=!1;break}return t},copy:function(e){for(var t=0;t<15;t++)this.rows[t].copy(e.rows[t])},isEmpty:function(){for(var e=!0,t=0;t<15;t++)if(!this.rows[t].isEmpty()){e=!1;break}return e},backSpace:function(){this.rows[this.currRow].backSpace()},clearToEndOfRow:function(){this.rows[this.currRow].clearToEndOfRow()},insertChar:function(e){this.rows[this.currRow].insertChar(e)},setPen:function(e){this.rows[this.currRow].setPenStyles(e)},moveCursor:function(e){this.rows[this.currRow].moveCursor(e)},setCursor:function(e){p.log("INFO","setCursor: "+e),this.rows[this.currRow].setCursor(e)},setPAC:function(e){p.log("INFO","pacData = "+JSON.stringify(e));var t=e.row-1;this.nrRollUpRows&&t<this.nrRollUpRows-1&&(t=this.nrRollUpRows-1),this.currRow=t;var r=this.rows[this.currRow];null!==e.indent&&(t=e.indent,t=Math.max(t-1,0),r.setCursor(e.indent),e.color=r.chars[t].penState.foreground);e={foreground:e.color,underline:e.underline,italics:e.italics,background:"black",flash:!1};this.setPen(e)},setBkgData:function(e){p.log("INFO","bkgData = "+JSON.stringify(e)),this.backSpace(),this.setPen(e),this.insertChar(32)},setRollUpRows:function(e){this.nrRollUpRows=e},rollUp:function(){var e;null!==this.nrRollUpRows?(p.log("TEXT",this.getDisplayText()),e=this.currRow+1-this.nrRollUpRows,(e=this.rows.splice(e,1)[0]).clear(),this.rows.splice(this.currRow,0,e),p.log("INFO","Rolling up")):p.log("DEBUG","roll_up but nrRollUpRows not set yet")},getDisplayText:function(e){e=e||!1;for(var t,r=[],n="",a=0;a<15;a++){var i=this.rows[a].getTextString();i&&(t=a+1,e?r.push("Row "+t+': "'+i+'"'):r.push(i.trim()))}return n=0<r.length?e?"["+r.join(" | ")+"]":r.join("\n"):n},getTextAndFormat:function(){return this.rows}},i.prototype={modes:["MODE_ROLL-UP","MODE_POP-ON","MODE_PAINT-ON","MODE_TEXT"],reset:function(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.currRollUpRow=this.displayedMemory.rows[14],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.lastCueEndTime=null},getHandler:function(){return this.outputFilter},setHandler:function(e){this.outputFilter=e},setPAC:function(e){this.writeScreen.setPAC(e)},setBkgData:function(e){this.writeScreen.setBkgData(e)},setMode:function(e){e!==this.mode&&(this.mode=e,p.log("INFO","MODE="+e),"MODE_POP-ON"==this.mode?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),"MODE_ROLL-UP"!==this.mode&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=e)},insertChars:function(e){for(var t=0;t<e.length;t++)this.writeScreen.insertChar(e[t]);var r=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";p.log("INFO",r+": "+this.writeScreen.getDisplayText(!0)),"MODE_PAINT-ON"!==this.mode&&"MODE_ROLL-UP"!==this.mode||(p.log("TEXT","DISPLAYED: "+this.displayedMemory.getDisplayText(!0)),this.outputDataUpdate())},cc_RCL:function(){p.log("INFO","RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")},cc_BS:function(){p.log("INFO","BS - BackSpace"),"MODE_TEXT"!==this.mode&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())},cc_AOF:function(){},cc_AON:function(){},cc_DER:function(){p.log("INFO","DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()},cc_RU:function(e){p.log("INFO","RU("+e+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(e)},cc_FON:function(){p.log("INFO","FON - Flash On"),this.writeScreen.setPen({flash:!0})},cc_RDC:function(){p.log("INFO","RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")},cc_TR:function(){p.log("INFO","TR"),this.setMode("MODE_TEXT")},cc_RTD:function(){p.log("INFO","RTD"),this.setMode("MODE_TEXT")},cc_EDM:function(){p.log("INFO","EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate()},cc_CR:function(){p.log("CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate()},cc_ENM:function(){p.log("INFO","ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset()},cc_EOC:function(){var e;p.log("INFO","EOC - End Of Caption"),"MODE_POP-ON"===this.mode&&(e=this.displayedMemory,this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=e,this.writeScreen=this.nonDisplayedMemory,p.log("TEXT","DISP: "+this.displayedMemory.getDisplayText())),this.outputDataUpdate()},cc_TO:function(e){p.log("INFO","TO("+e+") - Tab Offset"),this.writeScreen.moveCursor(e)},cc_MIDROW:function(e){var t={flash:!1};t.underline=e%2==1,t.italics=46<=e,t.italics?t.foreground="white":(e=Math.floor(e/2)-16,t.foreground=["white","green","blue","cyan","red","yellow","magenta"][e]),p.log("INFO","MIDROW: "+JSON.stringify(t)),this.writeScreen.setPen(t)},outputDataUpdate:function(){var e=p.time;null!==e&&this.outputFilter&&(this.outputFilter.updateData&&this.outputFilter.updateData(e,this.displayedMemory),null!==this.cueStartTime||this.displayedMemory.isEmpty()?this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,e,this.lastOutputScreen),this.cueStartTime=this.displayedMemory.isEmpty()?null:e):this.cueStartTime=e,this.lastOutputScreen.copy(this.displayedMemory))},cueSplitAtTime:function(e){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,e,this.displayedMemory),this.cueStartTime=e))}},u.prototype={getHandler:function(e){return this.channels[e].getHandler()},setHandler:function(e,t){this.channels[e].setHandler(t)},addData:function(e,t){var r,n=!1;this.lastTime=e,p.setTime(e);for(var a=0;a<t.length;a+=2){var i=127&t[a],o=127&t[a+1];16<=i&&i<=31&&i===this.lastCmdA&&o===this.lastCmdB?(this.lastCmdA=null,this.lastCmdB=null,p.log("DEBUG","Repeated command ("+s([i,o])+") is dropped")):0!=i||0!=o?(p.log("DATA","["+s([t[a],t[a+1]])+"] -> ("+s([i,o])+")"),(r=(r=(r=(r=this.parseCmd(i,o))||this.parseMidrow(i,o))||this.parsePAC(i,o))||this.parseBackgroundAttributes(i,o))||(n=this.parseChars(i,o))&&(this.currChNr&&0<=this.currChNr?this.channels[this.currChNr-1].insertChars(n):p.log("WARNING","No channel found yet. TEXT-MODE?")),r?this.dataCounters.cmd+=2:n?this.dataCounters.char+=2:(this.dataCounters.other+=2,p.log("WARNING","Couldn't parse cleaned data "+s([i,o])+" orig: "+s([t[a],t[a+1]])))):this.dataCounters.padding+=2}},parseCmd:function(e,t){var r=null;if(!((20===e||21===e||28===e||29===e)&&32<=t&&t<=47)&&!((23===e||31===e)&&33<=t&&t<=35))return!1;var r=20===e||21===e||23===e?1:2,n=this.channels[r-1];return 20===e||21===e||28===e||29===e?32===t?n.cc_RCL():33===t?n.cc_BS():34===t?n.cc_AOF():35===t?n.cc_AON():36===t?n.cc_DER():37===t?n.cc_RU(2):38===t?n.cc_RU(3):39===t?n.cc_RU(4):40===t?n.cc_FON():41===t?n.cc_RDC():42===t?n.cc_TR():43===t?n.cc_RTD():44===t?n.cc_EDM():45===t?n.cc_CR():46===t?n.cc_ENM():47===t&&n.cc_EOC():n.cc_TO(t-32),this.lastCmdA=e,this.lastCmdB=t,this.currChNr=r,!0},parseMidrow:function(e,t){var r=null;if((17===e||25===e)&&32<=t&&t<=47){if((r=17===e?1:2)!==this.currChNr)return p.log("ERROR","Mismatch channel in midrow parsing"),!1;r=this.channels[r-1];return r.insertChars([32]),r.cc_MIDROW(t),p.log("DEBUG","MIDROW ("+s([e,t])+")"),this.lastCmdA=e,this.lastCmdB=t,!0}return!1},parsePAC:function(e,t){var r=null;if(!((17<=e&&e<=23||25<=e&&e<=31)&&64<=t&&t<=127)&&!((16===e||24===e)&&64<=t&&t<=95))return!1;var n=e<=23?1:2,r=(64<=t&&t<=95?1==n?f:g:1==n?d:h)[e],r=this.interpretPAC(r,t);return this.channels[n-1].setPAC(r),this.lastCmdA=e,this.lastCmdB=t,this.currChNr=n,!0},interpretPAC:function(e,t){var r=t,e={color:null,italics:!1,indent:null,underline:!1,row:e},r=95<t?t-96:t-64;return e.underline=1==(1&r),r<=13?e.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(r/2)]:r<=15?(e.italics=!0,e.color="white"):e.indent=4*Math.floor((r-16)/2),e},parseChars:function(e,t){var r,n=null,a=null,i=null;return 17<=(i=25<=e?(n=2,e-8):(n=1,e))&&i<=19?(r=t,r=17===i?t+80:18===i?t+112:t+144,p.log("INFO","Special char '"+o(r)+"' in channel "+n),a=[r],this.lastCmdA=e,this.lastCmdB=t):32<=e&&e<=127&&(a=0===t?[e]:[e,t],this.lastCmdA=null,this.lastCmdB=null),a&&(t=s(a),p.log("DEBUG","Char codes =  "+t.join(","))),a},parseBackgroundAttributes:function(e,t){var r,n;return((16===e||24===e)&&32<=t&&t<=47||(23===e||31===e)&&45<=t&&t<=47)&&(r={},16===e||24===e?(n=Math.floor((t-32)/2),r.background=m[n],t%2==1&&(r.background=r.background+"_semi")):45===t?r.background="transparent":(r.foreground="black",47===t&&(r.underline=!0)),n=e<24?1:2,this.channels[n-1].setBkgData(r),this.lastCmdA=e,this.lastCmdB=t,!0)},reset:function(){for(var e=0;e<this.channels.length;e++)this.channels[e]&&this.channels[e].reset();this.lastCmdA=null,this.lastCmdB=null},cueSplitAtTime:function(e){for(var t=0;t<this.channels.length;t++)this.channels[t]&&this.channels[t].cueSplitAtTime(e)}},t.logger=p,t.PenState=l,t.CaptionScreen=a,t.Cea608Parser=u,t.findCea608Nalus=function(e,t,r){for(var n,a=t,i=[];a<t+r;){if(n=e.getUint32(a),6==(31&e.getUint8(a+4)))for(var o=a+5,s=-1;o<a+4+n-1;){for(var s=0,l=255;255===l;)s+=l=e.getUint8(o),o++;for(var u=0,l=255;255===l;)u+=l=e.getUint8(o),o++;!function(e,t,r,n){if(4!==e||t<8)return null;var a=r.getUint8(n),e=r.getUint16(n+1),t=r.getUint32(n+3),n=r.getUint8(n+7);return 181==a&&49==e&&1195456820==t&&3==n}(s,u,e,o)||i.push([o,u]),o+=u}a+=n+4}return i},t.extractCea608DataFromRange=function(e,t){var r=t[0],n=[[],[]];r+=8;var a=31&e.getUint8(r);r+=2;for(var i=0;i<a;i++){var o=e.getUint8(r),s=4&o,l=3&o;r++;var u=e.getUint8(r);r++;o=e.getUint8(r);r++,s&&(127&u)+(127&o)!=0&&(0==l?(n[0].push(u),n[0].push(o)):1==l&&(n[1].push(u),n[1].push(o)))}return n}},"./externals/xml2json.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>n});const n=function(S){void 0===(S=S||{}).escapeMode&&(S.escapeMode=!0),void 0===S.attributePrefix&&(S.attributePrefix="_"),S.arrayAccessForm=S.arrayAccessForm||"none",S.emptyNodeForm=S.emptyNodeForm||"text",void 0===S.enableToStringFunc&&(S.enableToStringFunc=!0),S.arrayAccessFormPaths=S.arrayAccessFormPaths||[],void 0===S.skipEmptyTextNodesForObj&&(S.skipEmptyTextNodesForObj=!0),void 0===S.stripWhitespaces&&(S.stripWhitespaces=!0),S.datetimeAccessFormPaths=S.datetimeAccessFormPaths||[],void 0===S.useDoubleQuotes&&(S.useDoubleQuotes=!1),S.xmlElementsFilter=S.xmlElementsFilter||[],S.jsonPropertiesFilter=S.jsonPropertiesFilter||[],void 0===S.keepCData&&(S.keepCData=!1),void 0===S.ignoreRoot&&(S.ignoreRoot=!1);var A={ELEMENT_NODE:1,TEXT_NODE:3,CDATA_SECTION_NODE:4,COMMENT_NODE:8,DOCUMENT_NODE:9};function R(e){var t=e.localName;return t=null==(t=null==t?e.baseName:t)||""==t?e.nodeName:t}function l(e){return"string"==typeof e?e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;"):e}function I(e,t,r,n){for(var a=0;a<e.length;a++){var i=e[a];if("string"==typeof i){if(i==n)break}else if(i instanceof RegExp){if(i.test(n))break}else if("function"==typeof i&&i(t,r,n))break}return a!=e.length}function w(e,t,r){"property"===S.arrayAccessForm&&(e[t]instanceof Array?e[t+"_asArray"]=e[t]:e[t+"_asArray"]=[e[t]]),!(e[t]instanceof Array)&&0<S.arrayAccessFormPaths.length&&I(S.arrayAccessFormPaths,e,t,r)&&(e[t]=[e[t]])}function C(e){var t=e.split(/[-T:+Z]/g),r=new Date(t[0],t[1]-1,t[2]),n=t[5].split(".");return r.setHours(t[3],t[4],n[0]),1<n.length&&r.setMilliseconds(n[1]),t[6]&&t[7]?(t=60*t[6]+Number(t[7]),t=0+("-"==(/\d\d-\d\d:\d\d$/.test(e)?"-":"+")?-1*t:t),r.setMinutes(r.getMinutes()-t-r.getTimezoneOffset())):-1!==e.indexOf("Z",e.length-1)&&(r=new Date(Date.UTC(r.getFullYear(),r.getMonth(),r.getDate(),r.getHours(),r.getMinutes(),r.getSeconds(),r.getMilliseconds()))),r}function N(e,t){if(e.nodeType==A.DOCUMENT_NODE){for(var r=new Object,n=e.childNodes,a=0;a<n.length;a++)(o=n[a]).nodeType==A.ELEMENT_NODE&&(S.ignoreRoot?r=N(o):(r={})[c=R(o)]=N(o));return r}if(e.nodeType==A.ELEMENT_NODE){(r=new Object).__cnt=0;for(var i=[],n=e.childNodes,a=0;a<n.length;a++){var o,s,l,u,c=R(o=n[a]);o.nodeType!=A.COMMENT_NODE&&(s=t+"."+c,_=r,v=o.nodeType,T=c,b=s,v==A.ELEMENT_NODE&&0<S.xmlElementsFilter.length&&!I(S.xmlElementsFilter,_,T,b)||(r.__cnt++,null==r[c]?(l=N(o,s),"#text"==c&&!/[^\s]/.test(l)||((u={})[c]=l,i.push(u)),r[c]=l,w(r,c,s)):(null!=r[c]&&(r[c]instanceof Array||(r[c]=[r[c]],w(r,c,s))),l=N(o,s),"#text"==c&&!/[^\s]/.test(l)||((u={})[c]=l,i.push(u)),r[c][r[c].length]=l)))}r.__children=i;for(var f=R(e),d=0;d<e.attributes.length;d++){var g=e.attributes[d];r.__cnt++;for(var h=g.value,m=0,p=S.matchers.length;m<p;m++){var y=S.matchers[m];y.test(g,f)&&(h=y.converter(g.value))}r[S.attributePrefix+g.name]=h}var E=e.prefix;return null!=E&&""!=E&&(r.__cnt++,r.__prefix=E),null!=r["#text"]&&(r.__text=r["#text"],r.__text instanceof Array&&(r.__text=r.__text.join("\n")),S.stripWhitespaces&&(r.__text=r.__text.trim()),delete r["#text"],"property"==S.arrayAccessForm&&delete r["#text_asArray"],r.__text=function(e,t,r){if(0<S.datetimeAccessFormPaths.length){r=r.split(".#")[0];return I(S.datetimeAccessFormPaths,e,t,r)?C(e):e}return e}(r.__text,c,t+"."+c)),null!=r["#cdata-section"]&&(r.__cdata=r["#cdata-section"],delete r["#cdata-section"],"property"==S.arrayAccessForm&&delete r["#cdata-section_asArray"]),0==r.__cnt&&"text"==S.emptyNodeForm?r="":1==r.__cnt&&null!=r.__text?r=r.__text:1!=r.__cnt||null==r.__cdata||S.keepCData?1<r.__cnt&&null!=r.__text&&S.skipEmptyTextNodesForObj&&(S.stripWhitespaces&&""==r.__text||""==r.__text.trim())&&delete r.__text:r=r.__cdata,delete r.__cnt,!S.enableToStringFunc||null==r.__text&&null==r.__cdata||(r.toString=function(){return(null!=this.__text?this.__text:"")+(null!=this.__cdata?this.__cdata:"")}),r}if(e.nodeType==A.TEXT_NODE||e.nodeType==A.CDATA_SECTION_NODE)return e.nodeValue;var _,v,T,b}function s(e,t,r,n){var a="<"+(null!=e&&null!=e.__prefix?e.__prefix+":":"")+t;if(null!=r)for(var i=0;i<r.length;i++){var o=r[i],s=e[o];S.escapeMode&&(s=l(s)),a+=" "+o.substr(S.attributePrefix.length)+"=",S.useDoubleQuotes?a+='"'+s+'"':a+="'"+s+"'"}return a+=n?"/>":">"}function u(e,t){return"</"+(null!=e.__prefix?e.__prefix+":":"")+t+">"}function c(e,t){return"property"==S.arrayAccessForm&&(r=t.toString(),n="_asArray",-1!==r.indexOf(n,r.length-n.length))||0==t.toString().indexOf(S.attributePrefix)||0==t.toString().indexOf("__")||e[t]instanceof Function;var r,n}function f(e){var t=0;if(e instanceof Object)for(var r in e)c(e,r)||t++;return t}function d(e){var t=[];if(e instanceof Object)for(var r in e)-1==r.toString().indexOf("__")&&0==r.toString().indexOf(S.attributePrefix)&&t.push(r);return t}function g(e){var t,r,n="";return e instanceof Object?n+=(r="",null!=(t=e).__cdata&&(r+="<![CDATA["+t.__cdata+"]]>"),null!=t.__text&&(S.escapeMode?r+=l(t.__text):r+=t.__text),r):null!=e&&(S.escapeMode?n+=l(e):n+=e),n}function h(e,t){return""===e?t:e+"."+t}function m(e,t){var r,n,a,i="";if(0<f(e))for(var o in e)c(e,o)||""!=t&&(r=e,a=h(t,n=o),0!=S.jsonPropertiesFilter.length&&""!=a&&!I(S.jsonPropertiesFilter,r,n,a))||(a=d(n=e[o]),null==n||null==n?i+=s(n,o,a,!0):n instanceof Object?n instanceof Array?i+=function(e,t,r,n){var a="";if(0==e.length)a+=s(e,t,r,!0);else for(var i=0;i<e.length;i++)a+=s(e[i],t,d(e[i]),!1),a+=m(e[i],h(n,t)),a+=u(e[i],t);return a}(n,o,a,t):n instanceof Date?(i+=s(n,o,a,!1),i+=n.toISOString(),i+=u(n,o)):0<f(n)||null!=n.__text||null!=n.__cdata?(i+=s(n,o,a,!1),i+=m(n,h(t,o)),i+=u(n,o)):i+=s(n,o,a,!0):(i+=s(n,o,a,!1),i+=g(n),i+=u(n,o)));return i+=g(e)}this.parseXmlString=function(e){var t;window.ActiveXObject||0 in window;if(void 0===e)return null;if(window.DOMParser){var r=new window.DOMParser;try{0<(t=r.parseFromString(e,"text/xml")).getElementsByTagNameNS("*","parsererror").length&&(t=null)}catch(e){t=null}}else 0==e.indexOf("<?")&&(e=e.substr(e.indexOf("?>")+2)),(t=new ActiveXObject("Microsoft.XMLDOM")).async="false",t.loadXML(e);return t},this.asArray=function(e){return void 0===e||null==e?[]:e instanceof Array?e:[e]},this.toXmlDateTime=function(e){return e instanceof Date?e.toISOString():"number"==typeof e?new Date(e).toISOString():null},this.asDateTime=function(e){return"string"==typeof e?C(e):e},this.xml2json=function(e){return N(e)},this.xml_str2json=function(e){e=this.parseXmlString(e);return null!=e?this.xml2json(e):null},this.json2xml_str=function(e){return m(e,"")},this.json2xml=function(e){e=this.json2xml_str(e);return this.parseXmlString(e)},this.getVersion=function(){return"1.2.0"}}},"./index_mediaplayerOnly.js":(e,t,r)=>{r.r(t),r.d(t,{Debug:()=>i.default,FactoryMaker:()=>a.default,MediaPlayer:()=>n.default,default:()=>s});var n=r("./src/streaming/MediaPlayer.js"),a=r("./src/core/FactoryMaker.js"),i=r("./src/core/Debug.js"),o=r("./src/core/Version.js"),t=r("./node_modules/es6-promise/auto.js"),t="undefined"!=typeof window&&window||r.g,r=t.dashjs;(r=r||(t.dashjs={})).MediaPlayer=n.default,r.FactoryMaker=a.default,r.Debug=i.default,r.Version=(0,o.getVersionString)();const s=r},"./src/core/Debug.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>s});var a=r("./src/core/EventBus.js"),g=r("./src/core/events/Events.js"),t=r("./src/core/FactoryMaker.js"),i=1,o=2,h=3,m=4,p=5;function n(e){e=e||{};var s,l,u,t=this.context,c=(0,a.default)(t).getInstance(),f=e.settings,d=[];function r(e){return(e&&e.bind?e:window.console.log).bind(window.console)}function n(e,t){var r,n="";s&&(r=(new Date).getTime(),n+="["+(r-u)+"]"),l&&t&&t.getClassName&&(n+="["+t.getClassName()+"]",t.getType&&(n+="["+t.getType()+"]")),0<n.length&&(n+=" ");for(var a=arguments.length,i=new Array(2<a?a-2:0),o=2;o<a;o++)i[o-2]=arguments[o];Array.apply(null,i).forEach(function(e){n+=e+" "}),d[e]&&f&&f.get().debug.logLevel>=e&&d[e](n),f&&f.get().debug.dispatchEvent&&c.trigger(g.default.LOG,{message:n,level:e})}return e={getLogger:function(e){return{fatal:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];n.apply(void 0,[i,this].concat(t))}.bind(e),error:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];n.apply(void 0,[o,this].concat(t))}.bind(e),warn:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];n.apply(void 0,[h,this].concat(t))}.bind(e),info:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];n.apply(void 0,[m,this].concat(t))}.bind(e),debug:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];n.apply(void 0,[p,this].concat(t))}.bind(e)}},setLogTimestampVisible:function(e){s=e},setCalleeNameVisible:function(e){l=e}},l=s=!0,u=(new Date).getTime(),"undefined"!=typeof window&&window.console&&(d[i]=r(window.console.error),d[o]=r(window.console.error),d[h]=r(window.console.warn),d[m]=r(window.console.info),d[p]=r(window.console.debug)),e}n.__dashjs_factory_name="Debug";r=t.default.getSingletonFactory(n);r.LOG_LEVEL_NONE=0,r.LOG_LEVEL_FATAL=i,r.LOG_LEVEL_ERROR=o,r.LOG_LEVEL_WARNING=h,r.LOG_LEVEL_INFO=m,r.LOG_LEVEL_DEBUG=p,t.default.updateSingletonFactory(n.__dashjs_factory_name,r);const s=r},"./src/core/EventBus.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>i});var t=r("./src/core/FactoryMaker.js"),n=r("./src/streaming/MediaPlayerEvents.js");function a(){var o={};function s(e,r,n){var a=-1;return o[e]&&o[e].some(function(e,t){if(e&&e.callback===r&&(!n||n===e.scope))return a=t,!0}),a}return{on:function(r,e,t){var n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:{};if(!r)throw new Error("event type cannot be null or undefined");if(!e||"function"!=typeof e)throw new Error("listener must be a function: "+e);var a,i=n.priority||0;0<=s(r,e,t)||(o[r]=o[r]||[],a={callback:e,scope:t,priority:i},t&&t.getStreamId&&(a.streamId=t.getStreamId()),t&&t.getType&&(a.mediaType=t.getType()),n&&n.mode&&(a.mode=n.mode),o[r].some(function(e,t){if(e&&i>e.priority)return o[r].splice(t,0,a),!0})||o[r].push(a))},off:function(e,t,r){e&&t&&o[e]&&((r=s(e,t,r))<0||(o[e][r]=null))},trigger:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{};if(e&&o[e]){if((t=t||{}).hasOwnProperty("type"))throw new Error("'type' is a reserved word for event dispatching");t.type=e,r.streamId&&(t.streamId=r.streamId),r.mediaType&&(t.mediaType=r.mediaType),o[e].filter(function(e){return!!e&&((!r.streamId||!e.streamId||e.streamId===r.streamId)&&((!r.mediaType||!e.mediaType||e.mediaType===r.mediaType)&&!(r.mode&&e.mode&&e.mode!==r.mode||!e.mode&&r.mode&&r.mode===n.default.EVENT_MODE_ON_RECEIVE)))}).forEach(function(e){return e&&e.callback.call(e.scope,t)})}},reset:function(){o={}}}}a.__dashjs_factory_name="EventBus";r=t.default.getSingletonFactory(a);r.EVENT_PRIORITY_LOW=0,r.EVENT_PRIORITY_HIGH=5e3,t.default.updateSingletonFactory(a.__dashjs_factory_name,r);const i=r},"./src/core/FactoryMaker.js":(e,t,r)=>{var l,i,n,a;function o(e,t){for(var r in i){r=i[r];if(r.context===e&&r.name===t)return r.instance}return null}function s(e,t){return t[e]}function u(e,t,r){e in r&&(r[e]=t)}function c(e,t,r){var n,a=e.__dashjs_factory_name,i=t[a];if(i){var o,s=i.instance;if(!i.override)return s.apply({context:t,factory:l},r);for(o in n=e.apply({context:t},r),s=s.apply({context:t,factory:l,parent:n},r))n.hasOwnProperty(o)&&(n[o]=s[o])}else n=e.apply({context:t},r);return n.getClassName=function(){return a},n}r.r(t),r.d(t,{default:()=>f});const f=(i=[],n={},a={},l={extend:function(e,t,r,n){!n[e]&&t&&(n[e]={instance:t,override:r})},getSingletonInstance:o,setSingletonInstance:function(e,t,r){for(var n in i){var a=i[n];if(a.context===e&&a.name===t)return void(i[n].instance=r)}i.push({name:t,context:e,instance:r})},deleteSingletonInstances:function(t){i=i.filter(function(e){return e.context!==t})},getSingletonFactory:function(r){var e=s(r.__dashjs_factory_name,n);return e||(e=function(e){var t;return void 0===e&&(e={}),{getInstance:function(){return(t=t||o(e,r.__dashjs_factory_name))||(t=c(r,e,arguments),i.push({name:r.__dashjs_factory_name,context:e,instance:t})),t}}},n[r.__dashjs_factory_name]=e),e},getSingletonFactoryByName:function(e){return n[e]},updateSingletonFactory:function(e,t){u(e,t,n)},getClassFactory:function(t){var e=s(t.__dashjs_factory_name,a);return e||(e=function(e){return void 0===e&&(e={}),{create:function(){return c(t,e,arguments)}}},a[t.__dashjs_factory_name]=e),e},getClassFactoryByName:function(e){return a[e]},updateClassFactory:function(e,t){u(e,t,a)}})},"./src/core/Settings.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>o});var t=r("./src/core/FactoryMaker.js"),s=r("./src/core/Utils.js"),n=r("./src/core/Debug.js"),a=r("./src/streaming/constants/Constants.js"),l=r("./src/streaming/vo/metrics/HTTPRequest.js"),u=r("./src/core/EventBus.js"),c=r("./src/core/events/Events.js");function f(e){return(f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function d(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function i(){var e=this.context,i=(0,u.default)(e).getInstance(),o={"streaming.delay.liveDelay":c.default.SETTING_UPDATED_LIVE_DELAY,"streaming.delay.liveDelayFragmentCount":c.default.SETTING_UPDATED_LIVE_DELAY_FRAGMENT_COUNT,"streaming.liveCatchup.enabled":c.default.SETTING_UPDATED_CATCHUP_ENABLED,"streaming.liveCatchup.playbackRate.min":c.default.SETTING_UPDATED_PLAYBACK_RATE_MIN,"streaming.liveCatchup.playbackRate.max":c.default.SETTING_UPDATED_PLAYBACK_RATE_MAX},t={debug:{logLevel:n.default.LOG_LEVEL_WARNING,dispatchEvent:!1},streaming:{abandonLoadTimeout:1e4,wallclockTimeUpdateInterval:100,manifestUpdateRetryInterval:100,cacheInitSegments:!1,applyServiceDescription:!0,applyProducerReferenceTime:!0,applyContentSteering:!0,eventControllerRefreshDelay:100,enableManifestDurationMismatchFix:!0,enableManifestTimescaleMismatchFix:!1,capabilities:{filterUnsupportedEssentialProperties:!0,useMediaCapabilitiesApi:!1},timeShiftBuffer:{calcFromSegmentTimeline:!1,fallbackToSegmentTimeline:!0},metrics:{maxListDepth:100},delay:{liveDelayFragmentCount:NaN,liveDelay:NaN,useSuggestedPresentationDelay:!0},protection:{keepProtectionMediaKeys:!1,ignoreEmeEncryptedEvent:!1,detectPlayreadyMessageFormat:!0},buffer:{enableSeekDecorrelationFix:!1,fastSwitchEnabled:!0,flushBufferAtTrackSwitch:!1,reuseExistingSourceBuffers:!0,bufferPruningInterval:10,bufferToKeep:20,bufferTimeAtTopQuality:30,bufferTimeAtTopQualityLongForm:60,initialBufferLevel:NaN,stableBufferTime:12,longFormContentDurationThreshold:600,stallThreshold:.3,useAppendWindow:!0,setStallState:!0,avoidCurrentTimeRangePruning:!1,useChangeTypeForTrackSwitch:!0},gaps:{jumpGaps:!0,jumpLargeGaps:!0,smallGapLimit:1.5,threshold:.3,enableSeekFix:!0,enableStallFix:!1,stallSeek:.1},utcSynchronization:{enabled:!0,useManifestDateHeaderTimeSource:!0,backgroundAttempts:2,timeBetweenSyncAttempts:30,maximumTimeBetweenSyncAttempts:600,minimumTimeBetweenSyncAttempts:2,timeBetweenSyncAttemptsAdjustmentFactor:2,maximumAllowedDrift:100,enableBackgroundSyncAfterSegmentDownloadError:!0,defaultTimingSource:{scheme:"urn:mpeg:dash:utc:http-xsdate:2014",value:"https://time.akamai.com/?iso&ms"}},scheduling:{defaultTimeout:500,lowLatencyTimeout:0,scheduleWhilePaused:!0},text:{defaultEnabled:!0,extendSegmentedCues:!0,webvtt:{customRenderingEnabled:!1}},liveCatchup:{maxDrift:NaN,playbackRate:{min:NaN,max:NaN},playbackBufferMin:.5,enabled:null,mode:a.default.LIVE_CATCHUP_MODE_DEFAULT},lastBitrateCachingInfo:{enabled:!0,ttl:36e4},lastMediaSettingsCachingInfo:{enabled:!0,ttl:36e4},cacheLoadThresholds:{video:50,audio:5},trackSwitchMode:{audio:a.default.TRACK_SWITCH_MODE_ALWAYS_REPLACE,video:a.default.TRACK_SWITCH_MODE_NEVER_REPLACE},selectionModeForInitialTrack:a.default.TRACK_SELECTION_MODE_HIGHEST_SELECTION_PRIORITY,fragmentRequestTimeout:2e4,manifestRequestTimeout:1e4,retryIntervals:(d(e={},l.HTTPRequest.MPD_TYPE,500),d(e,l.HTTPRequest.XLINK_EXPANSION_TYPE,500),d(e,l.HTTPRequest.MEDIA_SEGMENT_TYPE,1e3),d(e,l.HTTPRequest.INIT_SEGMENT_TYPE,1e3),d(e,l.HTTPRequest.BITSTREAM_SWITCHING_SEGMENT_TYPE,1e3),d(e,l.HTTPRequest.INDEX_SEGMENT_TYPE,1e3),d(e,l.HTTPRequest.MSS_FRAGMENT_INFO_SEGMENT_TYPE,1e3),d(e,l.HTTPRequest.LICENSE,1e3),d(e,l.HTTPRequest.OTHER_TYPE,1e3),d(e,"lowLatencyReductionFactor",10),e),retryAttempts:(d(e={},l.HTTPRequest.MPD_TYPE,3),d(e,l.HTTPRequest.XLINK_EXPANSION_TYPE,1),d(e,l.HTTPRequest.MEDIA_SEGMENT_TYPE,3),d(e,l.HTTPRequest.INIT_SEGMENT_TYPE,3),d(e,l.HTTPRequest.BITSTREAM_SWITCHING_SEGMENT_TYPE,3),d(e,l.HTTPRequest.INDEX_SEGMENT_TYPE,3),d(e,l.HTTPRequest.MSS_FRAGMENT_INFO_SEGMENT_TYPE,3),d(e,l.HTTPRequest.LICENSE,3),d(e,l.HTTPRequest.OTHER_TYPE,3),d(e,"lowLatencyMultiplyFactor",5),e),abr:{movingAverageMethod:a.default.MOVING_AVERAGE_SLIDING_WINDOW,ABRStrategy:a.default.ABR_STRATEGY_DYNAMIC,additionalAbrRules:{insufficientBufferRule:!0,switchHistoryRule:!0,droppedFramesRule:!0,abandonRequestsRule:!0},bandwidthSafetyFactor:.9,useDefaultABRRules:!0,useDeadTimeLatency:!0,limitBitrateByPortal:!1,usePixelRatioInLimitBitrateByPortal:!1,maxBitrate:{audio:-1,video:-1},minBitrate:{audio:-1,video:-1},maxRepresentationRatio:{audio:1,video:1},initialBitrate:{audio:-1,video:-1},initialRepresentationRatio:{audio:-1,video:-1},autoSwitchBitrate:{audio:!0,video:!0},fetchThroughputCalculationMode:a.default.ABR_FETCH_THROUGHPUT_CALCULATION_MOOF_PARSING},cmcd:{enabled:!1,sid:null,cid:null,rtp:null,rtpSafetyFactor:5,mode:a.default.CMCD_MODE_QUERY,enabledKeys:["br","d","ot","tb","bl","dl","mtp","nor","nrr","su","bs","rtp","cid","pr","sf","sid","st","v"]},cmsd:{enabled:!1,abr:{applyMb:!1,etpWeightRatio:0}}},errors:{recoverAttempts:{mediaErrorDecode:5}}},r=s.default.clone(t);return{get:function(){return r},update:function(e){"object"===f(e)&&!function e(t,r,n){for(var a in t)t.hasOwnProperty(a)&&(r.hasOwnProperty(a)?"object"!==f(t[a])||t[a]instanceof Array||null===t[a]?(r[a]=s.default.clone(t[a]),o[n+a]&&i.trigger(o[n+a])):e(t[a],r[a],n.slice()+a+"."):console.error("Settings parameter "+n+a+" is not supported"))}(e,r,"")},reset:function(){r=s.default.clone(t)}}}i.__dashjs_factory_name="Settings";const o=t.default.getSingletonFactory(i)},"./src/core/Utils.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>o});var t=r("./node_modules/path-browserify/index.js"),i=r.n(t),n=r("./node_modules/ua-parser-js/src/ua-parser.js");function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}const o=function(){function o(){!function(e){if(!(e instanceof o))throw new TypeError("Cannot call a class as a function")}(this)}var e,t,r;return e=o,r=[{key:"mixin",value:function(e,t,r){var n,a={};if(e)for(var i in t)t.hasOwnProperty(i)&&(n=t[i],i in e&&(e[i]===n||i in a&&a[i]===n)||("object"===s(e[i])&&null!==e[i]?e[i]=o.mixin(e[i],n,r):e[i]=r(n)));return e}},{key:"clone",value:function(e){if(!e||"object"!==s(e))return e;if(e instanceof Array)for(var t=[],r=0,n=e.length;r<n;++r)r in e&&t.push(o.clone(e[r]));else t={};return o.mixin(t,e,o.clone)}},{key:"addAditionalQueryParameterToUrl",value:function(t,e){try{if(!e||0===e.length)return t;var r=new URL(t);return e.forEach(function(e){e.key&&e.value&&r.searchParams.set(e.key,e.value)}),r.href}catch(e){return t}}},{key:"parseHttpHeaders",value:function(e){var t={};if(!e)return t;for(var r=e.trim().split("\r\n"),n=0,a=r.length;n<a;n++){var i=r[n],o=i.indexOf(": ");0<o&&(t[i.substring(0,o)]=i.substring(o+2))}return t}},{key:"generateUuid",value:function(){var r=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=(r+16*Math.random())%16|0;return r=Math.floor(r/16),("x"==e?t:3&t|8).toString(16)})}},{key:"generateHashCode",value:function(e){var t=0;if(0===e.length)return t;for(var r=0;r<e.length;r++){t=(t<<5)-t+e.charCodeAt(r);t|=0}return t}},{key:"getRelativeUrl",value:function(e,t){try{var r=new URL(e),n=new URL(t);if(r.protocol=n.protocol,r.origin!==n.origin)return t;var a=i().relative(r.pathname.substr(0,r.pathname.lastIndexOf("/")),n.pathname.substr(0,n.pathname.lastIndexOf("/"))),r=0===a.length?1:0;return a+=n.pathname.substr(n.pathname.lastIndexOf("/")+r,n.pathname.length-1),n.pathname.length<a.length?n.pathname:a}catch(e){return t}}},{key:"parseUserAgent",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null;try{var t=null===e&&"undefined"!=typeof navigator?navigator.userAgent.toLowerCase():"";return(0,n.UAParser)(t)}catch(e){return{}}}}],(t=null)&&a(e.prototype,t),r&&a(e,r),o}()},"./src/core/Version.js":(e,t,r)=>{r.r(t),r.d(t,{getVersionString:()=>function(){return n}});var n="4.6.0"},"./src/core/errors/Errors.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>l});var n=r("./src/core/errors/ErrorsBase.js");function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){return(i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function o(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=s(r);return e=n?(e=s(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),t=this,!(e=e)||"object"!==a(e)&&"function"!=typeof e?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(t):e}}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}const l=new(function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&i(e,t)}(r,n["default"]);var t=o(r);function r(){var e;return function(e){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}(this),(e=t.call(this)).MANIFEST_LOADER_PARSING_FAILURE_ERROR_CODE=10,e.MANIFEST_LOADER_LOADING_FAILURE_ERROR_CODE=11,e.XLINK_LOADER_LOADING_FAILURE_ERROR_CODE=12,e.SEGMENT_BASE_LOADER_ERROR_CODE=15,e.TIME_SYNC_FAILED_ERROR_CODE=16,e.FRAGMENT_LOADER_LOADING_FAILURE_ERROR_CODE=17,e.FRAGMENT_LOADER_NULL_REQUEST_ERROR_CODE=18,e.URL_RESOLUTION_FAILED_GENERIC_ERROR_CODE=19,e.APPEND_ERROR_CODE=20,e.REMOVE_ERROR_CODE=21,e.DATA_UPDATE_FAILED_ERROR_CODE=22,e.CAPABILITY_MEDIASOURCE_ERROR_CODE=23,e.CAPABILITY_MEDIAKEYS_ERROR_CODE=24,e.DOWNLOAD_ERROR_ID_MANIFEST_CODE=25,e.DOWNLOAD_ERROR_ID_SIDX_CODE=26,e.DOWNLOAD_ERROR_ID_CONTENT_CODE=27,e.DOWNLOAD_ERROR_ID_INITIALIZATION_CODE=28,e.DOWNLOAD_ERROR_ID_XLINK_CODE=29,e.MANIFEST_ERROR_ID_PARSE_CODE=31,e.MANIFEST_ERROR_ID_NOSTREAMS_CODE=32,e.TIMED_TEXT_ERROR_ID_PARSE_CODE=33,e.MANIFEST_ERROR_ID_MULTIPLEXED_CODE=34,e.MEDIASOURCE_TYPE_UNSUPPORTED_CODE=35,e.MANIFEST_LOADER_PARSING_FAILURE_ERROR_MESSAGE="parsing failed for ",e.MANIFEST_LOADER_LOADING_FAILURE_ERROR_MESSAGE="Failed loading manifest: ",e.XLINK_LOADER_LOADING_FAILURE_ERROR_MESSAGE="Failed loading Xlink element: ",e.SEGMENTS_UPDATE_FAILED_ERROR_MESSAGE="Segments update failed",e.SEGMENTS_UNAVAILABLE_ERROR_MESSAGE="no segments are available yet",e.SEGMENT_BASE_LOADER_ERROR_MESSAGE="error loading segment ranges from sidx",e.TIME_SYNC_FAILED_ERROR_MESSAGE="Failed to synchronize client and server time",e.FRAGMENT_LOADER_NULL_REQUEST_ERROR_MESSAGE="request is null",e.URL_RESOLUTION_FAILED_GENERIC_ERROR_MESSAGE="Failed to resolve a valid URL",e.APPEND_ERROR_MESSAGE="chunk is not defined",e.REMOVE_ERROR_MESSAGE="Removing data from the SourceBuffer",e.DATA_UPDATE_FAILED_ERROR_MESSAGE="Data update failed",e.CAPABILITY_MEDIASOURCE_ERROR_MESSAGE="mediasource is not supported",e.CAPABILITY_MEDIAKEYS_ERROR_MESSAGE="mediakeys is not supported",e.TIMED_TEXT_ERROR_MESSAGE_PARSE="parsing error :",e.MEDIASOURCE_TYPE_UNSUPPORTED_MESSAGE="Error creating source buffer of type : ",e}return r}())},"./src/core/errors/ErrorsBase.js":(e,t,r)=>{function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}r.r(t),r.d(t,{default:()=>n});const n=function(){function t(){!function(e){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this)}var e,r,n;return e=t,(r=[{key:"extend",value:function(e,t){if(e){var r,n=!!t&&t.override,a=!!t&&t.publicOnly;for(r in e)!e.hasOwnProperty(r)||this[r]&&!n||a&&-1===e[r].indexOf("public_")||(this[r]=e[r])}}}])&&a(e.prototype,r),n&&a(e,n),t}()},"./src/core/events/CoreEvents.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>l});var n=r("./src/core/events/EventsBase.js");function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){return(i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function o(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=s(r);return e=n?(e=s(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),t=this,!(e=e)||"object"!==a(e)&&"function"!=typeof e?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(t):e}}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}const l=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&i(e,t)}(r,n["default"]);var t=o(r);function r(){var e;return function(e){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}(this),(e=t.call(this)).ATTEMPT_BACKGROUND_SYNC="attemptBackgroundSync",e.BUFFERING_COMPLETED="bufferingCompleted",e.BUFFER_CLEARED="bufferCleared",e.BYTES_APPENDED_END_FRAGMENT="bytesAppendedEndFragment",e.BUFFER_REPLACEMENT_STARTED="bufferReplacementStarted",e.CHECK_FOR_EXISTENCE_COMPLETED="checkForExistenceCompleted",e.CMSD_STATIC_HEADER="cmsdStaticHeader",e.CURRENT_TRACK_CHANGED="currentTrackChanged",e.DATA_UPDATE_COMPLETED="dataUpdateCompleted",e.INBAND_EVENTS="inbandEvents",e.INITIAL_STREAM_SWITCH="initialStreamSwitch",e.INIT_FRAGMENT_LOADED="initFragmentLoaded",e.INIT_FRAGMENT_NEEDED="initFragmentNeeded",e.INTERNAL_MANIFEST_LOADED="internalManifestLoaded",e.ORIGINAL_MANIFEST_LOADED="originalManifestLoaded",e.LOADING_COMPLETED="loadingCompleted",e.LOADING_PROGRESS="loadingProgress",e.LOADING_DATA_PROGRESS="loadingDataProgress",e.LOADING_ABANDONED="loadingAborted",e.MANIFEST_UPDATED="manifestUpdated",e.MEDIA_FRAGMENT_LOADED="mediaFragmentLoaded",e.MEDIA_FRAGMENT_NEEDED="mediaFragmentNeeded",e.QUOTA_EXCEEDED="quotaExceeded",e.SEGMENT_LOCATION_BLACKLIST_ADD="segmentLocationBlacklistAdd",e.SEGMENT_LOCATION_BLACKLIST_CHANGED="segmentLocationBlacklistChanged",e.SERVICE_LOCATION_BLACKLIST_ADD="serviceLocationBlacklistAdd",e.SERVICE_LOCATION_BLACKLIST_CHANGED="serviceLocationBlacklistChanged",e.SET_FRAGMENTED_TEXT_AFTER_DISABLED="setFragmentedTextAfterDisabled",e.SET_NON_FRAGMENTED_TEXT="setNonFragmentedText",e.SOURCE_BUFFER_ERROR="sourceBufferError",e.STREAMS_COMPOSED="streamsComposed",e.STREAM_BUFFERING_COMPLETED="streamBufferingCompleted",e.STREAM_REQUESTING_COMPLETED="streamRequestingCompleted",e.TEXT_TRACKS_QUEUE_INITIALIZED="textTracksQueueInitialized",e.TIME_SYNCHRONIZATION_COMPLETED="timeSynchronizationComplete",e.UPDATE_TIME_SYNC_OFFSET="updateTimeSyncOffset",e.URL_RESOLUTION_FAILED="urlResolutionFailed",e.VIDEO_CHUNK_RECEIVED="videoChunkReceived",e.WALLCLOCK_TIME_UPDATED="wallclockTimeUpdated",e.XLINK_ELEMENT_LOADED="xlinkElementLoaded",e.XLINK_READY="xlinkReady",e.SEEK_TARGET="seekTarget",e.SETTING_UPDATED_LIVE_DELAY="settingUpdatedLiveDelay",e.SETTING_UPDATED_LIVE_DELAY_FRAGMENT_COUNT="settingUpdatedLiveDelayFragmentCount",e.SETTING_UPDATED_CATCHUP_ENABLED="settingUpdatedCatchupEnabled",e.SETTING_UPDATED_PLAYBACK_RATE_MIN="settingUpdatedPlaybackRateMin",e.SETTING_UPDATED_PLAYBACK_RATE_MAX="settingUpdatedPlaybackRateMax",e}return r}()},"./src/core/events/Events.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>l});var n=r("./src/core/events/CoreEvents.js");function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){return(i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function o(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=s(r);return e=n?(e=s(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),t=this,!(e=e)||"object"!==a(e)&&"function"!=typeof e?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(t):e}}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}const l=new(function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&i(e,t)}(t,n["default"]);var e=o(t);function t(){return function(e){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),e.apply(this,arguments)}return t}())},"./src/core/events/EventsBase.js":(e,t,r)=>{function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}r.r(t),r.d(t,{default:()=>n});const n=function(){function t(){!function(e){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this)}var e,r,n;return e=t,(r=[{key:"extend",value:function(e,t){if(e){var r,n=!!t&&t.override,a=!!t&&t.publicOnly;for(r in e)!e.hasOwnProperty(r)||this[r]&&!n||a&&-1===e[r].indexOf("public_")||(this[r]=e[r])}}}])&&a(e.prototype,r),n&&a(e,n),t}()},"./src/dash/DashAdapter.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>i});var A=r("./src/dash/constants/DashConstants.js"),R=r("./src/dash/vo/RepresentationInfo.js"),I=r("./src/dash/vo/MediaInfo.js"),w=r("./src/dash/vo/StreamInfo.js"),C=r("./src/dash/vo/ManifestInfo.js"),N=r("./src/dash/vo/Event.js"),n=r("./src/core/FactoryMaker.js"),D=r("./src/dash/models/DashManifestModel.js"),M=r("./src/dash/models/PatchManifestModel.js"),t=r("./node_modules/bcp-47-normalize/index.js"),O=r.n(t);function a(){var e,y,i,c,f,E,a,t=this.context;function n(e,t,r){var n,a=y.getAdaptationsForType(c[0].mpd.manifest,e,t);if(!a||0===a.length)return null;if(1<a.length&&r){var i=g(r,t);if(f[r.id]&&f[r.id][t])for(var o=0,s=a.length;o<s;o++)if(d(f[r.id][t],i[o]))return a[o];for(var l=0,u=a.length;l<u;l++)if(n=a[l],y.getRolesForAdaptation(n).filter(function(e){return e.value===A.default.MAIN})[0])return a[l]}return a[0]}function d(e,t){if(!e||!t)return!1;var r=e.id===t.id,n=e.codec===t.codec,a=e.viewpoint===t.viewpoint,i=e.lang===t.lang,o=e.roles.toString()===t.roles.toString(),s=e.accessibility.toString()===t.accessibility.toString(),t=e.audioChannelConfiguration.toString()===t.audioChannelConfiguration.toString();return r&&n&&a&&i&&o&&s&&t}function o(e,t,r,n,a,i){var o,s,l,u=[];if(!n||0===n.length)return[];for(var c=y.getAdaptationsForPeriod(t),f=0,d=n.length;f<d;f++)if(o=n[f],s=_(c[l=y.getIndexForAdaptation(o,e,r.index)]),i){for(var g=s.accessibility.length,h=0;h<g;h++)if(s){var m=s.accessibility[h];if(0===m.indexOf("cea-608:")){var p=m.substring(8).split(";");if("CC"===p[0].substring(0,2))for(h=0;h<p.length;h++)v(s=s||_.call(this,c[l]),p[h].substring(0,3),p[h].substring(4)),u.push(s),s=null;else for(h=0;h<p.length;h++)v(s=s||_.call(this,c[l]),"CC"+(h+1),p[h]),u.push(s),s=null}else 0===m.indexOf("cea-608")&&(v(s,E.CC1,"eng"),u.push(s),s=null)}}else a===E.IMAGE?(s.type=E.IMAGE,u.push(s),s=null):s&&u.push(s);return u}function g(e,t,r){var n=c,a=r,i=[];if(a)T(),n=s(a);else{if(!(0<c.length))return i;a=c[0].mpd.manifest}r=m(e,n),n=y.getAdaptationsForType(a,e?e.index:null,t),i=o(a,r,e,n,t);return t===E.TEXT&&(n=y.getAdaptationsForType(a,e?e.index:null,E.VIDEO),i=i.concat(o(a,r,e,n,t,!0))),i}function s(e){e=r(e);return y.getRegularPeriods(e)}function r(e){e=u(e);return y.getMpd(e)}function l(){c=[],f={}}function u(e){return e||(0<c.length?c[0].mpd.manifest:null)}function h(e){try{var t=m(e.streamInfo,c),t=y.getAdaptationsForPeriod(t);return e&&e.streamInfo&&void 0!==e.streamInfo.id&&t?t[e.index]:null}catch(e){return null}}function m(e,t){for(var r=t.length,n=0;n<r;n++){var a=t[n];if(e&&e.id===a.id)return a}return null}function _(e){if(!e)return null;var t,n=new I.default,r=e.period.mpd.manifest.Period_asArray[e.period.index].AdaptationSet_asArray[e.index];return n.id=e.id,n.index=e.index,n.type=e.type,n.streamInfo=p(e.period),n.representationCount=y.getRepresentationCount(r),n.labels=y.getLabelsForAdaptation(r),n.lang=y.getLanguageForAdaptation(r),e=y.getViewpointForAdaptation(r),n.viewpoint=e?e.value:void 0,n.accessibility=y.getAccessibilityForAdaptation(r).map(function(e){var t=e.value,r=t;return e.schemeIdUri&&0<=e.schemeIdUri.search("cea-608")&&void 0!==a&&(r=t?"cea-608:"+t:"cea-608",n.embeddedCaptions=!0),r}),n.audioChannelConfiguration=y.getAudioChannelConfigurationForAdaptation(r).map(function(e){return e.value}),0===n.audioChannelConfiguration.length&&Array.isArray(r.Representation_asArray)&&0<r.Representation_asArray.length&&(n.audioChannelConfiguration=y.getAudioChannelConfigurationForRepresentation(r.Representation_asArray[0]).map(function(e){return e.value})),n.roles=y.getRolesForAdaptation(r).map(function(e){return e.value}),n.codec=y.getCodec(r),n.mimeType=y.getMimeType(r),n.contentProtection=y.getContentProtectionData(r),n.bitrateList=y.getBitrateListForAdaptation(r),n.selectionPriority=y.getSelectionPriority(r),!n.contentProtection||(e=n.contentProtection.map(function(e){return y.getKID(e)}).filter(function(e){return null!==e})).length&&(t=e[0],n.contentProtection.forEach(function(e){e.keyId=t})),n.isText=y.getIsText(r),n.supplementalProperties=y.getSupplementalProperties(r),n.isFragmented=y.getIsFragmented(r),n.isEmbedded=!1,n}function v(e,t,r){e.id=t,e.index=100+parseInt(t.substring(2,3)),e.type=E.TEXT,e.codec="cea-608-in-SEI",e.isEmbedded=!0,e.isFragmented=!1,e.lang=O()(r),e.roles=["caption"]}function p(e){var t,r,n=new w.default;return n.id=e.id,n.index=e.index,n.start=e.start,n.duration=e.duration,n.manifestInfo=(t=e.mpd,(r=new C.default).dvrWindowSize=t.timeShiftBufferDepth,r.loadedTime=t.manifest.loadedTime,r.availableFrom=t.availabilityStartTime,r.minBufferTime=t.manifest.minBufferTime,r.maxFragmentDuration=t.maxSegmentDuration,r.duration=y.getDuration(t.manifest),r.isDynamic=y.getIsDynamic(t.manifest),r.serviceDescriptions=y.getServiceDescriptions(t.manifest),r.protocol=t.manifest.protocol,r),n.isLast=1===e.mpd.manifest.Period_asArray.length||Math.abs(n.start+n.duration-n.manifestInfo.duration)<1,n}function T(){if(!E)throw new Error("setConfig function has to be called previously")}function b(e){return 0<c.length?c[0].mpd.manifest.Period_asArray[e]:null}function S(e,t,r){var n,a,i,o,s;if(e)for(n=e.AdaptationSet_asArray,o=0;o<n.length;o+=1)for(i=n[o].Representation_asArray,s=0;s<i.length;s+=1)if(t===(a=i[s]).id)return r?s:a;return null}return e={getBandwidthForRepresentation:function(e,t){return(e=S(b(t),e))?e.bandwidth:null},getIndexForRepresentation:function(e,t){return function(e,t){t=S(e,t,!0);return null!==t?t:-1}(b(t),e)},getMaxIndexForBufferType:function(e,t){return function(e,t){var r,n,a,i;if(!e||!t)return-1;for(n=e.AdaptationSet_asArray,i=0;i<n.length;i+=1)if(r=n[i],a=r.Representation_asArray,y.getIsTypeOf(r,t))return a.length;return-1}(b(t),e)},convertRepresentationToRepresentationInfo:function(e){if(e){var t=new R.default,r=e.adaptation.period.mpd.manifest.Period_asArray[e.adaptation.period.index].AdaptationSet_asArray[e.adaptation.index],r=y.getRepresentationFor(e.index,r);return t.id=e.id,t.quality=e.index,t.bandwidth=y.getBandwidth(r),t.fragmentDuration=e.segmentDuration||(e.segments&&0<e.segments.length?e.segments[0].duration:NaN),t.MSETimeOffset=e.MSETimeOffset,t.mediaInfo=_(e.adaptation),t}return null},getStreamsInfo:function(e,t){var r=[],n=c;if(e&&(T(),n=s(e)),0<n.length){(!t||t>n.length)&&(t=n.length);for(var a=0;a<t;a++)r.push(p(n[a]))}return r},getMediaInfoForType:function(e,t){if(0===c.length||!e)return null;var r=m(e,c);return r?(r=y.getAdaptationsForPeriod(r),(t=n(e.index,t,e))?_(r[y.getIndexForAdaptation(t,c[0].mpd.manifest,e.index)]):null):null},getAllMediaInfoForType:g,getAdaptationForType:n,getRealAdaptation:function(e,t){var r,n=m(e,c),e=t?t.id:null;return r=0<c.length&&n?e?y.getAdaptationForId(e,c[0].mpd.manifest,n.index):y.getAdaptationForIndex(t?t.index:null,c[0].mpd.manifest,n.index):r},getProducerReferenceTimes:function(e,t){var r,n=m(e,c),e=t?t.id:null;return(r=0<c.length&&n?e?y.getAdaptationForId(e,c[0].mpd.manifest,n.index):y.getAdaptationForIndex(t?t.index:null,c[0].mpd.manifest,n.index):r)?y.getProducerReferenceTimesForAdaptation(r):[]},getRealPeriodByIndex:function(e){return y.getRealPeriodForIndex(e,c[0].mpd.manifest)},getEssentialPropertiesForRepresentation:function(e){try{return y.getEssentialPropertiesForRepresentation(e)}catch(e){return[]}},getVoRepresentations:function(e){return e=h(e),y.getRepresentationsForAdaptation(e)},getEventsFor:function(e,t,r){var n,a,i=[];return 0<c.length&&(n=c[0].mpd.manifest,e instanceof w.default?(a=m(e,c),i=y.getEventsForPeriod(a)):e instanceof I.default?(a=m(r,c),i=y.getEventStreamForAdaptationSet(n,h(e),a)):e instanceof R.default&&(r=m(r,c),i=y.getEventStreamForRepresentation(n,t,r))),i},getEvent:function(e,t,r,n){try{if(!e||!t||isNaN(r)||!n)return null;var a=e.scheme_id_uri,i=e.value;if(!t[a+"/"+i])return null;var o=new N.default,s=e.timescale||1,l=n.adaptation.period.start,u=t[a+"/"+i],c=isNaN(n.presentationTimeOffset)?isNaN(u.presentationTimeOffset)?0:u.presentationTimeOffset:n.presentationTimeOffset,f=e.presentation_time_delta/s,d=0===e.version?l+r-c+f:l-c+f,a=e.event_duration/s,l=e.id,c=e.message_data;return o.eventStream=u,o.eventStream.value=i,o.eventStream.timescale=s,o.duration=a,o.id=l,o.calculatedPresentationTime=d,o.messageData=c,o.presentationTimeDelta=f,o}catch(e){return null}},getMpd:r,setConfig:function(e){e&&(e.constants&&(E=e.constants),e.cea608parser&&(a=e.cea608parser),e.errHandler&&y.setConfig({errHandler:e.errHandler}),e.BASE64&&y.setConfig({BASE64:e.BASE64}))},updatePeriods:function(e){if(!e)return null;T(),c=s(e)},getIsTextTrack:function(e){return y.getIsText(e)},getUTCTimingSources:function(){var e=u();return y.getUTCTimingSources(e)},getSuggestedPresentationDelay:function(){var e=0<c.length?c[0].mpd:null;return y.getSuggestedPresentationDelay(e)},getAvailabilityStartTime:function(e){return e=r(e),y.getAvailabilityStartTime(e)},getIsTypeOf:function(e,t){return y.getIsTypeOf(e,t)},getIsDynamic:function(e){return e=u(e),y.getIsDynamic(e)},getDuration:function(e){return e=u(e),y.getDuration(e)},getRegularPeriods:s,getContentSteering:function(e){return y.getContentSteering(e)},getLocation:function(e){return y.getLocation(e)},getPatchLocation:function(e){var t=y.getPatchLocation(e),r=y.getPublishTime(e);if(!t||!r)return null;if(t.hasOwnProperty("ttl")&&r){e=1e3*parseFloat(t.ttl);if(r.getTime()+e<=(new Date).getTime())return null}return t.__text},getManifestUpdatePeriod:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;return y.getManifestUpdatePeriod(e,t)},getPublishTime:function(e){return y.getPublishTime(e)},getIsDVB:function(e){return y.hasProfile(e,"urn:dvb:dash:profile:dvb-dash:2014")},getIsPatch:function(e){return i.getIsPatch(e)},getBaseURLsFromElement:function(e){return y.getBaseURLsFromElement(e)},getRepresentationSortFunction:function(){return y.getRepresentationSortFunction()},getCodec:function(e,t,r){return y.getCodec(e,t,r)},getPeriodById:function(t){if(!t||0===c.length)return null;var e=c.filter(function(e){return e.id===t});return e&&0<e.length?e[0]:null},setCurrentMediaInfo:function(e,t,r){f[e]=f[e]||{},f[e][t]=f[e][t]||{},f[e][t]=r},isPatchValid:function(e,t){var r=y.getId(e),n=i.getMpdId(t),a=y.getPublishTime(e),e=i.getPublishTime(t),t=i.getOriginalPublishTime(t);return!!(r&&n&&r==n&&a&&t&&a.getTime()==t.getTime()&&e&&a.getTime()<e.getTime())},applyPatchToManifest:function(t,e){i.getPatchOperations(e).forEach(function(a){var e=a.getMpdTarget(t);if(null!==e){var i=e.name,o=e.target,e=e.leaf;if(a.xpath.findsAttribute())switch(a.action){case"add":case"replace":o[i]=a.value;break;case"remove":delete o[i]}else{var s=(o[i+"_asArray"]||[]).indexOf(e),l="prepend"===a.position||"before"===a.position;"remove"!==a.action&&"replace"!==a.action||(delete o[i],-1!=s&&((e=o[i+"_asArray"]).splice(s,1),1<e.length?o[i]=e:1==e.length?o[i]=e[0]:delete o[i+"_asArray"])),"add"!==a.action&&"replace"!==a.action||Object.keys(a.value).forEach(function(e){var t,r=a.value[e],n=o[e+"_asArray"]||[];0===n.length&&o[e]&&n.push(o[e]),0===n.length?n=r:(t=n.length,t=e==i&&-1!=s?s+(l?0:1)+("replace"==a.action?-1:0):l?0:n.length,n.splice.apply(n,[t,0].concat(r))),o[e+"_asArray"]=n,o[e]=1==n.length?n[0]:n})}}})},areMediaInfosEqual:d,reset:l},y=(0,D.default)(t).getInstance(),i=(0,M.default)(t).getInstance(),l(),e}a.__dashjs_factory_name="DashAdapter";const i=n.default.getSingletonFactory(a)},"./src/dash/DashHandler.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>a});var v=r("./src/streaming/vo/FragmentRequest.js"),T=r("./src/streaming/vo/metrics/HTTPRequest.js"),t=r("./src/core/FactoryMaker.js"),b=r("./src/streaming/MediaPlayerEvents.js"),S=r("./src/dash/utils/SegmentsUtils.js"),A=r("./src/dash/constants/DashConstants.js");function n(e){var t,a,i,o,s,r=(e=e||{}).eventBus,n=e.debug,l=e.urlUtils,u=e.type,c=e.streamInfo,f=e.segmentsController,d=e.timelineConverter,g=e.baseURLController;function h(){return u}function m(){i=null}function p(e,t,r){var n,a,r=g.resolve(r.path);return r&&t!==r.url&&l.isRelative(t)?(n=r.url,a=r.serviceLocation,t&&(n=l.resolve(t,n))):n=t,!l.isRelative(n)&&(e.url=n,e.serviceLocation=a,1)}function y(e,t){if(null==t)return null;var r=new v.default,n=t.representation,a=n.adaptation.period.mpd.manifest.Period_asArray[n.adaptation.period.index].AdaptationSet_asArray[n.adaptation.index].Representation_asArray[n.index].bandwidth,i=t.media,i=(0,S.replaceTokenForTemplate)(i,"Number",t.replacementNumber);return i=(0,S.replaceTokenForTemplate)(i,"Time",t.replacementTime),i=(0,S.replaceTokenForTemplate)(i,"Bandwidth",a),i=(0,S.replaceIDForTemplate)(i,n.id),i=(0,S.unescapeDollarsInTemplate)(i),r.mediaType=u,r.type=T.HTTPRequest.MEDIA_SEGMENT_TYPE,r.range=t.mediaRange,r.startTime=t.presentationStartTime,r.mediaStartTime=t.mediaStartTime,r.duration=t.duration,r.timescale=n.timescale,r.availabilityStartTime=t.availabilityStartTime,r.availabilityEndTime=t.availabilityEndTime,r.availabilityTimeComplete=n.availabilityTimeComplete,r.wallStartTime=t.wallStartTime,r.quality=n.index,r.index=t.index,r.mediaInfo=e,r.adaptationIndex=n.adaptation.index,r.representationId=n.id,p(r,i,n)?r:void 0}function E(e,t,r){var n=null;if(!t||!t.segmentInfoType)return n;t=f.getSegmentByTime(t,r);return t&&(i=t,a.debug("Index for time "+r+" is "+t.index),n=y(e,t)),n}function _(){a.debug("Dynamic stream complete"),s=!0}return t={initialize:function(e){o=e,s=!1,f.initialize(e)},getStreamId:function(){return c.id},getType:h,getStreamInfo:function(){return c},getInitRequest:function(e,t){return t?function(e,t,r){var n=new v.default,a=t.adaptation.period,i=a.start;if(n.mediaType=r,n.type=T.HTTPRequest.INIT_SEGMENT_TYPE,n.range=t.range,n.availabilityStartTime=d.calcAvailabilityStartTimeFromPresentationTime(i,t,o),n.availabilityEndTime=d.calcAvailabilityEndTimeFromPresentationTime(i+a.duration,t,o),n.quality=t.index,n.mediaInfo=e,n.representationId=t.id,p(n,t.initialization,t))return n.url=(0,S.replaceTokenForTemplate)(n.url,"Bandwidth",t.bandwidth),n}(e,t,u):null},getSegmentRequestForTime:E,getCurrentIndex:function(){return i?i.index:-1},getNextSegmentRequest:function(e,t){var r=null;if(!t||!t.segmentInfoType)return null;var n=i?i.index+1:0;if(t=f.getSegmentByIndex(t,n,i?i.mediaStartTime:-1))r=y(e,t),i=t;else{if(o&&!s)return a.debug(u+" No segment found at index: "+n+". Wait for next loop"),null;s=!0}return r},isLastSegmentRequested:function(e,t){if(!e||!i)return!1;if(s)return!0;if(!isFinite(e.adaptation.period.duration))return!1;if(i.presentationStartTime+i.duration>t)return!1;if(e.mediaFinishedInformation&&!isNaN(e.mediaFinishedInformation.numberOfSegments)&&!isNaN(i.index)&&i.index>=e.mediaFinishedInformation.numberOfSegments-1){if(!o||e.segmentInfoType===A.default.SEGMENT_TEMPLATE)return!0;if(o&&e.segmentInfoType===A.default.SEGMENT_LIST&&e.adaptation.period.nextPeriodId)return!0}return!!(o&&e.adaptation.period.nextPeriodId&&e.segmentInfoType===A.default.SEGMENT_TIMELINE&&e.mediaFinishedInformation&&!isNaN(e.mediaFinishedInformation.mediaTimeOfLastSignaledSegment)&&i&&!isNaN(i.mediaStartTime)&&!isNaN(i.duration)&&i.mediaStartTime+i.duration>=e.mediaFinishedInformation.mediaTimeOfLastSignaledSegment-.05)},reset:function(){m(),r.off(b.default.DYNAMIC_TO_STATIC,_,t)},getNextSegmentRequestIdempotent:function(e,t){var r=i?i.index+1:0;return(r=f.getSegmentByIndex(t,r,i?i.mediaStartTime:-1))?y(e,r):null},getValidTimeAheadOfTargetTime:function(e,t,r,n){try{if(isNaN(e)||!t||!r)return NaN;if(e<0&&(e=0),isNaN(n)&&(n=.5),E(t,r,e))return e;if(r.adaptation.period.start+r.adaptation.period.duration<e)return NaN;for(var a=isFinite(r.adaptation.period.duration)?r.adaptation.period.start+r.adaptation.period.duration:e+30,i=Math.min(e+n,a),o=NaN,s=null;i<=a;){var l=null;if(l=i<=a?E(t,r,i):l){o=i,s=l;break}i+=n}if(s){var u=s.startTime+s.duration;return e>s.startTime&&n<u-e?e:!isNaN(s.startTime)&&e<s.startTime&&o>s.startTime?s.startTime+.001:Math.min(u-n,o)}return o}catch(e){return NaN}}},a=n.getLogger(t),m(),r.on(b.default.DYNAMIC_TO_STATIC,_,t),t}n.__dashjs_factory_name="DashHandler";const a=t.default.getClassFactory(n)},"./src/dash/DashMetrics.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>a});var c=r("./src/streaming/constants/Constants.js"),f=r("./src/streaming/vo/metrics/HTTPRequest.js"),t=r("./src/core/FactoryMaker.js"),d=r("./src/streaming/constants/MetricsConstants.js"),g=r("./src/dash/utils/Round10.js"),h=r("./src/streaming/models/MetricsModel.js"),m=r("./src/core/Utils.js"),p=r("./src/streaming/vo/metrics/PlayList.js");function n(e){e=e||{};var t,n,a,i,r=this.context,o=e.metricsModel;function s(e){e=o.getMetricsFor(e,!0);if(!e)return null;var t,r=e.HttpList,n=null;if(!r||r.length<=0)return null;for(t=r.length-1;0<=t;){if(r[t].responsecode){n=r[t];break}t--}return n}function l(e){e=o.getMetricsFor(e,!0);return e&&e.HttpList||[]}function u(e,t){if(!e)return null;t=e[t];return t&&0!==t.length?t[t.length-1]:null}return t={getCurrentRepresentationSwitch:function(e){return u(o.getMetricsFor(e,!0),d.default.TRACK_SWITCH)},getCurrentBufferState:function(e){return u(o.getMetricsFor(e,!0),d.default.BUFFER_STATE)},getCurrentBufferLevel:function(e){return(e=u(o.getMetricsFor(e,!0),d.default.BUFFER_LEVEL))?g.default.round10(e.level/1e3,-3):0},getCurrentHttpRequest:s,getHttpRequests:l,getCurrentDroppedFrames:function(){return u(o.getMetricsFor(c.default.VIDEO,!0),d.default.DROPPED_FRAMES)},getCurrentSchedulingInfo:function(e){return u(o.getMetricsFor(e,!0),d.default.SCHEDULING_INFO)},getCurrentDVRInfo:function(e){return u(e?o.getMetricsFor(e,!0):o.getMetricsFor(c.default.VIDEO,!0)||o.getMetricsFor(c.default.AUDIO,!0),d.default.DVR_INFO)},getCurrentManifestUpdate:function(){return u(o.getMetricsFor(c.default.STREAM),d.default.MANIFEST_UPDATE)},getLatestFragmentRequestHeaderValueByID:function(e,t){if(!t)return null;var r={},e=s(e);return void 0===(t=(r=e?m.default.parseHttpHeaders(e._responseHeaders):r)[t.toLowerCase()])?null:t},getLatestMPDRequestHeaderValueByID:function(e){if(!e)return null;for(var t,r={},n=l(c.default.STREAM),a=n.length-1;0<=a;a--)if((t=n[a]).type===f.HTTPRequest.MPD_TYPE){r=m.default.parseHttpHeaders(t._responseHeaders);break}return void 0===(e=r[e.toLowerCase()])?null:e},addRepresentationSwitch:function(e,t,r,n,a){o.addRepresentationSwitch(e,t,r,n,a)},addDVRInfo:function(e,t,r,n){o.addDVRInfo(e,t,r,n)},updateManifestUpdateInfo:function(e){var t=this.getCurrentManifestUpdate();o.updateManifestUpdateInfo(t,e)},addManifestUpdateStreamInfo:function(e){var t;e&&(t=this.getCurrentManifestUpdate(),o.addManifestUpdateStreamInfo(t,e.id,e.index,e.start,e.duration))},addManifestUpdateRepresentationInfo:function(e,t){var r;e&&(r=this.getCurrentManifestUpdate(),o.addManifestUpdateRepresentationInfo(r,e.id,e.index,e.streamIndex,t,e.presentationTimeOffset,e.startNumber,e.fragmentInfoType))},addManifestUpdate:function(e){o.addManifestUpdate(c.default.STREAM,e.type,e.requestStartDate,e.requestEndDate)},addHttpRequest:function(e,t,r,n,a,i){o.addHttpRequest(e.mediaType,null,e.type,e.url,e.quality,t,e.serviceLocation||null,e.range||null,e.requestStartDate,e.firstByteDate,e.requestEndDate,r,e.duration,n,a,e.fileLoaderType,i)},addSchedulingInfo:function(e,t){o.addSchedulingInfo(e.mediaType,new Date,e.type,e.startTime,e.availabilityStartTime,e.duration,e.quality,e.range,t)},addRequestsQueue:function(e,t,r){o.addRequestsQueue(e,t,r)},addBufferLevel:function(e,t,r){o.addBufferLevel(e,t,r)},addBufferState:function(e,t,r){o.addBufferState(e,t,r)},addDroppedFrames:function(e){o.addDroppedFrames(c.default.VIDEO,e)},addPlayList:function(){i&&(o.addPlayList(i),i=null)},addDVBErrors:function(e){o.addDVBErrors(e)},createPlaylistMetrics:function(e,t){(i=new p.PlayList).start=new Date,i.mstart=e,i.starttype=t},createPlaylistTraceMetrics:function(e,t,r){!0===n&&(n=!1,(a=new p.PlayListTrace).representationid=e,a.start=new Date,a.mstart=t,a.playbackspeed=null!==r?r.toString():null)},updatePlayListTraceMetrics:function(e){if(a)for(var t in a)a[t]=e[t]},pushPlayListTraceMetrics:function(e,t){var r;!1===n&&i&&a&&a.start&&(r=a.start,r=e.getTime()-r.getTime(),a.duration=r,a.stopreason=t,i.trace.push(a),n=!0)},clearAllCurrentMetrics:function(){o.clearAllCurrentMetrics()}},o=o||(0,h.default)(r).getInstance({settings:e.settings}),n=!0,i=a=null,t}n.__dashjs_factory_name="DashMetrics";const a=t.default.getSingletonFactory(n)},"./src/dash/SegmentBaseLoader.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>a});var g=r("./src/dash/vo/Segment.js"),h=r("./src/streaming/vo/DashJSError.js"),t=r("./src/core/FactoryMaker.js"),m=r("./src/streaming/vo/FragmentRequest.js"),p=r("./src/streaming/net/URLLoader.js");function n(){var t,T,r,b,n,a,i,u,o,s,l,c,f,e=this.context;function d(e,t,r){r({segments:e,representation:t,error:e?void 0:new h.default(o.SEGMENT_BASE_LOADER_ERROR_CODE,o.SEGMENT_BASE_LOADER_ERROR_MESSAGE)})}function S(e,t){for(var r,n,a,i,o=e.references,s=o.length,l=e.timescale,u=e.earliest_presentation_time,c=t.range.start+e.offset+e.first_offset+e.size,f=[],d=0;d<s;d++)a=o[d].subsegment_duration,i=o[d].referenced_size,(r=new g.default).duration=a,r.startTime=u,r.timescale=l,n=c+i-1,r.mediaRange=c+"-"+n,f.push(r),u+=a,c+=i;return f}function A(e){if(e.url){var t=new m.default;return t.setInfo(e),t}}return t={setConfig:function(e){e.baseURLController&&(f=e.baseURLController),e.dashMetrics&&(a=e.dashMetrics),e.mediaPlayerModel&&(i=e.mediaPlayerModel),e.errHandler&&(r=e.errHandler),e.boxParser&&(b=e.boxParser),e.debug&&(T=e.debug.getLogger(t)),e.requestModifier&&(n=e.requestModifier),e.errors&&(o=e.errors),e.urlUtils&&(c=e.urlUtils),e.constants&&(s=e.constants),e.dashConstants&&(l=e.dashConstants)},initialize:function(){u=(0,p.default)(e).create({errHandler:r,dashMetrics:a,mediaPlayerModel:i,requestModifier:n,boxParser:b,errors:o,urlUtils:c,constants:s,dashConstants:l})},loadInitialization:function(t,r){return new Promise(function(e){!function t(r,n,a,e){var i=null;var o=r?f.resolve(r.path):null;var s=e||{init:!0,url:o?o.url:void 0,range:{start:0,end:1500},searching:!1,bytesLoaded:0,bytesToLoad:1500,mediaType:n};T.debug("Start searching for initialization.");var l=A(s);var e=function(e){if(s.bytesLoaded=s.range.end,!(i=b.findInitRange(e)))return s.range.end=s.bytesLoaded+s.bytesToLoad,t(r,n,a,s);r.range=i,a(r)};var o=function(){a(r)};u.load({request:l,success:e,error:o});T.debug("Perform init search: "+s.url)}(t,r,e)})},loadSegments:function(t,r,n){return new Promise(function(e){!function g(h,m,e,p,y,t){!e||void 0!==e.start&&void 0!==e.end||(e=(n=e?e.toString().split("-"):null)?{start:parseFloat(n[0]),end:parseFloat(n[1])}:null);y=y||d;var E=null;var _=null;var r=!!e;var n=h?f.resolve(h.path):null;var v={init:!1,url:n?n.url:void 0,range:r?e:{start:0,end:1500},searching:!r,bytesLoaded:t?t.bytesLoaded:0,bytesToLoad:1500,mediaType:m};var e=A(v);var r=function(e){var t=v.bytesToLoad,r=e.byteLength;if(v.bytesLoaded=v.range.end-v.range.start,E=b.parse(e),(_=E.getBox("sidx"))&&_.isComplete){var n,a,i,o,s,l=_.references;if(n=null!=l&&0<l.length?1===l[0].reference_type:n){T.debug("Initiate multiple SIDX load."),v.range.end=v.range.start+_.size;var u=[],c=0,f=(_.offset||v.range.start)+_.size,d=function(e){e?(u=u.concat(e),i<=++c&&(u.sort(function(e,t){return e.startTime-t.startTime<0?-1:0}),y(u,h,p))):y(null,h,p)};for(a=0,i=l.length;a<i;a++)s=(o=f)+l[a].referenced_size-1,f+=l[a].referenced_size,g(h,m,{start:o,end:s},p,d,v)}else T.debug("Parsing segments from SIDX. representation "+m+" - id: "+h.id+" for range : "+v.range.start+" - "+v.range.end),n=S(_,v),y(n,h,p)}else{if(_)v.range.start=_.offset||v.range.start,v.range.end=v.range.start+(_.size||t);else{if(r<v.bytesLoaded)return void y(null,h,p);var r=E.getLastBox();r&&r.size?(v.range.start=r.offset+r.size,v.range.end=v.range.start+t):v.range.end+=t}g(h,m,v.range,p,null,v)}};var t=function(){y(null,h,p)};u.load({request:e,success:r,error:t});T.debug("Perform SIDX load for type ".concat(m," : ").concat(v.url," with range ").concat(v.range.start," - ").concat(v.range.end))}(t,r,n,e)})},reset:function(){u&&(u.abort(),u=null)}}}n.__dashjs_factory_name="SegmentBaseLoader";const a=t.default.getSingletonFactory(n)},"./src/dash/WebmSegmentBaseLoader.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>a});var E=r("./src/streaming/utils/EBMLParser.js"),o=r("./src/streaming/constants/Constants.js"),t=r("./src/core/FactoryMaker.js"),f=r("./src/dash/vo/Segment.js"),u=r("./src/streaming/vo/FragmentRequest.js"),c=r("./src/streaming/net/URLLoader.js"),_=r("./src/streaming/vo/DashJSError.js");function n(){var t,d,g,r,n,a,i,h,s,l,m=this.context;function p(e,t,r,n){for(var a,i,o,s=function(e){var t,r=[],n=(0,E.default)(m).create({data:e});for(n.consumeTagAndSize(g.Segment.Cues);n.moreData()&&n.consumeTagAndSize(g.Segment.Cues.CuePoint,!0);){for((t={}).CueTime=n.parseTag(g.Segment.Cues.CuePoint.CueTime),t.CueTracks=[];n.moreData()&&n.consumeTag(g.Segment.Cues.CuePoint.CueTrackPositions,!0);){var a,i=n.getMatroskaCodedNum(),o=n.getPos();if((a={}).Track=n.parseTag(g.Segment.Cues.CuePoint.CueTrackPositions.CueTrack),0===a.Track)throw new Error("Cue track cannot be 0");a.ClusterPosition=n.parseTag(g.Segment.Cues.CuePoint.CueTrackPositions.CueClusterPosition),t.CueTracks.push(a),n.setPos(o+i)}if(0===t.CueTracks.length)throw new Error("Mandatory cuetrack not found");r.push(t)}if(0===r.length)throw new Error("mandatory cuepoint not found");return r}(e),l=[],u=0,c=s.length;u<c;u+=1)a=new f.default,o=0,o=u<s.length-1?s[u+1].CueTime-s[u].CueTime:n-s[u].CueTime,a.duration=o,a.startTime=s[u].CueTime,a.timescale=1e3,i=s[u].CueTracks[0].ClusterPosition+t,o=u<s.length-1?s[u+1].CueTracks[0].ClusterPosition+t-1:r-1,a.mediaRange=i+"-"+o,l.push(a);return d.debug("Parsed cues: "+l.length+" cues."),l}function y(e){var t=new u.default;return t.setInfo(e),t}return t={setConfig:function(e){if(!(e.baseURLController&&e.dashMetrics&&e.mediaPlayerModel&&e.errHandler))throw new Error(o.default.MISSING_CONFIG_ERROR);l=e.baseURLController,a=e.dashMetrics,i=e.mediaPlayerModel,r=e.errHandler,s=e.errors,d=e.debug.getLogger(t),n=e.requestModifier},initialize:function(){h=(0,c.default)(m).create({errHandler:r,dashMetrics:a,mediaPlayerModel:i,requestModifier:n,errors:s})},loadInitialization:function(a,i){return new Promise(function(e){var t=null,r=a?l.resolve(a.path):null,n=a?a.range.split("-"):null,r={range:{start:n?parseFloat(n[0]):null,end:n?parseFloat(n[1]):null},request:t,url:r?r.url:void 0,init:!0,mediaType:i};d.info("Start loading initialization.");t=y(r);h.load({request:t,success:function(){e(a)},error:function(){e(a)}}),d.debug("Perform init load: "+r.url)})},loadSegments:function(a,i,o){return new Promise(function(t){var e=null,r=a?l.resolve(a.path):null,n=r?r.url:void 0,e=y({bytesLoaded:0,bytesToLoad:8192,range:{start:0,end:8192},request:e,url:n,init:!1,mediaType:i});d.debug("Parsing ebml header");h.load({request:e,success:function(e){!function(e,t,r,n){if(e&&0!==e.byteLength){var a,i,o,s,l=(0,E.default)(m).create({data:e}),e=r?r.split("-"):null,r=null,u={url:t,range:{start:e?parseFloat(e[0]):null,end:e?parseFloat(e[1]):null},request:r};for(d.debug("Parse EBML header: "+u.url),l.skipOverElement(g.EBML),l.consumeTag(g.Segment),o=l.getMatroskaCodedNum(),o+=l.getPos(),s=l.getPos();l.moreData()&&!l.consumeTagAndSize(g.Segment.Info,!0);)if(!(l.skipOverElement(g.Segment.SeekHead,!0)||l.skipOverElement(g.Segment.Tracks,!0)||l.skipOverElement(g.Segment.Cues,!0)||l.skipOverElement(g.Void,!0)))throw new Error("no valid top level element found");for(;void 0===a;){var c=l.getMatroskaCodedNum(!0),f=l.getMatroskaCodedNum();c===g.Segment.Info.Duration.tag?a=l[g.Segment.Info.Duration.parse](f):l.setPos(l.getPos()+f)}r=y(u);h.load({request:r,success:function(e){i=p(e,s,o,a),n(i)},error:function(){d.error("Download Error: Cues "+u.url),n(null)}}),d.debug("Perform cues load: "+u.url+" bytes="+u.range.start+"-"+u.range.end)}else n(null)}(e,n,o,function(e){t({segments:e,representation:a,error:e?void 0:new _.default(s.SEGMENT_BASE_LOADER_ERROR_CODE,s.SEGMENT_BASE_LOADER_ERROR_MESSAGE)})})},error:function(){t({representation:a,error:new _.default(s.SEGMENT_BASE_LOADER_ERROR_CODE,s.SEGMENT_BASE_LOADER_ERROR_MESSAGE)})}})})},reset:function(){h&&(h.abort(),h=null)}},g={EBML:{tag:440786851,required:!0},Segment:{tag:408125543,required:!0,SeekHead:{tag:290298740,required:!0},Info:{tag:357149030,required:!0,TimecodeScale:{tag:2807729,required:!0,parse:"getMatroskaUint"},Duration:{tag:17545,required:!0,parse:"getMatroskaFloat"}},Tracks:{tag:374648427,required:!0},Cues:{tag:475249515,required:!0,CuePoint:{tag:187,required:!0,CueTime:{tag:179,required:!0,parse:"getMatroskaUint"},CueTrackPositions:{tag:183,required:!0,CueTrack:{tag:247,required:!0,parse:"getMatroskaUint"},CueClusterPosition:{tag:241,required:!0,parse:"getMatroskaUint"}}}}},Void:{tag:236,required:!0}},t}n.__dashjs_factory_name="WebmSegmentBaseLoader";const a=t.default.getSingletonFactory(n)},"./src/dash/constants/DashConstants.js":(e,t,r)=>{function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}r.r(t),r.d(t,{default:()=>n});const n=new(function(){function t(){!function(e){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),this.init()}var e,r,n;return e=t,(r=[{key:"init",value:function(){this.BASE_URL="BaseURL",this.SEGMENT_BASE="SegmentBase",this.SEGMENT_TEMPLATE="SegmentTemplate",this.SEGMENT_LIST="SegmentList",this.SEGMENT_URL="SegmentURL",this.SEGMENT_TIMELINE="SegmentTimeline",this.SEGMENT_PROFILES="segmentProfiles",this.ADAPTATION_SET="AdaptationSet",this.REPRESENTATION="Representation",this.REPRESENTATION_INDEX="RepresentationIndex",this.SUB_REPRESENTATION="SubRepresentation",this.INITIALIZATION="Initialization",this.INITIALIZATION_MINUS="initialization",this.MPD="MPD",this.PERIOD="Period",this.ASSET_IDENTIFIER="AssetIdentifier",this.EVENT_STREAM="EventStream",this.ID="id",this.PROFILES="profiles",this.SERVICE_LOCATION="serviceLocation",this.RANGE="range",this.INDEX="index",this.MEDIA="media",this.BYTE_RANGE="byteRange",this.INDEX_RANGE="indexRange",this.MEDIA_RANGE="mediaRange",this.VALUE="value",this.CONTENT_TYPE="contentType",this.MIME_TYPE="mimeType",this.BITSTREAM_SWITCHING="BitstreamSwitching",this.BITSTREAM_SWITCHING_MINUS="bitstreamSwitching",this.CODECS="codecs",this.DEPENDENCY_ID="dependencyId",this.MEDIA_STREAM_STRUCTURE_ID="mediaStreamStructureId",this.METRICS="Metrics",this.METRICS_MINUS="metrics",this.REPORTING="Reporting",this.WIDTH="width",this.HEIGHT="height",this.SAR="sar",this.FRAMERATE="frameRate",this.AUDIO_SAMPLING_RATE="audioSamplingRate",this.MAXIMUM_SAP_PERIOD="maximumSAPPeriod",this.START_WITH_SAP="startWithSAP",this.MAX_PLAYOUT_RATE="maxPlayoutRate",this.CODING_DEPENDENCY="codingDependency",this.SCAN_TYPE="scanType",this.FRAME_PACKING="FramePacking",this.AUDIO_CHANNEL_CONFIGURATION="AudioChannelConfiguration",this.CONTENT_PROTECTION="ContentProtection",this.ESSENTIAL_PROPERTY="EssentialProperty",this.SUPPLEMENTAL_PROPERTY="SupplementalProperty",this.INBAND_EVENT_STREAM="InbandEventStream",this.PRODUCER_REFERENCE_TIME="ProducerReferenceTime",this.ACCESSIBILITY="Accessibility",this.ROLE="Role",this.RATING="Rating",this.CONTENT_COMPONENT="ContentComponent",this.SUBSET="Subset",this.LANG="lang",this.VIEWPOINT="Viewpoint",this.ROLE_ASARRAY="Role_asArray",this.REPRESENTATION_ASARRAY="Representation_asArray",this.PRODUCERREFERENCETIME_ASARRAY="ProducerReferenceTime_asArray",this.ACCESSIBILITY_ASARRAY="Accessibility_asArray",this.AUDIOCHANNELCONFIGURATION_ASARRAY="AudioChannelConfiguration_asArray",this.CONTENTPROTECTION_ASARRAY="ContentProtection_asArray",this.MAIN="main",this.DYNAMIC="dynamic",this.STATIC="static",this.MEDIA_PRESENTATION_DURATION="mediaPresentationDuration",this.MINIMUM_UPDATE_PERIOD="minimumUpdatePeriod",this.CODEC_PRIVATE_DATA="codecPrivateData",this.BANDWITH="bandwidth",this.SOURCE_URL="sourceURL",this.TIMESCALE="timescale",this.DURATION="duration",this.START_NUMBER="startNumber",this.PRESENTATION_TIME_OFFSET="presentationTimeOffset",this.AVAILABILITY_START_TIME="availabilityStartTime",this.AVAILABILITY_END_TIME="availabilityEndTime",this.TIMESHIFT_BUFFER_DEPTH="timeShiftBufferDepth",this.MAX_SEGMENT_DURATION="maxSegmentDuration",this.PRESENTATION_TIME="presentationTime",this.MIN_BUFFER_TIME="minBufferTime",this.MAX_SUBSEGMENT_DURATION="maxSubsegmentDuration",this.START="start",this.AVAILABILITY_TIME_OFFSET="availabilityTimeOffset",this.AVAILABILITY_TIME_COMPLETE="availabilityTimeComplete",this.CENC_DEFAULT_KID="cenc:default_KID",this.DVB_PRIORITY="dvb:priority",this.DVB_WEIGHT="dvb:weight",this.SUGGESTED_PRESENTATION_DELAY="suggestedPresentationDelay",this.SERVICE_DESCRIPTION="ServiceDescription",this.SERVICE_DESCRIPTION_SCOPE="Scope",this.SERVICE_DESCRIPTION_LATENCY="Latency",this.SERVICE_DESCRIPTION_PLAYBACK_RATE="PlaybackRate",this.SERVICE_DESCRIPTION_OPERATING_QUALITY="OperatingQuality",this.SERVICE_DESCRIPTION_OPERATING_BANDWIDTH="OperatingBandwidth",this.PATCH_LOCATION="PatchLocation",this.PUBLISH_TIME="publishTime",this.ORIGINAL_PUBLISH_TIME="originalPublishTime",this.ORIGINAL_MPD_ID="mpdId",this.WALL_CLOCK_TIME="wallClockTime",this.PRESENTATION_TIME="presentationTime",this.LABEL="Label",this.GROUP_LABEL="GroupLabel",this.CONTENT_STEERING="ContentSteering",this.CONTENT_STEERING_AS_ARRAY="ContentSteering_asArray",this.DEFAULT_SERVICE_LOCATION="defaultServiceLocation",this.QUERY_BEFORE_START="queryBeforeStart",this.PROXY_SERVER_URL="proxyServerURL",this.CONTENT_STEERING_RESPONSE={VERSION:"VERSION",TTL:"TTL",RELOAD_URI:"RELOAD-URI",SERVICE_LOCATION_PRIORITY:"SERVICE-LOCATION-PRIORITY"}}}])&&a(e.prototype,r),n&&a(e,n),t}())},"./src/dash/controllers/ContentSteeringController.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>a});var t=r("./src/core/FactoryMaker.js"),A=r("./src/core/Debug.js"),R=r("./src/streaming/net/URLLoader.js"),I=r("./src/core/errors/Errors.js"),w=r("./src/dash/vo/ContentSteeringRequest.js"),C=r("./src/dash/vo/ContentSteeringResponse.js"),N=r("./src/dash/constants/DashConstants.js"),D=r("./src/streaming/MediaPlayerEvents.js"),M=r("./src/core/events/Events.js"),O=r("./src/streaming/constants/Constants.js"),P=r("./src/core/Utils.js"),L=r("./src/streaming/utils/URLUtils.js"),F="_DASH_throughput",x="_DASH_pathway",j="url";function n(){var e,n,o,s,l,t,a,r,i,u,c,f,d,g,h,m=this.context,p=(0,L.default)(m).getInstance();function y(e){e&&e.toStreamInfo&&(s=e.toStreamInfo)}function E(e){e&&e.request&&e.request.serviceLocation&&(l=e.request.serviceLocation)}function _(){var e=c.getValue();return h.getContentSteering(e)}function v(){return new Promise(function(r){try{var e=_();if(!e||!e.serverUrl)return void r();var t=function(e){var t=e.proxyServerUrl||e.serverUrl;o&&o.reloadUri&&(t=p.isRelative(o.reloadUri)?p.resolve(o.reloadUri,e.serverUrl):o.reloadUri);var r=[];{var n,a,i;s&&(i=h.getIsDynamic(),n=0<h.getAllMediaInfoForType(s,O.default.VIDEO).length?O.default.VIDEO:O.default.AUDIO,a=d.getThroughputHistory(),i=a?a.getAverageThroughput(n,i):NaN,isNaN(i)||r.push({key:F,value:1e3*i}))}l&&r.push({key:x,value:l});e.proxyServerUrl&&e.proxyServerUrl===t&&e.serverUrl&&r.push({key:j,value:encodeURI(e.serverUrl)});return t=P.default.addAditionalQueryParameterToUrl(t,r)}(e),e=new w.default(t);a.load({request:e,success:function(e){(e=e)&&e[N.default.CONTENT_STEERING_RESPONSE.VERSION]&&1===parseInt(e[N.default.CONTENT_STEERING_RESPONSE.VERSION])&&((o=new C.default).version=e[N.default.CONTENT_STEERING_RESPONSE.VERSION],e[N.default.CONTENT_STEERING_RESPONSE.TTL]&&!isNaN(e[N.default.CONTENT_STEERING_RESPONSE.TTL])&&(o.ttl=e[N.default.CONTENT_STEERING_RESPONSE.TTL]),e[N.default.CONTENT_STEERING_RESPONSE.RELOAD_URI]&&(o.reloadUri=e[N.default.CONTENT_STEERING_RESPONSE.RELOAD_URI]),e[N.default.CONTENT_STEERING_RESPONSE.SERVICE_LOCATION_PRIORITY]&&(o.serviceLocationPriority=e[N.default.CONTENT_STEERING_RESPONSE.SERVICE_LOCATION_PRIORITY]),T()),g.trigger(D.default.CONTENT_STEERING_REQUEST_COMPLETED,{currentSteeringResponseData:o,url:t}),r()},error:function(e){var t;t=e,n.warn("Error fetching data from content steering server",t),T(),r(e)}})}catch(e){r(e)}})}function T(){o&&o.ttl&&!isNaN(o.ttl)&&(t&&clearTimeout(t),t=setTimeout(function(){v()},1e3*o.ttl))}function b(){t&&clearTimeout(t),t=null}function S(){l=s=o=null,b()}return e={reset:function(){S(),g.off(D.default.PERIOD_SWITCH_COMPLETED,y,e),g.off(M.default.FRAGMENT_LOADING_STARTED,E,e)},setConfig:function(e){e&&(e.adapter&&(h=e.adapter),e.errHandler&&(r=e.errHandler),e.dashMetrics&&(i=e.dashMetrics),e.mediaPlayerModel&&(u=e.mediaPlayerModel),e.requestModifier&&(f=e.requestModifier),e.manifestModel&&(c=e.manifestModel),e.abrController&&(d=e.abrController),e.eventBus&&(g=e.eventBus))},loadSteeringData:v,getCurrentSteeringResponseData:function(){return o},shouldQueryBeforeStart:function(){var e=_();return e&&e.queryBeforeStart},getSteeringDataFromManifest:_,stopSteeringRequestTimer:b,initialize:function(){a=(0,R.default)(m).create({errHandler:r,dashMetrics:i,mediaPlayerModel:u,requestModifier:f,errors:I.default}),g.on(D.default.PERIOD_SWITCH_COMPLETED,y,e),g.on(M.default.FRAGMENT_LOADING_STARTED,E,e)}},n=(0,A.default)(m).getInstance().getLogger(e),S(),e}n.__dashjs_factory_name="ContentSteeringController";const a=t.default.getSingletonFactory(n)},"./src/dash/controllers/RepresentationController.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>a});var w=r("./src/streaming/constants/Constants.js"),t=r("./src/core/FactoryMaker.js"),C=r("./src/streaming/MediaPlayerEvents.js"),N=r("./src/dash/utils/SegmentsUtils.js");function n(e){var t,u,c,f,d,n=(e=e||{}).eventBus,r=e.events,g=e.abrController,h=e.dashMetrics,m=e.playbackController,p=e.timelineConverter,y=e.type,E=e.streamInfo,_=e.dashConstants,v=e.segmentsController,T=e.isDynamic;function a(){return y}function b(){if(!(g&&h&&m&&p))throw new Error(w.default.MISSING_CONFIG_ERROR)}function i(){return c}function o(){return d}function s(){c=!(u=null),f=[]}function S(){b();var e=new Date,t=d,r=1e3*m.getTime();t&&h.addRepresentationSwitch(t.adaptation.type,e,r,t.id),n.trigger(C.default.REPRESENTATION_SWITCH,{mediaType:y,streamId:E.id,currentRepresentation:t,numberOfRepresentations:f.length},{streamId:E.id,mediaType:y})}function A(e){return null==e||e>=f.length?null:f[e]}function R(e){c=!1,n.trigger(r.DATA_UPDATE_COMPLETED,{data:u,currentRepresentation:d,error:e},{streamId:E.id,mediaType:y})}function I(e){d=e}function l(e){e.newDuration&&d&&d.adaptation.period&&(d.adaptation.period.duration=e.newDuration)}return t={getStreamId:function(){return E.id},getType:a,getData:function(){return u},isUpdating:i,updateData:function(e,t,r,n,a){if(b(),c=!0,f=t,I(A(a)),u=e,r!==w.default.VIDEO&&r!==w.default.AUDIO&&(r!==w.default.TEXT||!n))return R(),Promise.resolve();for(var i=[],o=0,s=f.length;o<s;o++){var l=f[o];i.push(function(i){return new Promise(function(n,t){var e=i.hasInitialization(),r=i.hasSegments(),a=[];a.push(v.updateInitData(i,e)),a.push(v.updateSegmentData(i,r)),Promise.all(a).then(function(e){var t,r;e[0]&&!e[0].error&&(t=i,r=e[0],i=r&&!r.error&&r.representation?r.representation:t),e[1]&&!e[1].error&&(i=function(e,t){if(!t||t.error)return;var r,n,a,i=t.segments,o=[],s=0;for(r=0,n=i?i.length:0;r<n;r++)a=i[r],(a=(0,N.getTimeBasedSegment)(p,T,e,a.startTime,a.duration,a.timescale,a.media,a.mediaRange,s))&&(o.push(a),a=null,s++);0<o.length&&(e.segments=o);return e}(i,e[1])),(e=i).mediaFinishedInformation=v.getMediaFinishedInformation(e),function(e){if(c){var t,r,n=h.getCurrentManifestUpdate(),a=!1;if(n){for(var i=0;i<n.representationInfo.length;i++)if((t=n.representationInfo[i]).index===e.index&&t.mediaType===y){a=!0;break}a||h.addManifestUpdateRepresentationInfo(e,y)}!function(){for(var e=0,t=f.length;e<t;e++){var r=f[e].segmentInfoType;if(!f[e].hasInitialization()||(r===_.SEGMENT_BASE||r===_.BASE_URL)&&!f[e].segments)return!1}return!0}()||(g.setPlaybackQuality(y,E,function(e){return f.indexOf(e)}(d)),(r=h.getCurrentDVRInfo(y))&&h.updateManifestUpdateInfo({latency:r.range.end-m.getTime()}),h.getCurrentRepresentationSwitch(d.adaptation.type)||S(),R())}}(i),n()}).catch(function(e){t(e)})})}(l))}return Promise.all(i)},getCurrentRepresentation:o,getRepresentationForQuality:A,prepareQualityChange:function(e){I(A(e)),S()},reset:function(){n.off(C.default.MANIFEST_VALIDITY_CHANGED,l,t),s()}},s(),n.on(C.default.MANIFEST_VALIDITY_CHANGED,l,t),t}n.__dashjs_factory_name="RepresentationController";const a=t.default.getClassFactory(n)},"./src/dash/controllers/SegmentBaseController.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>a});var t=r("./src/core/FactoryMaker.js"),m=r("./src/dash/SegmentBaseLoader.js"),p=r("./src/dash/WebmSegmentBaseLoader.js");function n(e){e=e||{};var t,r,n=this.context,a=e.eventBus,i=e.events,o=e.dashMetrics,s=e.mediaPlayerModel,l=e.errHandler,u=e.baseURLController,c=e.debug,f=e.boxParser,d=e.requestModifier,g=e.errors;function h(e){return"webm"===(e?e.split("/")[1]:"").toLowerCase()}return e={initialize:function(){t.initialize(),r.initialize()},getSegmentBaseInitSegment:function(e){return(h(e.representation.mimeType)?r:t).loadInitialization(e.representation,e.mediaType)},getSegmentList:function(e){return(h(e.mimeType)?r:t).loadSegments(e.representation,e.mediaType,e.representation?e.representation.indexRange:null)},reset:function(){t.reset(),r.reset()}},t=(0,m.default)(n).getInstance(),r=(0,p.default)(n).getInstance(),t.setConfig({baseURLController:u,dashMetrics:o,mediaPlayerModel:s,errHandler:l,eventBus:a,events:i,errors:g,debug:c,boxParser:f,requestModifier:d}),r.setConfig({baseURLController:u,dashMetrics:o,mediaPlayerModel:s,errHandler:l,eventBus:a,events:i,errors:g,debug:c,requestModifier:d}),e}n.__dashjs_factory_name="SegmentBaseController";const a=t.default.getSingletonFactory(n)},"./src/dash/controllers/SegmentsController.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>a});var t=r("./src/core/FactoryMaker.js"),l=r("./src/dash/utils/TimelineSegmentsGetter.js"),u=r("./src/dash/utils/TemplateSegmentsGetter.js"),c=r("./src/dash/utils/ListSegmentsGetter.js"),f=r("./src/dash/utils/SegmentBaseGetter.js");function n(t){t=t||{};var e,r,n=this.context,a=t.dashConstants,i=t.type,o=t.segmentBaseController;function s(e){return e?e.segments?r[a.SEGMENT_BASE]:r[e.segmentInfoType]:null}return e={initialize:function(e){r[a.SEGMENT_TIMELINE]=(0,l.default)(n).create(t,e),r[a.SEGMENT_TEMPLATE]=(0,u.default)(n).create(t,e),r[a.SEGMENT_LIST]=(0,c.default)(n).create(t,e),r[a.SEGMENT_BASE]=(0,f.default)(n).create(t,e)},updateInitData:function(e,t){return t?Promise.resolve():o.getSegmentBaseInitSegment({representation:e,mediaType:i})},updateSegmentData:function(e,t){return t?Promise.resolve():o.getSegmentList({mimeType:e.mimeType,representation:e,mediaType:i})},getSegmentByIndex:function(e,t,r){var n=s(e);return n?n.getSegmentByIndex(e,t,r):null},getSegmentByTime:function(e,t){var r=s(e);return r?r.getSegmentByTime(e,t):null},getMediaFinishedInformation:function(e){var t=s(e);return t?t.getMediaFinishedInformation(e):{numberOfSegments:0,mediaTimeOfLastSignaledSegment:NaN}}},r={},e}n.__dashjs_factory_name="SegmentsController";const a=t.default.getClassFactory(n)},"./src/dash/controllers/ServiceDescriptionController.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>i});var t=r("./src/core/FactoryMaker.js"),n=r("./src/core/Debug.js"),f=r("./src/streaming/constants/Constants.js"),d=r("./src/dash/constants/DashConstants.js"),g=[f.default.SERVICE_DESCRIPTION_DVB_LL_SCHEME],h="video",m="audio",p="any",y="all";function a(){var e,o,s,l,u,t=this.context;function r(){o={liveDelay:NaN,liveCatchup:{maxDrift:NaN,playbackRate:{min:NaN,max:NaN}},minBitrate:{},maxBitrate:{},initialBitrate:{}},s=[]}function c(e,t,r){try{o[e][t]=r/1e3}catch(e){l.error(e)}}return e={getServiceDescriptionSettings:function(){return o},getProducerReferenceTimeOffsets:function(){return s},calculateProducerReferenceTimeOffsets:function(e){try{var t,i,r=[];e&&0<e.length&&(t=[f.default.VIDEO,f.default.AUDIO,f.default.TEXT],i=u.getAvailabilityStartTime()/1e3,e.forEach(function(a){var e=t.reduce(function(e,t){return e=e.concat(u.getAllMediaInfoForType(a,t))},[]).reduce(function(r,n){return u.getProducerReferenceTimes(a,n).forEach(function(e){var t=u.getVoRepresentations(n);t&&0<t.length&&t[0].adaptation&&t[0].segmentInfoType===d.default.SEGMENT_TEMPLATE&&(t=t[0],t=new Date(e[d.default.WALL_CLOCK_TIME]).getTime()/1e3-(e[d.default.PRESENTATION_TIME]/t[d.default.TIMESCALE]-t[d.default.PRESENTATION_TIME_OFFSET]+a.start),t=i-t,r.push({id:e[d.default.ID],to:t}))}),r},[]);r=r.concat(e)})),s=r}catch(e){l.error(e),s=[]}},applyServiceDescription:function(e){var t,r,n,a,i;e&&e.serviceDescriptions&&(t=e.serviceDescriptions.filter(function(e){return g.includes(e.schemeIdUri)}),r=e.serviceDescriptions.filter(function(e){return null==e.schemeIdUri}),(e=0<t.length?t[t.length-1]:r[r.length-1])&&(e.latency&&0<e.latency.target&&(n=((t=e).schemeIdUri===f.default.SERVICE_DESCRIPTION_DVB_LL_SCHEME?function(e){var t=e.latency.target/1e3,r=!isNaN(e.latency.max)&&e.latency.max>e.latency.target?(e.latency.max-e.latency.target+500)/1e3:NaN,e=e.latency.referenceId||NaN;return{liveDelay:t,maxDrift:r,referenceId:e}}:function(e){var t=e.latency.target/1e3,r=!isNaN(e.latency.max)&&e.latency.max>e.latency.target?(e.latency.max-e.latency.target+500)/1e3:NaN,e=e.latency.referenceId||NaN;return{liveDelay:t,maxDrift:r,referenceId:e}})(t),0<s.length?(r=function(t){var e=0,r=s.filter(function(e){return e.id===t.referenceId});r=0===r.length?(e=0<s.length?s[0].to:0,s[0].id||NaN):(e=r[0].to||0,r[0].id||NaN);return{to:e,id:r}}(n),t=r.to,r=r.id,o.liveDelay=n.liveDelay-t,o.liveCatchup.maxDrift=n.maxDrift,l.debug("\n                Found latency properties coming from service description. Applied time offset of ".concat(t," from ProducerReferenceTime element with id ").concat(r,".\n                Live Delay: ").concat(n.liveDelay-t,", Live catchup max drift: ").concat(n.maxDrift,"\n            "))):(o.liveDelay=n.liveDelay,o.liveCatchup.maxDrift=n.maxDrift,l.debug("Found latency properties coming from service description: Live Delay: ".concat(n.liveDelay,", Live catchup max drift: ").concat(n.maxDrift)))),e.playbackRate&&(n=(a=e).playbackRate.min?Math.round(1e3*(a.playbackRate.min-1))/1e3:NaN,a=a.playbackRate.max?Math.round(1e3*(a.playbackRate.max-1))/1e3:NaN,o.liveCatchup.playbackRate.min=n,o.liveCatchup.playbackRate.max=a,l.debug("Found latency properties coming from service description: Live catchup min playback rate: ".concat(n)),l.debug("Found latency properties coming from service description: Live catchup max playback rate: ".concat(a))),e.operatingQuality,!e.operatingBandwidth||(a=e)&&a.operatingBandwidth&&a.operatingBandwidth.mediaType&&a.operatingBandwidth.mediaType!==y&&((i={}).minBandwidth=a.operatingBandwidth.min,i.maxBandwidth=a.operatingBandwidth.max,i.targetBandwidth=a.operatingBandwidth.target,e=[],a.operatingBandwidth.mediaType===h||a.operatingBandwidth.mediaType===m?e.push(a.operatingBandwidth.mediaType):a.operatingBandwidth.mediaType===p&&(e.push(m),e.push(h)),e.forEach(function(e){isNaN(i.minBandwidth)||c("minBitrate",e,i.minBandwidth),isNaN(i.maxBandwidth)||c("maxBitrate",e,i.maxBandwidth),isNaN(i.targetBandwidth)||c("initialBitrate",e,i.targetBandwidth)}))))},reset:function(){r()},setConfig:function(e){e&&e.adapter&&(u=e.adapter)}},l=(0,n.default)(t).getInstance().getLogger(e),r(),e}a.__dashjs_factory_name="ServiceDescriptionController";const i=t.default.getSingletonFactory(a)},"./src/dash/models/DashManifestModel.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>l});var v=r("./src/streaming/constants/Constants.js"),T=r("./src/dash/constants/DashConstants.js"),b=r("./src/dash/vo/Representation.js"),S=r("./src/dash/vo/AdaptationSet.js"),A=r("./src/dash/vo/Period.js"),n=r("./src/dash/vo/Mpd.js"),a=r("./src/dash/vo/UTCTiming.js"),R=r("./src/dash/vo/Event.js"),I=r("./src/dash/vo/BaseURL.js"),w=r("./src/dash/vo/EventStream.js"),C=r("./src/dash/vo/ProducerReferenceTime.js"),N=r("./src/dash/vo/ContentSteering.js"),D=r("./src/streaming/utils/ObjectUtils.js"),M=r("./src/streaming/utils/URLUtils.js"),t=r("./src/core/FactoryMaker.js"),O=r("./src/core/Debug.js"),P=r("./src/streaming/vo/DashJSError.js"),L=r("./src/core/errors/Errors.js"),F=r("./src/streaming/thumbnail/ThumbnailTracks.js");function x(e,t){var r;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=s(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,t=function(){};return{s:t,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:t}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,o=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return i=e.done,e},e:function(e){o=!0,a=e},f:function(){try{i||null==r.return||r.return()}finally{if(o)throw a}}}}function j(e){return function(e){if(Array.isArray(e))return i(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||s(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(e,t){if(e){if("string"==typeof e)return i(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Map"===(r="Object"===r&&e.constructor?e.constructor.name:r)||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?i(e,t):void 0}}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function o(){var e,u,c,f,i=this.context,o=(0,M.default)(i).getInstance(),d=Number.isInteger||function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e};function s(e,t){if(!e)throw new Error("adaptation is not defined");if(!t)throw new Error("type is not defined");if(e.Representation_asArray&&e.Representation_asArray.length){var r=y(e.Representation_asArray[0]);if(r&&0<r.length&&0<=F.THUMBNAILS_SCHEME_ID_URIS.indexOf(r[0].schemeIdUri))return t===v.default.IMAGE}if(e.ContentComponent_asArray&&0<e.ContentComponent_asArray.length){if(1<e.ContentComponent_asArray.length)return t===v.default.MUXED;if(e.ContentComponent_asArray[0].contentType===t)return!0}var n=t===v.default.TEXT?new RegExp("(ttml|vtt|wvtt|stpp)"):new RegExp(t);if(e.Representation_asArray&&e.Representation_asArray.length){t=e.Representation_asArray[0].codecs;if(n.test(t))return!0}if(e.hasOwnProperty(T.default.MIME_TYPE))return n.test(e.mimeType);if(e.Representation_asArray)for(var a,i=0;i<e.Representation_asArray.length;i++)if((a=e.Representation_asArray[i]).hasOwnProperty(T.default.MIME_TYPE))return n.test(a.mimeType);return!1}function g(e){if(!e)throw new Error("adaptation is not defined");if(e.hasOwnProperty(T.default.SEGMENT_TEMPLATE)||e.hasOwnProperty(T.default.SEGMENT_TIMELINE)||e.hasOwnProperty(T.default.SEGMENT_LIST)||e.hasOwnProperty(T.default.SEGMENT_BASE))return!0;if(e.Representation_asArray&&0<e.Representation_asArray.length){e=e.Representation_asArray[0];if(e.hasOwnProperty(T.default.SEGMENT_TEMPLATE)||e.hasOwnProperty(T.default.SEGMENT_TIMELINE)||e.hasOwnProperty(T.default.SEGMENT_LIST)||e.hasOwnProperty(T.default.SEGMENT_BASE))return!0}return!1}function h(e){return s(e,v.default.TEXT)}function t(){return function(e,t){return e.bandwidth-t.bandwidth}}function m(e){return e&&Array.isArray(e.Representation_asArray)&&e.Representation_asArray.sort(t()),e}function l(e,t){return e&&e.Period_asArray&&d(t)&&e.Period_asArray[t]?e.Period_asArray[t].AdaptationSet_asArray:[]}function r(e){return e&&e.Period_asArray?e.Period_asArray:[]}function p(e){var t=!1;return t=e&&e.hasOwnProperty("type")?e.type===T.default.DYNAMIC:t}function y(e){return e&&e.EssentialProperty_asArray&&e.EssentialProperty_asArray.length?e.EssentialProperty_asArray.map(function(e){return{schemeIdUri:e.schemeIdUri,value:e.value}}):null}function E(e,t,r){var n,a=[];if(!e)return a;for(n=0;n<e.length;n++){var i=new w.default;if(i.timescale=1,i.representation=t,!e[n].hasOwnProperty(v.default.SCHEME_ID_URI))throw new Error("Invalid EventStream. SchemeIdUri has to be set");i.schemeIdUri=e[n].schemeIdUri,e[n].hasOwnProperty(T.default.TIMESCALE)&&(i.timescale=e[n].timescale),e[n].hasOwnProperty(T.default.VALUE)&&(i.value=e[n].value),a.push(i),i.period=r}return a}function _(n){var a=[],e=n.BaseURL_asArray||[n.baseUri],i=!1;return e.some(function(e){if(e){var t=new I.default,r=e.__text||e;return o.isRelative(r)&&(i=!0,n.baseUri&&(r=o.resolve(r,n.baseUri))),t.url=r,e.hasOwnProperty(T.default.SERVICE_LOCATION)&&e.serviceLocation.length?t.serviceLocation=e.serviceLocation:t.serviceLocation=r,e.hasOwnProperty(T.default.DVB_PRIORITY)&&(t.dvb_priority=e[T.default.DVB_PRIORITY]),e.hasOwnProperty(T.default.DVB_WEIGHT)&&(t.dvb_weight=e[T.default.DVB_WEIGHT]),e.hasOwnProperty(T.default.AVAILABILITY_TIME_OFFSET)&&(t.availabilityTimeOffset=e[T.default.AVAILABILITY_TIME_OFFSET]),e.hasOwnProperty(T.default.AVAILABILITY_TIME_COMPLETE)&&(t.availabilityTimeComplete="false"!==e[T.default.AVAILABILITY_TIME_COMPLETE]),a.push(t),i}}),a}return e={getIsTypeOf:s,getIsText:h,getIsFragmented:g,getProducerReferenceTimesForAdaptation:function(e){var t=e&&e.hasOwnProperty(T.default.PRODUCERREFERENCETIME_ASARRAY)?e[T.default.PRODUCERREFERENCETIME_ASARRAY]:[];(e&&e.hasOwnProperty(T.default.REPRESENTATION_ASARRAY)?e[T.default.REPRESENTATION_ASARRAY]:[]).forEach(function(e){e.hasOwnProperty(T.default.PRODUCERREFERENCETIME_ASARRAY)&&t.push.apply(t,j(e[T.default.PRODUCERREFERENCETIME_ASARRAY]))});var r=[];return t.forEach(function(e){var t=new C.default;e.hasOwnProperty(T.default.ID)&&(t[T.default.ID]=e[T.default.ID],e.hasOwnProperty(T.default.WALL_CLOCK_TIME)&&(t[T.default.WALL_CLOCK_TIME]=e[T.default.WALL_CLOCK_TIME],e.hasOwnProperty(T.default.PRESENTATION_TIME)&&(t[T.default.PRESENTATION_TIME]=e[T.default.PRESENTATION_TIME],r.push(t))))}),r},getLanguageForAdaptation:function(e){var t="";return t=e&&e.hasOwnProperty(T.default.LANG)?e.lang:t},getViewpointForAdaptation:function(e){return e&&e.hasOwnProperty(T.default.VIEWPOINT)?e.Viewpoint:null},getRolesForAdaptation:function(e){return e&&e.hasOwnProperty(T.default.ROLE_ASARRAY)?e.Role_asArray:[]},getAccessibilityForAdaptation:function(e){return e&&e.hasOwnProperty(T.default.ACCESSIBILITY_ASARRAY)?e.Accessibility_asArray:[]},getAudioChannelConfigurationForAdaptation:function(e){return e&&e.hasOwnProperty(T.default.AUDIOCHANNELCONFIGURATION_ASARRAY)?e.AudioChannelConfiguration_asArray:[]},getAudioChannelConfigurationForRepresentation:function(e){return e&&e.hasOwnProperty(T.default.AUDIOCHANNELCONFIGURATION_ASARRAY)?e.AudioChannelConfiguration_asArray:[]},getAdaptationForIndex:function(e,t,r){return 0<(r=l(t,r)).length&&d(e)?r[e]:null},getIndexForAdaptation:function(e,t,r){if(!e)return-1;for(var n=l(t,r),a=0;a<n.length;a++)if((0,D.default)(i).getInstance().areEqual(n[a],e))return a;return-1},getAdaptationForId:function(e,t,r){for(var n=l(t,r),a=0,i=n.length;a<i;a++)if(n[a].hasOwnProperty(T.default.ID)&&n[a].id===e)return n[a];return null},getAdaptationsForType:function(e,t,r){for(var n=l(e,t),a=[],i=0,o=n.length;i<o;i++)s(n[i],r)&&a.push(m(n[i]));return a},getRealPeriods:r,getRealPeriodForIndex:function(e,t){return 0<(t=r(t)).length&&d(e)?t[e]:null},getCodec:function(e,t,r){var n=null;return e&&e.Representation_asArray&&0<e.Representation_asArray.length&&((e=d(t)&&0<=t&&t<e.Representation_asArray.length?e.Representation_asArray[t]:e.Representation_asArray[0])&&(n=e.mimeType+';codecs="'+e.codecs+'"',r&&void 0!==e.width&&(n+=';width="'+e.width+'";height="'+e.height+'"'))),n=n&&n.replace(/\sprofiles=[^;]*/g,"")},getSelectionPriority:function(e){try{var t=e&&void 0!==e.selectionPriority?parseInt(e.selectionPriority):1;return isNaN(t)?1:t}catch(e){return 1}},getMimeType:function(e){return e&&e.Representation_asArray&&0<e.Representation_asArray.length?e.Representation_asArray[0].mimeType:null},getKID:function(e){return e&&e.hasOwnProperty(T.default.CENC_DEFAULT_KID)?e[T.default.CENC_DEFAULT_KID]:null},getLabelsForAdaptation:function(e){if(!e||!Array.isArray(e.Label_asArray))return[];for(var t=[],r=0;r<e.Label_asArray.length;r++)t.push({lang:e.Label_asArray[r].lang,text:e.Label_asArray[r].__text||e.Label_asArray[r]});return t},getContentProtectionData:function(e){return e&&e.hasOwnProperty(T.default.CONTENTPROTECTION_ASARRAY)&&0!==e.ContentProtection_asArray.length?e.ContentProtection_asArray:null},getIsDynamic:p,getId:function(e){return e&&e[T.default.ID]||null},hasProfile:function(e,t){var r=!1;return r=e&&e.profiles&&0<e.profiles.length?-1!==e.profiles.indexOf(t):r},getDuration:function(e){return e=e&&e.hasOwnProperty(T.default.MEDIA_PRESENTATION_DURATION)?e.mediaPresentationDuration:e&&"dynamic"==e.type?Number.POSITIVE_INFINITY:Number.MAX_SAFE_INTEGER||Number.MAX_VALUE},getBandwidth:function(e){return e&&e.bandwidth?e.bandwidth:NaN},getManifestUpdatePeriod:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,r=NaN;return e&&e.hasOwnProperty(T.default.MINIMUM_UPDATE_PERIOD)&&(r=e.minimumUpdatePeriod),isNaN(r)?r:Math.max(r-t,1)},getPublishTime:function(e){return e&&e.hasOwnProperty(T.default.PUBLISH_TIME)?new Date(e[T.default.PUBLISH_TIME]):null},getRepresentationCount:function(e){return e&&Array.isArray(e.Representation_asArray)?e.Representation_asArray.length:0},getBitrateListForAdaptation:function(e){return((e=m(e))&&Array.isArray(e.Representation_asArray)?e.Representation_asArray:[]).map(function(e){return{bandwidth:e.bandwidth,width:e.width||0,height:e.height||0,scanType:e.scanType||null,id:e.id||null}})},getRepresentationFor:function(e,t){return t&&t.Representation_asArray&&0<t.Representation_asArray.length&&d(e)?t.Representation_asArray[e]:null},getRepresentationsForAdaptation:function(e){var t,r,n,a=[],i=function(e){if(e&&e.period&&d(e.period.index)){var t=e.period.mpd.manifest.Period_asArray[e.period.index];if(t&&t.AdaptationSet_asArray&&d(e.index))return m(t.AdaptationSet_asArray[e.index])}}(e);if(i&&i.Representation_asArray){e&&e.period&&d(e.period.index)&&((n=_(e.period.mpd.manifest))&&(r=n[0]));for(var o=0,s=i.Representation_asArray.length;o<s;++o){var l,u=i.Representation_asArray[o],c=new b.default;c.index=o,c.adaptation=e,u.hasOwnProperty(T.default.ID)&&(c.id=u.id),u.hasOwnProperty(T.default.CODECS)&&(c.codecs=u.codecs),u.hasOwnProperty(T.default.MIME_TYPE)&&(c.mimeType=u[T.default.MIME_TYPE]),u.hasOwnProperty(T.default.CODEC_PRIVATE_DATA)&&(c.codecPrivateData=u.codecPrivateData),u.hasOwnProperty(T.default.BANDWITH)&&(c.bandwidth=u.bandwidth),u.hasOwnProperty(T.default.WIDTH)&&(c.width=u.width),u.hasOwnProperty(T.default.HEIGHT)&&(c.height=u.height),u.hasOwnProperty(T.default.SCAN_TYPE)&&(c.scanType=u.scanType),u.hasOwnProperty(T.default.MAX_PLAYOUT_RATE)&&(c.maxPlayoutRate=u.maxPlayoutRate),u.hasOwnProperty(T.default.SEGMENT_BASE)?(t=u.SegmentBase,c.segmentInfoType=T.default.SEGMENT_BASE):u.hasOwnProperty(T.default.SEGMENT_LIST)?(t=u.SegmentList).hasOwnProperty(T.default.SEGMENT_TIMELINE)?c.segmentInfoType=T.default.SEGMENT_TIMELINE:c.segmentInfoType=T.default.SEGMENT_LIST:u.hasOwnProperty(T.default.SEGMENT_TEMPLATE)?((t=u.SegmentTemplate).hasOwnProperty(T.default.SEGMENT_TIMELINE)?c.segmentInfoType=T.default.SEGMENT_TIMELINE:c.segmentInfoType=T.default.SEGMENT_TEMPLATE,t.hasOwnProperty(T.default.INITIALIZATION_MINUS)&&(c.initialization=t.initialization.split("$Bandwidth$").join(u.bandwidth).split("$RepresentationID$").join(u.id))):c.segmentInfoType=T.default.BASE_URL,c.essentialProperties=y(u),t&&(t.hasOwnProperty(T.default.INITIALIZATION)?((l=t.Initialization).hasOwnProperty(T.default.SOURCE_URL)&&(c.initialization=l.sourceURL),l.hasOwnProperty(T.default.RANGE)&&(c.range=l.range)):h(i)&&g(i)&&i.mimeType&&-1===i.mimeType.indexOf("application/mp4")&&(c.range=0),t.hasOwnProperty(T.default.TIMESCALE)&&(c.timescale=t.timescale),t.hasOwnProperty(T.default.DURATION)?c.segmentDuration=t.duration/c.timescale:u.hasOwnProperty(T.default.SEGMENT_TEMPLATE)&&(t=u.SegmentTemplate).hasOwnProperty(T.default.SEGMENT_TIMELINE)&&(c.segmentDuration=function(e){if(!e||!e.S_asArray)return NaN;var t=e.S_asArray[0],e=e.S_asArray[1];return t.hasOwnProperty("d")?t.d:e.t-t.t}(t.SegmentTimeline)/c.timescale),t.hasOwnProperty(T.default.MEDIA)&&(c.media=t.media),t.hasOwnProperty(T.default.START_NUMBER)&&(c.startNumber=t.startNumber),t.hasOwnProperty(T.default.INDEX_RANGE)&&(c.indexRange=t.indexRange),t.hasOwnProperty(T.default.PRESENTATION_TIME_OFFSET)&&(c.presentationTimeOffset=t.presentationTimeOffset/c.timescale),t.hasOwnProperty(T.default.AVAILABILITY_TIME_OFFSET)?c.availabilityTimeOffset=t.availabilityTimeOffset:r&&void 0!==r.availabilityTimeOffset&&(c.availabilityTimeOffset=r.availabilityTimeOffset),t.hasOwnProperty(T.default.AVAILABILITY_TIME_COMPLETE)?c.availabilityTimeComplete="false"!==t.availabilityTimeComplete:r&&void 0!==r.availabilityTimeComplete&&(c.availabilityTimeComplete=r.availabilityTimeComplete)),c.MSETimeOffset=(l=void 0,l=(u=c).presentationTimeOffset,u.adaptation.period.start-l),c.path=[e.period.index,e.index,o],a.push(c)}}return a},getAdaptationsForPeriod:function(e){var t,r,n,a=e&&d(e.index)?e.mpd.manifest.Period_asArray[e.index]:null,i=[];if(a&&a.AdaptationSet_asArray)for(n=0;n<a.AdaptationSet_asArray.length;n++)r=a.AdaptationSet_asArray[n],t=new S.default,r.hasOwnProperty(T.default.ID)&&(t.id=r.id),t.index=n,t.period=e,s(r,v.default.MUXED)?t.type=v.default.MUXED:s(r,v.default.AUDIO)?t.type=v.default.AUDIO:s(r,v.default.VIDEO)?t.type=v.default.VIDEO:h(r)?t.type=v.default.TEXT:s(r,v.default.IMAGE)?t.type=v.default.IMAGE:u.warn("Unknown Adaptation stream type"),i.push(t);return i},getRegularPeriods:function(e){for(var t=!!e&&p(e.manifest),r=[],n=null,a=null,i=null,o=null,s=0,l=e&&e.manifest&&e.manifest.Period_asArray?e.manifest.Period_asArray.length:0;s<l;s++)(a=e.manifest.Period_asArray[s]).hasOwnProperty(T.default.START)?(o=new A.default).start=a.start:null!==n&&n.hasOwnProperty(T.default.DURATION)&&null!==i?(o=new A.default).start=parseFloat((i.start+i.duration).toFixed(5)):0!==s||t||((o=new A.default).start=0),null!==i&&isNaN(i.duration)&&(null!==o?i.duration=parseFloat((o.start-i.start).toFixed(5)):u.warn("First period duration could not be calculated because lack of start and duration period properties. This will cause timing issues during playback")),null!==o&&(o.id=function(e,t){if(!e)throw new Error("Period cannot be null or undefined");t=A.default.DEFAULT_ID+"_"+t;e.hasOwnProperty(T.default.ID)&&0<e.id.length&&"__proto__"!==e.id&&(t=e.id);return t}(a,s),o.index=s,o.mpd=e,a.hasOwnProperty(T.default.DURATION)&&(o.duration=a.duration),i&&(i.nextPeriodId=o.id),r.push(o),n=a,i=o),o=a=null;return 0===r.length||null!==i&&isNaN(i.duration)&&(i.duration=parseFloat((function(e){!function(){if(!c||!c.hasOwnProperty("error"))throw new Error(v.default.MISSING_CONFIG_ERROR)}();var t,r=p(e.mpd.manifest);e.mpd.manifest.mediaPresentationDuration?t=e.mpd.manifest.mediaPresentationDuration:e.duration?t=e.duration:r?t=Number.POSITIVE_INFINITY:c.error(new P.default(L.default.MANIFEST_ERROR_ID_PARSE_CODE,"Must have @mediaPresentationDuration on MPD or an explicit @duration on the last period.",e));return t}(i)-i.start).toFixed(5))),r},getMpd:function(e){var t=new n.default;return e&&((t.manifest=e).hasOwnProperty(T.default.AVAILABILITY_START_TIME)?t.availabilityStartTime=new Date(e.availabilityStartTime.getTime()):e.loadedTime&&(t.availabilityStartTime=new Date(e.loadedTime.getTime())),e.hasOwnProperty(T.default.AVAILABILITY_END_TIME)&&(t.availabilityEndTime=new Date(e.availabilityEndTime.getTime())),e.hasOwnProperty(T.default.MINIMUM_UPDATE_PERIOD)&&(t.minimumUpdatePeriod=e.minimumUpdatePeriod),e.hasOwnProperty(T.default.MEDIA_PRESENTATION_DURATION)&&(t.mediaPresentationDuration=e.mediaPresentationDuration),e.hasOwnProperty(T.default.SUGGESTED_PRESENTATION_DELAY)&&(t.suggestedPresentationDelay=e.suggestedPresentationDelay),e.hasOwnProperty(T.default.TIMESHIFT_BUFFER_DEPTH)&&(t.timeShiftBufferDepth=e.timeShiftBufferDepth),e.hasOwnProperty(T.default.MAX_SEGMENT_DURATION)&&(t.maxSegmentDuration=e.maxSegmentDuration),e.hasOwnProperty(T.default.PUBLISH_TIME)&&(t.publishTime=new Date(e.publishTime))),t},getEventsForPeriod:function(e){var t,r,n=e&&e.mpd&&e.mpd.manifest?e.mpd.manifest:null,a=(n=n?n.Period_asArray:null)&&e&&d(e.index)?n[e.index].EventStream_asArray:null,i=[];if(a)for(t=0;t<a.length;t++){var o=new w.default;if(o.period=e,o.timescale=1,!a[t].hasOwnProperty(v.default.SCHEME_ID_URI))throw new Error("Invalid EventStream. SchemeIdUri has to be set");for(o.schemeIdUri=a[t][v.default.SCHEME_ID_URI],a[t].hasOwnProperty(T.default.TIMESCALE)&&(o.timescale=a[t][T.default.TIMESCALE]),a[t].hasOwnProperty(T.default.VALUE)&&(o.value=a[t][T.default.VALUE]),a[t].hasOwnProperty(T.default.PRESENTATION_TIME_OFFSET)&&(o.presentationTimeOffset=a[t][T.default.PRESENTATION_TIME_OFFSET]),r=0;a[t].Event_asArray&&r<a[t].Event_asArray.length;r++){var s=a[t].Event_asArray[r],l=new R.default;l.presentationTime=0,l.eventStream=o,s.hasOwnProperty(T.default.PRESENTATION_TIME)&&(l.presentationTime=s.presentationTime);var u=o.presentationTimeOffset?o.presentationTimeOffset/o.timescale:0;l.calculatedPresentationTime=l.presentationTime/o.timescale+e.start-u,s.hasOwnProperty(T.default.DURATION)&&(l.duration=s.duration/o.timescale),s.hasOwnProperty(T.default.ID)?l.id=s.id:l.id=null,s.Signal&&s.Signal.Binary?l.messageData=f.decodeArray(s.Signal.Binary.toString()):l.messageData=s.messageData||s.__cdata||s.__text,i.push(l)}}return i},getEssentialPropertiesForRepresentation:y,getEventStreamForAdaptationSet:function(e,t,r){var n,a,i;return E(n=e&&e.Period_asArray&&t&&t.period&&d(t.period.index)&&(a=e.Period_asArray[t.period.index])&&a.AdaptationSet_asArray&&d(t.index)&&(i=a.AdaptationSet_asArray[t.index])?i.InbandEventStream_asArray:n,null,r)},getEventStreamForRepresentation:function(e,t,r){var n,a,i,o;return E(n=e&&e.Period_asArray&&t&&t.adaptation&&t.adaptation.period&&d(t.adaptation.period.index)&&(a=e.Period_asArray[t.adaptation.period.index])&&a.AdaptationSet_asArray&&d(t.adaptation.index)&&(i=a.AdaptationSet_asArray[t.adaptation.index])&&i.Representation_asArray&&d(t.index)&&(o=i.Representation_asArray[t.index])?o.InbandEventStream_asArray:n,t,r)},getUTCTimingSources:function(e){var t=p(e),r=!!e&&e.hasOwnProperty(T.default.AVAILABILITY_START_TIME),e=e?e.UTCTiming_asArray:null,n=[];return(t||r)&&e&&e.forEach(function(e){var t=new a.default;e.hasOwnProperty(v.default.SCHEME_ID_URI)&&(t.schemeIdUri=e.schemeIdUri,e.hasOwnProperty(T.default.VALUE)&&(t.value=e.value.toString(),n.push(t)))}),n},getBaseURLsFromElement:_,getRepresentationSortFunction:t,getContentSteering:function(e){if(e&&e.hasOwnProperty(T.default.CONTENT_STEERING_AS_ARRAY)){var t=e[T.default.CONTENT_STEERING_AS_ARRAY][0],e=new N.default;return e.serverUrl=t.__text,t.hasOwnProperty(T.default.DEFAULT_SERVICE_LOCATION)&&(e.defaultServiceLocation=t[T.default.DEFAULT_SERVICE_LOCATION]),t.hasOwnProperty(T.default.QUERY_BEFORE_START)&&(e.queryBeforeStart="true"===t[T.default.QUERY_BEFORE_START].toLowerCase()),t.hasOwnProperty(T.default.PROXY_SERVER_URL)&&(e.proxyServerUrl=t[T.default.PROXY_SERVER_URL]),e}},getLocation:function(e){if(e&&e.hasOwnProperty(v.default.LOCATION))return e.Location=e.Location_asArray[0],e.Location},getPatchLocation:function(e){if(e&&e.hasOwnProperty(T.default.PATCH_LOCATION))return e.PatchLocation=e.PatchLocation_asArray[0],e.PatchLocation},getSuggestedPresentationDelay:function(e){return e&&e.hasOwnProperty(T.default.SUGGESTED_PRESENTATION_DELAY)?e.suggestedPresentationDelay:null},getAvailabilityStartTime:function(e){return e&&e.hasOwnProperty(T.default.AVAILABILITY_START_TIME)&&null!==e.availabilityStartTime?e.availabilityStartTime.getTime():null},getServiceDescriptions:function(e){var t=[];if(e&&e.hasOwnProperty(T.default.SERVICE_DESCRIPTION)){var r,n=x(e.ServiceDescription_asArray);try{for(n.s();!(r=n.n()).done;){var a,i=r.value,o=null,s=null,l=null,u=null,c=null,f=null;for(a in i)i.hasOwnProperty(a)&&(a===T.default.ID?o=i[a]:a===T.default.SERVICE_DESCRIPTION_SCOPE?s=i[a].schemeIdUri:a===T.default.SERVICE_DESCRIPTION_LATENCY?l={target:parseInt(i[a].target),max:parseInt(i[a].max),min:parseInt(i[a].min),referenceId:parseInt(i[a].referenceId)}:a===T.default.SERVICE_DESCRIPTION_PLAYBACK_RATE?u={max:parseFloat(i[a].max),min:parseFloat(i[a].min)}:a===T.default.SERVICE_DESCRIPTION_OPERATING_QUALITY?c={mediaType:i[a].mediaType,max:parseInt(i[a].max),min:parseInt(i[a].min),target:parseInt(i[a].target),type:i[a].type,maxQualityDifference:parseInt(i[a].maxQualityDifference)}:a===T.default.SERVICE_DESCRIPTION_OPERATING_BANDWIDTH&&(f={mediaType:i[a].mediaType,max:parseInt(i[a].max),min:parseInt(i[a].min),target:parseInt(i[a].target)}));t.push({id:o,schemeIdUri:s,latency:l,playbackRate:u,operatingQuality:c,operatingBandwidth:f})}}catch(e){n.e(e)}finally{n.f()}}return t},getSupplementalProperties:function(e){var t={};if(e&&e.hasOwnProperty(T.default.SUPPLEMENTAL_PROPERTY)){var r=x(e.SupplementalProperty_asArray);try{for(r.s();!(n=r.n()).done;){var n=n.value;n.hasOwnProperty(v.default.SCHEME_ID_URI)&&n.hasOwnProperty(T.default.VALUE)&&(t[n[v.default.SCHEME_ID_URI]]=n[T.default.VALUE])}}catch(e){r.e(e)}finally{r.f()}}return t},setConfig:function(e){e&&(e.errHandler&&(c=e.errHandler),e.BASE64&&(f=e.BASE64))}},u=(0,O.default)(i).getInstance().getLogger(e),e}o.__dashjs_factory_name="DashManifestModel";const l=t.default.getSingletonFactory(o)},"./src/dash/models/PatchManifestModel.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>l});var n=r("./src/dash/constants/DashConstants.js"),t=r("./src/core/FactoryMaker.js"),i=r("./src/core/Debug.js"),o=r("./src/dash/vo/SimpleXPath.js"),s=r("./src/dash/vo/PatchOperation.js");function a(){var e,a,t=this.context;return e={getIsPatch:function(e){return e&&e.hasOwnProperty(n.default.ORIGINAL_MPD_ID)||!1},getPublishTime:function(e){return e&&e.hasOwnProperty(n.default.PUBLISH_TIME)?new Date(e[n.default.PUBLISH_TIME]):null},getOriginalPublishTime:function(e){return e&&e.hasOwnProperty(n.default.ORIGINAL_PUBLISH_TIME)?new Date(e[n.default.ORIGINAL_PUBLISH_TIME]):null},getMpdId:function(e){return e&&e[n.default.ORIGINAL_MPD_ID]||null},getPatchOperations:function(e){return e?(e.__children||[]).map(function(e){var t=Object.keys(e)[0];if("add"!==t&&"remove"!==t&&"replace"!==t)return a.warn("Ignoring node of invalid action: ".concat(t)),null;var r=e[t],n=r.sel;if("add"===t&&r.type){if(!r.type.startsWith("@"))return a.warn("Ignoring add action for prefixed namespace declaration: ".concat(r.type,"=").concat(r.__text)),null;n="".concat(n,"/").concat(r.type)}e=new o.default(n);if(!e.isValid())return a.warn("Ignoring action with invalid selector: ".concat(t," - ").concat(n)),null;n=null;e.findsAttribute()?n=r.__text||"":"remove"!==t&&(n=r.__children.reduce(function(e,t){var r=Object.keys(t)[0];return"#text"!==r&&(e[r]=e[r]||[],e[r].push(t[r])),e},{}));n=new s.default(t,e,n);return"add"===t&&(n.position=r.pos),n}).filter(function(e){return!!e}):[]}},a=(0,i.default)(t).getInstance().getLogger(e),e}a.__dashjs_factory_name="PatchManifestModel";const l=t.default.getSingletonFactory(a)},"./src/dash/parser/DashParser.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>a});var t=r("./src/core/FactoryMaker.js"),l=r("./src/dash/parser/objectiron.js"),u=r("./externals/xml2json.js"),c=r("./src/dash/parser/matchers/StringMatcher.js"),f=r("./src/dash/parser/matchers/DurationMatcher.js"),d=r("./src/dash/parser/matchers/DateTimeMatcher.js"),g=r("./src/dash/parser/matchers/NumericMatcher.js"),h=r("./src/dash/parser/matchers/LangMatcher.js"),m=r("./src/dash/parser/maps/RepresentationBaseValuesMap.js"),p=r("./src/dash/parser/maps/SegmentValuesMap.js");function n(e){e=e||{};var t,a,r,i,o,n=this.context,s=e.debug;return t={parse:function(e){var t=window.performance.now(),r=i.xml_str2json(e);if(!r)throw new Error("parsing the manifest failed");var n=window.performance.now();return r.Patch?((r=r.Patch).add_asArray&&r.add_asArray.forEach(function(e){return o.run(e)}),r.replace_asArray&&r.replace_asArray.forEach(function(e){return o.run(e)})):(r=r.MPD,o.run(r)),e=window.performance.now(),a.info("Parsing complete: ( xml2json: "+(n-t).toPrecision(3)+"ms, objectiron: "+(e-n).toPrecision(3)+"ms, total: "+((e-t)/1e3).toPrecision(3)+"s)"),r.protocol="DASH",r},getMatchers:function(){return r},getIron:function(){return o}},a=s.getLogger(t),r=[new f.default,new d.default,new g.default,new h.default,new c.default],i=new u.default({escapeMode:!1,attributePrefix:"",arrayAccessForm:"property",emptyNodeForm:"object",stripWhitespaces:!1,enableToStringFunc:!0,ignoreRoot:!1,matchers:r}),o=(0,l.default)(n).create({adaptationset:new m.default,period:new p.default}),t}n.__dashjs_factory_name="DashParser";const a=t.default.getClassFactory(n)},"./src/dash/parser/maps/CommonProperty.js":(e,t,r)=>{function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}r.r(t),r.d(t,{default:()=>n});const n=function(){function r(e){!function(e){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}(this);var t;this._name=e,this._merge=(t=e)&&t.length&&t.charAt(0)===t.charAt(0).toUpperCase()}var e,t,n;return e=r,(t=[{key:"name",get:function(){return this._name}},{key:"merge",get:function(){return this._merge}}])&&a(e.prototype,t),n&&a(e,n),r}()},"./src/dash/parser/maps/MapNode.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>a});var i=r("./src/dash/parser/maps/CommonProperty.js");function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}const a=function(){function a(e,t,r){var n=this;!function(e){if(!(e instanceof a))throw new TypeError("Cannot call a class as a function")}(this),this._name=e||"",this._properties=[],this._children=r||[],Array.isArray(t)&&t.forEach(function(e){n._properties.push(new i.default(e))})}var e,t,r;return e=a,(t=[{key:"name",get:function(){return this._name}},{key:"children",get:function(){return this._children}},{key:"properties",get:function(){return this._properties}}])&&n(e.prototype,t),r&&n(e,r),a}()},"./src/dash/parser/maps/RepresentationBaseValuesMap.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>u});var n=r("./src/dash/parser/maps/MapNode.js"),a=r("./src/dash/constants/DashConstants.js");function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){return(o=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function s(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=l(r);return e=n?(e=l(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),t=this,!(e=e)||"object"!==i(e)&&"function"!=typeof e?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(t):e}}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}const u=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&o(e,t)}(r,n["default"]);var t=s(r);function r(){!function(e){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}(this);var e=[a.default.PROFILES,a.default.WIDTH,a.default.HEIGHT,a.default.SAR,a.default.FRAMERATE,a.default.AUDIO_SAMPLING_RATE,a.default.MIME_TYPE,a.default.SEGMENT_PROFILES,a.default.CODECS,a.default.MAXIMUM_SAP_PERIOD,a.default.START_WITH_SAP,a.default.MAX_PLAYOUT_RATE,a.default.CODING_DEPENDENCY,a.default.SCAN_TYPE,a.default.FRAME_PACKING,a.default.AUDIO_CHANNEL_CONFIGURATION,a.default.CONTENT_PROTECTION,a.default.ESSENTIAL_PROPERTY,a.default.SUPPLEMENTAL_PROPERTY,a.default.INBAND_EVENT_STREAM];return t.call(this,a.default.ADAPTATION_SET,e,[new n.default(a.default.REPRESENTATION,e,[new n.default(a.default.SUB_REPRESENTATION,e)])])}return r}()},"./src/dash/parser/maps/SegmentValuesMap.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>u});var n=r("./src/dash/parser/maps/MapNode.js"),a=r("./src/dash/constants/DashConstants.js");function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){return(o=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function s(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=l(r);return e=n?(e=l(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),t=this,!(e=e)||"object"!==i(e)&&"function"!=typeof e?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(t):e}}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}const u=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&o(e,t)}(r,n["default"]);var t=s(r);function r(){!function(e){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}(this);var e=[a.default.SEGMENT_BASE,a.default.SEGMENT_TEMPLATE,a.default.SEGMENT_LIST];return t.call(this,a.default.PERIOD,e,[new n.default(a.default.ADAPTATION_SET,e,[new n.default(a.default.REPRESENTATION,e)])])}return r}()},"./src/dash/parser/matchers/BaseMatcher.js":(e,t,r)=>{function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}r.r(t),r.d(t,{default:()=>n});const n=function(){function r(e,t){!function(e){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}(this),this._test=e,this._converter=t}var e,t,n;return e=r,(t=[{key:"test",get:function(){return this._test}},{key:"converter",get:function(){return this._converter}}])&&a(e.prototype,t),n&&a(e,n),r}()},"./src/dash/parser/matchers/DateTimeMatcher.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>d});var n=r("./src/dash/parser/matchers/BaseMatcher.js");function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){return(i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function o(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=s(r);return e=n?(e=s(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),t=this,!(e=e)||"object"!==a(e)&&"function"!=typeof e?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(t):e}}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var l=60,u=60,c=1e3,f=/^([0-9]{4})-([0-9]{2})-([0-9]{2})T([0-9]{2}):([0-9]{2})(?::([0-9]*)(\.[0-9]*)?)?(?:([+-])([0-9]{2})(?::?)([0-9]{2}))?/;const d=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&i(e,t)}(t,n["default"]);var e=o(t);function t(){return function(e){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),e.call(this,function(e){return f.test(e.value)},function(e){var t=f.exec(e),r=Date.UTC(parseInt(t[1],10),parseInt(t[2],10)-1,parseInt(t[3],10),parseInt(t[4],10),parseInt(t[5],10),t[6]&&parseInt(t[6],10)||0,t[7]&&parseFloat(t[7])*c||0);return t[9]&&t[10]&&(e=parseInt(t[9],10)*u+parseInt(t[10],10),r+=("+"===t[8]?-1:1)*e*l*c),new Date(r)})}return t}()},"./src/dash/parser/matchers/DurationMatcher.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>p});var n=r("./src/dash/parser/matchers/BaseMatcher.js"),a=r("./src/streaming/constants/Constants.js"),i=r("./src/dash/constants/DashConstants.js");function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(e,t){return(s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function l(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=u(r);return e=n?(e=u(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),t=this,!(e=e)||"object"!==o(e)&&"function"!=typeof e?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(t):e}}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var c=/^([-])?P(([\d.]*)Y)?(([\d.]*)M)?(([\d.]*)D)?T?(([\d.]*)H)?(([\d.]*)M)?(([\d.]*)S)?/,f=31536e3,d=2592e3,g=86400,h=3600,m=60;const p=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&s(e,t)}(t,n["default"]);var e=l(t);function t(){return function(e){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),e.call(this,function(e){for(var t=[i.default.MIN_BUFFER_TIME,i.default.MEDIA_PRESENTATION_DURATION,i.default.MINIMUM_UPDATE_PERIOD,i.default.TIMESHIFT_BUFFER_DEPTH,i.default.MAX_SEGMENT_DURATION,i.default.MAX_SUBSEGMENT_DURATION,i.default.SUGGESTED_PRESENTATION_DELAY,i.default.START,a.default.START_TIME,i.default.DURATION],r=t.length,n=0;n<r;n++)if(e.nodeName===t[n])return c.test(e.value);return!1},function(e){var t=c.exec(e),e=parseFloat(t[3]||0)*f+parseFloat(t[5]||0)*d+parseFloat(t[7]||0)*g+parseFloat(t[9]||0)*h+parseFloat(t[11]||0)*m+parseFloat(t[13]||0);return e=void 0!==t[1]?-e:e})}return t}()},"./src/dash/parser/matchers/LangMatcher.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>f});var n=r("./src/dash/parser/matchers/BaseMatcher.js"),a=r("./src/dash/constants/DashConstants.js"),t=r("./node_modules/bcp-47-normalize/index.js"),i=r.n(t);function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function l(e,t){return(l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function u(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=c(r);return e=n?(e=c(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),t=this,!(e=e)||"object"!==o(e)&&"function"!=typeof e?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(t):e}}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}const f=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&l(e,t)}(t,n["default"]);var e=u(t);function t(){return function(e){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),e.call(this,function(e,t){var r=(s(r={},a.default.ADAPTATION_SET,[a.default.LANG]),s(r,a.default.REPRESENTATION,[a.default.LANG]),s(r,a.default.CONTENT_COMPONENT,[a.default.LANG]),s(r,a.default.LABEL,[a.default.LANG]),s(r,a.default.GROUP_LABEL,[a.default.LANG]),r);if(r.hasOwnProperty(t)){t=r[t];return void 0!==t&&0<=t.indexOf(e.name)}return!1},function(e){var t=i()(e);return void 0!==t?t:String(e)})}return t}()},"./src/dash/parser/matchers/NumericMatcher.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>u});var n=r("./src/dash/parser/matchers/BaseMatcher.js");function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){return(i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function o(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=s(r);return e=n?(e=s(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),t=this,!(e=e)||"object"!==a(e)&&"function"!=typeof e?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(t):e}}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var l=/^[-+]?[0-9]+[.]?[0-9]*([eE][-+]?[0-9]+)?$/;const u=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&i(e,t)}(t,n["default"]);var e=o(t);function t(){return function(e){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),e.call(this,function(e){return l.test(e.value)},function(e){return parseFloat(e)})}return t}()},"./src/dash/parser/matchers/StringMatcher.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>c});var n=r("./src/dash/parser/matchers/BaseMatcher.js"),a=r("./src/dash/constants/DashConstants.js");function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function s(e,t){return(s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function l(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=u(r);return e=n?(e=u(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),t=this,!(e=e)||"object"!==i(e)&&"function"!=typeof e?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(t):e}}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}const c=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&s(e,t)}(t,n["default"]);var e=l(t);function t(){return function(e){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),e.call(this,function(e,t){var r=(o(r={},a.default.MPD,[a.default.ID,a.default.PROFILES]),o(r,a.default.PERIOD,[a.default.ID]),o(r,a.default.BASE_URL,[a.default.SERVICE_LOCATION,a.default.BYTE_RANGE]),o(r,a.default.SEGMENT_BASE,[a.default.INDEX_RANGE]),o(r,a.default.INITIALIZATION,[a.default.RANGE]),o(r,a.default.REPRESENTATION_INDEX,[a.default.RANGE]),o(r,a.default.SEGMENT_LIST,[a.default.INDEX_RANGE]),o(r,a.default.BITSTREAM_SWITCHING,[a.default.RANGE]),o(r,a.default.SEGMENT_URL,[a.default.MEDIA_RANGE,a.default.INDEX_RANGE]),o(r,a.default.SEGMENT_TEMPLATE,[a.default.INDEX_RANGE,a.default.MEDIA,a.default.INDEX,a.default.INITIALIZATION_MINUS,a.default.BITSTREAM_SWITCHING_MINUS]),o(r,a.default.ASSET_IDENTIFIER,[a.default.VALUE,a.default.ID]),o(r,a.default.EVENT_STREAM,[a.default.VALUE]),o(r,a.default.ADAPTATION_SET,[a.default.PROFILES,a.default.MIME_TYPE,a.default.SEGMENT_PROFILES,a.default.CODECS,a.default.CONTENT_TYPE]),o(r,a.default.FRAME_PACKING,[a.default.VALUE,a.default.ID]),o(r,a.default.AUDIO_CHANNEL_CONFIGURATION,[a.default.VALUE,a.default.ID]),o(r,a.default.CONTENT_PROTECTION,[a.default.VALUE,a.default.ID]),o(r,a.default.ESSENTIAL_PROPERTY,[a.default.VALUE,a.default.ID]),o(r,a.default.SUPPLEMENTAL_PROPERTY,[a.default.VALUE,a.default.ID]),o(r,a.default.INBAND_EVENT_STREAM,[a.default.VALUE,a.default.ID]),o(r,a.default.ACCESSIBILITY,[a.default.VALUE,a.default.ID]),o(r,a.default.ROLE,[a.default.VALUE,a.default.ID]),o(r,a.default.RATING,[a.default.VALUE,a.default.ID]),o(r,a.default.VIEWPOINT,[a.default.VALUE,a.default.ID]),o(r,a.default.CONTENT_COMPONENT,[a.default.CONTENT_TYPE]),o(r,a.default.REPRESENTATION,[a.default.ID,a.default.DEPENDENCY_ID,a.default.MEDIA_STREAM_STRUCTURE_ID]),o(r,a.default.SUBSET,[a.default.ID]),o(r,a.default.METRICS,[a.default.METRICS_MINUS]),o(r,a.default.REPORTING,[a.default.VALUE,a.default.ID]),r);if(r.hasOwnProperty(t)){t=r[t];return void 0!==t&&0<=t.indexOf(e.name)}return!1},function(e){return String(e)})}return t}()},"./src/dash/parser/objectiron.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>a});r=r("./src/core/FactoryMaker.js");function d(e){return(d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function n(c){function u(e,t,r){for(var n=0,a=e.length;n<a;++n){var i,o,s=e[n];t[s.name]&&(r[s.name]?s.merge&&(i=t[s.name],o=r[s.name],"object"===d(i)&&"object"===d(o)?function(e,t){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}(i,o):r[s.name]=i+o):r[s.name]=t[s.name])}}function f(e,t){for(var r=0,n=e.children.length;r<n;++r){var a=e.children[r],i=t[a.name+"_asArray"];if(i)for(var o=0,s=i.length;o<s;++o){var l=i[o];u(e.properties,t,l),f(a,l)}}}return{run:function(e){if(null===e||"object"!==d(e))return e;if(e.Period_asArray&&"period"in c)for(var t=c.period,r=e.Period_asArray,n=0,a=r.length;n<a;++n){var i=r[n];if(f(t,i),"adaptationset"in c){var o=i.AdaptationSet_asArray;if(o)for(var s=c.adaptationset,l=0,u=o.length;l<u;++l)f(s,o[l])}}return e}}}n.__dashjs_factory_name="ObjectIron";const a=r.default.getClassFactory(n)},"./src/dash/utils/ListSegmentsGetter.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>i});var t=r("./src/core/FactoryMaker.js"),a=r("./src/streaming/constants/Constants.js"),c=r("./src/dash/utils/SegmentsUtils.js");function n(e,s){var l=(e=e||{}).timelineConverter;function u(){if(!l||!l.hasOwnProperty("calcPeriodRelativeTimeFromMpdRelativeTime"))throw new Error(a.default.MISSING_CONFIG_ERROR)}function n(e,t){if(u(),!e)return null;var r=e.adaptation.period.mpd.manifest.Period_asArray[e.adaptation.period.index].AdaptationSet_asArray[e.adaptation.index].Representation_asArray[e.index].SegmentList,n=r.SegmentURL_asArray.length,a=e&&!isNaN(e.startNumber)?e.startNumber:1,i=Math.max(a-1,0),o=Math.max(t-i,0),i=null;return o<n&&(o=r.SegmentURL_asArray[o],(i=(0,c.getIndexBasedSegment)(l,s,e,t))&&(i.replacementTime=(a+t-1)*e.segmentDuration,i.media=o.media||"",i.mediaRange=o.mediaRange,i.indexRange=o.indexRange)),i}return{getSegmentByIndex:n,getSegmentByTime:function(e,t){if(u(),!e)return null;var r=e.segmentDuration;return isNaN(r)?null:(t=l.calcPeriodRelativeTimeFromMpdRelativeTime(e,t),n(e,Math.floor(t/r)))},getMediaFinishedInformation:function(e){var t={numberOfSegments:0,mediaTimeOfLastSignaledSegment:NaN};if(!e)return t;var r=e.adaptation.period.mpd.manifest.Period_asArray[e.adaptation.period.index].AdaptationSet_asArray[e.adaptation.index].Representation_asArray[e.index].SegmentList,e=e&&!isNaN(e.startNumber)?e.startNumber:1,e=Math.max(e-1,0);return t.numberOfSegments=e+r.SegmentURL_asArray.length,t}}}n.__dashjs_factory_name="ListSegmentsGetter";const i=t.default.getClassFactory(n)},"./src/dash/utils/Round10.js":(e,t,r)=>{function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}r.r(t),r.d(t,{default:()=>n});var n=function(){function t(){!function(e){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this)}var e,r,n;return e=t,n=[{key:"round10",value:function(e,t){return r="round",e=e,void 0!==(t=t)&&0!=+t?(t=+t,null===(e=+e)||isNaN(e)||"number"!=typeof t||t%1!=0?NaN:(e=e.toString().split("e"),+((e=(e=Math[r](+(e[0]+"e"+(e[1]?+e[1]-t:-t)))).toString().split("e"))[0]+"e"+(e[1]?+e[1]+t:t)))):Math[r](e);var r}}],(r=null)&&a(e.prototype,r),n&&a(e,n),t}()},"./src/dash/utils/SegmentBaseGetter.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>i});var t=r("./src/core/FactoryMaker.js"),n=r("./src/streaming/constants/Constants.js");function a(e){var t=(e=e||{}).timelineConverter;function i(){if(!t||!t.hasOwnProperty("calcPeriodRelativeTimeFromMpdRelativeTime"))throw new Error(n.default.MISSING_CONFIG_ERROR)}function r(e,t){if(i(),!e)return null;var r,n=e.segments?e.segments.length:-1;if(t<n&&(r=e.segments[t])&&r.index===t)return r;for(var a=0;a<n;a++)if((r=e.segments[a])&&r.index===t)return r;return null}return{getSegmentByIndex:r,getSegmentByTime:function(e,t){return i(),r(e,function(e,t){if(!e)return-1;var r,n,a,i,o,s=e.segments,l=s?s.length:null,u=-1;if(s&&0<l)for(o=0;o<l;o++)if(n=s[o],a=n.presentationStartTime,i=n.duration,a<=t+(r=i/2)&&t-r<a+i){u=n.index;break}return u}(e,t))},getMediaFinishedInformation:function(e){var t={numberOfSegments:0,mediaTimeOfLastSignaledSegment:NaN};return e&&e.segments&&(t.numberOfSegments=e.segments.length),t}}}a.__dashjs_factory_name="SegmentBaseGetter";const i=t.default.getClassFactory(a)},"./src/dash/utils/SegmentsUtils.js":(e,t,r)=>{r.r(t),r.d(t,{getIndexBasedSegment:()=>function(e,t,r,n){var a,i,o;a=r.segmentDuration,isNaN(a)&&(a=r.adaptation.period.duration);i=parseFloat((r.adaptation.period.start+n*a).toFixed(5)),o=parseFloat((i+a).toFixed(5));var s=e.calcMediaTimeFromPresentationTime(i,r),n=g(r,a,i,s,e,o,t,n);return h(e,r,n,t)?n:null},getTimeBasedSegment:()=>function(e,t,r,n,a,i,o,s,l,u){var c=n/i,a=a/i;return i=e.calcPresentationTimeFromMediaTime(c,r),l=g(r,a,i,c,e,i+a,t,l),h(e,r,l,t)?(l.replacementTime=u||n,o=d(o,"Number",l.replacementNumber),o=d(o,"Time",l.replacementTime),l.media=o,l.mediaRange=s,l):null},replaceIDForTemplate:()=>function(e,t){if(!t||!e||-1===e.indexOf("$RepresentationID$"))return e;t=t.toString();return e.split("$RepresentationID$").join(t)},replaceTokenForTemplate:()=>d,unescapeDollarsInTemplate:()=>function(e){return e&&e.split("$$").join("$")}});var u=r("./src/dash/vo/Segment.js");function f(e,t){for(;e.length<t;)e="0"+e;return e}function d(e,t,r){var n,a,i,o,s,l,u=t.length,c="%0".length;if(!e)return e;for(;;){if((n=e.indexOf("$"+t))<0)return e;if((a=e.indexOf("$",n+u))<0)return e;if(n<(i=e.indexOf("%0",n+u))&&i<a)switch(o=e.charAt(a-1),s=parseInt(e.substring(i+c,a-1),10),o){case"d":case"i":case"u":l=f(r.toString(),s);break;case"x":l=f(r.toString(16),s);break;case"X":l=f(r.toString(16),s).toUpperCase();break;case"o":l=f(r.toString(8),s);break;default:return e}else l=r;e=e.substring(0,n)+l+e.substring(a+1)}}function g(e,t,r,n,a,i,o,s){var l=new u.default;return l.representation=e,l.duration=t,l.presentationStartTime=r,l.mediaStartTime=n,l.availabilityStartTime=a.calcAvailabilityStartTimeFromPresentationTime(i,e,o),l.availabilityEndTime=a.calcAvailabilityEndTimeFromPresentationTime(i+t,e,o),l.wallStartTime=a.calcWallTimeForSegment(l,o),l.replacementNumber=(o=s,l.representation.startNumber+o),l.index=s,l}function h(e,t,r,n){var a=t.adaptation.period;if(!(isFinite(a.duration)&&a.start+a.duration<=r.presentationStartTime)){if(n){if("INF"===t.availabilityTimeOffset)return 1;e=e.getClientReferenceTime();return r.availabilityStartTime.getTime()<=e&&(!isFinite(r.availabilityEndTime)||r.availabilityEndTime.getTime()>=e)}return 1}}},"./src/dash/utils/TemplateSegmentsGetter.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>a});var t=r("./src/core/FactoryMaker.js"),s=r("./src/streaming/constants/Constants.js"),l=r("./src/dash/utils/SegmentsUtils.js");function n(e,a){var i=(e=e||{}).timelineConverter;function o(){if(!i||!i.hasOwnProperty("calcPeriodRelativeTimeFromMpdRelativeTime"))throw new Error(s.default.MISSING_CONFIG_ERROR)}function n(e,t){if(o(),!e)return null;var r=e.adaptation.period.mpd.manifest.Period_asArray[e.adaptation.period.index].AdaptationSet_asArray[e.adaptation.index].Representation_asArray[e.index].SegmentTemplate;t=Math.max(t,0);var n=(0,l.getIndexBasedSegment)(i,a,e,t);return n&&(n.replacementTime=Math.round((t-1)*e.segmentDuration*e.timescale,10),r=r.media,r=(0,l.replaceTokenForTemplate)(r,"Number",n.replacementNumber),r=(0,l.replaceTokenForTemplate)(r,"Time",n.replacementTime),n.media=r),n}return{getSegmentByIndex:n,getSegmentByTime:function(e,t){if(o(),!e)return null;var r=e.segmentDuration;return isNaN(r)?null:(t=i.calcPeriodRelativeTimeFromMpdRelativeTime(e,t),n(e,Math.floor(t/r)))},getMediaFinishedInformation:function(e){var t={numberOfSegments:0,mediaTimeOfLastSignaledSegment:NaN};if(!e)return t;var r=e.segmentDuration;return isNaN(r)?t.numberOfSegments=1:t.numberOfSegments=Math.ceil(e.adaptation.period.duration/r),t}}}n.__dashjs_factory_name="TemplateSegmentsGetter";const a=t.default.getClassFactory(n)},"./src/dash/utils/TimelineConverter.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>a});var y=r("./src/core/EventBus.js"),E=r("./src/core/events/Events.js"),t=r("./src/core/FactoryMaker.js"),_=r("./src/dash/constants/DashConstants.js"),v=r("./src/dash/models/DashManifestModel.js"),T=r("./src/core/Settings.js"),b=r("./src/streaming/constants/Constants.js"),S=r("./src/streaming/MediaPlayerEvents.js"),A=r("./src/streaming/constants/ConformanceViolationConstants.js");function n(){var e,u,r,n,t=this.context,i=(0,y.default)(t).getInstance(),o=(0,T.default)(t).getInstance();function a(e){n=e}function s(e,t,r,n){var a=t.adaptation.period.mpd,i=a.availabilityStartTime;return n?r&&a.timeShiftBufferDepth!==Number.POSITIVE_INFINITY?new Date(i.getTime()+1e3*(e+a.timeShiftBufferDepth)):a.availabilityEndTime:r?(t=t.availabilityTimeOffset,new Date(i.getTime()+1e3*(e-t))):i}function l(e,t){return(e.getTime()-t.mpd.availabilityStartTime.getTime()+1e3*n)/1e3}function c(e,t){return e+(t.adaptation.period.start-t.presentationTimeOffset)}function f(e){var r={start:NaN,end:NaN},t=e[0].getAdapter().getRegularPeriods()[0],n=l(new Date,t);if(!e||0===e.length)return{range:r,now:n};e.forEach(function(e){var t=e.getAdapter(),e=t.getMediaInfoForType(e.getStreamInfo(),b.default.VIDEO)||t.getMediaInfoForType(e.getStreamInfo(),b.default.AUDIO),t=t.getVoRepresentations(e)[0],e={start:NaN,end:NaN};t&&(t.segmentInfoType===_.default.SEGMENT_TIMELINE?e=function(e){var t,r,n,a,i=e.adaptation.period.mpd.manifest.Period_asArray[e.adaptation.period.index].AdaptationSet_asArray[e.adaptation.index],o=u.getRepresentationFor(e.index,i),i=o.SegmentTemplate.SegmentTimeline,o=o.SegmentTemplate.timescale,s=i.S_asArray,i={start:0,end:0},l=0;for(i.start=c(s[0].t/o,e),n=0,a=s.length;n<a;n++)t=s[n],r=0,t.hasOwnProperty("r")&&(r=t.r),l+=t.d*(1+r);return i.end=c((s[0].t+l)/o,e),i}(t):(t=t.adaptation.period,e.start=t.start,e.end=Math.max(n,t.start+t.duration))),!isNaN(e.start)&&(isNaN(r.start)||r.start>e.start)&&(r.start=e.start),!isNaN(e.end)&&(isNaN(r.end)||r.end<e.end)&&(r.end=e.end)}),r.end=Math.min(n,r.end);var a=g(e,r.end,!0);return r.end=isNaN(a)?r.end:a,r.start=t&&t.mpd&&t.mpd.timeShiftBufferDepth&&!isNaN(t.mpd.timeShiftBufferDepth)&&!isNaN(r.end)?Math.max(r.end-t.mpd.timeShiftBufferDepth,r.start):r.start,r.start=g(e,r.start),{range:r,now:n}}function d(e,t){r=e-t.end}function g(e,t,r){var n=2<arguments.length&&void 0!==r&&r;try{for(var a=0,i=!1,o=NaN;!i&&a<e.length;){var s=e[a].getStreamInfo();s.start<=t&&(!isFinite(s.duration)||s.start+s.duration>=t)?(o=t,i=!0):!n&&s.start>t&&(isNaN(o)||s.start<o)?o=s.start:n&&s.start+s.duration<t&&(isNaN(o)||s.start+s.duration>o)&&(o=s.start+s.duration),a+=1}return o}catch(e){return t}}function h(e){void 0===e.offset||isNaN(e.offset)||a(e.offset/1e3)}function m(){r=n=0}function p(){i.off(E.default.UPDATE_TIME_SYNC_OFFSET,h,this),m()}return e={initialize:function(){m(),i.on(E.default.UPDATE_TIME_SYNC_OFFSET,h,this)},getClientTimeOffset:function(){return n},setClientTimeOffset:a,getClientReferenceTime:function(){return Date.now()-1e3*r+1e3*n},calcAvailabilityStartTimeFromPresentationTime:function(e,t,r){return s(e,t,r)},calcAvailabilityEndTimeFromPresentationTime:function(e,t,r){return s(e,t,r,!0)},calcPresentationTimeFromWallTime:l,calcPresentationTimeFromMediaTime:c,calcPeriodRelativeTimeFromMpdRelativeTime:function(e,t){return t-e.adaptation.period.start},calcMediaTimeFromPresentationTime:function(e,t){return e-t.adaptation.period.start+t.presentationTimeOffset},calcWallTimeForSegment:function(e,t){var r;return t&&(r=e.representation.adaptation.period.mpd.suggestedPresentationDelay,r=e.presentationStartTime+r,r=new Date(e.availabilityStartTime.getTime()+1e3*r)),r},calcTimeShiftBufferWindow:function(e,t){if(!t)return a={start:NaN,end:NaN},r=0,n=NaN,e.forEach(function(e){e=e.getStreamInfo();r+=e.duration,(isNaN(n)||e.start<n)&&(n=e.start)}),a.start=n,a.end=n+r,a;var r,n;if(o.get().streaming.timeShiftBuffer.calcFromSegmentTimeline){var a=f(e);return d(a.now,a.range),a.range}return function(e){var t={start:NaN,end:NaN};if(!e||0===e.length)return t;var r=e[0].getAdapter().getRegularPeriods()[0],n=l(new Date,r),a=r.mpd.timeShiftBufferDepth,r=isNaN(a)?0:n-a;t.start=g(e,r),t.end=!isNaN(t.start)&&n<t.start?n:g(e,n,!0),!isNaN(a)&&t.end<n-a&&(t.end=NaN);if(o.get().streaming.timeShiftBuffer.fallbackToSegmentTimeline){e=f(e);if(e.range.end<t.start)return i.trigger(S.default.CONFORMANCE_VIOLATION,{level:A.default.LEVELS.WARNING,event:A.default.EVENTS.INVALID_DVR_WINDOW}),d(e.now,e.range),e.range}return t}(e)},reset:p},u=(0,v.default)(t).getInstance(),p(),e}n.__dashjs_factory_name="TimelineConverter";const a=t.default.getSingletonFactory(n)},"./src/dash/utils/TimelineSegmentsGetter.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>i});var t=r("./src/core/FactoryMaker.js"),n=r("./src/streaming/constants/Constants.js"),h=r("./src/dash/utils/SegmentsUtils.js");function a(e,d){var g=(e=e||{}).timelineConverter,l=e.dashMetrics;function t(){if(!g)throw new Error(n.default.MISSING_CONFIG_ERROR)}function r(e,t){for(var r,n,a,i=e.adaptation.period.mpd.manifest.Period_asArray[e.adaptation.period.index].AdaptationSet_asArray[e.adaptation.index].Representation_asArray[e.index].SegmentTemplate||e.adaptation.period.mpd.manifest.Period_asArray[e.adaptation.period.index].AdaptationSet_asArray[e.adaptation.index].Representation_asArray[e.index].SegmentList,o=i.SegmentTimeline,s=i.SegmentURL_asArray,l=0,u=-1,c=e.timescale,f=o.S_asArray,d=!1,g=0,h=f.length;g<h&&!d;g++)for(n=0,(a=f[g]).hasOwnProperty("r")&&(n=a.r),a.hasOwnProperty("t")&&(l=a.t),n<0&&(n=m(e,f[g+1],a,c,l/c)),r=0;r<=n&&!d;r++)(d=t(l,i,s,a,c,++u,g))&&(e.segmentDuration=a.d/c),l+=a.d}function m(e,t,r,n,a){var i;if(t&&t.hasOwnProperty("t"))i=t.t/n;else try{var o,s=0;s=isNaN(e.adaptation.period.start)||isNaN(e.adaptation.period.duration)||!isFinite(e.adaptation.period.duration)?(o=l.getCurrentDVRInfo(),isNaN(o.end)?0:o.end):e.adaptation.period.start+e.adaptation.period.duration,i=g.calcMediaTimeFromPresentationTime(s,e),e.segmentDuration=r.d/n}catch(e){i=0}return Math.max(Math.ceil((i-a)/(r.d/n))-1,0)}return{getSegmentByIndex:function(l,e,u){if(t(),!l)return null;var c=null,f=!1;return r(l,function(e,t,r,n,a,i,o){if(f||u<0){var s=t.media,t=n.mediaRange;return r&&(s=r[o].media||"",t=r[o].mediaRange),c=(0,h.getTimeBasedSegment)(g,d,l,e,n.d,a,s,t,i,n.tManifest),!0}return e>=u*a-.5*n.d&&(f=!0),!1}),c},getSegmentByTime:function(l,e){if(t(),!l)return null;void 0===e&&(e=null);var u=null,c=g.calcMediaTimeFromPresentationTime(e,l);return r(l,function(e,t,r,n,a,i,o){var s=parseFloat((c*a).toPrecision(15));if(s<e+n.d&&e<=s){s=t.media,t=n.mediaRange;return r&&(s=r[o].media||"",t=r[o].mediaRange),u=(0,h.getTimeBasedSegment)(g,d,l,e,n.d,a,s,t,i,n.tManifest),!0}return!1}),u},getMediaFinishedInformation:function(e){if(!e)return 0;for(var t,r,n,a=(e.adaptation.period.mpd.manifest.Period_asArray[e.adaptation.period.index].AdaptationSet_asArray[e.adaptation.index].Representation_asArray[e.index].SegmentTemplate||e.adaptation.period.mpd.manifest.Period_asArray[e.adaptation.period.index].AdaptationSet_asArray[e.adaptation.index].Representation_asArray[e.index].SegmentList).SegmentTimeline,i=0,o=0,s=0,l=e.timescale,u=a.S_asArray,c=u.length,f=0;f<c;f++)for(r=0,(n=u[f]).hasOwnProperty("r")&&(r=n.r),n.hasOwnProperty("t")&&(o=(i=n.t)/l),r<0&&(r=m(e,u[f+1],n,l,o)),t=0;t<=r;t++)s++,o=(i+=n.d)/l;return{numberOfSegments:s,mediaTimeOfLastSignaledSegment:o}}}}a.__dashjs_factory_name="TimelineSegmentsGetter";const i=t.default.getClassFactory(a)},"./src/dash/vo/AdaptationSet.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>n});const n=function t(){!function(e){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),this.period=null,this.index=-1,this.type=null}},"./src/dash/vo/BaseURL.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>n});t=function t(e,r,n,a){!function(e){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),this.url=e||"",this.serviceLocation=r||e||"",this.dvb_priority=n||1,this.dvb_weight=a||1,this.availabilityTimeOffset=0,this.availabilityTimeComplete=!0};t.DEFAULT_DVB_PRIORITY=1,t.DEFAULT_DVB_WEIGHT=1;const n=t},"./src/dash/vo/ContentSteering.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>n});const n=function t(){!function(e){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),this.defaultServiceLocation=null,this.queryBeforeStart=!1,this.proxyServerUrl=null,this.serverUrl=null}},"./src/dash/vo/ContentSteeringRequest.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>a});var n=r("./src/streaming/vo/metrics/HTTPRequest.js");const a=function t(e){!function(e){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),this.url=e||null,this.type=n.HTTPRequest.CONTENT_STEERING_TYPE,this.responseType="json"}},"./src/dash/vo/ContentSteeringResponse.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>n});const n=function t(){!function(e){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),this.version=null,this.ttl=300,this.reloadUri=null,this.serviceLocationPriority=[]}},"./src/dash/vo/Event.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>n});const n=function t(){!function(e){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),this.duration=NaN,this.presentationTime=NaN,this.id=NaN,this.messageData="",this.eventStream=null,this.presentationTimeDelta=NaN}},"./src/dash/vo/EventStream.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>n});const n=function t(){!function(e){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),this.adaptionSet=null,this.representation=null,this.period=null,this.timescale=1,this.value="",this.schemeIdUri="",this.presentationTimeOffset=0}},"./src/dash/vo/ManifestInfo.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>n});const n=function t(){!function(e){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),this.dvrWindowSize=NaN,this.loadedTime=null,this.availableFrom=null,this.minBufferTime=NaN,this.duration=NaN,this.isDynamic=!1,this.maxFragmentDuration=null}},"./src/dash/vo/MediaInfo.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>n});const n=function t(){!function(e){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),this.id=null,this.index=null,this.type=null,this.streamInfo=null,this.representationCount=0,this.labels=null,this.lang=null,this.viewpoint=null,this.accessibility=null,this.audioChannelConfiguration=null,this.roles=null,this.codec=null,this.mimeType=null,this.contentProtection=null,this.KID=null,this.bitrateList=null,this.isFragmented=null,this.isEmbedded=null,this.selectionPriority=1,this.supplementalProperties={}}},"./src/dash/vo/Mpd.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>n});const n=function t(){!function(e){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),this.manifest=null,this.suggestedPresentationDelay=0,this.availabilityStartTime=null,this.availabilityEndTime=Number.POSITIVE_INFINITY,this.timeShiftBufferDepth=Number.POSITIVE_INFINITY,this.maxSegmentDuration=Number.POSITIVE_INFINITY,this.publishTime=null,this.minimumUpdatePeriod=NaN,this.mediaPresentationDuration=NaN}},"./src/dash/vo/PatchOperation.js":(e,t,r)=>{function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}r.r(t),r.d(t,{default:()=>n});const n=function(){function n(e,t,r){!function(e){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this),this.action=e,this.xpath=t,this.value=r,this.position=null}var e,t,r;return e=n,(t=[{key:"getMpdTarget",value:function(e){var t="remove"===this.action||"replace"===this.action||"before"===this.position||"after"===this.position;return this.xpath.getMpdTarget(e,t)}}])&&a(e.prototype,t),r&&a(e,r),n}()},"./src/dash/vo/Period.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>n});t=function t(){!function(e){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),this.id=null,this.index=-1,this.duration=NaN,this.start=NaN,this.mpd=null,this.nextPeriodId=null};t.DEFAULT_ID="defaultId";const n=t},"./src/dash/vo/ProducerReferenceTime.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>n});const n=function t(){!function(e){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),this.id=null,this.inband=!1,this.type="encoder",this.applicationScheme=null,this.wallClockTime=null,this.presentationTime=NaN,this.UTCTiming=null}},"./src/dash/vo/Representation.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>n});var a=r("./src/dash/constants/DashConstants.js");function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}const n=function(){function t(){!function(e){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),this.id=null,this.index=-1,this.adaptation=null,this.segmentInfoType=null,this.initialization=null,this.codecs=null,this.mimeType=null,this.codecPrivateData=null,this.segmentDuration=NaN,this.timescale=1,this.startNumber=1,this.indexRange=null,this.range=null,this.presentationTimeOffset=0,this.MSETimeOffset=NaN,this.mediaFinishedInformation={numberOfSegments:0,mediaTimeOfLastSignaledSegment:NaN},this.bandwidth=NaN,this.width=NaN,this.height=NaN,this.scanType=null,this.maxPlayoutRate=NaN,this.availabilityTimeOffset=0,this.availabilityTimeComplete=!0}var e,r,n;return e=t,(r=[{key:"hasInitialization",value:function(){return null!==this.initialization||null!==this.range}},{key:"hasSegments",value:function(){return this.segmentInfoType!==a.default.BASE_URL&&this.segmentInfoType!==a.default.SEGMENT_BASE&&!this.indexRange}}])&&i(e.prototype,r),n&&i(e,n),t}()},"./src/dash/vo/RepresentationInfo.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>n});const n=function t(){!function(e){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),this.id=null,this.quality=null,this.fragmentDuration=null,this.mediaInfo=null,this.MSETimeOffset=null}},"./src/dash/vo/Segment.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>n});const n=function t(){!function(e){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),this.indexRange=null,this.index=null,this.mediaRange=null,this.media=null,this.duration=NaN,this.replacementTime=null,this.replacementNumber=NaN,this.mediaStartTime=NaN,this.presentationStartTime=NaN,this.availabilityStartTime=NaN,this.availabilityEndTime=NaN,this.wallStartTime=NaN,this.representation=null}},"./src/dash/vo/SimpleXPath.js":(e,t,r)=>{function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}r.r(t),r.d(t,{default:()=>n});const n=function(){function t(e){var n=this;!function(e){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),this.valid="/"==e[0],this.path=e.split("/").filter(function(e){return 0!==e.length}).map(function(e){var t={name:e},r=e.indexOf("[");return-1!=r&&(t.name=e.substring(0,r),r=e.substring(r+1,e.length-1),n.valid=n.valid&&-1==r.indexOf("["),-1!=(e=r.indexOf("="))?(t.attribute={name:r.substring(1,e),value:r.substring(e+1)},-1!=["'",'"'].indexOf(t.attribute.value[0])&&(t.attribute.value=t.attribute.value.substring(1,t.attribute.value.length-1))):t.position=parseInt(r,10)-1),t})}var e,r,n;return e=t,(r=[{key:"isValid",value:function(){return this.valid}},{key:"findsElement",value:function(){return!this.findsAttribute()}},{key:"findsAttribute",value:function(){return this.path[this.path.length-1].name.startsWith("@")}},{key:"getMpdTarget",value:function(e,t){for(var r=null,n=e,a=1,i="MPD";a<this.path.length&&null!==n;){var o,r=n,s=this.path[a],i=s.name;a===this.path.length-1&&i.startsWith("@")||(0===(o=r[i+"_asArray"]||[]).length&&r[i]&&o.push(r[i]),s.position?n=o[s.position]||null:s.attribute?function(){var t=s.attribute;n=o.filter(function(e){return e[t.name]==t.value})[0]||null}():n=o[0]||null),a++}return null===n?null:i.startsWith("@")?{name:i.substring(1),leaf:n,target:n}:{name:i,leaf:n,target:t?r:n}}}])&&a(e.prototype,r),n&&a(e,n),t}()},"./src/dash/vo/StreamInfo.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>n});const n=function t(){!function(e){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),this.id=null,this.index=null,this.start=NaN,this.duration=NaN,this.manifestInfo=null,this.isLast=!0}},"./src/dash/vo/UTCTiming.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>n});const n=function t(){!function(e){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),this.schemeIdUri="",this.value=""}},"./src/streaming/FragmentLoader.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>i});var n=r("./src/streaming/constants/Constants.js"),c=r("./src/streaming/net/URLLoader.js"),f=r("./src/streaming/vo/HeadRequest.js"),d=r("./src/streaming/vo/DashJSError.js"),r=r("./src/core/FactoryMaker.js");function a(e){e=e||{};var a,i,t=this.context,o=e.eventBus,s=e.events,r=e.urlUtils,l=e.errors,u=e.streamId;return a={checkForExistence:function(t){function e(e){o.trigger(s.CHECK_FOR_EXISTENCE_COMPLETED,{request:t,exists:e})}var r;t?(r=new f.default(t.url),i.load({request:r,success:function(){e(!0)},error:function(){e(!1)}})):e(!1)},load:function(r){function n(e,t){o.trigger(s.LOADING_COMPLETED,{request:r,response:e||null,error:t||null,sender:a})}r?i.load({request:r,progress:function(e){o.trigger(s.LOADING_PROGRESS,{request:r,stream:e.stream,streamId:u}),e.data&&o.trigger(s.LOADING_DATA_PROGRESS,{request:r,response:e.data||null,error:null,sender:a})},success:function(e){n(e)},error:function(e,t,r){n(void 0,new d.default(l.FRAGMENT_LOADER_LOADING_FAILURE_ERROR_CODE,r,t))},abort:function(e){e&&o.trigger(s.LOADING_ABANDONED,{mediaType:e.mediaType,request:e,sender:a})}}):n(void 0,new d.default(l.FRAGMENT_LOADER_NULL_REQUEST_ERROR_CODE,l.FRAGMENT_LOADER_NULL_REQUEST_ERROR_MESSAGE))},abort:function(){i&&i.abort()},reset:function(){i&&(i.abort(),i=null)}},i=(0,c.default)(t).create({errHandler:e.errHandler,errors:l,dashMetrics:e.dashMetrics,mediaPlayerModel:e.mediaPlayerModel,requestModifier:e.requestModifier,urlUtils:r,constants:n.default,boxParser:e.boxParser,dashConstants:e.dashConstants,requestTimeout:e.settings.get().streaming.fragmentRequestTimeout}),a}a.__dashjs_factory_name="FragmentLoader";const i=r.default.getClassFactory(a)},"./src/streaming/ManifestLoader.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>a});var p=r("./src/streaming/constants/Constants.js"),i=r("./src/dash/constants/DashConstants.js"),o=r("./src/streaming/controllers/XlinkController.js"),y=r("./src/streaming/net/URLLoader.js"),E=r("./src/streaming/utils/URLUtils.js"),_=r("./src/streaming/vo/TextRequest.js"),v=r("./src/streaming/vo/DashJSError.js"),T=r("./src/streaming/vo/metrics/HTTPRequest.js"),b=r("./src/core/EventBus.js"),S=r("./src/core/events/Events.js"),A=r("./src/core/errors/Errors.js"),t=r("./src/core/FactoryMaker.js"),R=r("./src/dash/parser/DashParser.js");function n(e){e=e||{};var t,s,r,l,u,c=this.context,f=e.debug,d=e.settings,g=(0,b.default)(c).getInstance(),h=(0,E.default)(c).getInstance(),m=e.mssHandler,n=e.errHandler;function a(e){g.trigger(S.default.INTERNAL_MANIFEST_LOADED,{manifest:e.manifest})}return t={load:function(o){var e=new _.default(o,T.HTTPRequest.MPD_TYPE);r.load({request:e,success:function(e,t,r){var n,a,i;if(l)if(r&&r!==o?(n=h.parseBaseUrl(r),i=r):(h.isRelative(o)&&(o=h.resolve(o,window.location.href)),n=h.parseBaseUrl(o)),"No Content"!=t)if(null===u&&(r=null,u=-1<(t=e).indexOf("SmoothStreamingMedia")?(m&&(r=m.createMssParser(),m.registerEvents()),r):-1<t.indexOf("MPD")||-1<t.indexOf("Patch")?(0,R.default)(c).create({debug:f}):r),null!==u){l.setMatchers(u.getMatchers()),l.setIron(u.getIron());try{a=u.parse(e)}catch(e){return void g.trigger(S.default.INTERNAL_MANIFEST_LOADED,{manifest:null,error:new v.default(A.default.MANIFEST_LOADER_PARSING_FAILURE_ERROR_CODE,A.default.MANIFEST_LOADER_PARSING_FAILURE_ERROR_MESSAGE+"".concat(o))})}a?(a.url=i||o,a.originalUrl||(a.originalUrl=a.url),a.hasOwnProperty(p.default.LOCATION)&&(n=h.parseBaseUrl(a.Location_asArray[0]),s.debug("BaseURI set by Location to: "+n)),d&&d.get().streaming.enableManifestDurationMismatchFix&&a.mediaPresentationDuration&&1<a.Period_asArray.length&&(i=a.Period_asArray.reduce(function(e,t){return e+t.duration},0),!isNaN(i)&&a.mediaPresentationDuration>i&&(s.warn("Media presentation duration greater than duration of all periods. Setting duration to total period duration"),a.mediaPresentationDuration=i)),a.baseUri=n,a.loadedTime=new Date,l.resolveManifestOnLoad(a),g.trigger(S.default.ORIGINAL_MANIFEST_LOADED,{originalManifest:e})):g.trigger(S.default.INTERNAL_MANIFEST_LOADED,{manifest:null,error:new v.default(A.default.MANIFEST_LOADER_PARSING_FAILURE_ERROR_CODE,A.default.MANIFEST_LOADER_PARSING_FAILURE_ERROR_MESSAGE+"".concat(o))})}else g.trigger(S.default.INTERNAL_MANIFEST_LOADED,{manifest:null,error:new v.default(A.default.MANIFEST_LOADER_PARSING_FAILURE_ERROR_CODE,A.default.MANIFEST_LOADER_PARSING_FAILURE_ERROR_MESSAGE+"".concat(o))});else g.trigger(S.default.INTERNAL_MANIFEST_LOADED,{manifest:null})},error:function(e,t,r){g.trigger(S.default.INTERNAL_MANIFEST_LOADED,{manifest:null,error:new v.default(A.default.MANIFEST_LOADER_LOADING_FAILURE_ERROR_CODE,A.default.MANIFEST_LOADER_LOADING_FAILURE_ERROR_MESSAGE+"".concat(o,", ").concat(r))})}})},reset:function(){g.off(S.default.XLINK_READY,a,t),m&&m.reset(),l&&(l.reset(),l=null),r&&(r.abort(),r=null)}},s=f.getLogger(t),g.on(S.default.XLINK_READY,a,t),r=(0,y.default)(c).create({errHandler:e.errHandler,dashMetrics:e.dashMetrics,mediaPlayerModel:e.mediaPlayerModel,requestModifier:e.requestModifier,urlUtils:h,constants:p.default,dashConstants:i.default,errors:A.default,requestTimeout:e.settings.get().streaming.manifestRequestTimeout}),l=(0,o.default)(c).create({errHandler:n,dashMetrics:e.dashMetrics,mediaPlayerModel:e.mediaPlayerModel,requestModifier:e.requestModifier,settings:e.settings}),u=null,t}n.__dashjs_factory_name="ManifestLoader";const a=t.default.getClassFactory(n)},"./src/streaming/ManifestUpdater.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>a});var R=r("./src/core/EventBus.js"),I=r("./src/core/events/Events.js"),w=r("./src/streaming/MediaPlayerEvents.js"),t=r("./src/core/FactoryMaker.js"),C=r("./src/core/Debug.js"),N=r("./src/core/errors/Errors.js"),D=r("./src/dash/constants/DashConstants.js"),M=r("./src/streaming/utils/URLUtils.js");function n(){var e,i,o,t,s,l,u,c,f,d,r,n,a=this.context,g=(0,R.default)(a).getInstance(),h=(0,M.default)(a).getInstance();function m(){o=NaN,l=!(s=!(u=!1)),p()}function p(){null!==t&&(clearTimeout(t),t=null)}function y(e){p(),l||(isNaN(e)&&!isNaN(o)&&(e=1e3*o),isNaN(e)||(i.debug("Refresh manifest in "+e+" milliseconds."),t=setTimeout(v,e)))}function E(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0];u=!0;var t=f.getValue(),r=t.url,n=d.getPatchLocation(t),a=d.getLocation(t);n&&!e?r=n:a&&(r=a),h.isRelative(r)&&(r=h.resolve(r,t.url)),c.load(r)}function _(e){if(e){if(d.getIsPatch(e)){var t=e;e=f.getValue();var r=d.isPatchValid(e,t),n=r;if(r&&(r=d.getPublishTime(e),n=d.applyPatchToManifest(e,t),a=d.getPublishTime(e),n=r.getTime()!=a.getTime()),!n)return i.debug("Patch provided is invalid, performing full manifest refresh"),void E(!0);e.loadedTime=new Date}}else(e=f.getValue()).loadedTime=new Date;if(f.getValue()&&f.getValue().type===D.default.DYNAMIC&&e.type===D.default.STATIC)return g.trigger(I.default.DYNAMIC_TO_STATIC),void(l=!(u=!1));f.setValue(e);var a=new Date,n=(a.getTime()-e.loadedTime.getTime())/1e3;2147483647<1e3*(o=d.getManifestUpdatePeriod(e,n))&&(o=2147483.647),g.trigger(I.default.MANIFEST_UPDATED,{manifest:e}),i.info("Manifest has been refreshed at "+a+"["+a.getTime()/1e3+"] "),s||y()}function v(){s||(u?y(n.get().streaming.manifestUpdateRetryInterval):E())}function T(e){e.error?e.error.code===N.default.MANIFEST_LOADER_PARSING_FAILURE_ERROR_CODE&&r.error(e.error):_(e.manifest)}function b(){s=!1,y()}function S(){(s=!n.get().streaming.scheduling.scheduleWhilePaused)&&p()}function A(){u=!1}return e={initialize:function(){m(),g.on(I.default.STREAMS_COMPOSED,A,this),g.on(w.default.PLAYBACK_STARTED,b,this),g.on(w.default.PLAYBACK_PAUSED,S,this),g.on(I.default.INTERNAL_MANIFEST_LOADED,T,this)},setManifest:function(e){_(e)},refreshManifest:E,getIsUpdating:function(){return u},setConfig:function(e){e&&(e.manifestModel&&(f=e.manifestModel),e.adapter&&(d=e.adapter),e.manifestLoader&&(c=e.manifestLoader),e.errHandler&&(r=e.errHandler),e.settings&&(n=e.settings))},reset:function(){g.off(w.default.PLAYBACK_STARTED,b,this),g.off(w.default.PLAYBACK_PAUSED,S,this),g.off(I.default.STREAMS_COMPOSED,A,this),g.off(I.default.INTERNAL_MANIFEST_LOADED,T,this),m()}},i=(0,C.default)(a).getInstance().getLogger(e),e}n.__dashjs_factory_name="ManifestUpdater";const a=t.default.getClassFactory(n)},"./src/streaming/MediaPlayer.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>a});var t=r("./externals/cea608-parser.js"),me=r.n(t),pe=r("./src/streaming/constants/Constants.js"),ye=r("./src/dash/constants/DashConstants.js"),Ee=r("./src/streaming/constants/MetricsConstants.js"),_e=r("./src/streaming/controllers/PlaybackController.js"),ve=r("./src/streaming/controllers/StreamController.js"),Te=r("./src/streaming/controllers/GapController.js"),be=r("./src/streaming/controllers/CatchupController.js"),Se=r("./src/dash/controllers/ServiceDescriptionController.js"),Ae=r("./src/dash/controllers/ContentSteeringController.js"),Re=r("./src/streaming/controllers/MediaController.js"),Ie=r("./src/streaming/controllers/BaseURLController.js"),we=r("./src/streaming/ManifestLoader.js"),Ce=r("./src/streaming/utils/ErrorHandler.js"),Ne=r("./src/streaming/utils/Capabilities.js"),De=r("./src/streaming/utils/CapabilitiesFilter.js"),Me=r("./src/streaming/utils/RequestModifier.js"),Oe=r("./src/streaming/models/URIFragmentModel.js"),Pe=r("./src/streaming/models/ManifestModel.js"),Le=r("./src/streaming/models/MediaPlayerModel.js"),Fe=r("./src/streaming/controllers/AbrController.js"),xe=r("./src/streaming/net/SchemeLoaderFactory.js"),je=r("./src/streaming/models/VideoModel.js"),ke=r("./src/streaming/models/CmcdModel.js"),Ue=r("./src/streaming/models/CmsdModel.js"),Be=r("./src/streaming/utils/DOMStorage.js"),Ge=r("./src/core/Debug.js"),qe=r("./src/core/errors/Errors.js"),He=r("./src/core/EventBus.js"),Ye=r("./src/core/events/Events.js"),Ve=r("./src/streaming/MediaPlayerEvents.js"),Ke=r("./src/core/FactoryMaker.js"),ze=r("./src/core/Settings.js"),We=r("./src/core/Version.js"),Xe=r("./src/dash/controllers/SegmentBaseController.js"),Qe=r("./src/dash/DashAdapter.js"),Je=r("./src/dash/DashMetrics.js"),$e=r("./src/dash/utils/TimelineConverter.js"),Ze=r("./src/streaming/vo/metrics/HTTPRequest.js"),et=r("./externals/base64.js"),tt=r("./node_modules/codem-isoboxer/dist/iso_boxer.js"),rt=r("./src/streaming/vo/DashJSError.js"),nt=r("./src/streaming/utils/SupervisorTools.js"),at=r("./src/streaming/ManifestUpdater.js"),it=r("./src/streaming/utils/URLUtils.js"),ot=r("./src/streaming/utils/BoxParser.js"),st=r("./src/streaming/text/TextController.js"),lt=r("./src/streaming/models/CustomParametersModel.js");function n(){var e,a,r,n,i,o,s,l,u,c,f,d,g,h,m,p,y,E,_,v,T,b,S,A,R,I,w,C,N,D,M,O,P,L,F,x,j,k,U="You must first call initialize() and set a source before calling this method",B="You must first call initialize() and set a valid source and view before calling this method",t="You must first call attachView() to set the video element before calling this method",G="You must first call attachSource() with a valid source before calling this method",q="MediaPlayer not initialized!",H=this.context,Y=(0,He.default)(H).getInstance(),V=(0,ze.default)(H).getInstance(),K=(0,Ge.default)(H).getInstance({settings:V});function z(){se(null),ie(null),n=null,g&&(g.reset(),g=null),h&&(h.reset(),h=null),_&&_.reset(),V.reset(),p&&(p.reset(),p=null)}function W(){return!!r&&!!F.getElement()}function X(){return(0,We.getVersionString)()}function Q(){if(!s)throw B;return w.isPaused()}function J(){if(!s)throw B;return w.getIsDynamic()}function $(e){var t=A&&A.hasVideoTrack()?pe.default.VIDEO:pe.default.AUDIO,r=M.getCurrentDVRInfo(t);if(!r)return 0;t=w.getOriginalLiveDelay(),e=r.range.start+e;return e=e>r.range.end-t?r.range.end-t:e}function Z(e){if(!s)throw B;var t=ae().currentTime;return void 0!==e?t=A.getTimeRelativeToStreamId(t,e):w.getIsDynamic()&&(e=A&&A.hasVideoTrack()?pe.default.VIDEO:pe.default.AUDIO,t=null===(e=M.getCurrentDVRInfo(e))||0===t?0:Math.max(0,t-e.range.start)),t}function ee(){if(!s)throw B;var e,t=ae().duration;return w.getIsDynamic()&&(e=A&&A.hasVideoTrack()?pe.default.VIDEO:pe.default.AUDIO,t=(e=M.getCurrentDVRInfo(e))?e.range.end-e.range.start:0),t}function te(e){(0,nt.checkParameterType)(e,"boolean"),l=e}function re(){_.restoreDefaultUTCTimingSources()}function ne(){return M}function ae(){if(!F.getElement())throw t;return F.getElement()}function ie(e){if(!i)throw q;var t;F.setElement(e),e&&(fe(),h||"function"==typeof(t=dashjs.MetricsReporting)&&(t=t(H).create(),h=t.createMetricsReporting({debug:K,eventBus:Y,mediaElement:ae(),adapter:y,dashMetrics:M,mediaPlayerModel:E,events:Ye.default,constants:pe.default,metricsConstants:Ee.default})),m||"function"==typeof(t=dashjs.MssHandler)&&(qe.default.extend(t.errors),m=t(H).create({eventBus:Y,mediaPlayerModel:E,dashMetrics:M,manifestModel:O,playbackController:w,streamController:A,protectionController:g,baseURLController:T,errHandler:v,events:Ye.default,constants:pe.default,debug:K,initSegmentType:Ze.HTTPRequest.INIT_SEGMENT_TYPE,BASE64:et,ISOBoxer:tt,settings:V})),A&&A.switchToVideoElement()),s&&ue(),he()}function oe(e){if(!o)throw U;var t=A.getActiveStreamInfo();return t?d.getTracksFor(e,t.id):[]}function se(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:NaN;if(!i)throw q;"string"==typeof e&&x.initialize(e),null==t&&(t=NaN),isNaN(t)||(t=Math.max(0,t)),r=e,(o||s)&&ue(),W()&&he(t)}function le(){if(!o)throw U;var e=A.getActiveStreamInfo();return e?A.getStreamById(e.id):null}function ue(){o=s=!1,y.reset(),A.reset(),I.reset(),D.reset(),w.reset(),C.reset(),N.reset(),u.reset(),d.reset(),k.reset(),g&&(V.get().streaming.protection.keepProtectionMediaKeys?g.stop():(g.reset(),g=null,fe())),R.reset(),P.reset(),L.reset()}function ce(){return(0,we.default)(H).create({debug:K,errHandler:v,dashMetrics:M,mediaPlayerModel:E,requestModifier:(0,Me.default)(H).getInstance(),mssHandler:m,settings:V})}function fe(){if(g)return g;var e=dashjs.Protection;if("function"!=typeof e)return null;var t=e(H).create();return Ye.default.extend(e.events),Ve.default.extend(e.events,{publicOnly:!0}),qe.default.extend(e.errors),b=b||(0,Ne.default)(H).getInstance(),g=t.createProtectionSystem({debug:K,errHandler:v,videoModel:F,customParametersModel:_,capabilities:b,eventBus:Y,events:Ye.default,BASE64:et,constants:pe.default,cmcdModel:P,settings:V})}function de(){if(!i)throw q;if(p)return p;var e=dashjs.OfflineController;if("function"!=typeof e)return null;Ye.default.extend(e.events),Ve.default.extend(e.events,{publicOnly:!0}),qe.default.extend(e.errors);var t=ce(),r=(0,at.default)(H).create();return r.setConfig({manifestModel:O,adapter:y,manifestLoader:t,errHandler:v}),p=e(H).create({debug:K,manifestUpdater:r,baseURLController:T,manifestLoader:t,manifestModel:O,mediaPlayerModel:E,abrController:u,playbackController:w,adapter:y,errHandler:v,dashMetrics:M,timelineConverter:f,segmentBaseController:k,schemeLoaderFactory:c,eventBus:Y,events:Ye.default,errors:qe.default,constants:pe.default,settings:V,dashConstants:ye.default,urlUtils:(0,it.default)(H).getInstance()})}function ge(e){var t=A&&A.hasVideoTrack()?pe.default.VIDEO:pe.default.AUDIO,t=M.getCurrentDVRInfo(t);return t?e+(t.manifestInfo.availableFrom.getTime()/1e3+t.range.start):0}function he(e){var t=0<arguments.length&&void 0!==e?e:NaN;p&&p.resetRecords(),!o&&r&&(o=!0,a.info("Streaming Initialized"),e=ce(),A=A||(0,ve.default)(H).getInstance(),R=R||(0,st.default)(H).create({errHandler:v,manifestModel:O,adapter:y,mediaController:d,videoModel:F,settings:V}),S.setConfig({capabilities:b,customParametersModel:_,adapter:y,settings:V,manifestModel:O,errHandler:v}),A.setConfig({capabilities:b,capabilitiesFilter:S,manifestLoader:e,manifestModel:O,mediaPlayerModel:E,customParametersModel:_,protectionController:g,textController:R,adapter:y,dashMetrics:M,errHandler:v,timelineConverter:f,videoModel:F,playbackController:w,serviceDescriptionController:C,contentSteeringController:N,abrController:u,mediaController:d,settings:V,baseURLController:T,uriFragmentModel:x,segmentBaseController:k}),I.setConfig({settings:V,playbackController:w,streamController:A,videoModel:F,timelineConverter:f,adapter:y}),w.setConfig({streamController:A,serviceDescriptionController:C,dashMetrics:M,adapter:y,videoModel:F,timelineConverter:f,settings:V}),D.setConfig({streamController:A,playbackController:w,mediaPlayerModel:E,videoModel:F,settings:V}),u.setConfig({streamController:A,domStorage:j,mediaPlayerModel:E,customParametersModel:_,cmsdModel:L,dashMetrics:M,adapter:y,videoModel:F,settings:V}),P.setConfig({abrController:u,dashMetrics:M,playbackController:w}),L.setConfig({}),u.initialize(),A.initialize(l,n),R.initialize(),I.initialize(),D.initialize(),P.initialize(),L.initialize(),N.initialize(),k.initialize(),"string"==typeof r?A.load(r,t):A.loadWithManifest(r,t)),!s&&W()&&(s=!0,a.info("Playback Initialized"))}return e={initialize:function(e,t,r){var n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:NaN;b||(b=(0,Ne.default)(H).getInstance()).setConfig({settings:V}),v=v||(0,Ce.default)(H).getInstance(),b.supportsMediaSource()?(i||(i=!0,f=(0,$e.default)(H).getInstance(),u||(u=(0,Fe.default)(H).getInstance()).setConfig({settings:V}),c=c||(0,xe.default)(H).getInstance(),w=w||(0,_e.default)(H).getInstance(),d=d||(0,Re.default)(H).getInstance(),A=A||(0,ve.default)(H).getInstance(),I=I||(0,Te.default)(H).getInstance(),D=D||(0,be.default)(H).getInstance(),C=C||(0,Se.default)(H).getInstance(),N=N||(0,Ae.default)(H).getInstance(),S=S||(0,De.default)(H).getInstance(),y=(0,Qe.default)(H).getInstance(),O=(0,Pe.default)(H).getInstance(),P=(0,ke.default)(H).getInstance(),L=(0,Ue.default)(H).getInstance(),M=(0,Je.default)(H).getInstance({settings:V}),j=(0,Be.default)(H).getInstance({settings:V}),y.setConfig({constants:pe.default,cea608parser:me(),errHandler:v,BASE64:et}),(T=T||(0,Ie.default)(H).create()).setConfig({adapter:y}),C.setConfig({adapter:y}),k=k||(0,Xe.default)(H).getInstance({dashMetrics:M,mediaPlayerModel:E,errHandler:v,baseURLController:T,events:Ye.default,eventBus:Y,debug:K,boxParser:(0,ot.default)(H).getInstance(),requestModifier:(0,Me.default)(H).getInstance(),errors:qe.default}),d.setConfig({domStorage:j,settings:V,customParametersModel:_}),E.setConfig({playbackController:w,serviceDescriptionController:C}),N.setConfig({adapter:y,errHandler:v,dashMetrics:M,mediaPlayerModel:E,manifestModel:O,abrController:u,eventBus:Y,requestModifier:(0,Me.default)(H).getInstance()}),re(),te(void 0===r||r),de()),e&&ie(e),t&&se(t,n),a.info("[dash.js "+X()+"] MediaPlayer has been initialized")):v.error(new rt.default(qe.default.CAPABILITY_MEDIASOURCE_ERROR_CODE,qe.default.CAPABILITY_MEDIASOURCE_ERROR_MESSAGE))},setConfig:function(e){e&&(e.capabilities&&(b=e.capabilities),e.capabilitiesFilter&&(S=e.capabilitiesFilter),e.streamController&&(A=e.streamController),e.textController&&(R=e.textController),e.gapController&&(I=e.gapController),e.playbackController&&(w=e.playbackController),e.serviceDescriptionController&&(C=e.serviceDescriptionController),e.contentSteeringController&&(N=e.contentSteeringController),e.catchupController&&(D=e.catchupController),e.mediaPlayerModel&&(E=e.mediaPlayerModel),e.customParametersModel&&(_=e.customParametersModel),e.abrController&&(u=e.abrController),e.schemeLoaderFactory&&(c=e.schemeLoaderFactory),e.mediaController&&(d=e.mediaController),e.settings&&(V=e.settings))},on:function(e,t,r,n){Y.on(e,t,r,n)},off:function(e,t,r){Y.off(e,t,r)},extend:function(e,t,r){Ke.default.extend(e,t,r,H)},attachView:ie,attachSource:se,isReady:W,preload:function(){if(F.getElement()||o)return!1;if(!r)throw G;he()},play:function(){if(!s)throw B;(!l||Q()&&s)&&w.play(!0)},isPaused:Q,pause:function(){if(!s)throw B;w.pause()},isSeeking:function(){if(!s)throw B;return w.isSeeking()},isDynamic:J,getLowLatencyModeEnabled:function(){if(!s)throw B;return w.getLowLatencyModeEnabled()},seek:function(e){if(!s)throw B;if((0,nt.checkParameterType)(e,"number"),isNaN(e))throw pe.default.BAD_ARGUMENT_ERROR;e<0&&(e=0);var t=w.getIsDynamic()?$(e):e,e=ae();!w.getIsDynamic()&&e.duration&&(t=Math.min(e.duration,t)),w.seek(t,!1,!1,!0)},seekToOriginalLive:function(){s&&J()&&w.seekToOriginalLive()},setPlaybackRate:function(e){ae().playbackRate=e},getPlaybackRate:function(){return ae().playbackRate},setMute:function(e){(0,nt.checkParameterType)(e,"boolean"),ae().muted=e},isMuted:function(){return ae().muted},setVolume:function(e){if("number"!=typeof e||isNaN(e)||e<0||1<e)throw pe.default.BAD_ARGUMENT_ERROR;ae().volume=e},getVolume:function(){return ae().volume},time:Z,duration:ee,timeAsUTC:function(){if(!s)throw B;return Z()<0?NaN:ge(Z())},durationAsUTC:function(){if(!s)throw B;return ge(ee())},getActiveStream:le,getDVRWindowSize:function(){var e=A&&A.hasVideoTrack()?pe.default.VIDEO:pe.default.AUDIO;return(e=M.getCurrentDVRInfo(e))?e.manifestInfo.dvrWindowSize:0},getDVRSeekOffset:$,getTargetLiveDelay:function(){if(!s)throw B;return w.getOriginalLiveDelay()},convertToTimeCode:function(e){e=Math.max(e,0);var t=Math.floor(e/3600),r=Math.floor(e%3600/60),e=Math.floor(e%3600%60);return(0===t?"":t<10?"0"+t.toString()+":":t.toString()+":")+(r<10?"0"+r.toString():r.toString())+":"+(e<10?"0"+e.toString():e.toString())},formatUTC:function(e,t,r){var n=3<arguments.length&&void 0!==arguments[3]&&arguments[3],a=new Date(1e3*e),e=a.toLocaleDateString(t),r=a.toLocaleTimeString(t,{hour12:r});return n?r+" "+e:r},getVersion:X,getDebug:function(){return K},getBufferLength:function(e){var t=[pe.default.VIDEO,pe.default.AUDIO,pe.default.TEXT];if(e){if(-1===t.indexOf(e))return a.warn("getBufferLength requested for invalid type"),NaN;e=M.getCurrentBufferLevel(e);return e||NaN}return(t=t.map(function(e){return 0<oe(e).length?M.getCurrentBufferLevel(e):Number.MAX_VALUE}).reduce(function(e,t){return Math.min(e,t)}))===Number.MAX_VALUE?NaN:t},getTTMLRenderingDiv:function(){return F?F.getTTMLRenderingDiv():null},getVideoElement:ae,getSource:function(){if(!r)throw G;return r},updateSource:function(e){r=e,A.load(r)},getCurrentLiveLatency:function(){if(!i)throw q;return s?w.getCurrentLiveLatency():NaN},getTopBitrateInfoFor:function(e){if(!o)throw U;return u.getTopBitrateInfoFor(e)},setAutoPlay:te,getAutoPlay:function(){return l},getDashMetrics:ne,getQualityFor:function(e){if(!o)throw U;return e!==pe.default.IMAGE?u.getQualityFor(e):(e=le())&&(e=e.getThumbnailController())?e.getCurrentTrackIndex():-1},setQualityFor:function(e,t){var r=2<arguments.length&&void 0!==arguments[2]&&arguments[2];if(!o)throw U;if(e===pe.default.IMAGE){var n=le();if(!n)return;n=n.getThumbnailController();n&&n.setTrackByIndex(t)}u.setPlaybackQuality(e,A.getActiveStreamInfo(),t,{forceReplace:r})},updatePortalSize:function(){u.setElementSize(),u.setWindowResizeEventCalled(!0)},enableText:function(e){var t=A.getActiveStreamInfo();return!(!t||!R)&&R.enableText(t.id,e)},enableForcedTextStreaming:function(e){return!(!A.getActiveStreamInfo()||!R)&&R.enableForcedTextStreaming(e)},isTextEnabled:function(){var e=A.getActiveStreamInfo();return!(!e||!R)&&R.isTextEnabled(e)},setTextTrack:function(e){if(!s)throw B;var t=A.getActiveStreamInfo();t&&R&&R.setTextTrack(t.id,e)},getBitrateInfoListFor:function(e){if(!o)throw U;var t=le();return t?t.getBitrateListFor(e):[]},getStreamsFromManifest:function(e){if(!o)throw U;return y.getStreamsInfo(e)},getTracksFor:oe,getTracksForTypeFromManifest:function(e,t,r){if(!o)throw U;return(r=r||y.getStreamsInfo(t,1)[0])?y.getAllMediaInfoForType(r,e,t):[]},getCurrentTrackFor:function(e){if(!o)throw U;var t=A.getActiveStreamInfo();return d.getCurrentTrackFor(e,t.id)},setInitialMediaSettingsFor:function(e,t){if(!i)throw q;d.setInitialSettings(e,t)},getInitialMediaSettingsFor:function(e){if(!i)throw q;return d.getInitialSettings(e)},setCurrentTrack:function(e){if(!o)throw U;d.setTrack(e)},addABRCustomRule:function(e,t,r){_.addAbrCustomRule(e,t,r)},removeABRCustomRule:function(e){_.removeAbrCustomRule(e)},removeAllABRCustomRule:function(){_.removeAllAbrCustomRule()},getABRCustomRules:function(){return _.getAbrCustomRules()},getAverageThroughput:function(e){var t=u.getThroughputHistory(),r=w.getIsDynamic();return t?t.getAverageThroughput(e,r):0},retrieveManifest:function(e,t){function r(e){e.error?t(null,e.error):t(e.manifest),Y.off(Ye.default.INTERNAL_MANIFEST_LOADED,r,a),n.reset()}var n=ce(),a=this;Y.on(Ye.default.INTERNAL_MANIFEST_LOADED,r,a),x.initialize(e),n.load(e)},addUTCTimingSource:function(e,t){_.addUTCTimingSource(e,t)},removeUTCTimingSource:function(e,t){_.removeUTCTimingSource(e,t)},clearDefaultUTCTimingSources:function(){_.clearDefaultUTCTimingSources()},restoreDefaultUTCTimingSources:re,setXHRWithCredentialsForType:function(e,t){_.setXHRWithCredentialsForType(e,t)},getXHRWithCredentialsForType:function(e){return _.getXHRWithCredentialsForType(e)},getProtectionController:fe,attachProtectionController:function(e){g=e},setProtectionData:function(e){n=e,A&&A.setProtectionData(n)},registerLicenseRequestFilter:function(e){_.registerLicenseRequestFilter(e)},registerLicenseResponseFilter:function(e){_.registerLicenseResponseFilter(e)},unregisterLicenseRequestFilter:function(e){_.unregisterLicenseRequestFilter(e)},unregisterLicenseResponseFilter:function(e){_.unregisterLicenseResponseFilter(e)},registerCustomCapabilitiesFilter:function(e){_.registerCustomCapabilitiesFilter(e)},unregisterCustomCapabilitiesFilter:function(e){_.unregisterCustomCapabilitiesFilter(e)},setCustomInitialTrackSelectionFunction:function(e){_.setCustomInitialTrackSelectionFunction(e)},resetCustomInitialTrackSelectionFunction:function(){_.resetCustomInitialTrackSelectionFunction(null)},attachTTMLRenderingDiv:function(e){if(!F.getElement())throw t;F.setTTMLRenderingDiv(e)},attachVttRenderingDiv:function(e){if(!F.getElement())throw t;F.setVttRenderingDiv(e)},getCurrentTextTrackIndex:function(){var e=A.getActiveStreamInfo();if(e&&R)return R.getCurrentTrackIdx(e.id)},provideThumbnail:function(e,t){if("function"==typeof t)if(e<0)t(null);else{var r=w.getIsDynamic()?$(e):e,e=A.getStreamForTime(r);if(null!==e){e=e.getThumbnailController();if(e)return e.provide(r,t);t(null)}else t(null)}},getDashAdapter:function(){return y},getOfflineController:de,triggerSteeringRequest:function(){if(N)return N.loadSteeringData()},getCurrentSteeringResponseData:function(){if(N)return N.getCurrentSteeringResponseData()},getSettings:function(){return V.get()},updateSettings:function(e){V.update(e)},resetSettings:function(){V.reset()},reset:z,destroy:function(){z(),Ke.default.deleteSingletonInstances(H)}},a=K.getLogger(e),l=!(o=s=i=!1),k=y=n=p=g=null,Ye.default.extend(Ve.default),E=(0,Le.default)(H).getInstance(),_=(0,lt.default)(H).getInstance(),F=(0,je.default)(H).getInstance(),x=(0,Oe.default)(H).getInstance(),e}n.__dashjs_factory_name="MediaPlayer";r=Ke.default.getClassFactory(n);r.events=Ve.default,r.errors=qe.default,Ke.default.updateClassFactory(n.__dashjs_factory_name,r);const a=r},"./src/streaming/MediaPlayerEvents.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>l});var n=r("./src/core/events/EventsBase.js");function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){return(i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function o(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=s(r);return e=n?(e=s(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),t=this,!(e=e)||"object"!==a(e)&&"function"!=typeof e?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(t):e}}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}const l=new(function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&i(e,t)}(r,n["default"]);var t=o(r);function r(){var e;return function(e){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}(this),(e=t.call(this)).AST_IN_FUTURE="astInFuture",e.BUFFER_EMPTY="bufferStalled",e.BUFFER_LOADED="bufferLoaded",e.BUFFER_LEVEL_STATE_CHANGED="bufferStateChanged",e.BUFFER_LEVEL_UPDATED="bufferLevelUpdated",e.DYNAMIC_TO_STATIC="dynamicToStatic",e.ERROR="error",e.FRAGMENT_LOADING_COMPLETED="fragmentLoadingCompleted",e.FRAGMENT_LOADING_PROGRESS="fragmentLoadingProgress",e.FRAGMENT_LOADING_STARTED="fragmentLoadingStarted",e.FRAGMENT_LOADING_ABANDONED="fragmentLoadingAbandoned",e.LOG="log",e.MANIFEST_LOADED="manifestLoaded",e.METRICS_CHANGED="metricsChanged",e.METRIC_CHANGED="metricChanged",e.METRIC_ADDED="metricAdded",e.METRIC_UPDATED="metricUpdated",e.PERIOD_SWITCH_STARTED="periodSwitchStarted",e.PERIOD_SWITCH_COMPLETED="periodSwitchCompleted",e.QUALITY_CHANGE_REQUESTED="qualityChangeRequested",e.QUALITY_CHANGE_RENDERED="qualityChangeRendered",e.TRACK_CHANGE_RENDERED="trackChangeRendered",e.STREAM_INITIALIZING="streamInitializing",e.STREAM_UPDATED="streamUpdated",e.STREAM_ACTIVATED="streamActivated",e.STREAM_DEACTIVATED="streamDeactivated",e.STREAM_INITIALIZED="streamInitialized",e.STREAM_TEARDOWN_COMPLETE="streamTeardownComplete",e.TEXT_TRACKS_ADDED="allTextTracksAdded",e.TEXT_TRACK_ADDED="textTrackAdded",e.TTML_PARSED="ttmlParsed",e.TTML_TO_PARSE="ttmlToParse",e.CAPTION_RENDERED="captionRendered",e.CAPTION_CONTAINER_RESIZE="captionContainerResize",e.CAN_PLAY="canPlay",e.CAN_PLAY_THROUGH="canPlayThrough",e.PLAYBACK_ENDED="playbackEnded",e.PLAYBACK_ERROR="playbackError",e.PLAYBACK_NOT_ALLOWED="playbackNotAllowed",e.PLAYBACK_METADATA_LOADED="playbackMetaDataLoaded",e.PLAYBACK_LOADED_DATA="playbackLoadedData",e.PLAYBACK_PAUSED="playbackPaused",e.PLAYBACK_PLAYING="playbackPlaying",e.PLAYBACK_PROGRESS="playbackProgress",e.PLAYBACK_RATE_CHANGED="playbackRateChanged",e.PLAYBACK_SEEKED="playbackSeeked",e.PLAYBACK_SEEKING="playbackSeeking",e.PLAYBACK_STALLED="playbackStalled",e.PLAYBACK_STARTED="playbackStarted",e.PLAYBACK_TIME_UPDATED="playbackTimeUpdated",e.PLAYBACK_VOLUME_CHANGED="playbackVolumeChanged",e.PLAYBACK_WAITING="playbackWaiting",e.MANIFEST_VALIDITY_CHANGED="manifestValidityChanged",e.EVENT_MODE_ON_START="eventModeOnStart",e.EVENT_MODE_ON_RECEIVE="eventModeOnReceive",e.CONFORMANCE_VIOLATION="conformanceViolation",e.REPRESENTATION_SWITCH="representationSwitch",e.ADAPTATION_SET_REMOVED_NO_CAPABILITIES="adaptationSetRemovedNoCapabilities",e.CONTENT_STEERING_REQUEST_COMPLETED="contentSteeringRequestCompleted",e}return r}())},"./src/streaming/MediaPlayerFactory.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>s});var a=r("./src/streaming/MediaPlayer.js");var i,u,n,o=(u="application/dash+xml",{create:c,createAll:function(e,t){var r=[];e=e||"[data-dashjs-player]";for(var n=(t=t||document).querySelectorAll(e),a=0;a<n.length;a++){var i=c(n[a],null);r.push(i)}for(var o=t.querySelectorAll('source[type="'+u+'"]'),s=0;s<o.length;s++){var l=c(function e(t){return/^VIDEO$/i.test(t.nodeName)?t:e(t.parentNode)}(o[s]),null);r.push(l)}return r}});function c(e,t,r){if(!e||!/^VIDEO$/i.test(e.nodeName))return null;if(e._dashjs_player)return e._dashjs_player;var n=e.id||e.name||"video element";if(!(t=t||[].slice.call(e.querySelectorAll("source")).filter(function(e){return e.type==u})[0])&&e.src)(t=document.createElement("source")).src=e.src;else if(!t&&!e.src)return null;return r=r||{},(r=(0,a.default)(r).create()).initialize(e,t.src,e.autoplay),(i=i||r.getDebug().getLogger()).debug("Converted "+n+" to dash.js player and added content: "+t.src),e._dashjs_player=r}"undefined"!=typeof window&&window&&window.dashjs&&window.dashjs.skipAutoCreate||"undefined"==typeof window||!window||!window.addEventListener||("complete"===window.document.readyState?window.dashjs?o.createAll():n=window.setInterval(function(){window.dashjs&&(window.clearInterval(n),o.createAll())},500):window.addEventListener("load",function e(){window.removeEventListener("load",e),o.createAll()}));const s=o},"./src/streaming/PreBufferSink.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>a});var l=r("./src/core/Debug.js"),r=r("./src/core/FactoryMaker.js");function n(e){var t,r,i,n=this.context,o=[],a=e;function s(t,r){return o=o.filter(function(e){return!((isNaN(r)||e.start<r)&&(isNaN(t)||e.end>t))}),Promise.resolve()}return t={getAllBufferRanges:function(){for(var t=[],e=0;e<o.length;e++){var r=o[e];0===t.length||r.start>t[t.length-1].end?t.push({start:r.start,end:r.end}):t[t.length-1].end=r.end}var n={start:function(e){return t[e].start},end:function(e){return t[e].end}};return Object.defineProperty(n,"length",{get:function(){return t.length}}),n},append:function(e){return i="InitializationSegment"!==e.segmentType?(o.push(e),o.sort(function(e,t){return e.start-t.start}),null):e,r.debug("PreBufferSink appended chunk s: "+e.start+"; e: "+e.end),a&&a({chunk:e}),Promise.resolve()},remove:s,abort:function(){return Promise.resolve()},discharge:function(e,t){var r,n,a=(r=e,n=t,o.filter(function(e){return(isNaN(n)||e.start<n)&&(isNaN(r)||e.end>r)}));return i&&(a.push(i),i=null),s(e,t),a},reset:function(){o=[],a=i=null},updateTimestampOffset:function(){return Promise.resolve()},waitForUpdateEnd:function(e){e()},getBuffer:function(){return this}},r=(0,l.default)(n).getInstance().getLogger(t),t}n.__dashjs_factory_name="PreBufferSink";const a=r.default.getClassFactory(n)},"./src/streaming/SourceBufferSink.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>a});var I=r("./src/core/Debug.js"),w=r("./src/streaming/vo/DashJSError.js"),t=r("./src/core/FactoryMaker.js"),C=r("./src/core/errors/Errors.js"),N=r("./src/core/Settings.js"),D=r("./src/streaming/constants/Constants.js"),M=r("./src/streaming/vo/metrics/HTTPRequest.js"),O=r("./src/core/events/Events.js");function n(e){var t,i,a,o,s,r,n=this.context,l=(0,N.default)(n).getInstance(),u=e.textController,c=e.eventBus,f=[],d=[],g=!1,h=e.mediaSource,m=null;function p(t){return new Promise(function(e){R(function(){o.changeType&&o.changeType(t),e()})})}function y(e){return o=u.getTextSourceBuffer(e),Promise.resolve()}function E(){if("function"==typeof o.addEventListener)try{o.addEventListener("updateend",S,!1),o.addEventListener("error",A,!1),o.addEventListener("abort",A,!1)}catch(e){r=setInterval(S,50)}else r=setInterval(S,50)}function _(n){return new Promise(function(r){o&&l.get().streaming.buffer.useAppendWindow?R(function(){try{if(!o)return void r();var e=h.duration,t=0;n&&!isNaN(n.start)&&!isNaN(n.duration)&&isFinite(n.duration)&&(e=n.start+n.duration),n&&!isNaN(n.start)&&(t=n.start),o.appendWindowEnd===e&&o.appendWindowStart===t||(o.appendWindowStart=0,o.appendWindowEnd=e+.01,o.appendWindowStart=Math.max(t-.1,0),a.debug("Updated append window for ".concat(s.type,". Set start to ").concat(o.appendWindowStart," and end to ").concat(o.appendWindowEnd))),r()}catch(e){a.warn("Failed to set append window"),r()}}):r()})}function v(e){return new Promise(function(t){o?R(function(){try{o.timestampOffset===e||isNaN(e)||(o.timestampOffset=e,a.debug("Set MSE timestamp offset to ".concat(e))),t()}catch(e){t()}}):t()})}function T(){if(!g&&0<d.length){g=!0;var t=d[0];d.splice(0,1);var e=function(){g=!1,0<d.length&&T.call(this),t&&t.data&&t.data.segmentType&&t.data.segmentType!==M.HTTPRequest.INIT_SEGMENT_TYPE&&delete t.data.bytes,t.promise.resolve({chunk:t.data})};try{m=t.request,0===t.data.bytes.byteLength?e.call(this):(o.appendBuffer?o.appendBuffer(t.data.bytes):o.append(t.data.bytes,t.data),R(e.bind(this)))}catch(e){a.fatal('SourceBuffer append failed "'+e+'"'),0<d.length?T():g=!1,delete t.data.bytes,t.promise.reject({chunk:t.data,error:new w.default(e.code,e.message)})}}}function b(){0<f.length&&(o.updating||(f.shift()(),b()))}function S(){o.updating||b()}function A(e){var t=e.target||{};e=O.default.SOURCE_BUFFER_ERROR,t=(t={error:t,lastRequestAppended:m})||{},c.trigger(e,t,{streamId:s.streamInfo.id,mediaType:i})}function R(e){f.push(e),o.updating||b()}return t={getType:function(){return i},getAllBufferRanges:function(){try{return o.buffered}catch(e){return a.error("getAllBufferRanges exception: "+e.message),null}},getBuffer:function(){return o},append:function(r){var n=this,a=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;return new Promise(function(e,t){r?(d.push({data:r,promise:{resolve:e,reject:t},request:a}),R(T.bind(n))):t({chunk:r,error:new w.default(C.default.APPEND_ERROR_CODE,C.default.APPEND_ERROR_MESSAGE)})})},remove:function(a){return new Promise(function(e,t){var r=a.start,n=a.end;0<=r&&r<n?R(function(){try{o.remove(r,n),R(function(){e({from:r,to:n,unintended:!1}),a.resolve&&a.resolve()})}catch(e){t({from:r,to:n,unintended:!1,error:new w.default(C.default.REMOVE_ERROR_CODE,C.default.REMOVE_ERROR_MESSAGE)}),a.reject&&a.reject(e)}}):e()})},abort:function(){return new Promise(function(t){try{d=[],"open"===h.readyState?R(function(){try{o&&o.abort(),t()}catch(e){t()}}):(o&&o.setTextTrack&&"ended"===h.readyState&&o.abort(),t())}catch(e){t()}})},reset:function(){if(o){try{f=[],function(){try{"function"==typeof o.removeEventListener&&(o.removeEventListener("updateend",S,!1),o.removeEventListener("error",A,!1),o.removeEventListener("abort",A,!1)),clearInterval(r)}catch(e){a.error(e)}}(),g=!1,d=[],o.getClassName&&"TextSourceBuffer"===o.getClassName()||(a.debug("Removing sourcebuffer from media source"),h.removeSourceBuffer(o))}catch(e){}o=null}m=null},updateTimestampOffset:v,initializeForStreamSwitch:function(e,t,r){return i=(s=e).type,e=s.codec,o=r.getBuffer(),E(),(r=[]).push(new Promise(function(r){R(function(){var e=o.appendWindowStart,t=o.appendWindowEnd;o&&(o.abort(),o.appendWindowStart=e,o.appendWindowEnd=t),r()})})),r.push(_(s.streamInfo)),r.push(p(e)),t&&void 0!==t.MSETimeOffset&&r.push(v(t.MSETimeOffset)),Promise.all(r)},initializeForFirstUse:function(t,e,r){i=(s=e).type;var n=s.codec;try{if(n.match(/application\/mp4;\s*codecs="(stpp|wvtt).*"/i))return y(t);o=h.addSourceBuffer(n),E();var a=[];return a.push(_(s.streamInfo)),r&&void 0!==r.MSETimeOffset&&a.push(v(r.MSETimeOffset)),Promise.all(a)}catch(e){return s.type==D.default.TEXT&&!s.isFragmented||-1!==n.indexOf('codecs="stpp')||-1!==n.indexOf('codecs="vtt')?y(t):Promise.reject(e)}},updateAppendWindow:_,changeType:p},a=(0,I.default)(n).getInstance().getLogger(t),t}n.__dashjs_factory_name="SourceBufferSink";const a=t.default.getClassFactory(n)},"./src/streaming/Stream.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>a});var ue=r("./src/streaming/constants/Constants.js"),ce=r("./src/dash/constants/DashConstants.js"),fe=r("./src/streaming/StreamProcessor.js"),de=r("./src/streaming/controllers/FragmentController.js"),ge=r("./src/streaming/thumbnail/ThumbnailController.js"),he=r("./src/core/EventBus.js"),me=r("./src/core/events/Events.js"),pe=r("./src/core/Debug.js"),ye=r("./src/core/errors/Errors.js"),t=r("./src/core/FactoryMaker.js"),Ee=r("./src/streaming/vo/DashJSError.js"),_e=r("./src/streaming/utils/BoxParser.js"),ve=r("./src/streaming/utils/URLUtils.js"),Te=r("./src/streaming/controllers/BlacklistController.js"),be=[ue.default.VIDEO,ue.default.AUDIO,ue.default.TEXT,ue.default.MUXED,ue.default.IMAGE];function n(l){l=l||{};var t,u,c,o,i,s,f,d,g,h,m,p,y,a,E,_,r,v,T=this.context,b=(0,he.default)(T).getInstance(),e=(0,ve.default)(T).getInstance(),S=l.manifestModel,A=l.mediaPlayerModel,n=l.dashMetrics,R=l.manifestUpdater,I=l.adapter,w=l.timelineConverter,C=l.capabilities,N=l.errHandler,D=l.abrController,M=l.playbackController,O=l.eventController,P=l.mediaController,L=l.protectionController,F=l.textController,x=l.videoModel,j=l.streamInfo,k=l.settings;function U(i,e){return new Promise(function(r,t){W(),h=!0,Q();var n,a=x.getElement();be.forEach(function(e){(e!==ue.default.TEXT||i)&&(e!==ue.default.VIDEO||!a||a&&/^VIDEO$/i.test(a.nodeName))&&B(e,i)}),n=e,new Promise(function(t){var r={},e=c.map(function(e){return e.createBufferSinks(n)});Promise.all(e).then(function(e){e.forEach(function(e){e&&(r[e.getType()]=e)}),t(r)}).catch(function(){t(r)})}).then(function(e){var t;h=!1,0===c.length?(t="No streams to play.",N.error(new Ee.default(ye.default.MANIFEST_ERROR_ID_NOSTREAMS_CODE,t,S.getValue())),u.fatal(t)):J(),i&&F.createTracks(j),r(e)}).catch(function(e){t(e)})})}function B(e,t){var r=I.getAllMediaInfoForType(j,e),n=[],a=null;if(r&&0!==r.length){e===ue.default.VIDEO&&(f=!0),e===ue.default.AUDIO&&(d=!0);for(var i,o=0,s=r.length;o<s;o++)a=r[o],e===ue.default.TEXT&&a.isEmbedded&&(F.addEmbeddedTrack(j,a),n.push(a)),G(a)&&P.addTrack(a);0<n.length&&(P.setInitialMediaSettingsForType(e,j),F.addMediaInfosToBuffer(j,e,n)),0!==(r=r.filter(function(e){return!e.isEmbedded})).length&&(e!==ue.default.IMAGE?(b.trigger(me.default.STREAM_INITIALIZING,{streamInfo:j,mediaInfo:a}),P.setInitialMediaSettingsForType(e,j),i=function(e,t){var r=e&&0<e.length?e[0]:null,n=m.getModel(r?r.type:null),a=r?r.type:null,i=r?r.mimeType:null,r=r?r.isFragmented:null,o=(0,fe.default)(T).create({streamInfo:j,type:a,mimeType:i,timelineConverter:w,adapter:I,manifestModel:S,mediaPlayerModel:A,fragmentModel:n,dashMetrics:l.dashMetrics,baseURLController:l.baseURLController,segmentBaseController:l.segmentBaseController,abrController:D,playbackController:M,mediaController:P,textController:F,errHandler:N,settings:k,boxParser:E,segmentBlacklistController:y});o.initialize(t,f,r),c.push(o);for(var s=0;s<e.length;s++)o.addMediaInfo(e[s]);a===ue.default.TEXT&&F.addMediaInfosToBuffer(j,a,e,n);return o}(r,t),(t=P.getCurrentTrackFor(e,j.id))&&(D.updateTopQualityIndex(t),i.selectMediaInfo(e===ue.default.TEXT&&t.isEmbedded?r[0]:t))):(p=(0,ge.default)(T).create({streamInfo:j,adapter:I,baseURLController:l.baseURLController,timelineConverter:l.timelineConverter,debug:_,eventBus:b,events:me.default,dashConstants:ce.default,dashMetrics:l.dashMetrics,segmentBaseController:l.segmentBaseController})).initialize())}else u.info("No "+e+" data.")}function G(e){var t,r=e?e.type:null;return r===ue.default.MUXED?(t="Multiplexed representations are intentionally not supported, as they are not compliant with the DASH-AVC/264 guidelines",u.fatal(t),void N.error(new Ee.default(ye.default.MANIFEST_ERROR_ID_MULTIPLEXED_CODE,t,S.getValue()))):r===ue.default.TEXT||r===ue.default.IMAGE||(!e.contentProtection||C.supportsEncryptedMedia()||void N.error(new Ee.default(ye.default.CAPABILITY_MEDIAKEYS_ERROR_CODE,ye.default.CAPABILITY_MEDIAKEYS_ERROR_MESSAGE)))}function q(e){for(var t=c?c.length:0,r=0;r<t;r++){var n=c[r].getFragmentModel();n.abortRequests(),n.resetInitialSettings(),c[r].reset(!1,e)}F&&F.deactivateStream(j),se(s=i=!(c=[])),Y(!1),b.trigger(me.default.STREAM_DEACTIVATED,{streamInfo:j})}function H(e){q(e),d=f=o=!1,r=h=!(g={}),v=[]}function Y(e){r=e}function V(){return j?j.start:NaN}function K(){return j?j.id:null}function z(){return j}function W(){if(!x||!D)throw new Error(ue.default.MISSING_CONFIG_ERROR)}function X(e){e.error&&(N.error(e.error),u.fatal(e.error.message))}function Q(){var e;!O||(e=I.getEventsFor(j))&&0<e.length&&O.addInlineEvents(e,j.id)}function J(){for(var e=c.length,t=!!g.audio||!!g.video?new Ee.default(ye.default.DATA_UPDATE_FAILED_ERROR_CODE,ye.default.DATA_UPDATE_FAILED_ERROR_MESSAGE):null,r=0;r<e;r++)if(c[r].isUpdating()||h)return;if(L){L.clearMediaInfoArray();for(var n=0;n<e&&c[n];n++){var a=c[n].getType(),i=c[n].getMediaInfo();!(a===ue.default.AUDIO||a===ue.default.VIDEO||a===ue.default.TEXT&&i.isFragmented)||(i=c[n].getMediaInfo())&&L.initializeForMedia(i)}L.handleKeySystemFromManifest()}t?N.error(t):o||(o=!0,x.waitForReadyState(ue.default.VIDEO_ELEMENT_READY_STATES.HAVE_METADATA,function(){b.trigger(me.default.STREAM_INITIALIZED,{streamInfo:j})}))}function $(){var e=ne(),t=e.length;if(0!==t){for(var r=0;r<t;r++)if(!e[r].isBufferingCompleted()&&(e[r].getType()===ue.default.AUDIO||e[r].getType()===ue.default.VIDEO))return void u.debug("onBufferingCompleted - One streamProcessor has finished but",e[r].getType(),"one is not buffering completed");u.debug("onBufferingCompleted - trigger STREAM_BUFFERING_COMPLETED"),s=!0,b.trigger(me.default.STREAM_BUFFERING_COMPLETED,{streamInfo:j},{streamInfo:j})}else u.warn("onBufferingCompleted - can't trigger STREAM_BUFFERING_COMPLETED because no streamProcessor is defined")}function Z(e){g[e.mediaType]=e.error,J()}function ee(e){O&&O.addInbandEvents(e.events,j.id)}function te(e){return e&&e.type?re(e.type):null}function re(t){return t?ne().filter(function(e){return e.getType()===t})[0]:null}function ne(){for(var e,t,r=[],n=0;n<c.length;n++)(e=(t=c[n]).getType())!==ue.default.AUDIO&&e!==ue.default.VIDEO&&e!==ue.default.TEXT||r.push(t);return r}function ae(e,t){var r=j,t=t.getStreamInfo();if(!t||!r)return!0;t=I.getAdaptationForType(t.index,e,t),r=I.getAdaptationForType(r.index,e,r);return t&&r?!(!ie(r)&&ie(t)):!t&&!r}function ie(e){return e&&(e.ContentProtection||e.Representation&&0<e.Representation.length&&e.Representation[0].ContentProtection)}function oe(e,t,r){r=2<arguments.length&&void 0!==r?r:null;if(!e||!e.hasOwnProperty("getStreamInfo"))return!1;e=e.getStreamInfo(),r=r?r.getStreamInfo():j;if(!e||!r)return!1;e=I.getAdaptationForType(e.index,t,e),t=I.getAdaptationForType(r.index,t,r);if(!e||!t)return!e&&!t;var r=e&&t&&e.mimeType===t.mimeType,n=t.Representation_asArray.map(function(e){return e.codecs}),t=e.Representation_asArray.map(function(e){return e.codecs}),e=t.some(function(e){return-1<n.indexOf(e)}),t=t.some(function(t){return n.some(function(e){return C.codecRootCompatibleWithCodec(e,t)})});return e||t&&r}function se(e){a=e}function le(){return a}return t={initialize:function(){b.on(me.default.BUFFERING_COMPLETED,$,t),b.on(me.default.DATA_UPDATE_COMPLETED,Z,t),b.on(me.default.INBAND_EVENTS,ee,t),L&&(b.on(me.default.KEY_ERROR,X,t),b.on(me.default.SERVER_CERTIFICATE_UPDATED,X,t),b.on(me.default.LICENSE_REQUEST_COMPLETE,X,t),b.on(me.default.KEY_SYSTEM_SELECTED,X,t),b.on(me.default.KEY_SESSION_CREATED,X,t),b.on(me.default.KEY_STATUSES_CHANGED,X,t)),F.initializeForStream(j),b.trigger(me.default.STREAM_UPDATED,{streamInfo:j})},getStreamId:function(){return j?j.id:null},activate:function(e,n){return new Promise(function(t,r){if(!i)return a?(i=!0,b.trigger(me.default.STREAM_ACTIVATED,{streamInfo:j}),void t(n)):void U(e,n).then(function(e){i=!0,b.trigger(me.default.STREAM_ACTIVATED,{streamInfo:j}),t(e)}).catch(function(e){r(e)});t(n)})},deactivate:q,getIsActive:function(){return i},getDuration:function(){return j?j.duration:NaN},getStartTime:V,getId:K,getStreamInfo:z,getHasAudioTrack:function(){return d},getHasVideoTrack:function(){return f},startPreloading:function(r,n){return new Promise(function(t,e){a?e():(u.info("[startPreloading] Preloading next stream with id ".concat(K())),se(!0),U(r,n).then(function(){for(var e=0;e<c.length&&c[e];e++)c[e].setExplicitBufferingTime(V()),c[e].getScheduleController().startScheduleTimer();t()}).catch(function(){se(!1),e()}))})},initializeForTextWithMediaSource:function(r){return new Promise(function(e,t){B(ue.default.TEXT,r),function(){var e=re(ue.default.TEXT);if(e)return e.createBufferSinks();return Promise.resolve()}().then(function(){F.createTracks(j),e()}).catch(function(e){t(e)})})},getThumbnailController:function(){return p},getBitrateListFor:function(e){return W(),e===ue.default.IMAGE?p?p.getBitrateList():[]:(e=function(e){for(var t=null,r=0;r<c.length;r++)if((t=c[r]).getType()===e)return t.getMediaInfo();return null}(e),D.getBitrateList(e))},updateData:function(u){return new Promise(function(e){h=!0,j=u,O&&Q();for(var r=[],t=0,n=c.length;t<n;t++){var a=c[t],i=a.getMediaInfo();r.push(a.updateStreamInfo(j));var o=I.getAllMediaInfoForType(j,a.getType());if(o=o.filter(function(e){return!e.isEmbedded})){a.clearMediaInfoArray();for(var s=0;s<o.length;s++){var l=o[s];a.addMediaInfo(o[s]),I.areMediaInfosEqual(i,l)&&(D.updateTopQualityIndex(l),r.push(a.selectMediaInfo(l)))}}}Promise.all(r).then(function(){for(r=[];0<v.length;){var e=v.pop(),t=e.newMediaInfo,e=te(e.oldMediaInfo);if(!e)return;r.push(e.prepareTrackSwitch()),e.selectMediaInfo(t)}return Promise.all(r)}).then(function(){h=!1,J(),b.trigger(me.default.STREAM_UPDATED,{streamInfo:j}),e()})})},reset:function(e){m&&(m.reset(),m=null),D&&j&&D.clearDataForStream(j.id),y&&(y.reset(),y=null),H(e),j=null,b.off(me.default.DATA_UPDATE_COMPLETED,Z,t),b.off(me.default.BUFFERING_COMPLETED,$,t),b.off(me.default.INBAND_EVENTS,ee,t),L&&(b.off(me.default.KEY_ERROR,X,t),b.off(me.default.SERVER_CERTIFICATE_UPDATED,X,t),b.off(me.default.LICENSE_REQUEST_COMPLETE,X,t),b.off(me.default.KEY_SYSTEM_SELECTED,X,t),b.off(me.default.KEY_SESSION_CREATED,X,t),b.off(me.default.KEY_STATUSES_CHANGED,X,t))},getProcessors:ne,setMediaSource:function(a){return new Promise(function(r,t){for(var e=[],n=0;n<c.length;)G(c[n].getMediaInfo())?(e.push(c[n].setMediaSource(a)),n++):(c[n].reset(),c.splice(n,1));Promise.all(e).then(function(){for(var e,t=0;t<c.length;t++)c[t].dischargePreBuffer();0===c.length&&(e="No streams to play.",N.error(new Ee.default(ye.default.MANIFEST_ERROR_ID_NOSTREAMS_CODE,e+"nostreams",S.getValue())),u.fatal(e)),r()}).catch(function(e){u.error(e),t(e)})})},isMediaCodecCompatible:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;return oe(e,ue.default.VIDEO,t)&&oe(e,ue.default.AUDIO,t)},isProtectionCompatible:function(e){return!e||ae(ue.default.VIDEO,e)&&ae(ue.default.AUDIO,e)},getPreloaded:le,getIsEndedEventSignaled:function(){return r},setIsEndedEventSignaled:Y,getAdapter:function(){return I},getHasFinishedBuffering:function(){return s},setPreloaded:se,startScheduleControllers:function(){for(var e=c.length,t=0;t<e&&c[t];t++)c[t].getScheduleController().startScheduleTimer()},prepareTrackChange:function(e){var t,r,n,a;i&&j&&(s=!1,t=e.newMediaInfo,r=S.getValue(),I.setCurrentMediaInfo(j.id,t.type,t),(n=te(t))&&(a=M.getTime(),u.info("Stream -  Process track changed at current time "+a),r.refreshManifestOnSwitchTrack?(v.push(e),R.getIsUpdating()||(u.debug("Stream -  Refreshing manifest for switch track"),R.refreshManifest())):n.selectMediaInfo(t).then(function(){t.type!==ue.default.VIDEO&&t.type!==ue.default.AUDIO||D.updateTopQualityIndex(t),n.prepareTrackSwitch()})))},prepareQualityChange:function(e){var t=re(e.mediaType);t&&t.prepareQualityChange(e)}},function(){try{_=(0,pe.default)(T).getInstance(),u=_.getLogger(t),H(),E=(0,_e.default)(T).getInstance(),y=(0,Te.default)(T).create({updateEventName:me.default.SEGMENT_LOCATION_BLACKLIST_CHANGED,addBlacklistEventName:me.default.SEGMENT_LOCATION_BLACKLIST_ADD}),m=(0,de.default)(T).create({streamInfo:j,mediaPlayerModel:A,dashMetrics:n,errHandler:N,settings:k,boxParser:E,dashConstants:ce.default,urlUtils:e})}catch(e){throw e}}(),t}n.__dashjs_factory_name="Stream";const a=t.default.getClassFactory(n)},"./src/streaming/StreamProcessor.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>a});var se=r("./src/streaming/constants/Constants.js"),le=r("./src/dash/constants/DashConstants.js"),ue=r("./src/streaming/constants/MetricsConstants.js"),ce=r("./src/streaming/models/FragmentModel.js"),fe=r("./src/streaming/controllers/BufferController.js"),de=r("./src/streaming/text/NotFragmentedTextBufferController.js"),ge=r("./src/streaming/controllers/ScheduleController.js"),he=r("./src/dash/controllers/RepresentationController.js"),t=r("./src/core/FactoryMaker.js"),me=r("./src/streaming/utils/SupervisorTools.js"),pe=r("./src/core/EventBus.js"),ye=r("./src/core/events/Events.js"),Ee=r("./src/dash/DashHandler.js"),_e=r("./src/core/errors/Errors.js"),ve=r("./src/streaming/vo/DashJSError.js"),Te=r("./src/core/Debug.js"),be=r("./src/streaming/utils/RequestModifier.js"),Se=r("./src/streaming/utils/URLUtils.js"),Ae=r("./src/streaming/utils/BoxParser.js"),Re=r("./src/streaming/vo/metrics/PlayList.js"),Ie=r("./src/dash/controllers/SegmentsController.js"),we=r("./src/streaming/vo/metrics/HTTPRequest.js");function n(n){n=n||{};var a,i,o,s,r,l,u,p,c,f,d,g,h,y=this.context,m=(0,pe.default)(y).getInstance(),E=n.streamInfo,_=n.type,v=n.errHandler,T=n.mimeType,b=n.timelineConverter,S=n.adapter,A=n.manifestModel,R=n.mediaPlayerModel,I=n.fragmentModel,w=n.abrController,C=n.playbackController,N=n.mediaController,D=n.textController,M=n.dashMetrics,O=n.settings,P=n.boxParser,L=n.segmentBlacklistController;function F(){return E.id}function e(){return _}function x(){return S.getIsTextTrack(p.getData())}function j(){s=null,h=0,f=c=!(r=[])}function k(e){var t=!(1<arguments.length&&void 0!==arguments[1])||arguments[1];e.sender&&(C.getIsManifestUpdateInProgress()?B():x()&&!D.isTextEnabled()||l&&e.representationId&&(l.appendInitSegmentFromCache(e.representationId)||(0!==(e=p.getCurrentRepresentation()).range?(e=d?d.getInitRequest(s,e):null)?I.executeRequest(e):t&&(u.setInitSegmentRequired(!0),B()):U())))}function U(e){var t,r=!(1<arguments.length&&void 0!==arguments[1])||arguments[1];C.getIsManifestUpdateInProgress()||l.getIsPruningInProgress()?B():(t=function(){var e=Z();if(isNaN(h)||_===se.default.TEXT&&!D.isTextEnabled())return null;{var t;d&&(t=p&&e?p.getRepresentationForQuality(e.quality):null,t=c?d.getSegmentRequestForTime(s,t,h):d.getNextSegmentRequest(s,t))}return t}())?(c=!1,t=t,isNaN(t.startTime+t.duration)||(h=t.startTime+t.duration),t.delayLoadingTime=(new Date).getTime()+u.getTimeToLoadDelay(),u.setTimeToLoadDelay(0),function(e){var t=e.url;e.range&&(t=t.concat("_",e.range));return L.contains(t)}(t)?(i.warn("Fragment request url ".concat(t.url," for stream id ").concat(E.id," and media type ").concat(_," is on the ignore list and will be skipped")),B()):(i.debug("Next fragment request url for stream id ".concat(E.id," and media type ").concat(_," is ").concat(t.url)),I.executeRequest(t))):function(e){var t,r=p.getCurrentRepresentation();if(O.get().streaming.gaps.enableSeekFix&&(c||0===C.getTime())&&((!o||o&&r.segmentInfoType===le.default.SEGMENT_TIMELINE)&&(t=d.getValidTimeAheadOfTargetTime(h,s,r,O.get().streaming.gaps.threshold)),!isNaN(t)&&t!==h))return C.isSeeking()||0===C.getTime()?(i.warn("Adjusting playback time ".concat(t," because of gap in the manifest. Seeking by ").concat(t-h)),C.seek(t,!1,!1)):(i.warn("Adjusting buffering time ".concat(t," because of gap in the manifest. Adjusting time by ").concat(t-h)),oe(t),e&&B());if(d.isLastSegmentRequested(r,h)){r=d.getCurrentIndex();return i.debug("Segment requesting for stream ".concat(E.id," has finished")),m.trigger(ye.default.STREAM_REQUESTING_COMPLETED,{segmentIndex:r},{streamId:E.id,mediaType:_}),l.segmentRequestingCompleted(r),u.clearScheduleTimer()}e&&B()}(r)}function B(){u.startScheduleTimer(C.getLowLatencyModeEnabled()?O.get().streaming.scheduling.lowLatencyTimeout:O.get().streaming.scheduling.defaultTimeout)}function G(e){e.error||(u.setCurrentRepresentation(S.convertRepresentationToRepresentationInfo(e.currentRepresentation)),l.getIsBufferingCompleted()||l.updateBufferTimestampOffset(e.currentRepresentation))}function q(e){M.addBufferState(_,e.state,u.getBufferTarget()),e.state!==ue.default.BUFFER_EMPTY||C.isSeeking()||(i.info("Buffer is empty! Stalling!"),M.pushPlayListTraceMetrics(new Date,Re.PlayListTrace.REBUFFERING_REASON))}function H(e){I.syncExecutedRequestsWithBufferedRange(l.getBuffer().getAllBufferRanges(),E.duration),e.quotaExceeded&&e.from>C.getTime()&&oe(e.from),e.hasEnoughSpaceToAppend&&e.quotaExceeded&&u.startScheduleTimer()}function Y(e){var t;e&&e.lastRequestAppended&&e.lastRequestAppended.url&&(t=e.lastRequestAppended.url,e.lastRequestAppended.range&&(t=t.concat("_",e.lastRequestAppended.range)),i.warn("Blacklisting segment with url ".concat(t)),L.add(t))}function V(){ae(),f=!1}function K(e){i.info("onFragmentLoadingAbandoned request: "+e.request.url+" has been aborted"),C.isSeeking()||u.getSwitchStrack()||f||(i.info("onFragmentLoadingAbandoned request: "+e.request.url+" has to be downloaded again, origin is not seeking process or switch track call"),e.request&&e.request.isInitializationRequest()?u.setInitSegmentRequired(!0):oe(e.request.startTime+e.request.duration/2),u.startScheduleTimer(0))}function z(e){i.info("OnFragmentLoadingCompleted for stream id "+E.id+" and media type "+_+" - Url:",e.request?e.request.url:"undefined",e.request.range?", Range:"+e.request.range:""),x()&&u.startScheduleTimer(0),e.error&&e.request.serviceLocation&&(e=e,i.info("Fragment loading completed with an error"),e&&e.request&&e.request.type&&(e.request.type===we.HTTPRequest.INIT_SEGMENT_TYPE?k({representationId:e.request.representationId,sender:{}},!1):e.request.type===we.HTTPRequest.MEDIA_SEGMENT_TYPE&&(oe(e.request.startTime+e.request.duration/2),U({},!1))))}function W(){oe(C.getTime()),u.startScheduleTimer()}function X(e){var t=e.currentTrackInfo;!t||(e=r.find(function(e){return e.index===t.index&&e.lang===t.lang}))&&$(e).then(function(){l.setIsBufferingCompleted(!1),oe(C.getTime()),u.setInitSegmentRequired(!0),u.startScheduleTimer()})}function Q(e){oe(e.quotaExceededTime),u.clearScheduleTimer()}function J(){return l?l.getBuffer():null}function $(e){e===s||e&&s&&e.type!==s.type||(s=e);var t=S.getRealAdaptation(E,s),r=S.getVoRepresentations(s);if(p){var n=p.getData(),a=w.getMaxAllowedIndexFor(_,E.id),i=w.getMinAllowedIndexFor(_,E.id),e=null,e=null!==n&&n.id===t.id||_===se.default.TEXT?w.getQualityFor(_,E.id):(e=w.getThroughputHistory().getAverageThroughput(_,o)||w.getInitialBitrateFor(_,E.id),w.getQualityForBitrate(s,e,E.id));return a<(e=void 0!==i&&e<i?i:e)&&(e=a),p.updateData(t,r,_,s.isFragmented,e)}return Promise.resolve()}function t(){return u}function Z(e){e=void 0!==e?((0,me.checkInteger)(e),p?p.getRepresentationForQuality(e):null):p?p.getCurrentRepresentation():null;return S.convertRepresentationToRepresentationInfo(e)}function ee(){return!!l&&l.getIsBufferingCompleted()}function te(e){var t,r;O.get().streaming.enableManifestTimescaleMismatchFix&&(r=(t=e.chunk).bytes,e=Z(t.quality),t=p&&e?p.getRepresentationForQuality(e.quality):null,e&&t&&(r=P.getMediaTimescaleFromMoov(r),t.timescale=r))}function re(e){var t=e.chunk,r=t.bytes,n=t.quality,a=Z(n),i=p&&a?p.getRepresentationForQuality(a.quality):null;a&&i&&(e=S.getEventsFor(a.mediaInfo,null,E),i=S.getEventsFor(a,i,E),(e&&0<e.length||i&&0<i.length)&&(i=function(e,t,r,n){try{for(var a={},i=[],o=r.concat(n),s=0,l=o.length;s<l;s++)a[o[s].schemeIdUri+"/"+o[s].value]=o[s];var u=(0,Ae.default)(y).getInstance().parse(e),c=u.getBoxes("emsg");if(!c||0===c.length)return i;for(var u=u.getBox("sidx"),u=!u||isNaN(u.earliest_presentation_time)||isNaN(u.timescale)?t&&!isNaN(t.mediaStartTime)?t.mediaStartTime:0:u.earliest_presentation_time/u.timescale,f=Math.max(u,0),d=p.getCurrentRepresentation(),g=0,h=c.length;g<h;g++){var m=S.getEvent(c[g],a,f,d);m&&i.push(m)}return i}catch(e){return[]}}(r,I.getRequests({state:ce.default.FRAGMENT_MODEL_EXECUTED,quality:n,index:t.index})[0],e,i),m.trigger(ye.default.INBAND_EVENTS,{events:i},{streamId:E.id})))}function ne(){var e=C.getTime();O.get().streaming.buffer.flushBufferAtTrackSwitch&&C.seek(e+.001,!1,!0),oe(e),l.setSeekTarget(e),u.startScheduleTimer()}function ae(){var e=C.getTime(),t=l.getContinuousBufferTimeForTargetTime(e);oe(isNaN(t)?e:t),u.startScheduleTimer()}function ie(e){e&&!isNaN(e.time)&&(oe(e.time),l.setSeekTarget(e.time))}function oe(e){h=e,c=!0}return a={initialize:function(e,t,r){g=(0,Ie.default)(y).create({events:ye.default,eventBus:m,streamInfo:E,timelineConverter:b,dashConstants:le.default,segmentBaseController:n.segmentBaseController,type:_}),d=(0,Ee.default)(y).create({streamInfo:E,type:_,timelineConverter:b,dashMetrics:M,mediaPlayerModel:R,baseURLController:n.baseURLController,errHandler:v,segmentsController:g,settings:O,boxParser:P,events:ye.default,eventBus:m,errors:_e.default,debug:(0,Te.default)(y).getInstance(),requestModifier:(0,be.default)(y).getInstance(),dashConstants:le.default,constants:se.default,urlUtils:(0,Se.default)(y).getInstance()}),o=E.manifestInfo.isDynamic,d.initialize(o),w.registerStreamType(_,a),p=(0,he.default)(y).create({streamInfo:E,type:_,abrController:w,dashMetrics:M,playbackController:C,timelineConverter:b,dashConstants:le.default,events:ye.default,eventBus:m,errors:_e.default,isDynamic:o,segmentsController:g}),(l=function(e,t){var r=null;if(!e)return v.error(new ve.default(_e.default.MEDIASOURCE_TYPE_UNSUPPORTED_CODE,_e.default.MEDIASOURCE_TYPE_UNSUPPORTED_MESSAGE+"not properly defined")),null;r=e!==se.default.TEXT||t?(0,fe.default)(y).create({streamInfo:E,type:e,mediaPlayerModel:R,manifestModel:A,fragmentModel:I,errHandler:v,mediaController:N,representationController:p,adapter:S,textController:D,abrController:w,playbackController:C,settings:O}):(0,de.default)(y).create({streamInfo:E,type:e,mimeType:T,fragmentModel:I,textController:D,errHandler:v,settings:O});return r}(_,r))&&l.initialize(e),(u=(0,ge.default)(y).create({streamInfo:E,type:_,mimeType:T,adapter:S,dashMetrics:M,mediaPlayerModel:R,fragmentModel:I,abrController:w,playbackController:C,textController:D,mediaController:N,bufferController:l,settings:O})).initialize(t),h=0,c=!1},getStreamId:F,getType:e,isUpdating:function(){return!!p&&p.isUpdating()},getBufferController:function(){return l},dischargePreBuffer:function(){l.dischargePreBuffer()},getFragmentModel:function(){return I},getScheduleController:t,getRepresentationController:function(){return p},getRepresentationInfo:Z,getBufferLevel:function(){return l?l.getBufferLevel():0},isBufferingCompleted:ee,createBufferSinks:function(e){var t=J();return t?Promise.resolve(t):l?l.createBufferSink(s,e):Promise.resolve(null)},updateStreamInfo:function(e){return E=e,ee()?Promise.resolve():l.updateAppendWindow()},getStreamInfo:function(){return E},selectMediaInfo:$,clearMediaInfoArray:function(){r=[]},addMediaInfo:function(e){-1===r.indexOf(e)&&r.push(e)},prepareTrackSwitch:function(){return new Promise(function(e){i.debug("Preparing track switch for type ".concat(_));var t=_===se.default.TEXT||O.get().streaming.trackSwitchMode[_]===se.default.TRACK_SWITCH_MODE_ALWAYS_REPLACE&&C.getTimeToStreamEnd(E)>O.get().streaming.buffer.stallThreshold;if(l.getIsBufferingCompleted()&&!t)return l.prepareForNonReplacementTrackSwitch(s.codec).then(function(){m.trigger(ye.default.BUFFERING_COMPLETED,{},{streamId:E.id,mediaType:_})}).catch(function(){m.trigger(ye.default.BUFFERING_COMPLETED,{},{streamId:E.id,mediaType:_})}),void e();u.clearScheduleTimer(),u.setSwitchTrack(!0),t?(m.trigger(ye.default.BUFFER_REPLACEMENT_STARTED,{mediaType:_,streamId:E.id},{mediaType:_,streamId:E.id}),I.abortRequests(),l.prepareForReplacementTrackSwitch(s.codec).then(function(){var e=Z();return l.updateBufferTimestampOffset(e)}).then(function(){ne(),e()}).catch(function(){ne(),e()})):l.prepareForNonReplacementTrackSwitch(s.codec).then(function(){ae(),e()}).catch(function(){ae(),e()})})},prepareQualityChange:function(o){i.debug("Preparing quality switch for type ".concat(_));var e=o.newQuality;f=!0,u.clearScheduleTimer();var s=Z(e);u.setCurrentRepresentation(s),p.prepareQualityChange(e),I.abortRequests(),l.updateBufferTimestampOffset(s).then(function(){var e,t,r,n,a,i;o.reason&&o.reason.forceReplace?(m.trigger(ye.default.BUFFER_REPLACEMENT_STARTED,{mediaType:_,streamId:E.id},{mediaType:_,streamId:E.id}),l.prepareForReplacementQualitySwitch().then(function(){ne(),f=!1}).catch(function(){ne(),f=!1})):O.get().streaming.buffer.fastSwitchEnabled?(e=s,n=C.getTime(),a=1.5*(isNaN(e.fragmentDuration)?1:e.fragmentDuration),(i=I.getRequests({state:ce.default.FRAGMENT_MODEL_EXECUTED,time:n+a,threshold:0})[0])&&!x()?(t=l.getBufferLevel(),r=w.getAbandonmentStateFor(E.id,_),i.quality<e.quality&&a<=t&&r!==ue.default.ABANDON_LOAD?(oe(n+a),u.setCheckPlaybackQuality(!1),u.startScheduleTimer()):V()):u.startScheduleTimer(),f=!1):V(),M.pushPlayListTraceMetrics(new Date,Re.PlayListTrace.REPRESENTATION_SWITCH_STOP_REASON),M.createPlaylistTraceMetrics(s.id,1e3*C.getTime(),C.getPlaybackRate())})},getMediaInfo:function(){return s},getMediaSource:function(){return l.getMediaSource()},setMediaSource:function(e){return l.setMediaSource(e,s)},getBuffer:J,setExplicitBufferingTime:oe,finalisePlayList:function(e,t){M.pushPlayListTraceMetrics(e,t)},probeNextRequest:function(){var e=Z(),e=p&&e?p.getRepresentationForQuality(e.quality):null;return d.getNextSegmentRequestIdempotent(s,e)},prepareInnerPeriodPlaybackSeeking:function(n){return new Promise(function(r){if(l.hasBufferAtTime(n.seekTime))return l.pruneBuffer(),void r();u.clearScheduleTimer(),I.abortRequests(),l.prepareForPlaybackSeek().then(function(){var e=l.getAllRangesWithSafetyFactor(n.seekTime);return l.clearBuffers(e)}).then(function(){var e,t=l.getContinuousBufferTimeForTargetTime(n.seekTime);!isNaN(t)&&!isNaN(E.duration)&&isFinite(E.duration)&&t>=E.start+E.duration?(l.setIsBufferingCompleted(!0),r()):(oe(e=isNaN(t)?n.seekTime:t),l.setSeekTarget(e),(t=[]).push(l.updateAppendWindow()),e=Z(),t.push(l.updateBufferTimestampOffset(e)),Promise.all(t).then(function(){u.setInitSegmentRequired(!0),u.setCheckPlaybackQuality(!1),u.startScheduleTimer(),r()}))}).catch(function(e){i.error(e)})})},prepareOuterPeriodPlaybackSeeking:function(){return new Promise(function(e,t){try{u.clearScheduleTimer(),I.abortRequests(),l.prepareForPlaybackSeek().then(function(){return l.pruneAllSafely()}).then(function(){e()})}catch(e){t(e)}})},reset:function(e,t){d&&d.reset(),l&&(l.reset(e,t),l=null),u&&(u.reset(),u=null),p&&(p.reset(),p=null),g=g&&null,w&&w.unRegisterStreamType(F(),_),m.off(ye.default.DATA_UPDATE_COMPLETED,G,a),m.off(ye.default.INIT_FRAGMENT_NEEDED,k,a),m.off(ye.default.MEDIA_FRAGMENT_NEEDED,U,a),m.off(ye.default.INIT_FRAGMENT_LOADED,te,a),m.off(ye.default.MEDIA_FRAGMENT_LOADED,re,a),m.off(ye.default.BUFFER_LEVEL_STATE_CHANGED,q,a),m.off(ye.default.BUFFER_CLEARED,H,a),m.off(ye.default.SEEK_TARGET,ie,a),m.off(ye.default.FRAGMENT_LOADING_ABANDONED,K,a),m.off(ye.default.FRAGMENT_LOADING_COMPLETED,z,a),m.off(ye.default.SET_FRAGMENTED_TEXT_AFTER_DISABLED,W,a),m.off(ye.default.SET_NON_FRAGMENTED_TEXT,X,a),m.off(ye.default.QUOTA_EXCEEDED,Q,a),m.off(ye.default.SOURCE_BUFFER_ERROR,Y,a),j(),E=_=null}},i=(0,Te.default)(y).getInstance().getLogger(a),j(),m.on(ye.default.DATA_UPDATE_COMPLETED,G,a,{priority:pe.default.EVENT_PRIORITY_HIGH}),m.on(ye.default.INIT_FRAGMENT_NEEDED,k,a),m.on(ye.default.MEDIA_FRAGMENT_NEEDED,U,a),m.on(ye.default.INIT_FRAGMENT_LOADED,te,a),m.on(ye.default.MEDIA_FRAGMENT_LOADED,re,a),m.on(ye.default.BUFFER_LEVEL_STATE_CHANGED,q,a),m.on(ye.default.BUFFER_CLEARED,H,a),m.on(ye.default.SEEK_TARGET,ie,a),m.on(ye.default.FRAGMENT_LOADING_ABANDONED,K,a),m.on(ye.default.FRAGMENT_LOADING_COMPLETED,z,a),m.on(ye.default.QUOTA_EXCEEDED,Q,a),m.on(ye.default.SET_FRAGMENTED_TEXT_AFTER_DISABLED,W,a),m.on(ye.default.SET_NON_FRAGMENTED_TEXT,X,a),m.on(ye.default.SOURCE_BUFFER_ERROR,Y,a),a}n.__dashjs_factory_name="StreamProcessor";const a=t.default.getClassFactory(n)},"./src/streaming/XlinkLoader.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>o});var l=r("./src/streaming/vo/DashJSError.js"),n=r("./src/streaming/net/URLLoader.js"),u=r("./src/streaming/vo/metrics/HTTPRequest.js"),c=r("./src/streaming/vo/TextRequest.js"),a=r("./src/core/EventBus.js"),f=r("./src/core/events/Events.js"),t=r("./src/core/FactoryMaker.js"),d=r("./src/core/errors/Errors.js");function i(e){e=e||{};var i="urn:mpeg:dash:resolve-to-zero:2013",t=this.context,o=(0,a.default)(t).getInstance(),s=(0,n.default)(t).create({errHandler:e.errHandler,dashMetrics:e.dashMetrics,mediaPlayerModel:e.mediaPlayerModel,requestModifier:e.requestModifier,errors:d.default});return{load:function(r,n,a){function t(e,t){n.resolved=!0,n.resolvedContent=e||null,o.trigger(f.default.XLINK_ELEMENT_LOADED,{element:n,resolveObject:a,error:e||t?null:new l.default(d.default.XLINK_LOADER_LOADING_FAILURE_ERROR_CODE,d.default.XLINK_LOADER_LOADING_FAILURE_ERROR_MESSAGE+r)})}var e;r===i?t(null,!0):(e=new c.default(r,u.HTTPRequest.XLINK_EXPANSION_TYPE),s.load({request:e,success:function(e){t(e)},error:function(){t(null)}}))},reset:function(){s&&(s.abort(),s=null)}}}i.__dashjs_factory_name="XlinkLoader";const o=t.default.getClassFactory(i)},"./src/streaming/constants/ConformanceViolationConstants.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>n});const n={LEVELS:{SUGGESTION:"Suggestion",WARNING:"Warning",ERROR:"Error"},EVENTS:{NO_UTC_TIMING_ELEMENT:{key:"NO_UTC_TIMING_ELEMENT",message:"No UTCTiming element is present in the manifest. You may experience playback failures. For a detailed validation use https://conformance.dashif.org/"},NON_COMPLIANT_SMPTE_IMAGE_ATTRIBUTE:{key:"NON_COMPLIANT_SMPTE_IMAGE_ATTRIBUTE",message:'SMPTE 2052-1:2013 defines the attribute name as "imageType" and does not define "imagetype"'},INVALID_DVR_WINDOW:{key:"INVALID_DVR_WINDOW",message:"No valid segment found when applying a specification compliant DVR window calculation. Using SegmentTimeline entries as a fallback."}}}},"./src/streaming/constants/Constants.js":(e,t,r)=>{function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}r.r(t),r.d(t,{default:()=>n});const n=new(function(){function t(){!function(e){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),this.init()}var e,r,n;return e=t,(r=[{key:"init",value:function(){this.STREAM="stream",this.VIDEO="video",this.AUDIO="audio",this.TEXT="text",this.MUXED="muxed",this.IMAGE="image",this.STPP="stpp",this.TTML="ttml",this.VTT="vtt",this.WVTT="wvtt",this.CONTENT_STEERING="contentSteering",this.ABR_STRATEGY_DYNAMIC="abrDynamic",this.ABR_STRATEGY_BOLA="abrBola",this.ABR_STRATEGY_L2A="abrL2A",this.ABR_STRATEGY_LoLP="abrLoLP",this.ABR_STRATEGY_THROUGHPUT="abrThroughput",this.ABR_FETCH_THROUGHPUT_CALCULATION_DOWNLOADED_DATA="abrFetchThroughputCalculationDownloadedData",this.ABR_FETCH_THROUGHPUT_CALCULATION_MOOF_PARSING="abrFetchThroughputCalculationMoofParsing",this.ABR_FETCH_THROUGHPUT_CALCULATION_AAST="abrFetchThroughputCalculationAAST",this.LIVE_CATCHUP_MODE_DEFAULT="liveCatchupModeDefault",this.LIVE_CATCHUP_MODE_LOLP="liveCatchupModeLoLP",this.MOVING_AVERAGE_SLIDING_WINDOW="slidingWindow",this.MOVING_AVERAGE_EWMA="ewma",this.BAD_ARGUMENT_ERROR="Invalid Arguments",this.MISSING_CONFIG_ERROR="Missing config parameter(s)",this.TRACK_SWITCH_MODE_ALWAYS_REPLACE="alwaysReplace",this.TRACK_SWITCH_MODE_NEVER_REPLACE="neverReplace",this.TRACK_SELECTION_MODE_FIRST_TRACK="firstTrack",this.TRACK_SELECTION_MODE_HIGHEST_BITRATE="highestBitrate",this.TRACK_SELECTION_MODE_HIGHEST_EFFICIENCY="highestEfficiency",this.TRACK_SELECTION_MODE_WIDEST_RANGE="widestRange",this.TRACK_SELECTION_MODE_HIGHEST_SELECTION_PRIORITY="highestSelectionPriority",this.CMCD_MODE_QUERY="query",this.CMCD_MODE_HEADER="header",this.LOCATION="Location",this.INITIALIZE="initialize",this.TEXT_SHOWING="showing",this.TEXT_HIDDEN="hidden",this.CC1="CC1",this.CC3="CC3",this.UTF8="utf-8",this.SCHEME_ID_URI="schemeIdUri",this.START_TIME="starttime",this.SERVICE_DESCRIPTION_DVB_LL_SCHEME="urn:dvb:dash:lowlatency:scope:2019",this.SUPPLEMENTAL_PROPERTY_DVB_LL_SCHEME="urn:dvb:dash:lowlatency:critical:2019",this.XML="XML",this.ARRAY_BUFFER="ArrayBuffer",this.DVB_REPORTING_URL="dvb:reportingUrl",this.DVB_PROBABILITY="dvb:probability",this.VIDEO_ELEMENT_READY_STATES={HAVE_NOTHING:0,HAVE_METADATA:1,HAVE_CURRENT_DATA:2,HAVE_FUTURE_DATA:3,HAVE_ENOUGH_DATA:4},this.FILE_LOADER_TYPES={FETCH:"fetch_loader",XHR:"xhr_loader"}}}])&&a(e.prototype,r),n&&a(e,n),t}())},"./src/streaming/constants/MetricsConstants.js":(e,t,r)=>{function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}r.r(t),r.d(t,{default:()=>n});const n=new(function(){function t(){!function(e){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),this.init()}var e,r,n;return e=t,(r=[{key:"init",value:function(){this.TCP_CONNECTION="TcpList",this.HTTP_REQUEST="HttpList",this.TRACK_SWITCH="RepSwitchList",this.BUFFER_LEVEL="BufferLevel",this.BUFFER_LOADED="bufferLoaded",this.ABANDON_LOAD="abandonload",this.ALLOW_LOAD="allowload",this.BUFFER_EMPTY="bufferStalled",this.BUFFER_STATE="BufferState",this.DVR_INFO="DVRInfo",this.DROPPED_FRAMES="DroppedFrames",this.SCHEDULING_INFO="SchedulingInfo",this.REQUESTS_QUEUE="RequestsQueue",this.MANIFEST_UPDATE="ManifestUpdate",this.MANIFEST_UPDATE_STREAM_INFO="ManifestUpdatePeriodInfo",this.MANIFEST_UPDATE_TRACK_INFO="ManifestUpdateRepresentationInfo",this.PLAY_LIST="PlayList",this.DVB_ERRORS="DVBErrors",this.HTTP_REQUEST_DVB_REPORTING_TYPE="DVBReporting"}}])&&a(e.prototype,r),n&&a(e,n),t}())},"./src/streaming/constants/ProtectionConstants.js":(e,t,r)=>{function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}r.r(t),r.d(t,{default:()=>n});const n=new(function(){function t(){!function(e){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),this.init()}var e,r,n;return e=t,(r=[{key:"init",value:function(){this.CLEARKEY_KEYSTEM_STRING="org.w3.clearkey",this.WIDEVINE_KEYSTEM_STRING="com.widevine.alpha",this.PLAYREADY_KEYSTEM_STRING="com.microsoft.playready",this.PLAYREADY_RECOMMENDATION_KEYSTEM_STRING="com.microsoft.playready.recommendation",this.INITIALIZATION_DATA_TYPE_CENC="cenc",this.INITIALIZATION_DATA_TYPE_KEYIDS="keyids",this.INITIALIZATION_DATA_TYPE_WEBM="webm"}}])&&a(e.prototype,r),n&&a(e,n),t}())},"./src/streaming/controllers/AbrController.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>a});var H=r("./src/streaming/rules/abr/ABRRulesCollection.js"),Y=r("./src/streaming/constants/Constants.js"),V=r("./src/streaming/constants/MetricsConstants.js"),K=r("./src/streaming/vo/BitrateInfo.js"),z=r("./src/streaming/models/FragmentModel.js"),W=r("./src/core/EventBus.js"),X=r("./src/core/events/Events.js"),t=r("./src/core/FactoryMaker.js"),Q=r("./src/streaming/rules/RulesContext.js"),J=r("./src/streaming/rules/SwitchRequest.js"),$=r("./src/streaming/rules/SwitchRequestHistory.js"),Z=r("./src/streaming/rules/DroppedFramesHistory.js"),ee=r("./src/streaming/rules/ThroughputHistory.js"),te=r("./src/core/Debug.js"),re=r("./src/streaming/vo/metrics/HTTPRequest.js"),ne=r("./src/streaming/utils/SupervisorTools.js"),ae=r("./src/streaming/MediaPlayerEvents.js");function n(){var s,u,l,i,o,c,f,d,g,h,m,p,y,E,_,t,v,T,b,S,A,R,I,w,C,N,D,M=this.context,e=(0,te.default)(M).getInstance(),O=(0,W.default)(M).getInstance();function r(){o={},c={},d={},f={},S={},I={},w={},C={},void 0===h&&(h=!1),A&&A.reset(),R=A=b=void 0,clearTimeout(g),g=null}function n(e){var t,r,n=e.request.mediaType,a=e.streamId;n&&a&&f[a]&&D.get().streaming.abr.autoSwitchBitrate[n]&&((t=f[a][n])&&(r=(0,Q.default)(M).create({abrController:s,streamProcessor:t,currentRequest:e.request,useBufferOccupancyABR:I[n],useL2AABR:w[n],useLoLPABR:C[n],videoModel:E}),(r=l.shouldAbandonFragment(r,a)).quality>J.default.NO_CHANGE&&t.getFragmentModel().getRequests({state:z.default.FRAGMENT_MODEL_LOADING,index:e.request.index})[0]&&(d[a][n].state=V.default.ABANDON_LOAD,S[a][n].reset(),S[a][n].push({oldValue:x(n,a),newValue:r.quality,confidence:1,reason:r.reason}),j(n,i.getActiveStreamInfo(),r.quality,r.reason),clearTimeout(g),g=setTimeout(function(){d[a][n].state=V.default.ALLOW_LOAD,g=null},D.get().streaming.abandonLoadTimeout))))}function a(e){e.mediaType===Y.default.VIDEO&&(void 0!==b&&A.push(e.streamId,b,E.getPlaybackQuality()),b=e.newQuality)}function P(e){var t;e.metric!==V.default.HTTP_REQUEST||!e.value||e.value.type!==re.HTTPRequest.MEDIA_SEGMENT_TYPE||e.mediaType!==Y.default.AUDIO&&e.mediaType!==Y.default.VIDEO||R.push(e.mediaType,e.value,D.get().streaming.abr.useDeadTimeLatency),e.metric!==V.default.BUFFER_LEVEL||e.mediaType!==Y.default.AUDIO&&e.mediaType!==Y.default.VIDEO||(t=e.mediaType,e=.001*e.value.level,D.get().streaming.abr.ABRStrategy===Y.default.ABR_STRATEGY_DYNAMIC&&function(e,t){try{var r=_.getStableBufferTime(),n=r,a=.5*r,r=I[e],n=(r?a:n)<t;(I[e]=n)!==r&&(n?u.info("["+e+"] switching from throughput to buffer occupancy ABR rule (buffer: "+t.toFixed(3)+")."):u.info("["+e+"] switching from buffer occupancy to throughput ABR rule (buffer: "+t.toFixed(3)+")."))}catch(e){u.error(e)}}(t,e))}function L(e,t){try{var r;return o[t]=o[t]||{},o[t].hasOwnProperty(e)||(o[t][e]=0),r=function(e,t,r){if(t!==Y.default.VIDEO||!D.get().streaming.abr.limitBitrateByPortal||!f[r]||!f[r][t])return e;h||q();var r=f[r][t].getStreamInfo(),n=y.getAdaptationForType(r.index,t,r).Representation_asArray,a=e;if(0<m&&0<p){for(;0<a&&n[a]&&m<n[a].width&&m-n[a-1].width<n[a].width-m;)a-=1;for(;a<n.length-1&&n[a].width===n[a+1].width;)a+=1}return a}(r=function(e,t,r){r=o[r][t],t=D.get().streaming.abr.maxRepresentationRatio[t];if(isNaN(t)||1<=t||t<0)return e;return Math.min(e,Math.round(r*t))}(r=function(e,t){var r=o[t][e],n=r;if(!f[t]||!f[t][e])return n;var a=F(e,t);void 0!==a&&(n=Math.max(r,a));t=function(e,t){try{var r=_.getAbrBitrateParameter("maxBitrate",e);return-1<r?B(f[t][e].getMediaInfo(),r,t):void 0}catch(e){return}}(e,t);void 0!==t&&(n=Math.min(n,t));return n}(e,t),e,t),e,t),r=D.get().streaming.cmsd.enabled&&D.get().streaming.cmsd.abr.applyMb?function(e,t,r){if("video"!==t)return e;var n=v.getMaxBitrate(t);if(n<0)return e;var a=U(r,"audio",x("audio",r));n-=a?a.bitrate/1e3:0;a=B(f[r][t].getMediaInfo(),n,r);return u.debug("Stream ID: "+r+" ["+t+"] Apply max bit rate from CMSD: "+n),Math.min(e,a)}(r,e,t):r}catch(e){return}}function F(e,t){try{return function(e,t){try{var r=_.getAbrBitrateParameter("minBitrate",e);if(-1<r){var n=f[t][e].getMediaInfo(),a=G(n),n=B(n,r,t);return a[n]&&n<a.length-1&&a[n].bitrate<1e3*r&&n++,n}return}catch(e){return}}(e,t)}catch(e){return}}function x(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;try{t=t||i.getActiveStreamInfo().id;if(e&&f[t]&&f[t][e])if(t)return c[t]=c[t]||{},c[t].hasOwnProperty(e)||(c[t][e]=0),c[t][e];return 0}catch(e){return 0}}function j(e,t,r){var n,a,i=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;t&&t.id&&e&&(a=x(e,n=t.id),(0,ne.checkInteger)(r),t=L(e,n),r!==a&&0<=r&&r<=t&&k(e,a,r,t,i,n))}function k(e,t,r,n,a,i){var o,s,l;e&&f[i]&&f[i][e]&&(l=(o=f[i][e].getStreamInfo())&&o.manifestInfo&&o.manifestInfo.isDynamic,s=N.getCurrentBufferLevel(e),u.info("Stream ID: "+i+" ["+e+"] switch from "+t+" to "+r+"/"+n+" (buffer: "+s+") "+(a?JSON.stringify(a):".")),c[i]=c[i]||{},i=U(i,e,c[i][e]=r),O.trigger(X.default.QUALITY_CHANGE_REQUESTED,{oldQuality:t,newQuality:r,reason:a,streamInfo:o,bitrateInfo:i,maxIdx:n,mediaType:e},{streamId:o.id,mediaType:e}),l=R.getAverageThroughput(e,l),isNaN(l)||T.setSavedBitrateSettings(e,l))}function U(e,t,r){if(t&&f&&f[e]&&f[e][t]){t=G(f[e][t].getMediaInfo());return t[r]||null}return null}function B(e,t,r){var n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null,r=e&&e.type?f[r][e.type].getRepresentationInfo():null;if(D.get().streaming.abr.useDeadTimeLatency&&n&&r&&r.fragmentDuration){n/=1e3;r=r.fragmentDuration;if(r<n)return 0;t*=1-n/r}for(var a=G(e),i=a.length-1;0<=i;i--)if(1e3*t>=a[i].bitrate)return i;return 0}function G(e){var t=[];if(!e||!e.bitrateList)return t;for(var r,n=e.bitrateList,a=e.type,i=0,o=n.length;i<o;i++)(r=new K.default).mediaType=a,r.qualityIndex=i,r.bitrate=n[i].bandwidth,r.width=n[i].width,r.height=n[i].height,r.scanType=n[i].scanType,t.push(r);return t}function q(){var e;E&&(e=D.get().streaming.abr.usePixelRatioInLimitBitrateByPortal&&window.hasOwnProperty("devicePixelRatio")?window.devicePixelRatio:1,m=E.getClientWidth()*e,p=E.getClientHeight()*e)}return s={initialize:function(){A=(0,Z.default)(M).create(),R=(0,ee.default)(M).create({settings:D}),(l=(0,H.default)(M).create({dashMetrics:N,customParametersModel:t,mediaPlayerModel:_,settings:D})).initialize(),O.on(ae.default.QUALITY_CHANGE_RENDERED,a,s),O.on(ae.default.METRIC_ADDED,P,s),O.on(X.default.LOADING_PROGRESS,n,s)},isPlayingAtTopQuality:function(e){var t=e?e.id:null,r=x(Y.default.AUDIO,t),e=x(Y.default.VIDEO,t);return r===L(Y.default.AUDIO,t)&&e===L(Y.default.VIDEO,t)},updateTopQualityIndex:function(e){var t=e.type,r=e.streamInfo.id,e=e.representationCount-1;return o[r]=o[r]||{},o[r][t]=e},clearDataForStream:function(e){A&&A.clearForStream(e),f[e]&&delete f[e],S[e]&&delete S[e],d[e]&&delete d[e]},getThroughputHistory:function(){return R},getBitrateList:G,getQualityForBitrate:B,getTopBitrateInfoFor:function(e){var t=(t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null)||i.getActiveStreamInfo().id;if(e&&f&&f[t]&&f[t][e]){var r=L(e,t),e=G(f[t][e].getMediaInfo());return e[r]||null}return null},getMinAllowedIndexFor:F,getMaxAllowedIndexFor:L,getInitialBitrateFor:function(e,t){if(!function(){if(!T||!T.hasOwnProperty("getSavedBitrateSettings"))throw new Error(Y.default.MISSING_CONFIG_ERROR)}(),e===Y.default.TEXT)return NaN;var r=T.getSavedBitrateSettings(e),n=_.getAbrBitrateParameter("initialBitrate",e),a=D.get().streaming.abr.initialRepresentationRatio[e];return n=-1===n?-1<a?(t=f[t][e].getStreamInfo(),t=y.getAdaptationForType(t.index,e,t).Representation_asArray,Array.isArray(t)?t[Math.max(Math.round(t.length*a)-1,0)].bandwidth/1e3:0):isNaN(r)?e===Y.default.VIDEO?1e3:100:r:n},getQualityFor:x,getAbandonmentStateFor:function(e,t){return d[e]&&d[e][t]?d[e][t].state:null},setPlaybackQuality:j,checkPlaybackQuality:function(e,t){try{if(!(e&&f&&f[t]&&f[t][e]))return!1;if(!A||(o=E.getPlaybackQuality())&&A.push(t,b,o),!D.get().streaming.abr.autoSwitchBitrate[e])return!1;var r=x(e,t),n=(0,Q.default)(M).create({abrController:s,switchHistory:S[t][e],droppedFramesHistory:A,streamProcessor:f[t][e],currentValue:r,useBufferOccupancyABR:I[e],useL2AABR:w[e],useLoLPABR:C[e],videoModel:E}),a=F(e,t),i=L(e,t),o=l.getMaxQuality(n),n=o.quality;return i<(n=void 0!==a&&(n>J.default.NO_CHANGE?n:r)<a?a:n)&&(n=i),S[t][e].push({oldValue:r,newValue:n}),n>J.default.NO_CHANGE&&n!==r&&(d[t][e].state===V.default.ALLOW_LOAD||n<r)&&(k(e,r,n,i,o.reason,t),!0)}catch(e){return!1}},setElementSize:q,setWindowResizeEventCalled:function(e){h=e},registerStreamType:function(e,t){var r=t.getStreamInfo().id;f[r]||(f[r]={}),S[r]||(S[r]={}),d[r]||(d[r]={}),S[r][e]=(0,$.default)(M).create(),f[r][e]=t,d[r][e]={},d[r][e].state=V.default.ALLOW_LOAD,t=e,(r=D.get().streaming.abr.ABRStrategy)===Y.default.ABR_STRATEGY_L2A?(I[t]=!1,C[t]=!1,w[t]=!0):r===Y.default.ABR_STRATEGY_LoLP?(I[t]=!1,C[t]=!0,w[t]=!1):r===Y.default.ABR_STRATEGY_BOLA?(I[t]=!0,C[t]=!1,w[t]=!1):r===Y.default.ABR_STRATEGY_THROUGHPUT?(I[t]=!1,C[t]=!1,w[t]=!1):r===Y.default.ABR_STRATEGY_DYNAMIC&&(I[t]=!(!I||!I[t])&&I[t],C[t]=!1,w[t]=!1),e===Y.default.VIDEO&&q()},unRegisterStreamType:function(e,t){try{f[e]&&f[e][t]&&delete f[e][t],S[e]&&S[e][t]&&delete S[e][t],d[e]&&d[e][t]&&delete d[e][t]}catch(e){}},setConfig:function(e){e&&(e.streamController&&(i=e.streamController),e.domStorage&&(T=e.domStorage),e.mediaPlayerModel&&(_=e.mediaPlayerModel),e.customParametersModel&&(t=e.customParametersModel),e.cmsdModel&&(v=e.cmsdModel),e.dashMetrics&&(N=e.dashMetrics),e.adapter&&(y=e.adapter),e.videoModel&&(E=e.videoModel),e.settings&&(D=e.settings))},reset:function(){r(),O.off(X.default.LOADING_PROGRESS,n,s),O.off(ae.default.QUALITY_CHANGE_RENDERED,a,s),O.off(ae.default.METRIC_ADDED,P,s),l&&l.reset()}},u=e.getLogger(s),r(),s}n.__dashjs_factory_name="AbrController";r=t.default.getSingletonFactory(n);r.QUALITY_DEFAULT=0,t.default.updateSingletonFactory(n.__dashjs_factory_name,r);const a=r},"./src/streaming/controllers/BaseURLController.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>a});var l=r("./src/streaming/models/BaseURLTreeModel.js"),u=r("./src/streaming/utils/BaseURLSelector.js"),c=r("./src/streaming/utils/URLUtils.js"),f=r("./src/dash/vo/BaseURL.js"),t=r("./src/core/FactoryMaker.js"),d=r("./src/core/EventBus.js"),g=r("./src/core/events/Events.js");function n(){var e,t,r,n,a=this.context,i=(0,d.default)(a).getInstance(),o=(0,c.default)(a).getInstance();function s(e){r.invalidateSelectedIndexes(e.entry)}return e={reset:function(){r.reset(),n.reset()},initialize:function(e){r.setConfig({adapter:t}),e=e,r.update(e),n.chooseSelector(t.getIsDVB(e))},resolve:function(e){if(e=r.getForPath(e).reduce(function(e,t){t=n.select(t);return t?(o.isRelative(t.url)?e.url=o.resolve(t.url,e.url):(e.url=t.url,e.serviceLocation=t.serviceLocation),e.availabilityTimeOffset=t.availabilityTimeOffset,e.availabilityTimeComplete=t.availabilityTimeComplete,e):new f.default},new f.default),!o.isRelative(e.url))return e},setConfig:function(e){e.baseURLTreeModel&&(r=e.baseURLTreeModel),e.baseURLSelector&&(n=e.baseURLSelector),e.adapter&&(t=e.adapter)}},r=(0,l.default)(a).create(),n=(0,u.default)(a).create(),i.on(g.default.SERVICE_LOCATION_BLACKLIST_CHANGED,s,e),e}n.__dashjs_factory_name="BaseURLController";const a=t.default.getClassFactory(n)},"./src/streaming/controllers/BlacklistController.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>a});var t=r("./src/core/FactoryMaker.js"),l=r("./src/core/EventBus.js");function n(e){var t;e=e||{};var r=[],n=(0,l.default)(this.context).getInstance(),a=e.updateEventName,i=e.addBlacklistEventName;function o(e){-1===r.indexOf(e)&&(r.push(e),n.trigger(a,{entry:e}))}function s(e){o(e.entry)}return t={add:o,contains:function(e){return!!(r.length&&e&&e.length)&&-1!==r.indexOf(e)},reset:function(){r=[]}},i&&n.on(i,s,t),t}n.__dashjs_factory_name="BlackListController";const a=t.default.getClassFactory(n)},"./src/streaming/controllers/BufferController.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>a});var de=r("./src/streaming/constants/Constants.js"),ge=r("./src/streaming/constants/MetricsConstants.js"),he=r("./src/streaming/models/FragmentModel.js"),me=r("./src/streaming/SourceBufferSink.js"),pe=r("./src/streaming/PreBufferSink.js"),ye=r("./src/core/EventBus.js"),Ee=r("./src/core/events/Events.js"),t=r("./src/core/FactoryMaker.js"),_e=r("./src/core/Debug.js"),ve=r("./src/streaming/utils/InitCache.js"),Te=r("./src/streaming/vo/DashJSError.js"),be=r("./src/core/errors/Errors.js"),Se=r("./src/streaming/vo/metrics/HTTPRequest.js"),Ae=r("./src/streaming/MediaPlayerEvents.js"),Re="BufferController";function n(e){e=e||{};var t,l,n,a,i,o,s,u,f,c,d,g,h,m,p,y,E,_,v,T,b=this.context,S=(0,ye.default)(b).getInstance(),A=e.errHandler,R=e.fragmentModel,I=e.representationController,r=e.adapter,w=e.textController,C=e.abrController,N=e.playbackController,D=e.streamInfo,M=e.type,O=e.settings;function P(r){var n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;return new Promise(function(e,t){o=r,f&&n&&"function"==typeof f.discharge?(c=f,F(n).then(function(){e()}).catch(function(e){t(e)})):e()})}function L(e){return r.convertRepresentationToRepresentationInfo(I.getRepresentationForQuality(e))}function F(e){var i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[];return new Promise(function(t,r){var n,a;E&&e?o?(n=e,a=i,new Promise(function(e,t){var r=C.getQualityFor(M,D.id);f=(0,me.default)(b).create({mediaSource:o,textController:w,eventBus:S}),function(e,t,r){r=L(r);return t&&t[M]&&(M===de.default.VIDEO||M===de.default.AUDIO)?f.initializeForStreamSwitch(e,r,t[M]):f.initializeForFirstUse(D,e,r)}(n,a,r).then(function(){return re(L(r))}).then(function(){e(f)}).catch(function(e){l.fatal("Caught error on create SourceBuffer: "+e),A.error(new Te.default(be.default.MEDIASOURCE_TYPE_UNSUPPORTED_CODE,be.default.MEDIASOURCE_TYPE_UNSUPPORTED_MESSAGE+M)),t(e)})}).then(function(e){t(e)}).catch(function(e){r(e)})):function(){var n=this;return new Promise(function(e,t){var r=C.getQualityFor(M,D.id);f=(0,pe.default)(b).create(B.bind(n)),re(L(r)).then(function(){e(f)}).catch(function(){t()})})}().then(function(e){t(e)}).catch(function(e){r(e)}):t(null)})}function x(e){O.get().streaming.cacheInitSegments&&(l.info("Init fragment finished loading saving to",M+"'s init cache"),E.save(e.chunk)),l.debug("Append Init fragment",M," with representationId:",e.chunk.representationId," and quality:",e.chunk.quality,", data size:",e.chunk.bytes.byteLength),k(e.chunk)}function j(e){k(e.chunk,e.request)}function k(e,t){t=1<arguments.length&&void 0!==t?t:null;f.append(e,t).then(function(e){B(e)}).catch(function(e){B(e)}),e.mediaInfo.type===de.default.VIDEO&&ce(Ee.default.VIDEO_CHUNK_RECEIVED,{chunk:e})}function U(e){if(e&&0<e.length)for(var t=0,r=e.length;t<r;t++)l.debug("Buffered range: "+e.start(t)+" - "+e.end(t)+", currentTime = ",N.getTime())}function B(e){if(e.error)return 22===e.error.code&&(y=!0,i=.8*se(),l.warn("Quota exceeded, Critical Buffer: "+i),0<i&&(t=Math.max(.2*i,1),n=i-t,r=Math.min(O.get().streaming.buffer.bufferTimeAtTopQuality,.9*n),n=Math.min(O.get().streaming.buffer.bufferTimeAtTopQualityLongForm,.9*n),n={streaming:{buffer:{bufferToKeep:parseFloat(t.toFixed(5)),bufferTimeAtTopQuality:parseFloat(r.toFixed(5)),bufferTimeAtTopQualityLongForm:parseFloat(n.toFixed(5))}}},O.update(n))),void(22!==e.error.code&&ue()||(l.warn("Clearing playback buffer to overcome quota exceed situation"),ce(Ee.default.QUOTA_EXCEEDED,{criticalBufferLevel:i,quotaExceededTime:e.chunk.start}),Z($())));var t,r,n;f&&(z(),y=!1,(h=e.chunk)&&h.endFragment&&(h&&!isNaN(h.index)&&(s=Math.max(h.index,s),W()),n=f.getAllBufferRanges(),h.segmentType===Se.HTTPRequest.MEDIA_SEGMENT_TYPE&&(U(n),H(),function(){if(!isNaN(T)){if(M!==de.default.AUDIO&&M!==de.default.VIDEO)return T=NaN;var e=N.getTime(),t=K(e,0),r=K(T,0);if(t&&r&&t.start===r.start)return T=NaN;t=I.getCurrentRepresentation().segmentDuration,(r=K(T,t))&&(O.get().streaming.buffer.enableSeekDecorrelationFix&&Math.abs(e-T)>t?T<=r.end&&N.seek(Math.max(T,r.start),!1,!0):e<r.start&&N.seek(r.start,!1,!0))}}()),e=!1,d&&(0<d.indexOf(h)&&(e=!0),d=null),h&&!e&&ce(Ee.default.BYTES_APPENDED_END_FRAGMENT,{quality:h.quality,startTime:h.start,index:h.index,bufferedRanges:n,segmentType:h.segmentType,mediaType:M})))}function G(){return new Promise(function(e,t){var r=q();if(!r||0===r.length)return H(),void e();Z(r).then(function(){e()}).catch(function(e){t(e)})})}function q(e){var t,r=[],n=f.getAllBufferRanges();return n&&0!==n.length&&(!e&&0!==e||isNaN(e)?r.push({start:n.start(0),end:n.end(n.length-1)+.5}):(t=function(e,t){var r=O.get().streaming.buffer.bufferToKeep,t=t.start(0);if(r<e-t){r=Math.max(0,e-r),e=R.getRequests({state:he.default.FRAGMENT_MODEL_EXECUTED,time:e,threshold:.01})[0];if(0<(r=e?Math.min(e.startTime,r):r))return{start:t,end:r}}return null}(e,n),n=function(e,t){var r=t.end(t.length-1)+.5,n=le(e),a=D.manifestInfo.duration>=O.get().streaming.buffer.longFormContentDurationThreshold?O.get().streaming.buffer.bufferTimeAtTopQualityLongForm:O.get().streaming.buffer.bufferTimeAtTopQuality,i=isNaN(n)?e:Math.min(n,e+a);if(i>=t.end(t.length-1))return null;a=R.getRequests({state:he.default.FRAGMENT_MODEL_EXECUTED,time:e,threshold:.01})[0];a&&(i=Math.max(a.startTime+a.duration,i));if(O.get().streaming.buffer.avoidCurrentTimeRangePruning)for(var o=0;o<t.length;o++)if(t.start(o)<=e&&e<=t.end(o)&&t.start(o)<=i&&i<=t.end(o)){var s=i;i=o+1<t.length?t.start(o+1):t.end(o)+1,l.debug("Buffered range ["+t.start(o)+", "+t.end(o)+"] overlaps with targetTime "+e+" and range to be pruned ["+s+", "+r+"], using ["+i+", "+r+"] instead"+(i<r?"":" (no actual pruning)"));break}if(i<t.end(t.length-1))return{start:i,end:r};return null}(e,n),t&&r.push(t),n&&r.push(n))),r}function H(){(!v||M===de.default.TEXT&&w.isTextEnabled())&&z()}function Y(){X()}function V(){X(),T=NaN}function K(e,t){var r,n,a,i,o=f.getAllBufferRanges(),s=null,l=null,u=0,c=isNaN(t)?.15:t;if(null!=o){for(i=0,a=o.length;i<a;i++)if(r=o.start(i),n=o.end(i),null===s)u=Math.abs(r-e),(r<=e&&e<n||u<=c)&&(s=r,l=n);else{if(!((u=r-l)<=c))break;l=n}if(null!==s)return{start:s,end:l}}return null}function z(){var e,t;N&&(t=O.get().streaming.gaps.jumpGaps&&!isNaN(O.get().streaming.gaps.smallGapLimit)?O.get().streaming.gaps.smallGapLimit:NaN,a=Math.max((e=N.getTime()||0,t=t,null===(t=K(e,t=O.get().streaming.gaps.jumpGaps?O.get().streaming.gaps.smallGapLimit:t))?0:t.end-e),0),ce(Ee.default.BUFFER_LEVEL_UPDATED,{mediaType:M,bufferLevel:a}),X())}function W(){var e=u-1<=s,t=N.getTimeToStreamEnd(D)-a<1e-5;!e&&!t||n||(oe(!0),l.debug("checkIfBufferingCompleted trigger BUFFERING_COMPLETED for stream id ".concat(D.id," and type ").concat(M)))}function X(){M!==de.default.AUDIO&&M!==de.default.VIDEO||((!N.getLowLatencyModeEnabled()&&a<O.get().streaming.buffer.stallThreshold||0===a)&&!n?Q(ge.default.BUFFER_EMPTY):(n||a>=O.get().streaming.buffer.stallThreshold||N.getLowLatencyModeEnabled()&&0<a)&&Q(ge.default.BUFFER_LOADED))}function Q(e){g===e||e===ge.default.BUFFER_EMPTY&&0===N.getTime()||M===de.default.TEXT&&!w.isTextEnabled()||(g=e,ce(Ee.default.BUFFER_LEVEL_STATE_CHANGED,{state:e}),ce(e===ge.default.BUFFER_LOADED?Ee.default.BUFFER_LOADED:Ee.default.BUFFER_EMPTY),l.debug(e===ge.default.BUFFER_LOADED?"Got enough buffer to start":"Waiting for more buffer before starting playback"))}function J(){f&&M!==de.default.TEXT&&(n||Z($()))}function $(){var e=[],t=f.getAllBufferRanges();if(!t||0===t.length)return e;var r=N.getTime(),n=Math.max(0,r-O.get().streaming.buffer.bufferToKeep),a=R.getRequests({state:he.default.FRAGMENT_MODEL_EXECUTED,time:r,threshold:.01})[0];if(a)n=Math.min(a.startTime,n);else if(0===r&&N.getIsDynamic())return[];if(t.start(0)<=n){for(var i={start:0,end:n},o=0;o<t.length&&t.end(o)<=n;o++)i.end=t.end(o);i.start<i.end&&e.push(i)}return e}function Z(r){return new Promise(function(e,t){var n;r&&f&&0!==r.length?(n=[],r.forEach(function(e){var r;n.push((r=e,new Promise(function(e,t){r.resolve=e,r.reject=t,_.push(r)})))}),p||ee(),Promise.all(n).then(function(){e()}).catch(function(e){t(e)})):e()})}function ee(){try{if(0===_.length||!f)return l.debug("Nothing to prune, halt pruning"),void(p=!(_=[]));var e=f.getBuffer();if(!e||!e.buffered||0===e.buffered.length)return l.debug("SourceBuffer is empty (or does not exist), halt pruning"),void(p=!(_=[]));e=_.shift();l.debug("".concat(M,": Removing buffer from: ").concat(e.start," to ").concat(e.end)),p=!0,N.getTime()<e.end&&oe(!1),f.remove(e).then(function(e){te(e)}).catch(function(e){te(e)})}catch(e){p=!1}}function te(e){l.debug("onRemoved buffer from:",e.from,"to",e.to),U(f.getAllBufferRanges()),0===_.length&&(p=!1,z()),e.unintended&&(l.warn("Detected unintended removal from:",e.from,"to",e.to,"setting streamprocessor time to",e.from),ce(Ee.default.SEEK_TARGET,{time:e.from})),p?ee():(v?v=!1:z(),ce(Ee.default.BUFFER_CLEARED,{from:e.from,to:e.to,unintended:e.unintended,hasEnoughSpaceToAppend:ue(),quotaExceeded:y}))}function re(t){return new Promise(function(e){t&&void 0!==t.MSETimeOffset&&f&&f.updateTimestampOffset?f.updateTimestampOffset(t.MSETimeOffset).then(function(){e()}).catch(function(){e()}):e()})}function ne(){return f&&!n?f.updateAppendWindow(D):Promise.resolve()}function ae(){++m*(O.get().streaming.wallclockTimeUpdateInterval/1e3)>=O.get().streaming.buffer.bufferPruningInterval&&(m=0,J())}function ie(){X()}function oe(e){n!==e&&((n=e)?ce(Ee.default.BUFFERING_COMPLETED):u=Number.POSITIVE_INFINITY)}function se(){try{var e,t,r=f.getAllBufferRanges(),n=0;if(!r)return n;for(t=0,e=r.length;t<e;t++)n+=r.end(t)-r.start(t);return n}catch(e){return 0}}function le(e){try{var t=e,r=f.getAllBufferRanges();if(!r||0===r.length)return NaN;for(var n=0;t===e&&n<r.length;){var a=r.start(n),i=r.end(n);a<=t&&t<=i&&(t=i),n+=1}return t===e?NaN:t}catch(e){}}function ue(){var e=se();return isNaN(e)||e<i}function ce(e,t){t=t||{};S.trigger(e,t,{streamId:D.id,mediaType:M})}function fe(e,t){var r;i=Number.POSITIVE_INFINITY,g=void 0,u=Number.POSITIVE_INFINITY,h=null,y=p=n=!1,m=a=s=0,_=[],T=NaN,f&&(r=f,f=null,e||t||r.abort().then(function(){r.reset(t),r=null})),v=!1}return t={initialize:function(e){P(e),S.on(Ee.default.INIT_FRAGMENT_LOADED,x,t),S.on(Ee.default.MEDIA_FRAGMENT_LOADED,j,t),S.on(Ee.default.WALLCLOCK_TIME_UPDATED,ae,t),S.on(Ae.default.PLAYBACK_PLAYING,V,t),S.on(Ae.default.PLAYBACK_PROGRESS,H,t),S.on(Ae.default.PLAYBACK_TIME_UPDATED,H,t),S.on(Ae.default.PLAYBACK_RATE_CHANGED,ie,t),S.on(Ae.default.PLAYBACK_STALLED,Y,t)},getStreamId:function(){return D.id},getType:function(){return M},getBufferControllerType:function(){return Re},createBufferSink:F,dischargePreBuffer:function(){if(f&&c&&"function"==typeof c.discharge){var e=c.getAllBufferRanges();if(0<e.length){for(var t="Beginning "+M+"PreBuffer discharge, adding buffer for:",r=0;r<e.length;r++)t+=" start: "+e.start(r)+", end: "+e.end(r)+";";l.debug(t)}else l.debug("PreBuffer discharge requested, but there were no media segments in the PreBuffer.");d=[];for(var n=c.discharge(),a=null,i=0;i<n.length;i++){var o,s=n[i];s.segmentType===Se.HTTPRequest.INIT_SEGMENT_TYPE||(o=E.extract(s.streamId,s.representationId))&&a!==o&&(d.push(o),f.append(o),a=o),d.push(s),f.append(s)}c.reset(),c=null}},getBuffer:function(){return f},getBufferLevel:function(){return a},getRangeAt:K,hasBufferAtTime:function(e){try{var t=f.getAllBufferRanges();if(!t||0===t.length)return!1;for(var r=0;r<t.length;){var n=t.start(r),a=t.end(r);if(n<=e&&e<=a)return!0;r+=1}return!1}catch(e){return l.error(e),!1}},pruneBuffer:J,setMediaSource:P,getMediaSource:function(){return o},appendInitSegmentFromCache:function(e){return!!(e=E.extract(D.id,e))&&(l.info("Append Init fragment",M," with representationId:",e.representationId," and quality:",e.quality,", data size:",e.bytes.byteLength),k(e),!0)},getIsBufferingCompleted:function(){return n},setIsBufferingCompleted:oe,getIsPruningInProgress:function(){return p},reset:function(e,t){S.off(Ee.default.INIT_FRAGMENT_LOADED,x,this),S.off(Ee.default.MEDIA_FRAGMENT_LOADED,j,this),S.off(Ee.default.WALLCLOCK_TIME_UPDATED,ae,this),S.off(Ae.default.PLAYBACK_PLAYING,V,this),S.off(Ae.default.PLAYBACK_PROGRESS,H,this),S.off(Ae.default.PLAYBACK_TIME_UPDATED,H,this),S.off(Ae.default.PLAYBACK_RATE_CHANGED,ie,this),S.off(Ae.default.PLAYBACK_STALLED,Y,this),fe(e,t)},prepareForPlaybackSeek:function(){return n&&oe(!1),f.abort()},prepareForReplacementTrackSwitch:function(r){return new Promise(function(e,t){f.abort().then(ne).then(function(){return O.get().streaming.buffer.useChangeTypeForTrackSwitch?f.changeType(r):Promise.resolve()}).then(G).then(function(){oe(!1),e()}).catch(function(e){t(e)})})},prepareForNonReplacementTrackSwitch:function(r){return new Promise(function(e,t){ne().then(function(){return O.get().streaming.buffer.useChangeTypeForTrackSwitch?f.changeType(r):Promise.resolve()}).then(function(){e()}).catch(function(e){t(e)})})},prepareForReplacementQualitySwitch:function(){return new Promise(function(e,t){f.abort().then(ne).then(G).then(function(){oe(!1),e()}).catch(function(e){t(e)})})},updateAppendWindow:ne,getAllRangesWithSafetyFactor:q,getContinuousBufferTimeForTargetTime:le,clearBuffers:Z,pruneAllSafely:G,updateBufferTimestampOffset:re,setSeekTarget:function(e){T=e},segmentRequestingCompleted:function(e){isNaN(e)||(u=e,W())}},l=(0,_e.default)(b).getInstance().getLogger(t),E=(0,ve.default)(b).getInstance(),fe(),t}n.__dashjs_factory_name=Re;const a=t.default.getClassFactory(n)},"./src/streaming/controllers/CatchupController.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>a});var t=r("./src/core/FactoryMaker.js"),T=r("./src/core/Debug.js"),b=r("./src/core/EventBus.js"),S=r("./src/streaming/constants/Constants.js"),A=r("./src/streaming/MediaPlayerEvents.js"),R=r("./src/core/events/Events.js"),I=r("./src/streaming/constants/MetricsConstants.js"),w=r("./src/core/Utils.js");function n(){var e,o,s,l,u,t,c,f,d,g,r=this.context,n=(0,b.default)(r).getInstance();function a(){o=!1;var e=w.default.parseUserAgent();s=e&&e.browser&&e.browser.name&&"safari"===e.browser.name.toLowerCase()}function i(){o=!1}function h(e){e.streamId===t.getActiveStreamInfo().id&&d&&c.getLiveDelay()/2<c.getBufferLevel()&&(d=!1)}function m(e){e.streamId===t.getActiveStreamInfo().id&&(d=e.state===I.default.BUFFER_EMPTY)}function p(){f.getCatchupModeEnabled()||l.setPlaybackRate(1)}function y(){var e,t,r,n,a,i;c.getIsDynamic()&&f.getCatchupModeEnabled()&&(0<f.getCatchupPlaybackRates().max||f.getCatchupPlaybackRates().min<0)&&!c.isPaused()&&!c.isSeeking()&&function(){try{if(0<!c.getTime()||o)return!1;if(_()!==S.default.LIVE_CATCHUP_MODE_LOLP)return function(){try{return 0<Math.abs(E())}catch(e){return!1}}();var e=c.getBufferLevel(),t=u.get().streaming.liveCatchup.playbackBufferMin;return function(e,t){try{return 0<Math.abs(E())||e<t}catch(e){return!1}}(e,t)}catch(e){return!1}}()&&(o||l&&(e=l.getPlaybackRate(),i=f.getCatchupPlaybackRates(),t=c.getBufferLevel(),a=E(),n=f.getCatchupMaxDrift(),!isNaN(n)&&0<n&&n<a?(g.info("[CatchupController]: Low Latency catchup mechanism. Latency too high, doing a seek to live point"),o=!0,c.seekToCurrentLive(!0,!1)):(r=c.getCurrentLiveLatency(),n=c.getLiveDelay(),t=_()===S.default.LIVE_CATCHUP_MODE_LOLP?(a=u.get().streaming.liveCatchup.playbackBufferMin,function(e,t,r,n,a){{var i,o;a<n?(i=Math.abs(e.min),o=5*(a-n),o=2*i/(1+Math.pow(Math.E,-o)),o=1-i+o,g.debug("[LoL+ playback control_buffer-based] bufferLevel: "+a+", newRate: "+o)):(e=e.max,o=Math.abs(t-r)<=.02*r?1:(r=5*(t-r),r=2*e/(1+Math.pow(Math.E,-r)),1-e+r),g.debug("[LoL+ playback control_latency-based] latency: "+t+", newRate: "+o))}return o}(i,r,n,a,t)):function(e,t,r,n){if(d)return 1;var a=t-r,t=a<0?Math.abs(e.min):e.max,e=5*a,e=2*t/(1+Math.pow(Math.E,-e)),e=1-t+e;c.getPlaybackStalled()&&n<=r/2&&0<a&&(e=1);return e}(i,r,n,t),i=s?.25:.02/(.5/i.max),t&&Math.abs(e-t)>=i&&(g.debug("[CatchupController]: Setting playback rate to ".concat(t)),l.setPlaybackRate(t)))))}function E(){return c.getCurrentLiveLatency()-c.getLiveDelay()}function _(){var e=u.get().streaming.liveCatchup.playbackBufferMin;return u.get().streaming.liveCatchup.mode!==S.default.LIVE_CATCHUP_MODE_LOLP||null===e||isNaN(e)?S.default.LIVE_CATCHUP_MODE_DEFAULT:S.default.LIVE_CATCHUP_MODE_LOLP}function v(){f.getCatchupPlaybackRates(!0)}return e={reset:function(){n.off(A.default.BUFFER_LEVEL_UPDATED,h,e),n.off(A.default.BUFFER_LEVEL_STATE_CHANGED,m,e),n.off(A.default.PLAYBACK_PROGRESS,y,e),n.off(A.default.PLAYBACK_TIME_UPDATED,y,e),n.off(A.default.PLAYBACK_SEEKED,y,e),n.off(R.default.SETTING_UPDATED_CATCHUP_ENABLED,p,e),n.off(R.default.SETTING_UPDATED_PLAYBACK_RATE_MIN,v,e),n.off(R.default.SETTING_UPDATED_PLAYBACK_RATE_MAX,v,e),n.off(A.default.STREAM_INITIALIZED,v,e),a(),l.setPlaybackRate(1,!0)},setConfig:function(e){e&&(e.settings&&(u=e.settings),e.videoModel&&(l=e.videoModel),e.streamController&&(t=e.streamController),e.playbackController&&(c=e.playbackController),e.mediaPlayerModel&&(f=e.mediaPlayerModel))},initialize:function(){n.on(A.default.BUFFER_LEVEL_UPDATED,h,e),n.on(A.default.BUFFER_LEVEL_STATE_CHANGED,m,e),n.on(A.default.PLAYBACK_PROGRESS,y,e),n.on(A.default.PLAYBACK_TIME_UPDATED,y,e),n.on(A.default.PLAYBACK_SEEKED,i,e),n.on(R.default.SETTING_UPDATED_CATCHUP_ENABLED,p,e),n.on(R.default.SETTING_UPDATED_PLAYBACK_RATE_MIN,v,e),n.on(R.default.SETTING_UPDATED_PLAYBACK_RATE_MAX,v,e),n.on(A.default.STREAM_INITIALIZED,v,e),v()}},g=(0,T.default)(r).getInstance().getLogger(e),a(),e}n.__dashjs_factory_name="CatchupController";const a=t.default.getSingletonFactory(n)},"./src/streaming/controllers/EventController.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>a});var t=r("./src/core/FactoryMaker.js"),D=r("./src/core/Debug.js"),M=r("./src/core/EventBus.js"),O=r("./src/streaming/MediaPlayerEvents.js"),P=r("./src/streaming/net/XHRLoader.js");function n(){var e,s,i,a,t,r,o,l,n,u,c,f="urn:mpeg:dash:event:2012",d=1,g="urn:mpeg:dash:event:callback:2015",h=1,m=300,p={DISCARDED:"discarded",UPDATED:"updated",ADDED:"added"},y=this.context,E=(0,M.default)(y).getInstance();function _(){if(!o||!l)throw new Error("setConfig function has to be called previously")}function v(){c=!1,i={},t=null,u=!(a={}),r=Date.now()/1e3}function T(){try{null!==t&&c&&(clearInterval(t),t=null,c=!1,function(){try{I(a),I(i)}catch(e){s.error(e)}}())}catch(e){throw e}}function b(){try{var e,t;u||(u=!0,t=(e=l.getTime())-r,t=0<r?Math.max(0,t):0,S(a,t,e),S(i,t,e),A(a),A(i),r=e,u=!1)}catch(e){u=!1,s.error(e)}}function S(r,n,a){try{w(r,function(e){var t;void 0!==e&&(t=isNaN(e.duration)?0:e.duration,e.calculatedPresentationTime<=a&&e.calculatedPresentationTime+n+t>=a?N(e,O.default.EVENT_MODE_ON_START):(C(a,t+n,e.calculatedPresentationTime)||function(e){try{var t=e.eventStream.period.start+e.eventStream.period.duration;return e.calculatedPresentationTime>t}catch(e){return s.error(e),!1}}(e))&&(s.debug("Removing event ".concat(e.id," from period ").concat(e.eventStream.period.id," as it is expired or invalid")),function(e,t){try{var r=t.eventStream.schemeIdUri,n=t.eventStream.period.id,a=t.eventStream.value,i=t.id;e[n][r]=e[n][r].filter(function(e){return a&&e.eventStream.value&&e.eventStream.value!==a||e.id!==i}),0===e[n][r].length&&delete e[n][r]}catch(e){s.error(e)}}(r,e)))})}catch(e){s.error(e)}}function A(e){try{for(var t in e)e.hasOwnProperty(t)&&0===Object.keys(e[t]).length&&delete e[t]}catch(e){s.error(e)}}function R(e,t,r){var n=2<arguments.length&&void 0!==r&&r,a=e.eventStream.schemeIdUri,i=e.eventStream.value,o=e.id,s=p.DISCARDED;t[a]||(t[a]=[]);r=t[a].findIndex(function(e){return(!i||e.eventStream.value&&e.eventStream.value===i)&&e.id===o});return-1===r?(t[a].push(e),e.triggeredReceivedEvent=!1,e.triggeredStartEvent=!1,s=p.ADDED):n&&(n=t[a][r],e.triggeredReceivedEvent=n.triggeredReceivedEvent,e.triggeredStartEvent=n.triggeredStartEvent,t[a][r]=e,s=p.UPDATED),s}function I(e){try{var n=l.getTime();w(e,function(e){var t=e.eventStream&&e.eventStream.period&&!isNaN(e.eventStream.period.duration)?e.eventStream.period.duration:NaN,r=e.eventStream&&e.eventStream.period&&!isNaN(e.eventStream.period.start)?e.eventStream.period.start:NaN;isNaN(t)||isNaN(r)||(r=e.calculatedPresentationTime,Math.abs(r-n)<m&&N(e,O.default.EVENT_MODE_ON_START))})}catch(e){s.error(e)}}function w(e,t){try{if(e)for(var r=Object.keys(e),n=0;n<r.length;n++)for(var a=e[r[n]],i=Object.keys(a),o=0;o<i.length;o++)a[i[o]].forEach(function(e){void 0!==e&&t(e)})}catch(e){s.error(e)}}function C(e,t,r){try{return r<e-t}catch(e){return void s.error(e)}}function N(e,t){try{var r=l.getTime(),n=e.id;if(t===O.default.EVENT_MODE_ON_RECEIVE&&!e.triggeredReceivedEvent)return s.debug("Received event ".concat(n)),e.triggeredReceivedEvent=!0,void E.trigger(e.eventStream.schemeIdUri,{event:e},{mode:t});e.triggeredStartEvent||(e.eventStream.schemeIdUri===f&&e.eventStream.value==d?0===e.duration&&0===e.presentationTimeDelta||(s.debug("Starting manifest refresh event ".concat(n," at ").concat(r)),function(){try{_(),o.refreshManifest()}catch(e){s.error(e)}}()):e.eventStream.schemeIdUri===g&&e.eventStream.value==h?(s.debug("Starting callback event ".concat(n," at ").concat(r)),function(e){try{(0,P.default)(y).create({}).load({method:"get",url:e,request:{responseType:"arraybuffer"}})}catch(e){s.error(e)}}(e.messageData)):(s.debug("Starting event ".concat(n," from period ").concat(e.eventStream.period.id," at ").concat(r)),E.trigger(e.eventStream.schemeIdUri,{event:e},{mode:t})),e.triggeredStartEvent=!0)}catch(e){s.error(e)}}return e={addInlineEvents:function(e,t){try{if(_(),i[t]||(i[t]={}),e)for(var r=0;r<e.length;r++){var n,a=e[r];C(l.getTime(),isNaN(a.duration)?0:a.duration,a.calculatedPresentationTime)||((n=R(a,i[t],!0))===p.ADDED?(s.debug("Added inline event with id ".concat(a.id," from period ").concat(t)),N(a,O.default.EVENT_MODE_ON_RECEIVE)):n===p.UPDATED&&s.debug("Updated inline event with id ".concat(a.id," from period ").concat(t)))}}catch(e){throw e}},addInbandEvents:function(e,t){try{_(),a[t]||(a[t]={});for(var r=0;r<e.length;r++){var n=e[r];C(l.getTime(),isNaN(n.duration)?0:n.duration,n.calculatedPresentationTime)||(R(n,a[t],!1)===p.ADDED?(n.eventStream.schemeIdUri===f&&function(e){try{var t,r;e.eventStream.value==d&&(t=e.calculatedPresentationTime,r=4294967295==e.calculatedPresentationTime?NaN:e.calculatedPresentationTime+e.duration,E.trigger(O.default.MANIFEST_VALIDITY_CHANGED,{id:e.id,validUntil:t,newDuration:r,newManifestValidAfter:NaN},{mode:O.default.EVENT_MODE_ON_START}))}catch(e){s.error(e)}}(n),s.debug("Added inband event with id ".concat(n.id," from period ").concat(t)),N(n,O.default.EVENT_MODE_ON_RECEIVE)):s.debug("Inband event with scheme_id_uri ".concat(n.eventStream.schemeIdUri,", value ").concat(n.eventStream.value,", period id ").concat(t," and event id ").concat(n.id," was ignored because it has been added before.")))}b()}catch(e){throw e}},getInbandEvents:function(){return a},getInlineEvents:function(){return i},start:function(){try{_(),s.debug("Start Event Controller");var e=n.get().streaming.eventControllerRefreshDelay;c||isNaN(e)||(c=!0,t=setInterval(b,e))}catch(e){throw e}},setConfig:function(e){try{if(!e)return;e.manifestUpdater&&(o=e.manifestUpdater),e.playbackController&&(l=e.playbackController),e.settings&&(n=e.settings)}catch(e){throw e}},reset:function(){T(),v()}},s=(0,D.default)(y).getInstance().getLogger(e),v(),e}n.__dashjs_factory_name="EventController";const a=t.default.getSingletonFactory(n)},"./src/streaming/controllers/FragmentController.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>a});var m=r("./src/streaming/constants/Constants.js"),p=r("./src/streaming/vo/DataChunk.js"),y=r("./src/streaming/models/FragmentModel.js"),E=r("./src/streaming/FragmentLoader.js"),_=r("./src/streaming/utils/RequestModifier.js"),v=r("./src/core/EventBus.js"),T=r("./src/core/events/Events.js"),b=r("./src/streaming/MediaPlayerEvents.js"),S=r("./src/core/errors/Errors.js"),t=r("./src/core/FactoryMaker.js"),A=r("./src/core/Debug.js"),R=r("./src/streaming/utils/SegmentResponseModifier.js");function n(r){r=r||{};var e,u,n,a=this.context,c=(0,v.default)(a).getInstance(),i=r.errHandler,o=r.mediaPlayerModel,s=r.dashMetrics,l=(0,A.default)(a).getInstance(),f=(0,R.default)(a).getInstance(),d=r.streamInfo;function g(){return d.id}function t(){for(var e in n)n[e].reset();n={}}function h(e){var t,r,n,a,i,o,s,l;e.sender&&(t=e.request,l=e.response,r=t.isInitializationRequest(),n=t.mediaInfo.streamInfo,e.error&&(t.mediaType===m.default.AUDIO||t.mediaType===m.default.VIDEO||t.mediaType===m.default.TEXT&&t.mediaInfo.isFragmented)&&c.trigger(T.default.SERVICE_LOCATION_BLACKLIST_ADD,{entry:e.request.serviceLocation}),l&&n?(i=l,o=t,s=d.id,l=e.type!==T.default.FRAGMENT_LOADING_PROGRESS,(e=new p.default).streamId=s,e.mediaInfo=o.mediaInfo,e.segmentType=o.type,e.start=o.startTime,e.duration=o.duration,e.end=e.start+e.duration,e.bytes=i,e.index=o.index,e.quality=o.quality,e.representationId=o.representationId,e.endFragment=l,a=e,f.modifyResponseAsync(a).then(function(e){c.trigger(r?T.default.INIT_FRAGMENT_LOADED:T.default.MEDIA_FRAGMENT_LOADED,{chunk:e,request:t},{streamId:n.id,mediaType:t.mediaType})}).catch(function(e){u.error(e),c.trigger(r?T.default.INIT_FRAGMENT_LOADED:T.default.MEDIA_FRAGMENT_LOADED,{chunk:a,request:t},{streamId:n.id,mediaType:t.mediaType})})):u.warn("No "+t.mediaType+" bytes to push or stream is inactive."))}return e={getStreamId:g,getModel:function(e){var t=n[e];return t||(t=(0,y.default)(a).create({streamInfo:d,type:e,dashMetrics:s,fragmentLoader:(0,E.default)(a).create({dashMetrics:s,mediaPlayerModel:o,errHandler:i,requestModifier:(0,_.default)(a).getInstance(),settings:r.settings,boxParser:r.boxParser,eventBus:c,events:T.default,errors:S.default,dashConstants:r.dashConstants,urlUtils:r.urlUtils,streamId:g()}),debug:l,eventBus:c,events:T.default}),n[e]=t),t},reset:function(){c.off(b.default.FRAGMENT_LOADING_COMPLETED,h,this),c.off(b.default.FRAGMENT_LOADING_PROGRESS,h,this),t()}},u=l.getLogger(e),t(),c.on(b.default.FRAGMENT_LOADING_COMPLETED,h,e),c.on(b.default.FRAGMENT_LOADING_PROGRESS,h,e),e}n.__dashjs_factory_name="FragmentController";const a=t.default.getClassFactory(n)},"./src/streaming/controllers/GapController.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>a});var t=r("./src/core/FactoryMaker.js"),b=r("./src/core/Debug.js"),S=r("./src/core/events/Events.js"),A=r("./src/core/EventBus.js"),R=r("./src/streaming/constants/Constants.js");function n(){var e,t,h,r,n,m,p,y,E,_,a,v,i=this.context,o=(0,A.default)(i).getInstance();function s(){v.debug("Stopping the gap controller"),n&&(clearInterval(n),n=null),function(){o.off(S.default.WALLCLOCK_TIME_UPDATED,d,this),o.off(S.default.INITIAL_STREAM_SWITCH,f,this),o.off(S.default.PLAYBACK_SEEKING,l,this),o.off(S.default.BUFFER_REPLACEMENT_STARTED,u,e),o.off(S.default.TRACK_CHANGE_RENDERED,c,e)}(),m=NaN,r=0,_=n=null,a={}}function l(){_&&(clearTimeout(_),_=null)}function u(e){try{if(e.streamId!==y.getActiveStreamInfo().id||e.mediaType!==R.default.VIDEO&&e.mediaType!==R.default.AUDIO)return;e.streamId===y.getActiveStreamInfo().id&&(a[e.mediaType]=!0)}catch(e){v.error(e)}}function c(e){e&&e.mediaType&&(a[e.mediaType]=!1)}function f(){n||function(){try{n||(v.debug("Starting the gap controller"),n=setInterval(function(){g()&&T(p.getTime())},100))}catch(e){}}()}function d(){var e;g(h.get().streaming.gaps.enableSeekFix)&&10<=++r&&(e=p.getTime(),t===e?T(e,!0):(t=e,m=NaN),r=0)}function g(e){var t=0<arguments.length&&void 0!==e&&e;if(y.getActiveStream()){var r,e=Object.keys(a).some(function(e){return a[e]}),r=!!t&&(r=y.getActiveStream(),r=parseFloat((r.getStartTime()+r.getDuration()).toFixed(5)),p.getTime()+h.get().streaming.gaps.threshold>=r);return!e&&h.get().streaming.gaps.jumpGaps&&0<y.getActiveStreamProcessors().length&&(!p.isSeeking()||r)&&!p.isPaused()&&!y.getIsStreamSwitchInProgress()&&!y.getHasMediaOrInitialisationError()}}function T(e,t){var r=1<arguments.length&&void 0!==t&&t,n=h.get().streaming.gaps.enableStallFix,a=h.get().streaming.gaps.stallSeek,i=h.get().streaming.gaps.smallGapLimit,o=h.get().streaming.gaps.jumpLargeGaps,s=E.getBufferRange(),l=NaN,u=!1,c=function(e,t){try{if(!e||e.length<=1&&0<t)return NaN;for(var r=NaN,n=0;isNaN(r)&&n<e.length;){var a=0<n?e.end(n-1):0;t<e.start(n)&&a-t<h.get().streaming.gaps.threshold&&(r=n),n+=1}return r}catch(e){return null}}(s,e);isNaN(c)||0<(t=(g=s.start(c))-e)&&(t<=i||o)&&(l=g);var f,d,g=p.getTimeToStreamEnd();isNaN(l)&&r&&isFinite(g)&&!isNaN(g)&&g<i&&(l=parseFloat(p.getStreamEndTime().toFixed(5)),u=!0),n&&isNaN(l)&&r&&isNaN(c)&&function(e,t){for(var r=0,n=e.length;r<n;r++)if(t>=e.start(r)&&t<=e.end(r))return 1}(s,e)&&(0===a?(v.warn("Toggle play pause to break stall"),E.pause(),E.play()):(v.warn("Jumping ".concat(a,"s to break stall")),l=e+a)),0<l&&m!==l&&e<l&&!_&&(a=l-e,u?(f=(f=y.getStreamForTime(l))&&!!f.getPreloaded(),v.warn("Jumping to end of stream because of gap from ".concat(e," to ").concat(l,". Gap duration: ").concat(a)),p.seek(l,!0,f)):(f=p.getIsDynamic(),d=0<c?s.end(c-1):e,a=f?1e3*Math.max(0,a-.1):0,_=window.setTimeout(function(){p.seek(l,!0,!0),v.warn("Jumping gap occuring in period ".concat(y.getActiveStream().getStreamId()," starting at ").concat(d," and ending at ").concat(l,". Jumping by: ").concat(l-d)),_=null},a)),m=l)}return e={reset:s,setConfig:function(e){e&&(e.settings&&(h=e.settings),e.playbackController&&(p=e.playbackController),e.streamController&&(y=e.streamController),e.videoModel&&(E=e.videoModel))},initialize:function(){!function(){o.on(S.default.WALLCLOCK_TIME_UPDATED,d,this),o.on(S.default.INITIAL_STREAM_SWITCH,f,this),o.on(S.default.PLAYBACK_SEEKING,l,this),o.on(S.default.BUFFER_REPLACEMENT_STARTED,u,e),o.on(S.default.TRACK_CHANGE_RENDERED,c,e)}()}},v=(0,b.default)(i).getInstance().getLogger(e),s(),e}n.__dashjs_factory_name="GapController";const a=t.default.getSingletonFactory(n)},"./src/streaming/controllers/MediaController.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>i});var C=r("./src/streaming/constants/Constants.js"),N=r("./src/core/events/Events.js"),D=r("./src/core/EventBus.js"),n=r("./src/core/FactoryMaker.js"),M=r("./src/core/Debug.js"),t=r("./node_modules/bcp-47-normalize/index.js"),O=r.n(t),P=r("./node_modules/bcp-47-match/index.js");function a(){var e,a,o,i,r,s,l,u,t=this.context,c=(0,D.default)(t).getInstance();function f(e,t){return e&&o[t]&&o[t][e]?o[t][e].list:[]}function d(e,t){return e&&o[t]&&o[t][e]?o[t][e].current:null}function g(e){var t,r,n,a=1<arguments.length&&void 0!==arguments[1]&&arguments[1];e&&e.streamInfo&&(n=d(t=e.type,r=e.streamInfo.id),o[r]&&o[r][t]&&(o[r][t].current=e,o[r][t].current&&(t!==C.default.TEXT&&!p(e,n)||t===C.default.TEXT&&e.isFragmented)&&c.trigger(N.default.CURRENT_TRACK_CHANGED,{oldMediaInfo:n,newMediaInfo:e,switchMode:i.get().streaming.trackSwitchMode[t]},{streamId:r}),a||(e=function(e){e={lang:e.lang,viewpoint:e.viewpoint,roles:e.roles,accessibility:e.accessibility,audioChannelConfiguration:e.audioChannelConfiguration};return e.lang||e.viewpoint||e.role&&0<e.role.length||e.accessibility&&0<e.accessibility.length||e.audioChannelConfiguration&&0<e.audioChannelConfiguration.length?e:null}(e))&&o[r][t].storeLastSettings&&(e.roles&&(e.role=e.roles[0],delete e.roles),e.accessibility&&(e.accessibility=e.accessibility[0]),e.audioChannelConfiguration&&(e.audioChannelConfiguration=e.audioChannelConfiguration[0]),s[t]=e,u.setSavedMediaSettings(t,e))))}function h(e,t){e&&t&&(r[e]=t)}function m(e){return e?r[e]:null}function p(e,t){if(!e&&!t)return!0;if(!e||!t)return!1;var r=e.id===t.id,n=e.viewpoint===t.viewpoint,a=e.lang===t.lang,i=e.codec===t.codec,o=e.roles.toString()===t.roles.toString(),s=e.accessibility.toString()===t.accessibility.toString(),t=e.audioChannelConfiguration.toString()===t.audioChannelConfiguration.toString();return r&&i&&n&&a&&o&&s&&t}function n(){o={},s={},r={audio:null,video:null,text:null}}function y(e,t,r){var n=[];return e.forEach(function(e){t(r,e)&&n.push(e)}),0!==n.length?n:e}function E(e,t){return!e.lang||e.lang instanceof RegExp?t.lang.match(e.lang):""!==t.lang&&0<(0,P.extendedFilter)(t.lang,O()(e.lang)).length}function _(e,t){return void 0===e.index||null===e.index||t.index===e.index}function v(e,t){return!e.viewpoint||e.viewpoint===t.viewpoint}function T(t,e){var r=2<arguments.length&&void 0!==arguments[2]&&arguments[2];return!t.role||!!e.roles.filter(function(e){return e===t.role})[0]||e.type===C.default.AUDIO&&r}function b(t,e){e=t.accessibility?!!e.accessibility.filter(function(e){return e===t.accessibility})[0]:!e.accessibility.length;return e}function S(t,e){return!t.audioChannelConfiguration||!!e.audioChannelConfiguration.filter(function(e){return e===t.audioChannelConfiguration})[0]}function A(e){var t,r=0,n=[];return e.forEach(function(e){t=Math.max.apply(Math,e.bitrateList.map(function(e){return e.bandwidth})),r<t?(r=t,n=[e]):t===r&&n.push(e)}),n}function R(e){var r,n=1/0,a=[];return e.forEach(function(e){var t=e.bitrateList.reduce(function(e,t){var r=Math.max(1,t.width*t.height);return e+t.bandwidth/r},0);(r=t/e.bitrateList.length)<n?(n=r,a=[e]):r===n&&a.push(e)}),a}function I(e){var t,r=0,n=[];return e.forEach(function(e){t=e.representationCount,r<t?(r=t,n=[e]):t===r&&n.push(e)}),n}function w(e,t){if(e===C.default.TEXT)return t[0];var r,n=i.get().streaming.selectionModeForInitialTrack,e=l.getCustomInitialTrackSelectionFunction();if(e&&"function"==typeof e)r=e(t);else switch(n){case C.default.TRACK_SELECTION_MODE_HIGHEST_SELECTION_PRIORITY:r=function(e){e=function(e){var t=0,r=[];return e.forEach(function(e){isNaN(e.selectionPriority)||(e.selectionPriority>t?(t=e.selectionPriority,r=[e]):e.selectionPriority===t&&r.push(e))}),r}(e);1<e.length&&(e=A(e));1<e.length&&(e=I(e));return e}(t);break;case C.default.TRACK_SELECTION_MODE_HIGHEST_BITRATE:r=function(e){e=A(e);1<e.length&&(e=I(e));return e}(t);break;case C.default.TRACK_SELECTION_MODE_FIRST_TRACK:r=t[0];break;case C.default.TRACK_SELECTION_MODE_HIGHEST_EFFICIENCY:r=function(e){e=R(e);1<e.length&&(e=A(e));return e}(t);break;case C.default.TRACK_SELECTION_MODE_WIDEST_RANGE:r=function(e){var t=I(e);1<t.length&&(t=A(e));return t}(t);break;default:a.warn("Track selection mode ".concat(n," is not supported. Falling back to TRACK_SELECTION_MODE_FIRST_TRACK")),r=t[0]}return(0<r.length?r:t)[0]}return e={setInitialMediaSettingsForType:function(e,t){var r=s[e]||m(e),n=f(e,t.id),t=[];r||h(e,r=u.getSavedMediaSettings(e)),n&&0!==n.length&&(r&&(t=y(t=Array.from(n),E,r),t=y(t,_,r),t=y(t,v,r),e===C.default.AUDIO&&s[e]||(t=y(t,T,r)),t=y(t,b,r),t=y(t,S,r)),0===t.length?g(w(e,n),!0):1<t.length?g(w(e,t,s[e])):g(t[0]))},addTrack:function(e){if(e){var t=e.type;if((r=t)===C.default.AUDIO||r===C.default.VIDEO||r===C.default.TEXT||r===C.default.IMAGE){var r=e.streamInfo.id;o[r]||(o[r]={audio:{list:[],storeLastSettings:!0,current:null},video:{list:[],storeLastSettings:!0,current:null},text:{list:[],storeLastSettings:!0,current:null},image:{list:[],storeLastSettings:!0,current:null}});for(var n=o[r][t].list,a=0,i=n.length;a<i;++a)if(p(n[a],e))return;n.push(e)}}},getTracksFor:f,getCurrentTrackFor:d,isCurrentTrack:function(e){if(!e)return!1;var t=e.type,r=e.streamInfo.id;return o[r]&&o[r][t]&&p(o[r][t].current,e)},setTrack:g,selectInitialTrack:w,setInitialSettings:h,getInitialSettings:m,getTracksWithHighestBitrate:A,getTracksWithHighestEfficiency:R,getTracksWithWidestRange:I,isTracksEqual:p,matchSettings:function(t,e){var r=2<arguments.length&&void 0!==arguments[2]&&arguments[2];try{var n=!1;t.lang?t.lang instanceof RegExp?n=e.lang.match(t.lang):""===e.lang||(l=O()(t.lang))&&(n=0<(0,P.extendedFilter)(e.lang,l).length):n=!0;var a=void 0===t.index||null===t.index||e.index===t.index,i=!t.viewpoint||t.viewpoint===e.viewpoint,o=!t.role||!!e.roles.filter(function(e){return e===t.role})[0],s=!t.accessibility||!!e.accessibility.filter(function(e){return e===t.accessibility})[0],l=!t.audioChannelConfiguration||!!e.audioChannelConfiguration.filter(function(e){return e===t.audioChannelConfiguration})[0];return n&&a&&i&&(o||e.type===C.default.AUDIO&&r)&&s&&l}catch(e){return!1}},matchSettingsLang:E,matchSettingsIndex:_,matchSettingsViewPoint:v,matchSettingsRole:T,matchSettingsAccessibility:b,matchSettingsAudioChannelConfig:S,saveTextSettingsDisabled:function(){u.setSavedMediaSettings(C.default.TEXT,null)},setConfig:function(e){e&&(e.domStorage&&(u=e.domStorage),e.settings&&(i=e.settings),e.customParametersModel&&(l=e.customParametersModel))},reset:n},a=(0,M.default)(t).getInstance().getLogger(e),n(),e}a.__dashjs_factory_name="MediaController";r=n.default.getSingletonFactory(a);n.default.updateSingletonFactory(a.__dashjs_factory_name,r);const i=r},"./src/streaming/controllers/MediaSourceController.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>a});var t=r("./src/core/FactoryMaker.js"),i=r("./src/core/Debug.js");function n(){var e,r,n,t=this.context;function a(e){r&&"open"===r.readyState&&(null===e&&isNaN(e)||r.duration!==e&&(!function(e){for(var t=e.sourceBuffers,r=0;r<t.length;r++)if(t[r].updating)return!0;return!1}(r)?(n.info("Set MediaSource duration:"+e),r.duration=e):setTimeout(a.bind(null,e),50)))}return e={createMediaSource:function(){var e="WebKitMediaSource"in window;return"MediaSource"in window?r=new MediaSource:e&&(r=new WebKitMediaSource),r},attachMediaSource:function(e){var t=window.URL.createObjectURL(r);return e.setSource(t),t},detachMediaSource:function(e){e.setSource(null)},setDuration:a,setSeekable:function(e,t){r&&"function"==typeof r.setLiveSeekableRange&&"function"==typeof r.clearLiveSeekableRange&&"open"===r.readyState&&0<=e&&e<t&&(r.clearLiveSeekableRange(),r.setLiveSeekableRange(e,t))},signalEndOfStream:function(e){if(e&&"open"===e.readyState){for(var t=e.sourceBuffers,r=0;r<t.length;r++){if(t[r].updating)return;if(0===t[r].buffered.length)return}n.info("call to mediaSource endOfStream"),e.endOfStream()}}},n=(0,i.default)(t).getInstance().getLogger(e),e}n.__dashjs_factory_name="MediaSourceController";const a=t.default.getSingletonFactory(n)},"./src/streaming/controllers/PlaybackController.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>a});var me=r("./src/streaming/constants/Constants.js"),pe=r("./src/core/EventBus.js"),ye=r("./src/core/events/Events.js"),t=r("./src/core/FactoryMaker.js"),Ee=r("./src/core/Debug.js"),_e=r("./src/streaming/MediaPlayerEvents.js"),ve=r("./src/streaming/constants/MetricsConstants.js");function n(){var r,a,n,i,o,s,l,u,t,c,f,d,g,h,m,p,y,E,_,v,T,b,S,A,e=this.context,R=(0,pe.default)(e).getInstance();function I(){D(),p=f=c=0,S=E=!(y=!(b=h=!1)),_=NaN,l&&(R.off(ye.default.DATA_UPDATE_COMPLETED,Y,r),R.off(ye.default.LOADING_PROGRESS,ue,r),R.off(ye.default.MANIFEST_UPDATED,ge,r),R.off(ye.default.STREAMS_COMPOSED,he,r),R.off(_e.default.PLAYBACK_ENDED,se,r),R.off(_e.default.STREAM_INITIALIZING,fe,r),R.off(_e.default.REPRESENTATION_SWITCH,de,r),R.off(_e.default.BUFFER_LEVEL_STATE_CHANGED,z,r),H(),l.removeEventListener("canplay",V),l.removeEventListener("canplaythrough",K),l.removeEventListener("play",W),l.removeEventListener("waiting",X),l.removeEventListener("playing",Q),l.removeEventListener("pause",J),l.removeEventListener("error",le),l.removeEventListener("seeking",$),l.removeEventListener("seeked",Z),l.removeEventListener("timeupdate",ee),l.removeEventListener("progress",te),l.removeEventListener("ratechange",re),l.removeEventListener("loadedmetadata",ne),l.removeEventListener("loadeddata",ae),l.removeEventListener("stalled",ce),l.removeEventListener("ended",ie),l.removeEventListener("volumechange",oe)),g=d=l=t=null}function w(){return parseFloat((C(0<arguments.length&&void 0!==arguments[0]?arguments[0]:null)-L()).toFixed(5))}function C(e){e=e||d;return e.start+e.duration}function N(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0];d&&l&&l.getElement()?(e&&g&&P(L()),l.play()):h=!0}function D(){d&&l&&l.pause()}function M(e){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1],r=2<arguments.length&&void 0!==arguments[2]&&arguments[2],n=3<arguments.length&&void 0!==arguments[3]&&arguments[3];d&&l&&e!==(isNaN(_)?l.getTime():_)&&((v=!0===r)||(_=e),a.info("Requesting seek to time: "+e+(v?" (internal)":"")),g&&n&&P(e),l.setCurrentTime(e,t))}function O(){if(d&&l&&g){var e=n&&n.hasVideoTrack()?me.default.VIDEO:me.default.AUDIO,e=o.getCurrentDVRInfo(e);return e&&e.range?e.range.end:0}}function P(e){var t=new Date(u.getClientReferenceTime()),r=s.getRegularPeriods()[0],r=u.calcPresentationTimeFromWallTime(t,r);c=r-e}function L(){return d&&l?l.getTime():null}function F(){return d&&l?l.isPaused():null}function x(){return d&&l?l.isSeeking():null}function j(){return d&&l?l.isStalled():null}function k(){return d&&l?l.getPlaybackRate():null}function U(){return d&&l?l.getEnded():null}function B(){return g}function G(){var e,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null;F()||!g||0===l.getReadyState()||x()||b||(t=t||(n.hasVideoTrack()?me.default.VIDEO:me.default.AUDIO),t=function(e,t){t=o.getCurrentDVRInfo(t),t=t?t.range:null;if(!t)return NaN;e=e>t.end?Math.max(t.end-c,t.start):0<e&&e+.25<t.start&&Math.abs(e-t.start)<31536e4?E?Math.max(t.end-c,t.start):t.start:e;return e}(e=L(),t),isNaN(t)||t===e||x()||!j()&&!T&&1!==l.getReadyState()||(a.debug("UpdateCurrentTime: Seek to actual time: ".concat(t," from currentTime: ").concat(e)),M(t,!1,!1)))}function q(){null===t&&(t=setInterval(function(){R.trigger(ye.default.WALLCLOCK_TIME_UPDATED,{isDynamic:g,time:new Date}),g&&(n.addDVRMetric(),(F()?function(){var e=Date.now();(!m||m+500<e)&&(m=e,ee())}:G)())},A.get().streaming.wallclockTimeUpdateInterval))}function H(){clearInterval(t),t=null}function Y(e){e=s.convertRepresentationToRepresentationInfo(e.currentRepresentation),e=e?e.mediaInfo.streamInfo:null;null!==e&&d.id===e.id&&(d=e)}function V(){R.trigger(ye.default.CAN_PLAY)}function K(){R.trigger(ye.default.CAN_PLAY_THROUGH)}function z(e){e.streamId===n.getActiveStreamInfo().id&&(T=e.state===ve.default.BUFFER_EMPTY,A.get().streaming.buffer.setStallState&&l.setStallState(e.mediaType,e.state===ve.default.BUFFER_EMPTY))}function W(){a.info("Native video element event: play"),G(),q(),R.trigger(ye.default.PLAYBACK_STARTED,{startTime:L()})}function X(){a.info("Native video element event: waiting"),R.trigger(ye.default.PLAYBACK_WAITING,{playingTime:L()})}function Q(){a.info("Native video element event: playing"),v=!1,R.trigger(ye.default.PLAYBACK_PLAYING,{playingTime:L()})}function J(){a.info("Native video element event: pause"),R.trigger(ye.default.PLAYBACK_PAUSED,{ended:U()})}function $(){var e;v||(e=L(),isNaN(_)||_===e||(e=_),_=NaN,a.info("Seeking to: "+e),q(),R.trigger(ye.default.PLAYBACK_SEEKING,{seekTime:e,streamId:d.id}))}function Z(){a.info("Native video element event: seeked"),v=!1,R.trigger(ye.default.PLAYBACK_SEEKED)}function ee(){d&&R.trigger(ye.default.PLAYBACK_TIME_UPDATED,{timeToEnd:w(),time:L(),streamId:d.id})}function te(){R.trigger(ye.default.PLAYBACK_PROGRESS,{streamId:d.id})}function re(){var e=k();a.info("Native video element event: ratechange: ",e),R.trigger(ye.default.PLAYBACK_RATE_CHANGED,{playbackRate:e})}function ne(){a.info("Native video element event: loadedmetadata"),R.trigger(ye.default.PLAYBACK_METADATA_LOADED),q()}function ae(){a.info("Native video element event: loadeddata"),R.trigger(ye.default.PLAYBACK_LOADED_DATA)}function ie(){a.info("Native video element event: ended"),D(),H();var e=n?n.getActiveStreamInfo():null;e&&R.trigger(ye.default.PLAYBACK_ENDED,{isLast:e.isLast})}function oe(){R.trigger(ye.default.PLAYBACK_VOLUME_CHANGED)}function se(e){t&&e.isLast&&(a.info("onPlaybackEnded -- PLAYBACK_ENDED but native video element didn't fire ended"),e=e.seekTime||C(),l.setCurrentTime(e),D(),H())}function le(e){e=e.target||e.srcElement;R.trigger(ye.default.PLAYBACK_ERROR,{error:e.error})}function ue(e){!1===e.stream&&E&&!isNaN(e.request.duration)&&(e=1.2*e.request.duration,c<e&&(a.warn("Browser does not support fetch API with StreamReader. Increasing live delay to be 20% higher than segment duration:",e.toFixed(2)),f=c=e))}function ce(e){R.trigger(ye.default.PLAYBACK_STALLED,{e:e})}function fe(e){(e=e.mediaInfo)&&e.supplementalProperties&&"true"===e.supplementalProperties[me.default.SUPPLEMENTAL_PROPERTY_DVB_LL_SCHEME]&&(a.debug("Low Latency critical SupplementalProperty set: Enabling low Latency"),E=!0)}function de(e){var t=n.getActiveStreamInfo();e&&t&&e.currentRepresentation&&e.streamId&&e.streamId===t.id&&e.mediaType&&(e.mediaType===me.default.VIDEO||e.mediaType===me.default.AUDIO)&&(y=e.currentRepresentation.availabilityTimeComplete,(E=!y)&&!S&&(S=!0))}function ge(){b=!0}function he(){b=!1}return r={initialize:function(e,t){d=e,!0!==t&&(l.addEventListener("canplay",V),l.addEventListener("canplaythrough",K),l.addEventListener("play",W),l.addEventListener("waiting",X),l.addEventListener("playing",Q),l.addEventListener("pause",J),l.addEventListener("error",le),l.addEventListener("seeking",$),l.addEventListener("seeked",Z),l.addEventListener("timeupdate",ee),l.addEventListener("progress",te),l.addEventListener("ratechange",re),l.addEventListener("loadedmetadata",ne),l.addEventListener("loadeddata",ae),l.addEventListener("stalled",ce),l.addEventListener("ended",ie),l.addEventListener("volumechange",oe),g=d.manifestInfo.isDynamic,v=T=!1,R.on(ye.default.DATA_UPDATE_COMPLETED,Y,r),R.on(ye.default.LOADING_PROGRESS,ue,r),R.on(ye.default.MANIFEST_UPDATED,ge,r),R.on(ye.default.STREAMS_COMPOSED,he,r),R.on(_e.default.PLAYBACK_ENDED,se,r,{priority:pe.default.EVENT_PRIORITY_HIGH}),R.on(_e.default.STREAM_INITIALIZING,fe,r),R.on(_e.default.REPRESENTATION_SWITCH,de,r),R.on(_e.default.BUFFER_LEVEL_STATE_CHANGED,z,r),h&&(h=!1,N()))},setConfig:function(e){e&&(e.streamController&&(n=e.streamController),e.serviceDescriptionController&&(i=e.serviceDescriptionController),e.dashMetrics&&(o=e.dashMetrics),e.adapter&&(s=e.adapter),e.videoModel&&(l=e.videoModel),e.timelineConverter&&(u=e.timelineConverter),e.settings&&(A=e.settings))},getTimeToStreamEnd:w,getBufferLevel:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null,r=null;return n.getActiveStreamProcessors().forEach(function(e){t&&0!==t.length&&-1!==t.indexOf(e.getType())||(e=e.getBufferLevel(),r=null===r?e:Math.min(r,e))}),r},getPlaybackStalled:function(){return T},getTime:L,getLowLatencyModeEnabled:function(){return E},getInitialCatchupModeActivated:function(){return S},getIsManifestUpdateInProgress:function(){return b},getPlaybackRate:k,getPlayedRanges:function(){return d&&l?l.getPlayedRanges():null},getEnded:U,getIsDynamic:B,getStreamController:function(){return n},computeAndSetLiveDelay:function(e,t){var r=!isNaN(e)&&isFinite(e)?e:NaN,n=s.getSuggestedPresentationDelay(),e=i.getServiceDescriptionSettings(),n=isNaN(A.get().streaming.delay.liveDelay)?null===A.get().streaming.delay.liveDelayFragmentCount||isNaN(A.get().streaming.delay.liveDelayFragmentCount)||isNaN(r)?e&&!isNaN(e.liveDelay)&&0<e.liveDelay?e.liveDelay:!0===A.get().streaming.delay.useSuggestedPresentationDelay&&null!==n&&!isNaN(n)&&0<n?n:isNaN(r)?t&&!isNaN(t.minBufferTime)?4*t.minBufferTime:4*d.manifestInfo.minBufferTime:4*r:r*A.get().streaming.delay.liveDelayFragmentCount:A.get().streaming.delay.liveDelay;return null!==(r=s.getAvailabilityStartTime())&&(p=r),n=t&&0<t.dvrWindowSize?Math.min(n,t.dvrWindowSize):n,f=c=n},getLiveDelay:function(){return c},getOriginalLiveDelay:function(){return f},getCurrentLiveLatency:function(){if(!g||isNaN(p))return NaN;var e=L();if(isNaN(e)||0===e)return 0;var t=(new Date).getTime()+1e3*u.getClientTimeOffset();return Math.max(((t-p-1e3*e)/1e3).toFixed(3),0)},play:N,isPaused:F,isStalled:j,pause:D,isSeeking:x,getStreamEndTime:C,seek:M,seekToOriginalLive:function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0],t=1<arguments.length&&void 0!==arguments[1]&&arguments[1],r=2<arguments.length&&void 0!==arguments[2]&&arguments[2],n=O();0!==n&&M(n-(c=f),e,t,r)},seekToCurrentLive:function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0],t=1<arguments.length&&void 0!==arguments[1]&&arguments[1],r=2<arguments.length&&void 0!==arguments[2]&&arguments[2],n=O();0!==n&&M(n-c,e,t,r)},reset:I,updateCurrentTime:G,getAvailabilityStartTime:function(){return p}},a=(0,Ee.default)(e).getInstance().getLogger(r),I(),r}n.__dashjs_factory_name="PlaybackController";const a=t.default.getSingletonFactory(n)},"./src/streaming/controllers/ScheduleController.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>a});var x=r("./src/streaming/constants/Constants.js"),j=r("./src/streaming/models/FragmentModel.js"),k=r("./src/core/EventBus.js"),U=r("./src/core/events/Events.js"),t=r("./src/core/FactoryMaker.js"),B=r("./src/core/Debug.js"),G=r("./src/streaming/constants/MetricsConstants.js"),q=r("./src/streaming/MediaPlayerEvents.js");function n(e){e=e||{};var t,r,n,a,i,o,s,l,u,c,f,d,g,h=this.context,m=(0,k.default)(h).getInstance(),p=e.dashMetrics,y=e.mediaPlayerModel,E=e.fragmentModel,_=e.abrController,v=e.playbackController,T=e.textController,b=e.type,S=e.bufferController,A=e.settings;function R(e){S.getIsBufferingCompleted()||(I(),e=isNaN(e)?0:e,o=setTimeout(w,e))}function I(){o&&(clearTimeout(o),o=null)}function w(){try{if(function(){try{return b===x.default.TEXT&&!T.isTextEnabled()||v.isPaused()&&(!v.getStreamController().getInitialPlayback()||!v.getStreamController().getAutoPlay())&&!A.get().streaming.scheduling.scheduleWhilePaused}catch(e){return!1}}())return void I();var e;!function(){try{return a&&(isNaN(c)||f||function(){var e=r.id,e=_.getMaxAllowedIndexFor(b,e);return!(!isNaN(u)&&u==e)&&(n.info("Top quality "+b+" index has changed from "+u+" to "+e),u=e,!0)}()||!b||!a||p.getCurrentBufferLevel(b)<C())}catch(e){return!1}}()?R(v.getLowLatencyModeEnabled()?A.get().streaming.scheduling.lowLatencyTimeout:A.get().streaming.scheduling.defaultTimeout):(e=!1,(e=g?_.checkPlaybackQuality(b,r.id):e)||(d||a.quality!==c||f?(f?(n.debug("Switch track for "+b+", representation id = "+a.id),f=!1):n.debug("Quality has changed, get init request for representationid = "+a.id),m.trigger(U.default.INIT_FRAGMENT_NEEDED,{representationId:a.id,sender:t},{streamId:r.id,mediaType:b}),d=g=!1):(n.debug("Media segment needed for ".concat(b," and stream id ").concat(r.id)),m.trigger(U.default.MEDIA_FRAGMENT_NEEDED,{},{streamId:r.id,mediaType:b}),g=!0)))}catch(e){R(v.getLowLatencyModeEnabled()?A.get().streaming.scheduling.lowLatencyTimeout:A.get().streaming.scheduling.defaultTimeout)}}function C(){var e=NaN;return b&&a?e=(b===x.default.TEXT?function(){try{if(T.isTextEnabled()){if(isNaN(a.fragmentDuration)){var e=p.getCurrentSchedulingInfo(G.default.SCHEDULING_INFO);return e?e.duration:0}return a.fragmentDuration}return 0}catch(e){return 0}}:b===x.default.AUDIO&&s?function(){try{var e=p.getCurrentBufferLevel(x.default.VIDEO);return isNaN(a.fragmentDuration)?e+1:Math.max(e+1,a.fragmentDuration)}catch(e){return 0}}:function(){try{var e=a.mediaInfo.streamInfo;return _.isPlayingAtTopQuality(e)?e.manifestInfo.duration>=A.get().streaming.buffer.longFormContentDurationThreshold?A.get().streaming.buffer.bufferTimeAtTopQualityLongForm:A.get().streaming.buffer.bufferTimeAtTopQuality:y.getStableBufferTime()}catch(e){return y.getStableBufferTime()}})():e}function N(){D(!0)}function D(e){var t;v&&E&&((t=E.getRequests({state:j.default.FRAGMENT_MODEL_EXECUTED,time:v.getTime(),threshold:0})[0])&&v.getTime()>=t.startTime&&((!l.mediaInfo||t.mediaInfo.type===l.mediaInfo.type&&t.mediaInfo.id!==l.mediaInfo.id)&&e&&m.trigger(U.default.TRACK_CHANGE_RENDERED,{mediaType:b,oldMediaInfo:l.mediaInfo,newMediaInfo:t.mediaInfo,streamId:r.id}),t.quality===l.quality&&t.adaptationIndex===l.adaptationIndex||!e||(n.debug("Quality change rendered for streamId ".concat(r.id," and type ").concat(b)),m.trigger(U.default.QUALITY_CHANGE_RENDERED,{mediaType:b,oldQuality:l.quality,newQuality:t.quality,streamId:r.id})),l={mediaInfo:t.mediaInfo,quality:t.quality,adaptationIndex:t.adaptationIndex}))}function M(e){n.debug("Appended bytes for ".concat(e.mediaType," and stream id ").concat(r.id)),(isNaN(e.index)||isNaN(c))&&(c=e.quality,n.info("["+b+"] lastInitializedRepresentationInfo changed to "+e.quality)),R(0)}function O(){E.abortRequests(),I()}function P(){A.get().streaming.scheduling.scheduleWhilePaused||R()}function L(e){p.updatePlayListTraceMetrics({playbackspeed:e.playbackRate.toString()})}function F(){g=!0,u=c=NaN,d=f=!(l={mediaInfo:void(i=0),quality:NaN,adaptationIndex:NaN})}return t={initialize:function(e){s=e,m.on(U.default.BYTES_APPENDED_END_FRAGMENT,M,t),m.on(U.default.URL_RESOLUTION_FAILED,O,t),m.on(q.default.PLAYBACK_STARTED,P,t),m.on(q.default.PLAYBACK_RATE_CHANGED,L,t),m.on(q.default.PLAYBACK_TIME_UPDATED,N,t)},getType:function(){return b},getStreamId:function(){return r.id},setCurrentRepresentation:function(e){a=e},setTimeToLoadDelay:function(e){i=e},getTimeToLoadDelay:function(){return i},setSwitchTrack:function(e){f=e},getSwitchStrack:function(){return f},startScheduleTimer:R,clearScheduleTimer:I,reset:function(){m.off(U.default.BYTES_APPENDED_END_FRAGMENT,M,t),m.off(U.default.URL_RESOLUTION_FAILED,O,t),m.off(q.default.PLAYBACK_STARTED,P,t),m.off(q.default.PLAYBACK_RATE_CHANGED,L,t),m.off(q.default.PLAYBACK_TIME_UPDATED,N,t),I(),D(!1),F(),r=null},getBufferTarget:C,getPlaybackController:function(){return v},setCheckPlaybackQuality:function(e){g=e},setInitSegmentRequired:function(e){d=e}},n=(0,B.default)(h).getInstance().getLogger(t),F(),r=e.streamInfo,t}n.__dashjs_factory_name="ScheduleController";const a=t.default.getClassFactory(n)},"./src/streaming/controllers/StreamController.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>i});var Be=r("./src/streaming/constants/Constants.js"),Ge=r("./src/streaming/constants/MetricsConstants.js"),qe=r("./src/streaming/Stream.js"),He=r("./src/streaming/ManifestUpdater.js"),Ye=r("./src/core/EventBus.js"),Ve=r("./src/core/events/Events.js"),t=r("./src/core/FactoryMaker.js"),Ke=r("./src/streaming/vo/metrics/PlayList.js"),ze=r("./src/core/Debug.js"),We=r("./src/streaming/utils/InitCache.js"),Xe=r("./src/streaming/MediaPlayerEvents.js"),Qe=r("./src/streaming/controllers/TimeSyncController.js"),Je=r("./src/streaming/controllers/MediaSourceController.js"),$e=r("./src/streaming/vo/DashJSError.js"),Ze=r("./src/core/errors/Errors.js"),et=r("./src/streaming/controllers/EventController.js"),tt=r("./src/streaming/constants/ConformanceViolationConstants.js");function rt(e){return function(e){if(Array.isArray(e))return n(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return n(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return n(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function a(){var r,s,i,o,l,n,u,c,f,d,a,g,h,m,p,y,E,_,v,T,b,S,A,R,I,w,C,N,D,M,O,P,L,F,x,j,t,k,e,U,B,G,q,H,Y,V,K,z,W=this.context,X=(0,Ye.default)(W).getInstance();function Q(){if(!(n&&n.hasOwnProperty("load")&&b&&b.hasOwnProperty("initialize")&&b.hasOwnProperty("reset")&&b.hasOwnProperty("getClientTimeOffset")&&u&&T&&f&&L))throw new Error(Be.default.MISSING_CONFIG_ERROR)}function J(){!function(){try{var e=c.getStreamsInfo();if(!A&&0===e.length)throw new Error("There are no periods in the MPD");A&&0<e.length&&f.updateManifestUpdateInfo({currentTime:L.getTime(),buffered:P.getBufferRange(),presentationStartTime:e[0].start,clientTimeOffset:b.getClientTimeOffset()}),0<S.length&&function(r){0===r.length?s.warn("No periods included in the current manifest. Skipping the filtering of outdated stream objects."):S=S.filter(function(t){var e=0<r.filter(function(e){return e.id===t.getId()}).length||t.getId()===A.getId();return e||(s.debug("Removing stream ".concat(t.getId())),t.reset(!0)),e})}(e);for(var t=[],r=0,n=e.length;r<n;r++){var a=e[r];t.push(function(e){var t=Le(e.id);return t?t.updateData(e):(t=(0,qe.default)(W).create({manifestModel:u,mediaPlayerModel:x,dashMetrics:f,manifestUpdater:l,adapter:c,timelineConverter:b,capabilities:i,capabilitiesFilter:o,errHandler:T,baseURLController:h,segmentBaseController:m,textController:I,abrController:y,playbackController:L,eventController:_,mediaController:E,protectionController:R,videoModel:P,streamInfo:e,settings:H}),S.push(t),t.initialize(),Promise.resolve())}(a)),f.addManifestUpdateStreamInfo(a)}Promise.all(t).then(function(){return H.get().streaming.applyContentSteering&&!A&&g.shouldQueryBeforeStart()?g.loadSteeringData():Promise.resolve()}).then(function(){A||!function e(t){le();var r=f.getCurrentDVRInfo().range;if(r.end<r.start){V&&clearTimeout(V);var n=Math.min(1e3*(-1*(r.end-r.start)+2),2147483647);return s.debug("Waiting for ".concat(n," ms before playback can start")),X.trigger(Ve.default.AST_IN_FUTURE,{delay:n}),void(V=setTimeout(function(){e(t)},n))}H.get().streaming.applyProducerReferenceTime&&F.calculateProducerReferenceTimeOffsets(t);n=t[0].manifestInfo;H.get().streaming.applyServiceDescription&&F.applyServiceDescription(n);c.getIsDynamic()&&(a=Ie(t,n),L.computeAndSetLiveDelay(a,n));var a=be();n=se(a);var n=null!==n?n:S[0];X.trigger(Ve.default.INITIAL_STREAM_SWITCH,{startTime:a});Z(n,null,a);ye()}(e),X.trigger(Ve.default.STREAMS_COMPOSED),pe()}).catch(function(e){throw e})}catch(e){T.error(new $e.default(Ze.default.MANIFEST_ERROR_ID_NOSTREAMS_CODE,e.message+" nostreamscomposed",u.getValue())),M=!0,je()}}()}function $(){Y=!0}function Z(e,t,r){try{if(N||!e||t===e&&e.getIsActive())return;N=!0,X.trigger(Ve.default.PERIOD_SWITCH_STARTED,{fromStreamInfo:t?t.getStreamInfo():null,toStreamInfo:e.getStreamInfo()});var n=!1;A=e,t&&(n=oe(e,t),t.deactivate(n)),r=isNaN(r)?!n&&t?e.getStreamInfo().start:NaN:r,s.info("Switch to stream ".concat(e.getId(),". Seektime is ").concat(r,", current playback time is ").concat(L.getTime(),". Seamless period switch is set to ").concat(n)),G=G.filter(function(e){return e.getId()!==A.getId()}),L.initialize(Pe(),!!t),P.getElement()?ee(r,n,!1):te(r,n)}catch(e){N=!1}}function ee(t,r,e){var n,a=2<arguments.length&&void 0!==e&&e;function i(){var e;O&&"open"===O.readyState&&(s.debug("MediaSource is open!"),window.URL.revokeObjectURL(n),O.removeEventListener("sourceopen",i),O.removeEventListener("webkitsourceopen",i),Te(),e=f.getCurrentDVRInfo(),d.setSeekable(e.range.start,e.range.end),a?A.setMediaSource(O).then(function(){A.initializeForTextWithMediaSource(O)}):te(t,r))}function o(){O.addEventListener("sourceopen",i,!1),O.addEventListener("webkitsourceopen",i,!1),n=d.attachMediaSource(P),s.debug("MediaSource attached to element.  Waiting on open...")}O?r?te(t,r):(d.detachMediaSource(P),o()):(O=d.createMediaSource(),o())}function te(r,e){A.activate(O,e?B:void 0,r).then(function(e){var t;e&&(0<(t=Object.keys(e)).length&&e[t[0]].getBuffer().changeType&&(q=!0),B=e),isNaN(r)||(X.trigger(Ve.default.SEEK_TARGET,{time:r},{streamId:A.getId()}),L.seek(r,!1,!0),A.startScheduleControllers()),N=!1,X.trigger(Ve.default.PERIOD_SWITCH_COMPLETED,{toStreamInfo:Pe()})})}function re(e){var t,r,n,a,i=se(e.seekTime);i&&i!==A?i&&i!==A&&(ne(i),r=i,n=(t=e)&&!isNaN(t.seekTime)?t.seekTime:NaN,i=A.getProcessors().map(function(e){return e.prepareOuterPeriodPlaybackSeeking(t)}),Promise.all(i).then(function(){Z(r,A,n)}).catch(function(e){T.error(e)})):(ne(),a=e,A.getProcessors().forEach(function(e){return e.prepareInnerPeriodPlaybackSeeking(a)}),De(Ke.PlayListTrace.USER_REQUEST_STOP_REASON)),Me(Ke.PlayList.SEEK_START_REASON)}function ne(){ae()}function ae(){G&&0<G.length&&(G.forEach(function(e){e.deactivate(!0)}),G=[])}function ie(e){e.newMediaInfo.streamInfo.id===A.getId()&&(ae(),A.prepareTrackChange(e))}function oe(e,t){try{return H.get().streaming.buffer.reuseExistingSourceBuffers&&(t.isProtectionCompatible(e)||Y)&&(q||t.isMediaCodecCompatible(e,t))}catch(e){return!1}}function se(e){if(isNaN(e))return null;for(var t=S.length,r=0;r<t;r++){var n=S[r];if(e<parseFloat((n.getStartTime()+n.getDuration()).toFixed(5)))return n}return null}function le(){try{var e=c.getIsDynamic(),t=c.getStreamsInfo()[0].manifestInfo,r=L.getTime(),n=b.calcTimeShiftBufferWindow(S,e),e=_e();if(void 0===n.start||void 0===n.end)return;e&&0!==e.length?e.forEach(function(e){f.addDVRInfo(e.getType(),r,t,n)}):f.addDVRInfo(Be.default.VIDEO,r,t,n)}catch(e){}}function ue(e){var t,r;k&&C&&(t=x.getInitialBufferLevel(),r=[Be.default.TEXT],(isNaN(t)||t<=L.getBufferLevel(r)||c.getIsDynamic()&&t>L.getLiveDelay())&&(k=!1,Me(Ke.PlayList.INITIAL_PLAYOUT_START_REASON),L.play())),e&&e.mediaType&&f.addBufferLevel(e.mediaType,new Date,1e3*e.bufferLevel)}function ce(e){e.streamInfo.id===A.getId()&&e.reason&&e.reason.forceReplace&&ae(),Le(e.streamInfo.id).prepareQualityChange(e)}function fe(){var e,t;c.getIsDynamic()&&0!==L.getOriginalLiveDelay()&&A&&(0<(t=c.getStreamsInfo()).length&&(t=Ie(t,e=t[0].manifestInfo),L.computeAndSetLiveDelay(t,e)))}function de(){var e;!Ce()||(e=P.getPlaybackQuality())&&f.addDroppedFrames(e)}function ge(){s.debug("[onPlaybackStarted]"),!k&&t&&Me(Ke.PlayList.RESUME_FROM_PAUSE_START_REASON),k=k&&!1,e&&(e=!1,H.get().streaming.applyContentSteering&&!g.shouldQueryBeforeStart()&&g.loadSteeringData()),t=!1}function he(e){s.debug("[onPlaybackPaused]"),e.ended||(t=!0,De(Ke.PlayListTrace.USER_REQUEST_STOP_REASON))}function me(e){s.debug("Stream with id ".concat(e.streamInfo.id," finished buffering"));e=e.streamInfo.isLast;O&&e?(s.info("[onStreamBufferingCompleted] calls signalEndOfStream of mediaSourceController."),d.signalEndOfStream(O)):pe()}function pe(){if(A&&A.getHasFinishedBuffering())for(var e=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null;try{var t=e||A||null;if(t){var r=t.getStreamInfo();return S.filter(function(e){e=e.getStreamInfo();return e.start>r.start&&r.id!==e.id})}}catch(e){return[]}}(A),t=0;t<e.length;){var r=e[t],n=0===t?A:e[t-1];!r.getPreloaded()&&n.getHasFinishedBuffering()&&O&&function(e,t){t=1<arguments.length&&void 0!==t?t:null,O&&!e.getPreloaded()&&oe(e,t)&&e.startPreloading(O,B).then(function(){G.push(e)})}(r,n),t+=1}}function ye(){U=U||setInterval(function(){!N&&L.getTimeToStreamEnd()<=0&&!L.isSeeking()&&X.trigger(Ve.default.PLAYBACK_ENDED,{isLast:Pe().isLast})},200)}function Ee(){U&&(clearInterval(U),U=null)}function _e(){return A?A.getProcessors():[]}function ve(e){var t;A&&!A.getIsEndedEventSignaled()&&(A.setIsEndedEventSignaled(!0),(t=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null,e=e||A||null;if(!e)return null;var t=e.getStreamInfo(),r=t.start,n=0,a=-1,i=NaN;for(;n<S.length;){var o=S[n].getStreamInfo(),s=o.start-r;0<s&&(isNaN(i)||s<i)&&t.id!==o.id&&(i=s,a=n),n+=1}if(0<=a)return S[a];return null}())?(s.debug("StreamController onEnded, found next stream with id ".concat(t.getStreamInfo().id,". Switching from ").concat(A.getStreamInfo().id," to ").concat(t.getStreamInfo().id)),Z(t,A,NaN)):(s.debug("StreamController no next stream found"),A.setIsEndedEventSignaled(!1)),De(t?Ke.PlayListTrace.END_OF_PERIOD_STOP_REASON:Ke.PlayListTrace.END_OF_CONTENT_STOP_REASON)),e&&e.isLast&&(Ee(),g.stopSteeringRequestTimer())}function Te(e){e=e||Pe().manifestInfo.duration;d.setDuration(e)}function be(){var e,t,r,n,a;return c.getIsDynamic()?(n=((t=f.getCurrentDVRInfo())&&t.range?t.range.end:0)-L.getOriginalLiveDelay(),(e=t?t.range:null)&&(isNaN(K)&&-1===K.toString().indexOf("posix:")?(t=Se(!0),isNaN(t)||(s.info("Start time from URI parameters: ".concat(t)),n=Math.min(n,t))):(s.info("Start time provided by the app: ".concat(K)),r=Ae(!0,K),isNaN(r)||(n=Math.min(n,r))),r=H.get().streaming.timeShiftBuffer.calcFromSegmentTimeline?.1:0,n=Math.max(n,e.start+r))):(n=S[0].getStreamInfo().start,isNaN(K)?(a=Se(!1),isNaN(a)||(s.info("Start time from URI parameters: ".concat(a)),n=Math.max(n,a))):(s.info("Start time provided by the app: ".concat(K)),a=Ae(!1,K),isNaN(a)||(n=Math.max(n,a)))),n}function Se(e){var t=p.getURIFragmentData();if(!t||!t.t)return NaN;var r=S[0].getStreamInfo().start;return t.t=t.t.split(",")[0],Re(e,t.t,r)}function Ae(e,t){var r=0;return Re(e,t,r=!e?S[0].getStreamInfo().start:r)}function Re(e,t,r){var n=c.getRegularPeriods()[0],a=t.toString(),t=-1!==a.indexOf("posix:")?"now"===a.substring(6)?Date.now()/1e3:parseFloat(a.substring(6)):NaN;return e&&!isNaN(t)?b.calcPresentationTimeFromWallTime(new Date(1e3*t),n):parseFloat(a)+r}function Ie(e,t){try{var r,n,a=NaN;return t&&!isNaN(t.maxFragmentDuration)&&isFinite(t.maxFragmentDuration)?t.maxFragmentDuration:(e&&1===e.length&&(r=e[0],n=[Be.default.VIDEO,Be.default.AUDIO,Be.default.TEXT].reduce(function(e,t){t=c.getMediaInfoForType(r,t);return t&&!1!==t.isFragmented&&e.push(t),e},[]).reduce(function(t,e){e=c.getVoRepresentations(e);return e&&0<e.length&&e.forEach(function(e){e&&t.push(e)}),t},[]).reduce(function(e,t){t=c.convertRepresentationToRepresentationInfo(t);return t&&t.fragmentDuration&&!isNaN(t.fragmentDuration)&&e.push(t.fragmentDuration),e},[]),a=Math.max.apply(Math,rt(n))),isFinite(a)?a:NaN)}catch(e){return NaN}}function we(e){var t,r;e.error?(M=!0,je()):(s.info("Manifest updated... updating data system wide."),t=e.manifest,c.updatePeriods(t),e=c.getUTCTimingSources(),!c.getIsDynamic()||e&&0!==e.length||X.trigger(Xe.default.CONFORMANCE_VIOLATION,{level:tt.default.LEVELS.WARNING,event:tt.default.EVENTS.NO_UTC_TIMING_ELEMENT}),r=c.getIsDynamic()?e.concat(j.getUTCTimingSources()):e,o.filterUnsupportedFeatures(t).then(function(){h.initialize(t),a.attemptSync(r,c.getIsDynamic())}))}function Ce(){return!!A&&A.getHasVideoTrack()}function Ne(){return!!A&&A.getHasAudioTrack()}function De(t,r){r=r||new Date,_e().forEach(function(e){e.finalisePlayList(r,t)}),f.addPlayList()}function Me(e){f.createPlaylistMetrics(1e3*L.getTime(),e)}function Oe(e){if(e.error){var t="";switch(e.error.code){case 1:t="MEDIA_ERR_ABORTED";break;case 2:t="MEDIA_ERR_NETWORK";break;case 3:t="MEDIA_ERR_DECODE",z.counts.mediaErrorDecode+=1;break;case 4:t="MEDIA_ERR_SRC_NOT_SUPPORTED";break;case 5:t="MEDIA_ERR_ENCRYPTED";break;default:t="UNKNOWN"}"MEDIA_ERR_DECODE"===t&&H.get().errors.recoverAttempts.mediaErrorDecode>=z.counts.mediaErrorDecode?function(){s.warn("A MEDIA_ERR_DECODE occured: Resetting the MediaSource");var e=L.getTime();A.deactivate(!1),s.warn("MediaSource has been resetted. Resuming playback from time ".concat(e)),ee(e,!1,!1)}():(D=!0,e.error.message&&(t+=" ("+e.error.message+")"),e.error.msExtendedCode&&(t+=" (0x"+(e.error.msExtendedCode>>>0).toString(16).toUpperCase()+")"),s.fatal("Video Element Error: "+t),e.error&&s.fatal(e.error),T.error(new $e.default(e.error.code,t)),je())}}function Pe(){return A?A.getStreamInfo():null}function Le(e){for(var t=0,r=S.length;t<r;t++)if(S[t].getId()===e)return S[t];return null}function Fe(e){isNaN(e.newDuration)||Te(e.newDuration)}function xe(){K=NaN,q=Y=!(C=!(t=!(e=k=!(M=D=N=!(S=[]))))),G=[],V=U=A=R=null,z={counts:{mediaErrorDecode:0}}}function je(){Q(),a.reset(),De(D||M?Ke.PlayListTrace.FAILURE_STOP_REASON:Ke.PlayListTrace.USER_REQUEST_STOP_REASON);for(var e=0,t=S?S.length:0;e<t;e++)S[e].reset(D);X.off(Xe.default.PLAYBACK_TIME_UPDATED,de,r),X.off(Xe.default.PLAYBACK_SEEKING,re,r),X.off(Xe.default.PLAYBACK_ERROR,Oe,r),X.off(Xe.default.PLAYBACK_STARTED,ge,r),X.off(Xe.default.PLAYBACK_PAUSED,he,r),X.off(Xe.default.PLAYBACK_ENDED,ve,r),X.off(Xe.default.METRIC_ADDED,ke,r),X.off(Xe.default.MANIFEST_VALIDITY_CHANGED,Fe,r),X.off(Xe.default.BUFFER_LEVEL_UPDATED,ue,r),X.off(Xe.default.QUALITY_CHANGE_REQUESTED,ce,r),Ve.default.KEY_SESSION_UPDATED&&X.off(Ve.default.KEY_SESSION_UPDATED,$,r),X.off(Ve.default.MANIFEST_UPDATED,we,r),X.off(Ve.default.STREAM_BUFFERING_COMPLETED,me,r),X.off(Ve.default.TIME_SYNCHRONIZATION_COMPLETED,J,r),X.off(Ve.default.CURRENT_TRACK_CHANGED,ie,r),X.off(Ve.default.SETTING_UPDATED_LIVE_DELAY,fe,r),X.off(Ve.default.SETTING_UPDATED_LIVE_DELAY_FRAGMENT_COUNT,fe,r),h.reset(),l.reset(),_.reset(),f.clearAllCurrentMetrics(),u.setValue(null),n.reset(),b.reset(),v.reset(),O&&(d.detachMediaSource(P),O=null),P=null,R&&(w=R=null,u.getValue()&&X.trigger(Ve.default.PROTECTION_DESTROYED,{data:u.getValue().url})),Ee(),X.trigger(Ve.default.STREAM_TEARDOWN_COMPLETE),xe()}function ke(e){var t;e.metric===Ge.default.DVR_INFO&&(t=Ne()?Be.default.AUDIO:Be.default.VIDEO,e.mediaType===t&&d.setSeekable(e.value.range.start,e.value.range.end))}function Ue(){return S}return r={initialize:function(e,t){Q(),C=e,w=t,b.initialize(),(l=(0,He.default)(W).create()).setConfig({manifestModel:u,adapter:c,manifestLoader:n,errHandler:T,settings:H}),l.initialize(),(_=(0,et.default)(W).getInstance()).setConfig({manifestUpdater:l,playbackController:L,settings:H}),_.start(),a.setConfig({dashMetrics:f,baseURLController:h,errHandler:T,settings:H}),a.initialize(),R&&(X.trigger(Ve.default.PROTECTION_CREATED,{controller:R}),R.setMediaElement(P.getElement()),w&&R.setProtectionData(w)),X.on(Xe.default.PLAYBACK_TIME_UPDATED,de,r),X.on(Xe.default.PLAYBACK_SEEKING,re,r),X.on(Xe.default.PLAYBACK_ERROR,Oe,r),X.on(Xe.default.PLAYBACK_STARTED,ge,r),X.on(Xe.default.PLAYBACK_PAUSED,he,r),X.on(Xe.default.PLAYBACK_ENDED,ve,r),X.on(Xe.default.METRIC_ADDED,ke,r),X.on(Xe.default.MANIFEST_VALIDITY_CHANGED,Fe,r),X.on(Xe.default.BUFFER_LEVEL_UPDATED,ue,r),X.on(Xe.default.QUALITY_CHANGE_REQUESTED,ce,r),Ve.default.KEY_SESSION_UPDATED&&X.on(Ve.default.KEY_SESSION_UPDATED,$,r),X.on(Ve.default.MANIFEST_UPDATED,we,r),X.on(Ve.default.STREAM_BUFFERING_COMPLETED,me,r),X.on(Ve.default.TIME_SYNCHRONIZATION_COMPLETED,J,r),X.on(Ve.default.CURRENT_TRACK_CHANGED,ie,r),X.on(Ve.default.SETTING_UPDATED_LIVE_DELAY,fe,r),X.on(Ve.default.SETTING_UPDATED_LIVE_DELAY_FRAGMENT_COUNT,fe,r)},getActiveStreamInfo:Pe,addDVRMetric:le,hasVideoTrack:Ce,hasAudioTrack:Ne,getStreamById:Le,getStreamForTime:se,getTimeRelativeToStreamId:function(e,t){for(var r,n,a=null,i=0,o=0;o<S.length;o++){if(r=(a=S[o]).getStartTime(),n=a.getDuration(),Number.isFinite(r)&&(i=r),a.getId()===t)return e-i;Number.isFinite(n)&&(i+=n)}return null},load:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:NaN;Q(),K=t,n.load(e)},loadWithManifest:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:NaN;!function(){if(!l||!l.hasOwnProperty("setManifest"))throw new Error("initialize function has to be called previously")}(),K=t,l.setManifest(e)},getActiveStreamProcessors:_e,setConfig:function(e){e&&(e.capabilities&&(i=e.capabilities),e.capabilitiesFilter&&(o=e.capabilitiesFilter),e.manifestLoader&&(n=e.manifestLoader),e.manifestModel&&(u=e.manifestModel),e.mediaPlayerModel&&(x=e.mediaPlayerModel),e.customParametersModel&&(j=e.customParametersModel),e.protectionController&&(R=e.protectionController),e.adapter&&(c=e.adapter),e.dashMetrics&&(f=e.dashMetrics),e.errHandler&&(T=e.errHandler),e.timelineConverter&&(b=e.timelineConverter),e.videoModel&&(P=e.videoModel),e.playbackController&&(L=e.playbackController),e.serviceDescriptionController&&(F=e.serviceDescriptionController),e.contentSteeringController&&(g=e.contentSteeringController),e.textController&&(I=e.textController),e.abrController&&(y=e.abrController),e.mediaController&&(E=e.mediaController),e.settings&&(H=e.settings),e.baseURLController&&(h=e.baseURLController),e.uriFragmentModel&&(p=e.uriFragmentModel),e.segmentBaseController&&(m=e.segmentBaseController))},setProtectionData:function(e){w=e,R&&R.setProtectionData(w)},getIsStreamSwitchInProgress:function(){return N},switchToVideoElement:function(e){A&&(L.initialize(Pe()),ee(e,!1,!0))},getHasMediaOrInitialisationError:function(){return D||M},getStreams:Ue,getActiveStream:function(){return A},getInitialPlayback:function(){return k},getAutoPlay:function(){return C},reset:je},s=(0,ze.default)(W).getInstance().getLogger(r),a=(0,Qe.default)(W).getInstance(),d=(0,Je.default)(W).getInstance(),v=(0,We.default)(W).getInstance(),xe(),r}a.__dashjs_factory_name="StreamController";const i=t.default.getSingletonFactory(a)},"./src/streaming/controllers/TimeSyncController.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>a});var P=r("./src/streaming/vo/DashJSError.js"),L=r("./src/streaming/vo/metrics/HTTPRequest.js"),F=r("./src/core/EventBus.js"),x=r("./src/core/events/Events.js"),j=r("./src/core/errors/Errors.js"),t=r("./src/core/FactoryMaker.js"),k=r("./src/core/Debug.js"),U=r("./src/streaming/utils/URLUtils.js");function n(){var e,s,n,t,l,i,a,o,u,c,r,f,d,g,h,m,p=this.context,y=(0,F.default)(p).getInstance(),E=(0,U.default)(p).getInstance();function _(){o=[],d=r=c=null,f=NaN,t=n=!(u=[]),g=l.get().streaming.utcSynchronization.timeBetweenSyncAttempts}function v(){l.get().streaming.utcSynchronization.enabled&&!n&&!t&&d&&d.value&&d.schemeIdUri&&!isNaN(f)&&!isNaN(l.get().streaming.utcSynchronization.backgroundAttempts)&&(r&&(Date.now()-r)/1e3<30||(o=[],t=!0,function r(n){try{if(n<=0)return void M();var a=Date.now();i[d.schemeIdUri](d.value,function(e){var t=Date.now(),e=T(a,t,e);o.push(e),r(n-1)},function(){M()})}catch(e){M()}}(isNaN(l.get().streaming.utcSynchronization.backgroundAttempts)?2:l.get().streaming.utcSynchronization.backgroundAttempts)))}function T(e,t,r){return r-(t-(t-e)/2)}function b(e){var t=0<arguments.length&&void 0!==e?e:NaN,r=isNaN(t);r&&l.get().streaming.utcSynchronization.useManifestDateHeaderTimeSource?(e=null!==(e=a.getLatestMPDRequestHeaderValueByID("Date"))?new Date(e).getTime():Number.NaN,isNaN(e)?D(!0):D(!1,e-Date.now())):D(r,t)}function S(e){var t,r,n=Date.parse(e);return isNaN(n)&&(r=/^([0-9]{4})-([0-9]{2})-([0-9]{2})T([0-9]{2}):([0-9]{2})(?::([0-9]*)(\.[0-9]*)?)?(?:([+\-])([0-9]{2})([0-9]{2}))?/.exec(t=e),e=Date.UTC(parseInt(r[1],10),parseInt(r[2],10)-1,parseInt(r[3],10),parseInt(r[4],10),parseInt(r[5],10),r[6]&&(parseInt(r[6],10)||0),r[7]&&1e3*parseFloat(r[7])||0),r[9]&&r[10]&&(t=60*parseInt(r[9],10)+parseInt(r[10],10),e+=("+"===r[8]?-1:1)*t*60*1e3),n=new Date(e).getTime()),n}function A(e){return Date.parse(e)}function R(e){return Date.parse(e)}function I(e,t,r){r()}function w(e,t,r){e=S(e);isNaN(e)?r():t(e)}function C(t,e,r,n,a){var i,o,s,l=!1,u=new XMLHttpRequest,c=a?L.HTTPRequest.HEAD:L.HTTPRequest.GET,f=e.match(/\S+/g);e=f.shift(),i=function(){l||(l=!0,f.length?C(t,f.join(" "),r,n,a):n())},o=function(){var e;200===u.status&&(e=a?u.getResponseHeader("Date"):u.response,e=t(e),isNaN(e)||(r(e),l=!0))},!E.isRelative(e)||(s=m.resolve())&&(e=E.resolve(e,s.url)),u.open(c,e),u.timeout=5e3,u.onload=o,u.onloadend=i,u.send()}function N(e,t,r){C(R,e,t,r,!0)}function D(e,t){var r;isNaN(f)||isNaN(t)||e||function(e){try{var t,r=O(e),n=isNaN(g)?30:g,a=isNaN(l.get().streaming.utcSynchronization.timeBetweenSyncAttemptsAdjustmentFactor)?2:l.get().streaming.utcSynchronization.timeBetweenSyncAttemptsAdjustmentFactor,i=isNaN(l.get().streaming.utcSynchronization.maximumTimeBetweenSyncAttempts)?600:l.get().streaming.utcSynchronization.maximumTimeBetweenSyncAttempts,o=isNaN(l.get().streaming.utcSynchronization.minimumTimeBetweenSyncAttempts)?2:l.get().streaming.utcSynchronization.minimumTimeBetweenSyncAttempts;r?(t=Math.min(n*a,i),s.debug("Increasing timeBetweenSyncAttempts to ".concat(t))):(t=Math.max(n/a,o),s.debug("Decreasing timeBetweenSyncAttempts to ".concat(t))),g=t}catch(e){}}(t),e||isNaN(t)||(c=Date.now(),n=!1,r=isNaN(f),f=t,r&&v(),s.debug("Completed UTC sync. Setting client - server offset to ".concat(t))),e&&(d=null,n=!1,h.error(new P.default(j.default.TIME_SYNC_FAILED_ERROR_CODE,j.default.TIME_SYNC_FAILED_ERROR_MESSAGE))),y.trigger(x.default.UPDATE_TIME_SYNC_OFFSET,{offset:t}),y.trigger(x.default.TIME_SYNCHRONIZATION_COMPLETED)}function M(){var e;o&&0!==o.length&&(O(e=o.reduce(function(e,t){return e+t},0)/o.length)?s.debug("Completed background UTC sync. Offset is within allowed threshold and is not adjusted."):(s.debug("Completed background UTC sync. Setting client - server offset to ".concat(e)),f=e,y.trigger(x.default.UPDATE_TIME_SYNC_OFFSET,{offset:f})),t=!1,r=Date.now())}function O(e){try{if(isNaN(f))return!0;var t=l.get().streaming.utcSynchronization.maximumAllowedDrift&&!isNaN(l.get().streaming.utcSynchronization.maximumAllowedDrift)?l.get().streaming.utcSynchronization.maximumAllowedDrift:100;return f-t<=e&&e<=f+t}catch(e){return!0}}return e={initialize:function(){_(),i={"urn:mpeg:dash:utc:http-head:2014":N,"urn:mpeg:dash:utc:http-xsdate:2014":C.bind(null,S),"urn:mpeg:dash:utc:http-iso:2014":C.bind(null,A),"urn:mpeg:dash:utc:direct:2014":w,"urn:mpeg:dash:utc:http-head:2012":N,"urn:mpeg:dash:utc:http-xsdate:2012":C.bind(null,S),"urn:mpeg:dash:utc:http-iso:2012":C.bind(null,A),"urn:mpeg:dash:utc:direct:2012":w,"urn:mpeg:dash:utc:http-ntp:2014":I,"urn:mpeg:dash:utc:ntp:2014":I,"urn:mpeg:dash:utc:sntp:2014":I}},attemptSync:function(e,t){u=e,n||(!function(e){try{if(!e||!l.get().streaming.utcSynchronization.enabled)return!1;var t=isNaN(g)?30:g;return c&&t&&!isNaN(t)?(Date.now()-c)/1e3>=t:!0}catch(e){return!0}}(t)?y.trigger(x.default.TIME_SYNCHRONIZATION_COMPLETED):(n=!0,function e(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null;var r=t||0;if(!u||0===u.length||r>=u.length)return void b();var n=u[r];{var a;n?i.hasOwnProperty(n.schemeIdUri)?(a=(new Date).getTime(),i[n.schemeIdUri](n.value,function(e){var t=(new Date).getTime(),e=T(a,t,e);d=n,b(e)},function(){e(r+1)})):e(r+1):b()}}()))},setConfig:function(e){e&&(e.dashMetrics&&(a=e.dashMetrics),e.baseURLController&&(m=e.baseURLController),e.errHandler&&(h=e.errHandler),e.settings&&(l=e.settings))},reset:function(){_(),y.off(x.default.ATTEMPT_BACKGROUND_SYNC,v,e)}},s=(0,k.default)(p).getInstance().getLogger(e),y.on(x.default.ATTEMPT_BACKGROUND_SYNC,v,e),e}n.__dashjs_factory_name="TimeSyncController";r=t.default.getSingletonFactory(n);r.HTTP_TIMEOUT_MS=5e3,t.default.updateSingletonFactory(n.__dashjs_factory_name,r);const a=r},"./src/streaming/controllers/XlinkController.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>a});var h=r("./src/streaming/XlinkLoader.js"),m=r("./src/core/EventBus.js"),p=r("./src/core/events/Events.js"),t=r("./src/core/FactoryMaker.js"),y=r("./externals/xml2json.js"),E=r("./src/streaming/utils/URLUtils.js"),_=r("./src/dash/constants/DashConstants.js"),v="onLoad";function n(e){e=e||{};var t,r,l,u,a,s,n=this.context,i=(0,m.default)(n).getInstance(),c=(0,E.default)(n).getInstance();function o(e,t,r){var n,a,i={};i.elements=e,i.type=t,i.resolveType=r,0===i.elements.length&&d(i);for(var o=0;o<i.elements.length;o++)n=i.elements[o],a=c.isHTTPURL(n.url)?n.url:n.originalContent.BaseURL+n.url,s.load(a,n,i)}function f(e){var t,r=e.element,n=e.resolveObject;r.resolvedContent&&((e=0)===r.resolvedContent.indexOf("<?xml")&&(e=r.resolvedContent.indexOf("?>")+2),t=r.resolvedContent.substr(0,e)+"<response>"+r.resolvedContent.substr(e)+"</response>",r.resolvedContent=a.xml_str2json(t)),function(e){var t;for(t=0;t<e.elements.length;t++)if(!1===e.elements[t].resolved)return!1;return!0}(n)&&d(n)}function d(e){var t,r,n=[];if(!function(e){var t,r,n,a,i,o,s=[];for(a=e.elements.length-1;0<=a;a--){if(t=e.elements[a],r=t.type+"_asArray",t.resolvedContent){if(t.resolvedContent)for(i=0;i<t.resolvedContent[r].length;i++)n=t.resolvedContent[r][i],s.push(n)}else delete t.originalContent["xlink:actuate"],delete t.originalContent["xlink:href"],s.push(t.originalContent);for(t.parentElement[r].splice(t.index,1),o=0;o<s.length;o++)t.parentElement[r].splice(t.index+o,0,s[o]);s=[]}0<e.elements.length&&l.run(u)}(e),"onActuate"===e.resolveType&&i.trigger(p.default.XLINK_READY,{manifest:u}),e.resolveType===v)switch(e.type){case _.default.PERIOD:for(t=0;t<u[_.default.PERIOD+"_asArray"].length;t++)(r=u[_.default.PERIOD+"_asArray"][t]).hasOwnProperty(_.default.ADAPTATION_SET+"_asArray")&&(n=n.concat(g(r[_.default.ADAPTATION_SET+"_asArray"],r,_.default.ADAPTATION_SET,v))),r.hasOwnProperty(_.default.EVENT_STREAM+"_asArray")&&(n=n.concat(g(r[_.default.EVENT_STREAM+"_asArray"],r,_.default.EVENT_STREAM,v)));o(n,_.default.ADAPTATION_SET,v);break;case _.default.ADAPTATION_SET:i.trigger(p.default.XLINK_READY,{manifest:u})}}function g(e,t,r,n){for(var a,i,o=[],s=e.length-1;0<=s;s--)(a=e[s]).hasOwnProperty("xlink:href")&&"urn:mpeg:dash:resolve-to-zero:2013"===a["xlink:href"]&&e.splice(s,1);for(s=0;s<e.length;s++)(a=e[s]).hasOwnProperty("xlink:href")&&a.hasOwnProperty("xlink:actuate")&&a["xlink:actuate"]===n&&(i={url:a["xlink:href"],parentElement:t,type:r,index:s,resolveType:n,originalContent:a,resolvedContent:null,resolved:!1},o.push(i));return o}return t={resolveManifestOnLoad:function(e){a=new y.default({escapeMode:!1,attributePrefix:"",arrayAccessForm:"property",emptyNodeForm:"object",stripWhitespaces:!1,enableToStringFunc:!1,ignoreRoot:!0,matchers:r}),(u=e).Period_asArray?o(g(u.Period_asArray,u,_.default.PERIOD,v),_.default.PERIOD,v):i.trigger(p.default.XLINK_READY,{manifest:u})},setMatchers:function(e){e&&(r=e)},setIron:function(e){e&&(l=e)},reset:function(){i.off(p.default.XLINK_ELEMENT_LOADED,f,t),s&&(s.reset(),s=null)}},i.on(p.default.XLINK_ELEMENT_LOADED,f,t),s=(0,h.default)(n).create({errHandler:e.errHandler,dashMetrics:e.dashMetrics,mediaPlayerModel:e.mediaPlayerModel,requestModifier:e.requestModifier,settings:e.settings}),t}n.__dashjs_factory_name="XlinkController";const a=t.default.getClassFactory(n)},"./src/streaming/metrics/MetricsReporting.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>l});var n=r("./src/streaming/metrics/utils/DVBErrorsTranslator.js"),t=r("./src/streaming/metrics/MetricsReportingEvents.js"),a=r("./src/streaming/metrics/controllers/MetricsCollectionController.js"),i=r("./src/streaming/metrics/metrics/MetricsHandlerFactory.js"),o=r("./src/streaming/metrics/reporting/ReportingFactory.js");function s(){var t=this.context;return{createMetricsReporting:function(e){return(0,n.default)(t).getInstance({eventBus:e.eventBus,dashMetrics:e.dashMetrics,metricsConstants:e.metricsConstants,events:e.events}).initialise(),(0,a.default)(t).create(e)},getReportingFactory:function(){return(0,o.default)(t).getInstance()},getMetricsHandlerFactory:function(){return(0,i.default)(t).getInstance()}}}s.__dashjs_factory_name="MetricsReporting";r=dashjs.FactoryMaker.getClassFactory(s);r.events=t.default,dashjs.FactoryMaker.updateClassFactory(s.__dashjs_factory_name,r);const l=r},"./src/streaming/metrics/MetricsReportingEvents.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>l});var n=r("./src/core/events/EventsBase.js");function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){return(i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function o(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=s(r);return e=n?(e=s(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),t=this,!(e=e)||"object"!==a(e)&&"function"!=typeof e?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(t):e}}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}const l=new(function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&i(e,t)}(r,n["default"]);var t=o(r);function r(){var e;return function(e){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}(this),(e=t.call(this)).METRICS_INITIALISATION_COMPLETE="internal_metricsReportingInitialized",e.BECAME_REPORTING_PLAYER="internal_becameReportingPlayer",e.CMCD_DATA_GENERATED="cmcdDataGenerated",e}return r}())},"./src/streaming/metrics/controllers/MetricsCollectionController.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>a});var l=r("./src/streaming/metrics/controllers/MetricsController.js"),u=r("./src/streaming/metrics/utils/ManifestParsing.js"),c=r("./src/streaming/metrics/MetricsReportingEvents.js");function n(a){var e;a=a||{};var i={},o=this.context,t=a.eventBus,r=a.events;function n(e){var n;e.error||(n=Object.keys(i),(0,u.default)(o).getInstance({adapter:a.adapter,constants:a.constants}).getMetrics(e.manifest).forEach(function(e){var t=JSON.stringify(e);if(i.hasOwnProperty(t))n.splice(t,1);else try{var r=(0,l.default)(o).create(a);r.initialize(e),i[t]=r}catch(e){}}),n.forEach(function(e){i[e].reset(),delete i[e]}),t.trigger(c.default.METRICS_INITIALISATION_COMPLETE))}function s(){Object.keys(i).forEach(function(e){i[e].reset()}),i={}}return e={reset:function(){t.off(r.MANIFEST_UPDATED,n,e),t.off(r.STREAM_TEARDOWN_COMPLETE,s,e)}},t.on(r.MANIFEST_UPDATED,n,e),t.on(r.STREAM_TEARDOWN_COMPLETE,s,e),e}n.__dashjs_factory_name="MetricsCollectionController";const a=dashjs.FactoryMaker.getClassFactory(n)},"./src/streaming/metrics/controllers/MetricsController.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>a});var s=r("./src/streaming/metrics/controllers/RangeController.js"),l=r("./src/streaming/metrics/controllers/ReportingController.js"),u=r("./src/streaming/metrics/controllers/MetricsHandlersController.js");function n(t){var r,n,a;t=t||{};var i=this.context;function o(){r&&r.reset(),n&&n.reset(),a&&a.reset()}return{initialize:function(e){try{(a=(0,s.default)(i).create({mediaElement:t.mediaElement})).initialize(e.Range),(n=(0,l.default)(i).create({debug:t.debug,metricsConstants:t.metricsConstants,mediaPlayerModel:t.mediaPlayerModel})).initialize(e.Reporting,a),(r=(0,u.default)(i).create({debug:t.debug,eventBus:t.eventBus,metricsConstants:t.metricsConstants,events:t.events})).initialize(e.metrics,n)}catch(e){throw o(),e}},reset:o}}n.__dashjs_factory_name="MetricsController";const a=dashjs.FactoryMaker.getClassFactory(n)},"./src/streaming/metrics/controllers/MetricsHandlersController.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>i});var a=r("./src/streaming/metrics/metrics/MetricsHandlerFactory.js");function n(e){e=e||{};var t,i=[],r=this.context,n=e.eventBus,o=e.events,s=(0,a.default)(r).getInstance({debug:e.debug,eventBus:e.eventBus,metricsConstants:e.metricsConstants});function l(t){i.forEach(function(e){e.handleNewMetric(t.metric,t.value,t.mediaType)})}return t={initialize:function(e,a){e.split(",").forEach(function(e,t,r){var n;-1===e.indexOf("(")||-1!==e.indexOf(")")||(n=r[t+1])&&-1===n.indexOf("(")&&-1!==n.indexOf(")")&&(e+=","+n,delete r[t+1]),(e=s.create(e,a))&&i.push(e)}),n.on(o.METRIC_ADDED,l,t),n.on(o.METRIC_UPDATED,l,t)},reset:function(){n.off(o.METRIC_ADDED,l,t),n.off(o.METRIC_UPDATED,l,t),i.forEach(function(e){return e.reset()}),i=[]}}}n.__dashjs_factory_name="MetricsHandlersController";const i=dashjs.FactoryMaker.getClassFactory(n)},"./src/streaming/metrics/controllers/RangeController.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>i});var n=r("./src/streaming/utils/CustomTimeRanges.js");function a(e){e=e||{};var i,o=!1,t=this.context,s=e.mediaElement;return e={initialize:function(e){e&&e.length&&(e.forEach(function(e){var t=e.starttime,e=t+e.duration;i.add(t,e)}),o=!!e[0]._useWallClockTime)},reset:function(){i.clear()},isEnabled:function(){var e=i.length;if(!e)return!0;for(var t=o?(new Date).getTime()/1e3:s.currentTime,r=0;r<e;r+=1){var n=i.start(r),a=i.end(r);if(n<=t&&t<a)return!0}return!1}},i=(0,n.default)(t).create(),e}a.__dashjs_factory_name="RangeController";const i=dashjs.FactoryMaker.getClassFactory(a)},"./src/streaming/metrics/controllers/ReportingController.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>i});var a=r("./src/streaming/metrics/reporting/ReportingFactory.js");function n(e){var n=[],r=(0,a.default)(this.context).getInstance(e);return{initialize:function(e,t){e.some(function(e){e=r.create(e,t);if(e)return n.push(e),!0})},reset:function(){n.forEach(function(e){return e.reset()}),n=[]},report:function(t,r){n.forEach(function(e){return e.report(t,r)})}}}n.__dashjs_factory_name="ReportingController";const i=dashjs.FactoryMaker.getClassFactory(n)},"./src/streaming/metrics/metrics/MetricsHandlerFactory.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>i});var n=r("./src/streaming/metrics/metrics/handlers/BufferLevelHandler.js"),u=r("./src/streaming/metrics/metrics/handlers/DVBErrorsHandler.js"),c=r("./src/streaming/metrics/metrics/handlers/HttpListHandler.js"),f=r("./src/streaming/metrics/metrics/handlers/GenericMetricHandler.js");function a(a){var e,i=(a=a||{}).debug?a.debug.getLogger(e):{},o=/([a-zA-Z]*)(\(([0-9]*)(\,\s*([a-zA-Z]*))?\))?/,s=this.context,l={BufferLevel:n.default,DVBErrors:u.default,HttpList:c.default,PlayList:f.default,RepSwitchList:f.default,TcpList:f.default};return e={create:function(e,t){var r,n=e.match(o);if(n){try{(r=l[n[1]](s).create({eventBus:a.eventBus,metricsConstants:a.metricsConstants})).initialize(n[1],t,n[3],n[5])}catch(e){r=null,i.error("MetricsHandlerFactory: Could not create handler for type ".concat(n[1]," with args ").concat(n[3],", ").concat(n[5]," (").concat(e.message,")"))}return r}},register:function(e,t){l[e]=t},unregister:function(e){delete l[e]}}}a.__dashjs_factory_name="MetricsHandlerFactory";const i=dashjs.FactoryMaker.getSingletonFactory(a)},"./src/streaming/metrics/metrics/handlers/BufferLevelHandler.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>a});var f=r("./src/streaming/metrics/utils/HandlerHelpers.js");function n(e){var n,a,i,o,t;e=e||{};var r=this.context,s=(0,f.default)(r).getInstance(),l=[],u=e.metricsConstants;function c(){var e=function(){try{return Object.keys(l).map(function(e){return l[e]}).reduce(function(e,t){return e.level<t.level?e:t})}catch(e){return}}();e&&t!==e.t&&(t=e.t,n.report(i,e))}return{initialize:function(e,t,r){t&&(a=s.validateN(r),n=t,i=s.reconstructFullMetricName(e,r),o=setInterval(c,a))},reset:function(){clearInterval(o),a=0,t=n=o=null},handleNewMetric:function(e,t,r){e===u.BUFFER_LEVEL&&(l[r]=t)}}}n.__dashjs_factory_name="BufferLevelHandler";const a=dashjs.FactoryMaker.getClassFactory(n)},"./src/streaming/metrics/metrics/handlers/DVBErrorsHandler.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>n});var o=r("./src/streaming/metrics/MetricsReportingEvents.js");const n=dashjs.FactoryMaker.getClassFactory(function(e){var r,n=(e=e||{}).eventBus,a=e.metricsConstants;function i(){n.off(o.default.METRICS_INITIALISATION_COMPLETE,i,this),n.trigger(o.default.BECAME_REPORTING_PLAYER)}return{initialize:function(e,t){t&&(r=t,n.on(o.default.METRICS_INITIALISATION_COMPLETE,i,this))},reset:function(){r=null},handleNewMetric:function(e,t){e===a.DVB_ERRORS&&r&&r.report(e,t)}}})},"./src/streaming/metrics/metrics/handlers/GenericMetricHandler.js":(e,t,r)=>{function n(){var r,n;return{initialize:function(e,t){r=e,n=t},reset:function(){n=null,r=void 0},handleNewMetric:function(e,t){e===r&&n&&n.report(r,t)}}}r.r(t),r.d(t,{default:()=>a}),n.__dashjs_factory_name="GenericMetricHandler";const a=dashjs.FactoryMaker.getClassFactory(n)},"./src/streaming/metrics/metrics/handlers/HttpListHandler.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>a});var f=r("./src/streaming/metrics/utils/HandlerHelpers.js");function n(e){var a,i,o,s,l;e=e||{};var r=[],u=(0,f.default)(this.context).getInstance(),n=e.metricsConstants;function c(){r.length&&a&&a.report(s,r),r=[]}return{initialize:function(e,t,r,n){t&&(i=u.validateN(r),a=t,n&&n.length&&(o=n),s=u.reconstructFullMetricName(e,r,n),l=setInterval(c,i))},reset:function(){clearInterval(l),r=[],a=o=i=l=null},handleNewMetric:function(e,t){e===n.HTTP_REQUEST&&(o&&o!==t.type||r.push(t))}}}n.__dashjs_factory_name="HttpListHandler";const a=dashjs.FactoryMaker.getClassFactory(n)},"./src/streaming/metrics/reporting/ReportingFactory.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>a});var l=r("./src/streaming/metrics/reporting/reporters/DVBReporting.js");function n(e){e=e||{};var t,n={"urn:dvb:dash:reporting:2014":l.default},a=this.context,i=e.debug?e.debug.getLogger(t):{},o=e.metricsConstants,s=e.mediaPlayerModel||{};return t={create:function(t,e){var r;try{(r=n[t.schemeIdUri](a).create({metricsConstants:o,mediaPlayerModel:s})).initialize(t,e)}catch(e){r=null,i.error("ReportingFactory: could not create Reporting with schemeIdUri ".concat(t.schemeIdUri," (").concat(e.message,")"))}return r},register:function(e,t){n[e]=t},unregister:function(e){delete n[e]}}}n.__dashjs_factory_name="ReportingFactory";const a=dashjs.FactoryMaker.getSingletonFactory(n)},"./src/streaming/metrics/reporting/reporters/DVBReporting.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>a});var g=r("./src/streaming/metrics/utils/MetricSerialiser.js"),h=r("./src/streaming/metrics/utils/RNG.js"),m=r("./src/streaming/models/CustomParametersModel.js");function n(e){e=e||{};var r,i,n,a,o,s,l,t=this.context,u=[],c=e.metricsConstants;function f(e,t,r){var n=new XMLHttpRequest;n.withCredentials=i.getXHRWithCredentialsForType(c.HTTP_REQUEST_DVB_REPORTING_TYPE);function a(){var e=u.indexOf(n);-1!==e&&(u.splice(e,1),200<=n.status&&n.status<300?t&&t():r&&r())}u.push(n);try{n.open("GET",e),n.onloadend=a,n.onerror=a,n.send()}catch(e){n.onerror()}}function d(){o=a=!1,l=s=null}return e={report:function(t,e){Array.isArray(e)||(e=[e]),o&&l.isEnabled()&&e.forEach(function(e){e=r.serialise(e);t!==c.DVB_ERRORS&&(e="metricname=".concat(t,"&").concat(e)),f(e="".concat(s,"?").concat(e),null,function(){o=!1})})},initialize:function(e,t){if(l=t,!(s=e.dvb_reportingUrl))throw new Error("required parameter missing (dvb:reportingUrl)");a||((e=e.dvb_probability)&&(1e3===e||e/1e3>=n.random())&&(o=!0),a=!0)},reset:function(){d()}},r=(0,g.default)(t).getInstance(),n=(0,h.default)(t).getInstance(),i=(0,m.default)(t).getInstance(),d(),e}n.__dashjs_factory_name="DVBReporting";const a=dashjs.FactoryMaker.getClassFactory(n)},"./src/streaming/metrics/utils/DVBErrorsTranslator.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>a});var g=r("./src/streaming/metrics/vo/DVBErrors.js"),h=r("./src/streaming/metrics/MetricsReportingEvents.js");function n(e){var t,n,r=(e=e||{}).eventBus,a=e.dashMetrics,i=e.metricsConstants,o=e.events;function s(e){var t=new g.default;if(n){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.mpdurl||(t.mpdurl=n.originalUrl||n.url),t.terror||(t.terror=new Date),a.addDVBErrors(t)}}function l(e){e.error||(n=e.manifest)}function u(e){s({errorcode:g.default.BASE_URL_CHANGED,servicelocation:e.entry})}function c(){s({errorcode:g.default.BECAME_REPORTER})}function f(e){var t;e.metric===i.HTTP_REQUEST&&(0===(t=e.value).responsecode||null==t.responsecode||400<=t.responsecode||t.responsecode<100||600<=t.responsecode)&&s({errorcode:t.responsecode||g.default.CONNECTION_ERROR,url:t.url,terror:t.tresponse,servicelocation:t._serviceLocation})}function d(e){var t;switch(e.error?e.error.code:0){case MediaError.MEDIA_ERR_NETWORK:t=g.default.CONNECTION_ERROR;break;case MediaError.MEDIA_ERR_DECODE:t=g.default.CORRUPT_MEDIA_OTHER;break;default:return}s({errorcode:t})}return t={initialise:function(){r.on(o.MANIFEST_UPDATED,l,t),r.on(o.SERVICE_LOCATION_BLACKLIST_CHANGED,u,t),r.on(o.METRIC_ADDED,f,t),r.on(o.METRIC_UPDATED,f,t),r.on(o.PLAYBACK_ERROR,d,t),r.on(h.default.BECAME_REPORTING_PLAYER,c,t)},reset:function(){r.off(o.MANIFEST_UPDATED,l,t),r.off(o.SERVICE_LOCATION_BLACKLIST_CHANGED,u,t),r.off(o.METRIC_ADDED,f,t),r.off(o.METRIC_UPDATED,f,t),r.off(o.PLAYBACK_ERROR,d,t),r.off(h.default.BECAME_REPORTING_PLAYER,c,t)}}}n.__dashjs_factory_name="DVBErrorsTranslator";const a=dashjs.FactoryMaker.getSingletonFactory(n)},"./src/streaming/metrics/utils/HandlerHelpers.js":(e,t,r)=>{function n(){return{reconstructFullMetricName:function(e,t,r){return t&&(e+="("+t,r&&r.length&&(e+=","+r),e+=")"),e},validateN:function(e){if(!e)throw new Error("missing n");if(isNaN(e))throw new Error("n is NaN");if(e<0)throw new Error("n must be positive");return e}}}r.r(t),r.d(t,{default:()=>a}),n.__dashjs_factory_name="HandlerHelpers";const a=dashjs.FactoryMaker.getSingletonFactory(n)},"./src/streaming/metrics/utils/ManifestParsing.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>o});var n=r("./src/streaming/metrics/vo/Metrics.js"),c=r("./src/streaming/metrics/vo/Range.js"),a=r("./src/streaming/metrics/vo/Reporting.js");function i(e){var l=(e=e||{}).adapter,u=e.constants;return{getMetrics:function(s){var t=[];return s&&s.Metrics_asArray&&s.Metrics_asArray.forEach(function(e){var i=new n.default,o=l.getIsDynamic(s);e.hasOwnProperty("metrics")&&(i.metrics=e.metrics,e.Range_asArray&&e.Range_asArray.forEach(function(e){var t,r,n,a=new c.default;a.starttime=(t=s,r=e,n=0,o?n=l.getAvailabilityStartTime(t)/1e3:(t=l.getRegularPeriods(t)).length&&(n=t[0].start),n=n,r&&r.hasOwnProperty(u.START_TIME)&&(n+=r.starttime),n),e.hasOwnProperty("duration")?a.duration=e.duration:a.duration=l.getDuration(s),a._useWallClockTime=o,i.Range.push(a)}),e.Reporting_asArray&&(e.Reporting_asArray.forEach(function(e){var t=new a.default;e.hasOwnProperty(u.SCHEME_ID_URI)&&(t.schemeIdUri=e.schemeIdUri,e.hasOwnProperty("value")&&(t.value=e.value),e.hasOwnProperty(u.DVB_REPORTING_URL)&&(t.dvb_reportingUrl=e[u.DVB_REPORTING_URL]),e.hasOwnProperty(u.DVB_PROBABILITY)&&(t.dvb_probability=e[u.DVB_PROBABILITY]),i.Reporting.push(t))}),t.push(i)))}),t}}}i.__dashjs_factory_name="ManifestParsing";const o=dashjs.FactoryMaker.getSingletonFactory(i)},"./src/streaming/metrics/utils/MetricSerialiser.js":(e,t,r)=>{function n(){return{serialise:function r(e){var t,n,a=[],i=[];for(t in e)if(e.hasOwnProperty(t)&&0!==t.indexOf("_")){if(null==(n=e[t])&&(n=""),Array.isArray(n)){if(!n.length)continue;i=[],n.forEach(function(e){var t="Object"!==Object.prototype.toString.call(e).slice(8,-1);i.push(t?e:r(e))}),n=i.map(encodeURIComponent).join(",")}else"string"==typeof n?n=encodeURIComponent(n):n instanceof Date?n=n.toISOString():"number"==typeof n&&(n=Math.round(n));a.push(t+"="+n)}return a.join("&")}}}r.r(t),r.d(t,{default:()=>a}),n.__dashjs_factory_name="MetricSerialiser";const a=dashjs.FactoryMaker.getSingletonFactory(n)},"./src/streaming/metrics/utils/RNG.js":(e,t,r)=>{function n(){var n,a,e,i=window.crypto||window.msCrypto,t=Uint32Array,o=Math.pow(2,8*t.BYTES_PER_ELEMENT)-1,r=10;function s(){i&&(n=n||new t(r),i.getRandomValues(n),a=0)}return e={random:function(e,t){var r;return e=e||0,t=t||1,i?(a===n.length&&s(),r=n[a]/o,a+=1):r=Math.random(),r*(t-e)+e}},s(),e}r.r(t),r.d(t,{default:()=>a}),n.__dashjs_factory_name="RNG";const a=dashjs.FactoryMaker.getSingletonFactory(n)},"./src/streaming/metrics/vo/DVBErrors.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>n});t=function t(){!function(e){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),this.mpdurl=null,this.errorcode=null,this.terror=null,this.url=null,this.ipaddress=null,this.servicelocation=null};t.SSL_CONNECTION_FAILED_PREFIX="SSL",t.DNS_RESOLUTION_FAILED="C00",t.HOST_UNREACHABLE="C01",t.CONNECTION_REFUSED="C02",t.CONNECTION_ERROR="C03",t.CORRUPT_MEDIA_ISOBMFF="M00",t.CORRUPT_MEDIA_OTHER="M01",t.BASE_URL_CHANGED="F00",t.BECAME_REPORTER="S00";const n=t},"./src/streaming/metrics/vo/Metrics.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>n});const n=function t(){!function(e){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),this.metrics="",this.Range=[],this.Reporting=[]}},"./src/streaming/metrics/vo/Range.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>n});const n=function t(){!function(e){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),this.starttime=0,this.duration=1/0,this._useWallClockTime=!1}},"./src/streaming/metrics/vo/Reporting.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>n});const n=function t(){!function(e){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),this.schemeIdUri="",this.value="",this.dvb_reportingUrl="",this.dvb_probability=1e3}},"./src/streaming/models/BaseURLTreeModel.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>a});var s=r("./src/streaming/utils/ObjectUtils.js"),r=r("./src/core/FactoryMaker.js");function l(e,t){!function(e){if(!(e instanceof l))throw new TypeError("Cannot call a class as a function")}(this),this.data={baseUrls:e||null,selectedIdx:t||NaN},this.children=[]}function n(){var a,i,e=this.context,n=(0,s.default)(e).getInstance();function o(e,t,r){r=i.getBaseURLsFromElement(r);e[t]?n.areEqual(r,e[t].data.baseUrls)||(e[t].data.baseUrls=r,e[t].data.selectedIdx=NaN):e[t]=new l(r)}function t(e){!function(){if(!i||!i.hasOwnProperty("getBaseURLsFromElement")||!i.hasOwnProperty("getRepresentationSortFunction"))throw new Error("setConfig function has to be called previously")}();var t=i.getBaseURLsFromElement(e);n.areEqual(t,a.data.baseUrls)||(a.data.baseUrls=t,a.data.selectedIdx=NaN),e&&e.Period_asArray&&e.Period_asArray.forEach(function(e,n){o(a.children,n,e),e.AdaptationSet_asArray&&e.AdaptationSet_asArray.forEach(function(e,r){o(a.children[n].children,r,e),e.Representation_asArray&&e.Representation_asArray.sort(i.getRepresentationSortFunction()).forEach(function(e,t){o(a.children[n].children[r].children,t,e)})})})}function r(){a=new l}return e={reset:r,update:function(e){t(e)},getForPath:function(e){var t=a,r=[t.data];return e&&e.forEach(function(e){(t=t.children[e])&&r.push(t.data)}),r.filter(function(e){return e.baseUrls.length})},invalidateSelectedIndexes:function(t){!function t(r,e){e=e||a;r(e.data),e.children&&e.children.forEach(function(e){return t(r,e)})}(function(e){isNaN(e.selectedIdx)||t===e.baseUrls[e.selectedIdx].serviceLocation&&(e.selectedIdx=NaN)})},setConfig:function(e){e.adapter&&(i=e.adapter)}},r(),e}n.__dashjs_factory_name="BaseURLTreeModel";const a=r.default.getClassFactory(n)},"./src/streaming/models/CmcdModel.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>a});var I=r("./src/core/EventBus.js"),w=r("./src/streaming/MediaPlayerEvents.js"),C=r("./src/streaming/metrics/MetricsReportingEvents.js"),t=r("./src/core/FactoryMaker.js"),N=r("./src/core/Settings.js"),D=r("./src/streaming/constants/Constants.js"),M=r("./src/streaming/vo/metrics/HTTPRequest.js"),O=r("./src/dash/models/DashManifestModel.js"),P=r("./src/core/Utils.js");function L(e,t){var r;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return s(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return s(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,t=function(){};return{s:t,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:t}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,o=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return i=e.done,e},e:function(e){o=!0,a=e},f:function(){try{i||null==r.return||r.return()}finally{if(o)throw a}}}}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var F="m",x="a",j="v",k="i",U="c",B="tt",G="k",q="o",H="d",Y="s",V="v",K="l";function n(){var n,e,d,g,h,m,p,y,E,_,t=this.context,o=(0,I.default)(t).getInstance(),v=(0,N.default)(t).getInstance();function r(){d={pr:1,nor:null,st:null,sf:null,sid:"".concat(P.default.generateUuid()),cid:null},E={},y={},_={},i()}function a(){i()}function i(){var e;!m||(e=m.getStreamController())&&("function"!=typeof e.getActiveStream||(e=e.getActiveStream())&&(p=e.getProcessors()))}function s(e,t){var r={},n=L(t);try{for(n.s();!(a=n.n()).done;){var a=a.value;e[a]&&(r[a]=e[a])}}catch(e){n.e(e)}finally{n.f()}return r}function l(e){var t=v.get().streaming.cmcd.enabledKeys;return e.filter(function(e){return t.includes(e)})}function u(e){try{return e.type===M.HTTPRequest.MPD_TYPE?((n=T()).ot=F,n):e.type===M.HTTPRequest.MEDIA_SEGMENT_TYPE?(r=e.mediaType,_.hasOwnProperty(r)||(_[r]=!1),y.hasOwnProperty(r)||(y[r]=!1),E.hasOwnProperty(r)||(E[r]=!1),function(e){var t,r=T(),n=function(e){try{var t=e.quality,r=e.mediaInfo.bitrateList;return parseInt(r[t].bandwidth/1e3)}catch(e){return null}}(e),a=function(e){try{return isNaN(e.duration)?null:Math.round(1e3*e.duration)}catch(e){return null}}(e),i=function(e){try{return 100*parseInt(g.getThroughputHistory().getSafeAverageThroughput(e)/100)}catch(e){return null}}(e.mediaType),o=function(e){try{var t=d.pr,r=h.getCurrentBufferLevel(e);return isNaN(t)||isNaN(r)?null:100*parseInt(r/t*10)}catch(e){return null}}(e.mediaType),s=b(e.mediaType),l=function(e){try{var t=g.getTopBitrateInfoFor(e);return Math.round(t.bitrate/1e3)}catch(e){return null}}(e.mediaType),u=d.pr,c=function(e){if(!p||0===p.length)return;var t=L(p);try{for(t.s();!(r=t.n()).done;){var r=r.value;if(r.getType()===e)return r.probeNextRequest()}}catch(e){t.e(e)}finally{t.f()}}(e.mediaType);e.mediaType===D.default.VIDEO&&(t=j);e.mediaType===D.default.AUDIO&&(t=x);e.mediaType===D.default.TEXT&&(t="application/mp4"===e.mediaInfo.mimeType?B:U);var f=v.get().streaming.cmcd.rtp;f=f||function(e){var t=m.getPlaybackRate();t=t||1;var r=e.quality,n=e.mediaType,a=e.mediaInfo,e=e.duration,n=b(n);0===n&&(n=500);n=a.bitrateList[r].bandwidth*e/1e3/(n/t/1e3),t=v.get().streaming.cmcd.rtpSafetyFactor&&!isNaN(v.get().streaming.cmcd.rtpSafetyFactor)?v.get().streaming.cmcd.rtpSafetyFactor:5;return 100*(parseInt(n*t/100)+1)}(e);r.rtp=f,c&&(e.url!==c.url?r.nor=encodeURIComponent(P.default.getRelativeUrl(e.url,c.url)):c.range&&(r.nrr=c.range));n&&(r.br=n);t&&(r.ot=t);isNaN(a)||(r.d=a);isNaN(i)||(r.mtp=i);isNaN(o)||(r.dl=o);isNaN(s)||(r.bl=s);isNaN(l)||(r.tb=l);isNaN(u)||1===u||(r.pr=u);E[e.mediaType]&&(r.bs=!0,E[e.mediaType]=!1);!y[e.mediaType]&&_[e.mediaType]||(r.su=!0,y[e.mediaType]=!1,_[e.mediaType]=!0);return r}(e)):e.type===M.HTTPRequest.INIT_SEGMENT_TYPE?((r=T()).ot=k,r.su=!0,r):e.type===M.HTTPRequest.OTHER_TYPE||e.type===M.HTTPRequest.XLINK_EXPANSION_TYPE?((t=T()).ot=q,t):e.type===M.HTTPRequest.LICENSE?((t=T()).ot=G,t):null}catch(e){return null}var t,r,n}function T(){var e={},t=(v.get().streaming.cmcd.cid?v.get().streaming.cmcd:d).cid;return e.v=1,e.sid=(v.get().streaming.cmcd.sid?v.get().streaming.cmcd:d).sid,e.sid="".concat(e.sid),t&&(e.cid="".concat(t)),isNaN(d.pr)||1===d.pr||null===d.pr||(e.pr=d.pr),d.st&&(e.st=d.st),d.sf&&(e.sf=d.sf),e}function b(e){try{var t=h.getCurrentBufferLevel(e);return isNaN(t)?null:100*parseInt(10*t)}catch(e){return null}}function c(e){try{d.pr=e.playbackRate}catch(e){}}function f(e){try{var t=n.getIsDynamic(e.data)?K:V,r=e.protocol&&"MSS"===e.protocol?Y:H;d.st="".concat(t),d.sf="".concat(r)}catch(e){}}function S(e){try{e.state&&e.mediaType&&e.state===w.default.BUFFER_EMPTY&&(E[e.mediaType]||(E[e.mediaType]=!0),y[e.mediaType]||(y[e.mediaType]=!0))}catch(e){}}function A(){for(var e in E)E.hasOwnProperty(e)&&(E[e]=!0);for(var t in y)y.hasOwnProperty(t)&&(y[t]=!0)}function R(n){try{if(!n)return null;var e=Object.keys(n).sort(function(e,t){return e.localeCompare(t)}),a=e.length,e=e.reduce(function(e,t,r){return"v"===t&&1===n[t]||("string"==typeof n[t]&&"ot"!==t&&"sf"!==t&&"st"!==t?e+="".concat(t,"=").concat(JSON.stringify(n[t])):e+="".concat(t,"=").concat(n[t]),r<a-1&&(e+=",")),e},"");return e=(e=e.replace(/=true/g,"")).replace(/,\s*$/,"")}catch(e){return null}}return e={getQueryParameter:function(e){try{if(v.get().streaming.cmcd&&v.get().streaming.cmcd.enabled){var t=u(e),r=R(function(r){try{var t=v.get().streaming.cmcd.enabledKeys;return Object.keys(r).filter(function(e){return t.includes(e)}).reduce(function(e,t){return e[t]=r[t],e},{})}catch(e){return r}}(t));return o.trigger(C.default.CMCD_DATA_GENERATED,{url:e.url,mediaType:e.mediaType,cmcdData:t,cmcdString:r}),{key:"CMCD",value:r}}return null}catch(e){return null}},getHeaderParameters:function(e){try{if(v.get().streaming.cmcd&&v.get().streaming.cmcd.enabled){var t=u(e),r=s(t,l(["br","d","ot","tb"])),n=s(t,l(["bl","dl","mtp","nor","nrr","su"])),a=s(t,l(["bs","rtp"])),i=s(t,l(["cid","pr","sf","sid","st","v"])),i={"CMCD-Object":R(r),"CMCD-Request":R(n),"CMCD-Status":R(a),"CMCD-Session":R(i)};return o.trigger(C.default.CMCD_DATA_GENERATED,{url:e.url,mediaType:e.mediaType,cmcdData:t,headers:i}),i}return null}catch(e){return null}},setConfig:function(e){e&&(e.abrController&&(g=e.abrController),e.dashMetrics&&(h=e.dashMetrics),e.playbackController&&(m=e.playbackController))},reset:function(){o.off(w.default.PLAYBACK_RATE_CHANGED,c,this),o.off(w.default.MANIFEST_LOADED,f,this),o.off(w.default.BUFFER_LEVEL_STATE_CHANGED,S,e),o.off(w.default.PLAYBACK_SEEKED,A,e),r()},initialize:function(){o.on(w.default.PLAYBACK_RATE_CHANGED,c,e),o.on(w.default.MANIFEST_LOADED,f,e),o.on(w.default.BUFFER_LEVEL_STATE_CHANGED,S,e),o.on(w.default.PLAYBACK_SEEKED,A,e),o.on(w.default.PERIOD_SWITCH_COMPLETED,a,e)}},n=(0,O.default)(t).getInstance(),r(),e}n.__dashjs_factory_name="CmcdModel";const a=t.default.getSingletonFactory(n)},"./src/streaming/models/CmsdModel.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>f});var t=r("./src/core/FactoryMaker.js"),a=r("./src/core/EventBus.js"),p=r("./src/core/events/Events.js"),i=r("./src/core/Debug.js");function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function y(e,t){y=function(e,t){return new r(e,void 0,t)};var n=l(RegExp),a=RegExp.prototype,i=new WeakMap;function r(e,t,r){t=n.call(this,e,t);return i.set(t,r||i.get(e)),t}function o(r,e){var n=i.get(e);return Object.keys(n).reduce(function(e,t){return e[t]=r[n[t]],e},Object.create(null))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&u(e,t)}(r,n),r.prototype.exec=function(e){e=a.exec.call(this,e);return e&&(e.groups=o(e,this)),e},r.prototype[Symbol.replace]=function(e,t){if("string"==typeof t){var r=i.get(this);return a[Symbol.replace].call(this,e,t.replace(/\$<([^>]+)>/g,function(e,t){return"$"+r[t]}))}if("function"!=typeof t)return a[Symbol.replace].call(this,e,t);var n=this;return a[Symbol.replace].call(this,e,function(){var e=[];return e.push.apply(e,arguments),"object"!==s(e[e.length-1])&&e.push(o(e,n)),t.apply(this,e)})},y.apply(this,arguments)}function l(e){var n="function"==typeof Map?new Map:void 0;return(l=function(e){if(null===e||(t=e,-1===Function.toString.call(t).indexOf("[native code]")))return e;var t;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==n){if(n.has(e))return n.get(e);n.set(e,r)}function r(){return o(e,arguments,c(this).constructor)}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),u(r,e)})(e)}function o(e,t,r){return(o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}()?Reflect.construct:function(e,t,r){var n=[null];n.push.apply(n,t);n=new(Function.bind.apply(e,n));return r&&u(n,r.prototype),n}).apply(null,arguments)}function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var E="dynamic",_="etp",v="mb",T="ot",b="rd",S="rtt",A="o",R="stream",I=[v,"st","sf","v"],w={video:"v",audio:"a",text:"tt",stream:R},C=/^[-0-9]/;function n(){var e,u,c,f,t=this.context,d=(0,a.default)(t).getInstance();function r(){c={},f={}}function g(t){t&&Object.keys(t).forEach(function(e){I.includes(e)||delete t[e]})}function h(e){return!e||"false"!==e.toLowerCase()&&(C.test(e)?parseInt(e,10):e.replace(/["]+/g,""))}function m(e){return w[e]||A}function n(e,t,r){e="static"===e?c:f,t=e[t]||{},e=e[R]||{};return t[r]||e[r]}return e={setConfig:function(){},initialize:function(){},reset:function(){r()},parseResponseHeaders:function(e,t){for(var r=null,n=null,a=e.split("\r\n"),i=a.length-1;0<=i;i--){var o=a[i].match(y(/^((?:(?!:)[\s\S])*):[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*(.*)$/,{key:1,value:2}));if(o&&o.groups){var s=o.groups.key.toLowerCase(),l=o.groups.value;switch(s){case"cmsd-static":r=function(e){try{for(var t={},r=e.split(","),n=0;n<r.length;n++){var a=r[n].split("="),i=a[0],a=h(a[1]);t[i]=a}return t}catch(e){u.error("Failed to parse CMSD-Static response header value:",e)}}(l),d.trigger(p.default.CMSD_STATIC_HEADER,r);break;case"cmsd-dynamic":n=n||function(e){try{for(var t={},r=e.split(","),n=r[r.length-1].split(";"),a=1;a<n.length;a++){var i=n[a].split("="),o=i[0],i=h(i[1]);t[o]=i}return t}catch(e){return u.error("Failed to parse CMSD-Dynamic response header value:",e),[]}}(l)}}}return e=R,r&&r[T]?e=r[T]:t&&(e=m(t)),g(c[e]),g(f[e]),r&&(c[e]=Object.assign(c[e]||{},r)),n&&(f[e]=Object.assign(f[e]||{},n)),{static:r,dynamic:n}},getMaxBitrate:function(e){return e=m(e),(e=n(E,e,v))||-1},getEstimatedThroughput:function(e){return e=m(e),(e=n(E,e,_))||null},getResponseDelay:function(e){return e=m(e),(e=n(E,e,b))||null},getRoundTripTime:function(e){return e=m(e),(e=n(E,e,S))||null}},u=(0,i.default)(t).getInstance().getLogger(e),r(),e}n.__dashjs_factory_name="CmsdModel";const f=t.default.getSingletonFactory(n)},"./src/streaming/models/CustomParametersModel.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>a});var h=r("./src/dash/vo/UTCTiming.js"),t=r("./src/core/FactoryMaker.js"),m=r("./src/core/Settings.js"),p=r("./src/streaming/utils/SupervisorTools.js"),y=r("./src/streaming/rules/abr/ABRRulesCollection.js"),E=r("./src/streaming/constants/Constants.js");function n(){var a,n,t,r,i,o,s,e=this.context,l=(0,m.default)(e).getInstance();function u(){t=[],r=[],i=[],s=[],o=null,a=[]}function c(e,r){var n=-1;e.some(function(e,t){if(e===r)return n=t,!0}),n<0||e.splice(n,1)}function f(e){for(var t=0;t<s.length;t++)if(s[t].rulename===e)return t;return-1}function d(e,t){g(e,t);var r=new h.default;r.schemeIdUri=e,r.value=t,a.push(r)}function g(r,n){(0,p.checkParameterType)(r,"string"),(0,p.checkParameterType)(n,"string"),a.forEach(function(e,t){e.schemeIdUri===r&&e.value===n&&a.splice(t,1)})}return n={default:!(e={getCustomInitialTrackSelectionFunction:function(){return o},setCustomInitialTrackSelectionFunction:function(e){o=e},resetCustomInitialTrackSelectionFunction:function(){o=null},getLicenseResponseFilters:function(){return r},getLicenseRequestFilters:function(){return t},getCustomCapabilitiesFilters:function(){return i},registerCustomCapabilitiesFilter:function(e){i.push(e)},registerLicenseResponseFilter:function(e){r.push(e)},registerLicenseRequestFilter:function(e){t.push(e)},unregisterCustomCapabilitiesFilter:function(e){c(i,e)},unregisterLicenseResponseFilter:function(e){c(r,e)},unregisterLicenseRequestFilter:function(e){c(t,e)},addAbrCustomRule:function(e,t,r){if("string"!=typeof e||e!==y.default.ABANDON_FRAGMENT_RULES&&e!==y.default.QUALITY_SWITCH_RULES||"string"!=typeof t)throw E.default.BAD_ARGUMENT_ERROR;var n=f(t);-1===n?s.push({type:e,rulename:t,rule:r}):(s[n].type=e,s[n].rule=r)},removeAllAbrCustomRule:function(){s=[]},removeAbrCustomRule:function(e){e?-1!==(e=f(e))&&s.splice(e,1):s=[]},getAbrCustomRules:function(){return s},addUTCTimingSource:d,removeUTCTimingSource:g,getUTCTimingSources:function(){return a},clearDefaultUTCTimingSources:function(){a=[]},restoreDefaultUTCTimingSources:function(){var e=l.get().streaming.utcSynchronization.defaultTimingSource;d(e.scheme,e.value)},setXHRWithCredentialsForType:function t(e,r){e?n[e]=!!r:Object.keys(n).forEach(function(e){t(e,r)})},getXHRWithCredentialsForType:function(e){return void 0===(e=n[e])?n.default:e},setConfig:function(){},reset:function(){u()}})},u(),e}n.__dashjs_factory_name="CustomParametersModel";const a=t.default.getSingletonFactory(n)},"./src/streaming/models/FragmentModel.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>a});var t=r("./src/core/FactoryMaker.js"),T=r("./src/streaming/vo/FragmentRequest.js"),b="loading",S="executed";function n(e){var t,r,o,a,n=(e=e||{}).eventBus,i=e.events,s=e.dashMetrics,l=e.fragmentLoader,u=e.debug,c=e.streamInfo,f=e.type;function d(a){var i;return!!a&&(i=!1,o.some(function(e){if(r=a,n=e,!isNaN(r.index)&&r.startTime===n.startTime&&r.adaptationIndex===n.adaptationIndex&&r.type===n.type||(n=a,t=e,isNaN(n.index)&&isNaN(t.index)&&n.quality===t.quality)||(t=e,(e=a).action===T.default.ACTION_COMPLETE&&e.action===t.action))return i=!0;var t,r,n}),i)}function g(e){return isNaN(e.duration)?.25:Math.min(e.duration/8,.5)}function h(r){o=o.filter(function(e){var t=g(e);return isNaN(e.startTime)||void 0!==r&&e.startTime>=r-t})}function m(r,n){n<=r+.5||(o=o.filter(function(e){var t=g(e);return isNaN(e.startTime)||e.startTime>=n-t||isNaN(e.duration)||e.startTime+e.duration<=r+t}))}function p(e,t){s.addSchedulingInfo(e,t),s.addRequestsQueue(e.mediaType,a,o)}function y(e){e.sender===l&&(a.splice(a.indexOf(e.request),1),e.response&&!e.error&&o.push(e.request),p(e.request,e.error?"failed":S),n.trigger(i.FRAGMENT_LOADING_COMPLETED,{request:e.request,response:e.response,error:e.error,sender:this},{streamId:c.id,mediaType:f}))}function E(e){e.sender===l&&n.trigger(i.FRAGMENT_LOADING_PROGRESS,{request:e.request,response:e.response,error:e.error,sender:this},{streamId:c.id,mediaType:f})}function _(e){e.sender===l&&n.trigger(i.FRAGMENT_LOADING_ABANDONED,{request:e.request},{streamId:c.id,mediaType:f})}function v(){o=[],a=[]}return t={getStreamId:function(){return c.id},getType:function(){return f},getRequests:function(t){var e=t?t.state instanceof Array?t.state:[t.state]:[],r=[];return e.forEach(function(e){e=function(e){var t;switch(e){case b:t=a;break;case S:t=o;break;default:t=[]}return t}(e);r=r.concat(function(e,r){if(r.hasOwnProperty("time"))return[function(e,t,r){for(var n=e.length-1;0<=n;n--){var a=e[n],i=a.startTime,o=i+a.duration;if(r=isNaN(r)?g(a):r,!isNaN(i)&&!isNaN(o)&&i<=t+r&&t-r<o||isNaN(i)&&isNaN(t))return a}return null}(e,r.time,r.threshold)];return e.filter(function(e){for(var t in r)if("state"!==t&&r.hasOwnProperty(t)&&e[t]!=r[t])return!1;return!0})}(e,t))}),r},isFragmentLoaded:d,isFragmentLoadedOrPending:function(e){var t,r=!1,n=0;if(!(r=d(e)))for(n=0;n<a.length;n++)t=a[n],e.url===t.url&&e.startTime===t.startTime&&(r=!0);return r},removeExecutedRequestsBeforeTime:h,removeExecutedRequestsAfterTime:function(t){o=o.filter(function(e){return isNaN(e.startTime)||void 0!==t&&e.startTime<t})},syncExecutedRequestsWithBufferedRange:function(e,t){if(e&&0!==e.length){for(var r=0,n=0,a=e.length;n<a;n++)m(r,e.start(n)),r=e.end(n);0<t&&m(r,t)}else h()},abortRequests:function(){r.debug("abort requests"),l.abort(),a=[]},executeRequest:function(e){e.action===T.default.ACTION_DOWNLOAD?(p(e,b),a.push(e),e=e,n.trigger(i.FRAGMENT_LOADING_STARTED,{request:e},{streamId:c.id,mediaType:f}),l.load(e)):r.warn("Unknown request action.")},reset:function(){n.off(i.LOADING_COMPLETED,y,this),n.off(i.LOADING_DATA_PROGRESS,E,this),n.off(i.LOADING_ABANDONED,_,this),l&&l.reset(),v()},resetInitialSettings:v,addExecutedRequest:function(e){o.push(e)}},r=u.getLogger(t),v(),n.on(i.LOADING_COMPLETED,y,t),n.on(i.LOADING_DATA_PROGRESS,E,t),n.on(i.LOADING_ABANDONED,_,t),t}n.__dashjs_factory_name="FragmentModel";r=t.default.getClassFactory(n);r.FRAGMENT_MODEL_LOADING=b,r.FRAGMENT_MODEL_EXECUTED=S,r.FRAGMENT_MODEL_CANCELED="canceled",r.FRAGMENT_MODEL_FAILED="failed",t.default.updateClassFactory(n.__dashjs_factory_name,r);const a=r},"./src/streaming/models/LowLatencyThroughputModel.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>i});var n=r("./src/core/Debug.js"),r=r("./src/core/FactoryMaker.js");function a(){var e,c,t=this.context,f={};function r(){c=(0,n.default)(t).getInstance().getLogger(e)}function d(e){var t,r=!0,n=e.reduce(function(e,t){return e+t.bufferLevelAtSegmentEnd},0)/e.length;return e.forEach(function(e){Math.abs(e.bufferLevelAtSegmentEnd/e.bufferLevelAtSegmentStart)<.95&&(r=!1),e.bufferLevelAtSegmentEnd/n<.8&&(r=!1),t?t>e.bitrate&&(r=!1):t=e.bitrate}),r}return e={setup:r,addMeasurement:function(t,e,r,n,a){t&&t.mediaType&&!f[t.mediaType]&&(f[t.mediaType]=[]);var i=t.mediaInfo.bitrateList.find(function(e){return e.id===t.representationId});f[t.mediaType].push({index:t.index,repId:t.representationId,mediaType:t.mediaType,requestTimeMS:n,adjustedAvailabilityStartTimeMS:t.availabilityStartTime.getTime(),segDurationMS:1e3*t.duration,chunksDurationMS:r.reduce(function(e,t){return e+t.chunkDownloadDurationMS},0),segmentBytes:r.reduce(function(e,t){return e+t.chunkBytes},0),bitrate:i&&i.bandwidth,bitrateList:t.mediaInfo.bitrateList,chunkMeasurements:r,fetchDownloadDurationMS:e,throughputCapacityDelayMS:a,getEstimatedBufferLevel:function(e){for(var t={},r=0,n=0,a=0,i=0,o=e.length,s=0;s<o;++s)r+=e[s].chunkDownloadTimeRelativeMS,n+=e[s].bufferLevel,a+=e[s].chunkDownloadTimeRelativeMS*e[s].bufferLevel,i+=e[s].chunkDownloadTimeRelativeMS*e[s].chunkDownloadTimeRelativeMS;return t.m=(a-r*n/o)/(i-r*r/o),t.b=n/o-t.m*r/o,function(e){return t.m*e+t.b}}(r.slice(1))}),10<f[t.mediaType].length&&f[t.mediaType].shift()},getThroughputCapacityDelayMS:function(e,t){return(e=f[e.mediaType]&&f[e.mediaType].slice(-3))&&!(e.length<3)&&d(e)?250<t/4?250:t/4:0},getEstimatedDownloadDurationMS:function(e){var t=f[e.mediaType].slice(-1).pop(),r=f[e.mediaType].slice(-3),e=t.chunkMeasurements.slice(-1).pop().chunkDownloadTimeRelativeMS;if(t.bufferLevelAtSegmentStart=t.getEstimatedBufferLevel(e/2),t.bufferLevelAtSegmentEnd=t.getEstimatedBufferLevel(e),e=d(r),r=e?.6:.8,t.isBufferStable&&1.05*t.segDurationMS<t.fetchDownloadDurationMS)return t.fetchDownloadDurationMS;if(!e||t.segDurationMS<t.fetchDownloadDurationMS)return.8*t.fetchDownloadDurationMS;if(t.adjustedAvailabilityStartTimeMS<=t.requestTimeMS+t.throughputCapacityDelayMS-t.segDurationMS)return.8*t.fetchDownloadDurationMS;for(var n=t.requestTimeMS+t.throughputCapacityDelayMS-t.adjustedAvailabilityStartTimeMS,a=0,i=0,o=0,s=0;s<t.chunkMeasurements.length;s++){var l=t.chunkMeasurements[s];if(n<i+l.chunkDownloadDurationMS)break;i+=l.chunkDownloadDurationMS,a+=l.chunkBytes,o++}if(n<0&&c.warn("request time was before adjusted availibitly start time"),a&&i&&o>.2*t.chunkMeasurements.length){e=a/i,e=t.segmentBytes/e;return t.fetchDownloadDurationMS<e?t.fetchDownloadDurationMS*r:e*r}var u=t.bitrate;return t.bitrateList.some(function(e){if(e.bandwidth>t.bitrate)return u=e.bandwidth,!0}),u===t.bitrate?t.fetchDownloadDurationMS*r:r*t.segmentBytes*8*1e3/u}},r(),e}a.__dashjs_factory_name="LowLatencyThroughputModel";const i=r.default.getSingletonFactory(a)},"./src/streaming/models/ManifestModel.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>o});var n=r("./src/core/EventBus.js"),a=r("./src/core/events/Events.js"),r=r("./src/core/FactoryMaker.js");function i(){var t,e=this.context,r=(0,n.default)(e).getInstance();return{getValue:function(){return t},setValue:function(e){(t=e)&&r.trigger(a.default.MANIFEST_LOADED,{data:e})}}}i.__dashjs_factory_name="ManifestModel";const o=r.default.getSingletonFactory(i)},"./src/streaming/models/MediaPlayerModel.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>a});var u=r("./src/core/Debug.js"),t=r("./src/core/FactoryMaker.js"),c=r("./src/core/Settings.js");function n(){var e,r,n,a,t=this.context,i=(0,c.default)(t).getInstance();function o(e,t){return isNaN(e)?0:0<e?(t&&r.warn("Supplied minimum playback rate is a positive value when it should be negative or 0. The supplied rate will not be applied and set to 0: 100% playback speed."),0):e<-.5?(t&&r.warn("Supplied minimum playback rate is out of range and will be limited to ".concat(-.5,": ").concat(-50,"% playback speed.")),-.5):e}function s(e,t){return isNaN(e)?0:e<0?(t&&r.warn("Supplied maximum playback rate is a negative value when it should be negative or 0. The supplied rate will not be applied and set to 0: 100% playback speed."),0):1<e?(t&&r.warn("Supplied maximum playback rate is out of range and will be limited to ".concat(1,": ").concat(200,"% playback speed.")),1):e}function l(){var e=0<i.get().streaming.buffer.stableBufferTime?i.get().streaming.buffer.stableBufferTime:i.get().streaming.buffer.fastSwitchEnabled?20:12,t=n.getLiveDelay();return!isNaN(t)&&0<t?Math.min(e,t):e}return e={getCatchupMaxDrift:function(){if(!isNaN(i.get().streaming.liveCatchup.maxDrift)&&0<i.get().streaming.liveCatchup.maxDrift)return i.get().streaming.liveCatchup.maxDrift;var e=a.getServiceDescriptionSettings();return e&&e.liveCatchup&&!isNaN(e.liveCatchup.maxDrift)&&0<e.liveCatchup.maxDrift?e.liveCatchup.maxDrift:12},getCatchupModeEnabled:function(){return null!==i.get().streaming.liveCatchup.enabled?i.get().streaming.liveCatchup.enabled:n.getInitialCatchupModeActivated()},getStableBufferTime:l,getInitialBufferLevel:function(){var e=i.get().streaming.buffer.initialBufferLevel;return isNaN(e)||e<0?0:Math.min(l(),e)},getRetryAttemptsForType:function(e){var t=isNaN(i.get().streaming.retryAttempts.lowLatencyMultiplyFactor)?5:i.get().streaming.retryAttempts.lowLatencyMultiplyFactor;return n.getLowLatencyModeEnabled()?i.get().streaming.retryAttempts[e]*t:i.get().streaming.retryAttempts[e]},getRetryIntervalsForType:function(e){var t=isNaN(i.get().streaming.retryIntervals.lowLatencyReductionFactor)?10:i.get().streaming.retryIntervals.lowLatencyReductionFactor;return n.getLowLatencyModeEnabled()?i.get().streaming.retryIntervals[e]/t:i.get().streaming.retryIntervals[e]},getCatchupPlaybackRates:function(e){var t=i.get().streaming.liveCatchup.playbackRate;return isNaN(t.min)&&isNaN(t.max)?!(t=a.getServiceDescriptionSettings())||!t.liveCatchup||isNaN(t.liveCatchup.playbackRate.min)&&isNaN(t.liveCatchup.playbackRate.max)?{min:-.5,max:.5}:{min:o((t=t.liveCatchup.playbackRate).min,e),max:s(t.max,e)}:{min:o(t.min,e),max:s(t.max,e)}},getAbrBitrateParameter:function(e,t){try{var r=i.get().streaming.abr[e][t];if(!isNaN(r)&&-1!==r)return r;r=a.getServiceDescriptionSettings();return r&&r[e]&&!isNaN(r[e][t])?r[e][t]:-1}catch(e){return-1}},setConfig:function(e){e.playbackController&&(n=e.playbackController),e.serviceDescriptionController&&(a=e.serviceDescriptionController)},reset:function(){}},r=(0,u.default)(t).getInstance().getLogger(e),e}n.__dashjs_factory_name="MediaPlayerModel";const a=t.default.getSingletonFactory(n)},"./src/streaming/models/MetricsModel.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>a});var g=r("./src/streaming/constants/Constants.js"),v=r("./src/streaming/constants/MetricsConstants.js"),l=r("./src/streaming/vo/MetricsList.js"),T=r("./src/streaming/vo/metrics/HTTPRequest.js"),c=r("./src/streaming/vo/metrics/RepresentationSwitch.js"),h=r("./src/streaming/vo/metrics/BufferLevel.js"),m=r("./src/streaming/vo/metrics/BufferState.js"),p=r("./src/streaming/vo/metrics/DVRInfo.js"),y=r("./src/streaming/vo/metrics/DroppedFrames.js"),E=r("./src/streaming/vo/metrics/ManifestUpdate.js"),b=r("./src/streaming/vo/metrics/SchedulingInfo.js"),S=r("./src/core/EventBus.js"),A=r("./src/streaming/vo/metrics/RequestsQueue.js"),R=r("./src/core/events/Events.js"),r=r("./src/core/FactoryMaker.js");function n(e){var n,a=(e=e||{}).settings,e=this.context,i=(0,S.default)(e).getInstance();function t(){i.trigger(R.default.METRICS_CHANGED)}function o(e){i.trigger(R.default.METRIC_CHANGED,{mediaType:e}),t()}function u(e,t,r){i.trigger(R.default.METRIC_UPDATED,{mediaType:e,metric:t,value:r}),o(e)}function f(e,t,r){i.trigger(R.default.METRIC_ADDED,{mediaType:e,metric:t,value:r}),o(e)}function s(e,t){var r=null;return e&&(n.hasOwnProperty(e)?r=n[e]:t||(r=new l.default,n[e]=r)),r}function d(e,t,r){e=s(e);null!==e&&(e[t].push(r),e[t].length>a.get().streaming.metrics.maxListDepth&&e[t].shift())}function _(e,t,r){d(e,t,r),f(e,t,r)}return e={clearCurrentMetricsForType:function(e){delete n[e],o(e)},clearAllCurrentMetrics:function(){n={},t()},getMetricsFor:s,addHttpRequest:function e(t,r,n,a,i,o,s,l,u,c,f,d,g,h,m,p,y){var E=new T.HTTPRequest;o&&o!==a&&(e(t,null,n,a,i,null,null,l,u,null,null,null,g,null,null,p,y),E.actualurl=o),E.tcpid=r,E.type=n,E.url=a,E.range=l,E.trequest=u,E.tresponse=c,E.responsecode=d,E.cmsd=y,E._tfinish=f,E._stream=t,E._mediaduration=g,E._quality=i,E._responseHeaders=h,E._serviceLocation=s,E._fileLoaderType=p,m?m.forEach(function(e){var t,r,n,a;t=E,r=e.s,n=e.d,a=e.b,(e=new T.HTTPRequestTrace).s=r,e.d=n,e.b=a,t.trace.push(e),t.interval||(t.interval=0),t.interval+=n}):(delete E.interval,delete E.trace),_(t,v.default.HTTP_REQUEST,E)},addRepresentationSwitch:function(e,t,r,n,a){var i=new c.default;i.t=t,i.mt=r,i.to=n,a?i.lto=a:delete i.lto,_(e,v.default.TRACK_SWITCH,i)},addBufferLevel:function(e,t,r){var n=new h.default;n.t=t,n.level=r,_(e,v.default.BUFFER_LEVEL,n)},addBufferState:function(e,t,r){var n=new m.default;n.target=r,n.state=t,_(e,v.default.BUFFER_STATE,n)},addDVRInfo:function(e,t,r,n){var a=new p.default;a.time=t,a.range=n,a.manifestInfo=r,_(e,v.default.DVR_INFO,a)},addDroppedFrames:function(e,t){var r=new y.default,n=s(e).DroppedFrames;t&&(r.time=t.creationTime,r.droppedFrames=t.droppedVideoFrames,0<n.length&&n[n.length-1]==r||_(e,v.default.DROPPED_FRAMES,r))},addSchedulingInfo:function(e,t,r,n,a,i,o,s,l){var u=new b.default;u.mediaType=e,u.t=t,u.type=r,u.startTime=n,u.availabilityStartTime=a,u.duration=i,u.quality=o,u.range=s,u.state=l,_(e,v.default.SCHEDULING_INFO,u)},addRequestsQueue:function(e,t,r){var n=new A.default;n.loadingRequests=t,n.executedRequests=r,s(e).RequestsQueue=n,f(e,v.default.REQUESTS_QUEUE,n)},addManifestUpdate:function(e,t,r,n,a,i,o,s,l,u){var c=new E.ManifestUpdate;c.mediaType=e,c.type=t,c.requestTime=r,c.fetchTime=n,c.availabilityStartTime=a,c.presentationStartTime=i,c.clientTimeOffset=o,c.currentTime=s,c.buffered=l,c.latency=u,d(g.default.STREAM,v.default.MANIFEST_UPDATE,c),f(e,v.default.MANIFEST_UPDATE,c)},updateManifestUpdateInfo:function(e,t){if(e){for(var r in t)e[r]=t[r];u(e.mediaType,v.default.MANIFEST_UPDATE,e)}},addManifestUpdateStreamInfo:function(e,t,r,n,a){var i;e&&((i=new E.ManifestUpdateStreamInfo).id=t,i.index=r,i.start=n,i.duration=a,e.streamInfo.push(i),u(e.mediaType,v.default.MANIFEST_UPDATE_STREAM_INFO,e))},addManifestUpdateRepresentationInfo:function(e,t,r,n,a,i,o,s){var l;e&&e.representationInfo&&((l=new E.ManifestUpdateRepresentationInfo).id=t,l.index=r,l.streamIndex=n,l.mediaType=a,l.startNumber=o,l.fragmentInfoType=s,l.presentationTimeOffset=i,e.representationInfo.push(l),u(e.mediaType,v.default.MANIFEST_UPDATE_TRACK_INFO,e))},addPlayList:function(e){e.trace&&Array.isArray(e.trace)?e.trace.forEach(function(e){e.hasOwnProperty("subreplevel")&&!e.subreplevel&&delete e.subreplevel}):delete e.trace,_(g.default.STREAM,v.default.PLAY_LIST,e)},addDVBErrors:function(e){_(g.default.STREAM,v.default.DVB_ERRORS,e)}},n={},e}n.__dashjs_factory_name="MetricsModel";const a=r.default.getSingletonFactory(n)},"./src/streaming/models/URIFragmentModel.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>a});var u=r("./src/streaming/vo/URIFragmentData.js"),r=r("./src/core/FactoryMaker.js");function n(){var l;return{initialize:function(e){if(l=new u.default,!e)return null;var t=e.indexOf("#");if(-1!==t)for(var r=e.substr(t+1).split("&"),n=0,a=r.length;n<a;++n){var i,o=r[n],s=o.indexOf("=");-1!==s&&(i=o.substring(0,s),l.hasOwnProperty(i)&&(l[i]=o.substr(s+1)))}},getURIFragmentData:function(){return l}}}n.__dashjs_factory_name="URIFragmentModel";const a=r.default.getSingletonFactory(n)},"./src/streaming/models/VideoModel.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>a});var t=r("./src/core/FactoryMaker.js"),_=r("./src/core/EventBus.js"),v=r("./src/core/events/Events.js"),T=r("./src/core/Debug.js"),b=r("./src/streaming/constants/Constants.js"),S=new Map([[b.default.VIDEO_ELEMENT_READY_STATES.HAVE_METADATA,"loadedmetadata"],[b.default.VIDEO_ELEMENT_READY_STATES.HAVE_CURRENT_DATA,"loadeddata"],[b.default.VIDEO_ELEMENT_READY_STATES.HAVE_FUTURE_DATA,"canplay"],[b.default.VIDEO_ELEMENT_READY_STATES.HAVE_ENOUGH_DATA,"canplaythrough"]]);function n(){var e,t,o,r,n,a,i="element is not video or audio DOM type!",s=this.context,l=(0,_.default)(s).getInstance(),u=[];function c(){o&&(o.playbackRate=1,o.removeEventListener("canplay",c))}function f(){return 0<u.length}function d(){var e;o&&f()&&0===o.playbackRate&&((e=document.createEvent("Event")).initEvent("waiting",!0,!1),o.dispatchEvent(e))}function g(e,t){o&&o.addEventListener(e,t)}function h(e,t){o&&o.removeEventListener(e,t)}function m(){return o?o.readyState:NaN}function p(){return o?o.buffered:null}function y(e,t,r,n,a){if(o)for(var i=0;i<o.textTracks.length;i++)if(o.textTracks[i].kind===e&&(!t||o.textTracks[i].label==t)&&o.textTracks[i].language===r&&o.textTracks[i].isTTML===n&&o.textTracks[i].isEmbedded===a)return o.textTracks[i];return null}function E(e,t){var r,n;e===b.default.VIDEO_ELEMENT_READY_STATES.HAVE_NOTHING||m()>=e?t():(e=S.get(e),n=t,g(r=e,function e(){h(r,e),n(r)}))}return e={initialize:function(){l.on(v.default.PLAYBACK_PLAYING,d,this)},setCurrentTime:function(e,t){o&&(r=e,E(b.default.VIDEO_ELEMENT_READY_STATES.HAVE_METADATA,function(){if(o.currentTime!==r)try{r=t?function(e){var t=p(),r=e,n=9999999999;if(t)for(var a=0;a<t.length;a++){var i=t.start(a),o=t.end(a),s=Math.abs(i-e),l=Math.abs(o-e);if(i<=e&&e<=o)return e;s<n&&(n=s,r=i),l<n&&(n=l,r=o)}return r}(r):r,o.currentTime=r,r=NaN}catch(e){0===o.readyState&&e.code===e.INVALID_STATE_ERR&&setTimeout(function(){o.currentTime=r,r=NaN},400)}else r=NaN}))},play:function(){var e;o&&(o.autoplay=!0,(e=o.play())&&e.catch&&"undefined"!=typeof Promise&&e.catch(function(e){"NotAllowedError"===e.name&&l.trigger(v.default.PLAYBACK_NOT_ALLOWED),t.warn("Caught pending play exception - continuing (".concat(e,")"))}))},isPaused:function(){return o?o.paused:null},pause:function(){o&&(o.pause(),o.autoplay=!1)},isStalled:f,isSeeking:function(){return o?o.seeking||!isNaN(r):null},getTime:function(){return o?isNaN(r)?o.currentTime:r:null},getPlaybackRate:function(){return o?o.playbackRate:null},setPlaybackRate:function(e){o&&(!(1<arguments.length&&void 0!==arguments[1]&&arguments[1])&&o.readyState<=2&&0<e?o.addEventListener("canplay",c):o.playbackRate=e)},getPlayedRanges:function(){return o?o.played:null},getEnded:function(){return o?o.ended:null},setStallState:function(e,t){(t?function(e){null!==e&&o&&!o.seeking&&-1===u.indexOf(e)&&u.push(e)}:function(e){var t=u.indexOf(e);null!==e&&-1!==t&&u.splice(t,1)})(e)},getElement:function(){return o},setElement:function(e){if(!(null==e||e&&/^(VIDEO|AUDIO)$/i.test(e.nodeName)))throw i;(o=e)&&(o.preload="auto")},setSource:function(e){o&&(e?o.src=e:(o.removeAttribute("src"),o.load()))},getSource:function(){return o?o.src:null},getTTMLRenderingDiv:function(){return n},setTTMLRenderingDiv:function(e){(n=e).style.position="absolute",n.style.display="flex",n.style.overflow="hidden",n.style.pointerEvents="none",n.style.top=0,n.style.left=0},getVttRenderingDiv:function(){return a},setVttRenderingDiv:function(e){a=e},getPlaybackQuality:function(){if(!o)return null;var e="webkitDroppedFrameCount"in o&&"webkitDecodedFrameCount"in o,t=null;return"getVideoPlaybackQuality"in o?t=o.getVideoPlaybackQuality():e&&(t={droppedVideoFrames:o.webkitDroppedFrameCount,totalVideoFrames:o.webkitDroppedFrameCount+o.webkitDecodedFrameCount,creationTime:new Date}),t},addEventListener:g,removeEventListener:h,getReadyState:m,getBufferRange:p,getClientWidth:function(){return o?o.clientWidth:NaN},getClientHeight:function(){return o?o.clientHeight:NaN},getTextTracks:function(){return o?o.textTracks:[]},getTextTrack:y,addTextTrack:function(e,t,r,n,a){if(!o)return null;var i=y(e,t,r,n,a);return i||((i=o.addTextTrack(e,t,r)).isEmbedded=a,i.isTTML=n),i},appendChild:function(e){o&&(o.appendChild(e),void 0!==e.isTTML&&(o.textTracks[o.textTracks.length-1].isTTML=e.isTTML,o.textTracks[o.textTracks.length-1].isEmbedded=e.isEmbedded))},removeChild:function(e){o&&o.removeChild(e)},getVideoWidth:function(){return o?o.videoWidth:NaN},getVideoHeight:function(){return o?o.videoHeight:NaN},getVideoRelativeOffsetTop:function(){var e=o.parentNode.host||o.parentNode;return e?o.getBoundingClientRect().top-e.getBoundingClientRect().top:NaN},getVideoRelativeOffsetLeft:function(){var e=o.parentNode.host||o.parentNode;return e?o.getBoundingClientRect().left-e.getBoundingClientRect().left:NaN},waitForReadyState:E,reset:function(){l.off(v.default.PLAYBACK_PLAYING,d,this)}},t=(0,T.default)(s).getInstance().getLogger(e),r=NaN,e}n.__dashjs_factory_name="VideoModel";const a=t.default.getSingletonFactory(n)},"./src/streaming/net/FetchLoader.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>s});var t=r("./src/core/FactoryMaker.js"),n=r("./src/core/Settings.js"),D=r("./src/streaming/constants/Constants.js"),a=r("./src/streaming/utils/RequestModifier.js");function M(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var r=[],n=!0,a=!1,i=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(e){a=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(a)throw i}}return r}(e,t)||O(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function O(e,t){if(e){if("string"==typeof e)return i(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Map"===(r="Object"===r&&e.constructor?e.constructor.name:r)||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?i(e,t):void 0}}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function o(e){e=e||{};var R,t=this.context,o=e.requestModifier,I=e.lowLatencyThroughputModel,w=e.boxParser,s=(0,n.default)(t).getInstance();function r(v){var e,t=new Date,T=v.request,r=new Headers;if(T.range&&r.append("Range","bytes="+T.range),v.headers)for(var n in v.headers){var a=v.headers[n];a&&r.append(n,a)}T.requestStartDate||(T.requestStartDate=t),o&&o.modifyRequestHeader&&o.modifyRequestHeader({setRequestHeader:function(e,t){r.append(e,t)}},{url:v.url}),"function"==typeof window.AbortController&&(e=new AbortController,(v.abortController=e).signal.onabort=v.onabort);var i={method:v.method,headers:r,credentials:v.withCredentials?"include":void 0,signal:e?e.signal:void 0},b=s.get().streaming.abr.fetchThroughputCalculationMode,S=Date.now(),A=0;new Promise(function(e){if(b===D.default.ABR_FETCH_THROUGHPUT_CALCULATION_AAST&&I&&(A=I.getThroughputCapacityDelayMS(T,1e3*R.getCurrentBufferLevel(T.mediaType))))return setTimeout(e,A);e()}).then(function(){var _=Date.now();fetch(v.url,i).then(function(e){v.response||(v.response={}),v.response.status=e.status,v.response.statusText=e.statusText,v.response.responseURL=e.url,e.ok||v.onerror();var a="",t=function(e,t){var r;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=O(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,t=function(){};return{s:t,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:t}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,o=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return i=e.done,e},e:function(e){o=!0,a=e},f:function(){try{i||null==r.return||r.return()}finally{if(o)throw a}}}}(e.headers.keys());try{for(t.s();!(r=t.n()).done;){var r=r.value;a+=r+": "+e.headers.get(r)+"\r\n"}}catch(e){t.e(e)}finally{t.f()}if(v.response.responseHeaders=a,!e.body)return e.arrayBuffer().then(function(e){e={loaded:(v.response.response=e).byteLength,total:e.byteLength,stream:!1};v.progress(e),v.onload(),v.onend()});var i,o,n,s,l,u=parseInt(e.headers.get("Content-Length"),10),c=0,f=!1,d=new Uint8Array,g=0;b===D.default.ABR_FETCH_THROUGHPUT_CALCULATION_AAST&&I?(i=_,o=0,n=(E=M(e.body.tee(),2))[0],E=E[1],s=n.getReader(),l=[],s.read().then(function e(t){var r=t.value,t=t.done;if(o=Date.now(),r&&r.length&&(n=o-i,r=r.length,l.push({chunkDownloadTimeRelativeMS:o-_,chunkDownloadDurationMS:n,chunkBytes:r,kbps:Math.round(8*r/(n/1e3)),bufferLevel:R.getCurrentBufferLevel(T.mediaType)})),t){var n=o-_,t=l.reduce(function(e,t){return e+t.chunkBytes},0);return I.addMeasurement(T,n,l,S,A,a),void v.progress({loaded:t,total:t,lengthComputable:!0,time:I.getEstimatedDownloadDurationMS(T),stream:!0})}return i=Date.now(),s.read().then(e)}),v.reader=E.getReader()):v.reader=e.body.getReader();var h=[],m=[],p=[],y=!0,E=function e(t){var r,n,a=t.value,t=t.done;if(t)return d&&(b!==D.default.ABR_FETCH_THROUGHPUT_CALCULATION_AAST&&(r=t=null,b===D.default.ABR_FETCH_THROUGHPUT_CALCULATION_MOOF_PARSING?(t=function(r,n){try{var e,t;e=r.filter(function(e,t){return t<r.length-1}),t=n.filter(function(e,t){return t<n.length-1});var a=[];if(1<e.length){for(var i,o=0,s=0,l=0;l<e.length;l++)e[l]&&t[l]&&(1<(i=t[l].ts-e[l].ts)?a.push(8*t[l].bytes/i):(0===s&&(s=e[l].ts),1<(i=t[l].ts-s)?(a.push(8*o/i),s=o=0):o+=t[l].bytes));if(0<a.length)return a.reduce(function(e,t){return e+t},0)/a.length}return null}catch(e){return null}}(m,p))&&(r=8*c/t):b===D.default.ABR_FETCH_THROUGHPUT_CALCULATION_DOWNLOADED_DATA&&(r=N(h,c)),v.progress({loaded:c,total:isNaN(u)?c:u,lengthComputable:!0,time:r,stream:!0})),v.response.response=d.buffer),v.onload(),void v.onend();a&&0<a.length&&(d=function(e,t){if(0===e.length)return t;var r=new Uint8Array(e.length+t.length);return r.set(e),r.set(t,e.length),r}(d,a),c+=a.length,h.push({ts:Date.now(),bytes:a.length}),b===D.default.ABR_FETCH_THROUGHPUT_CALCULATION_MOOF_PARSING&&y&&w.findLastTopIsoBoxCompleted(["moof"],d,g).found&&(y=!1,m.push({ts:performance.now(),bytes:a.length})),(r=w.findLastTopIsoBoxCompleted(["moov","mdat"],d,g)).found?(a=r.lastCompletedOffset+r.size,b!==D.default.ABR_FETCH_THROUGHPUT_CALCULATION_MOOF_PARSING||y||(y=!0,p.push({ts:performance.now(),bytes:d.length})),d=a===d.length?(n=d,new Uint8Array):(n=new Uint8Array(d.subarray(0,a)),d.subarray(a)),v.progress({data:n.buffer,lengthComputable:!1,noTrace:!0}),g=0):(g=r.lastCompletedOffset,f||(v.progress({lengthComputable:!1,noTrace:!0}),f=!0))),C(v,e)};C(v,E)}).catch(function(e){v.onerror&&v.onerror(e)})})}function C(t,e){t.reader.read().then(e).catch(function(e){t.onerror&&200===t.response.status&&t.onerror(e)})}function N(r,t){try{if(1<(r=r.filter(function(e){return e.bytes>t/4/r.length})).length){var n=0,a=(r[r.length-1].ts-r[0].ts)/r.length;return r.forEach(function(e,t){t=r[t+1];t&&(e=t.ts-e.ts,n+=e<a?e:0)}),n}return null}catch(e){return null}}return{load:function(e){o&&o.modifyRequest?(0,a.modifyRequest)(e,o).then(function(){return r(e)}):r(e)},abort:function(e){if(e.abortController)e.abortController.abort();else if(e.reader)try{e.reader.cancel(),e.onabort()}catch(e){}},calculateDownloadedTime:N,setup:function(e){R=e.dashMetrics}}}o.__dashjs_factory_name="FetchLoader";const s=t.default.getClassFactory(o)},"./src/streaming/net/HTTPLoader.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>d});var k=r("./src/streaming/net/XHRLoader.js"),U=r("./src/streaming/net/FetchLoader.js"),B=r("./src/streaming/vo/metrics/HTTPRequest.js"),t=r("./src/core/FactoryMaker.js"),G=r("./src/streaming/vo/DashJSError.js"),a=r("./src/streaming/models/CmcdModel.js"),i=r("./src/streaming/models/CmsdModel.js"),q=r("./src/core/Utils.js"),o=r("./src/core/Debug.js"),s=r("./src/core/EventBus.js"),H=r("./src/core/events/Events.js"),l=r("./src/core/Settings.js"),Y=r("./src/streaming/constants/Constants.js"),u=r("./src/streaming/models/LowLatencyThroughputModel.js"),c=r("./src/streaming/models/CustomParametersModel.js");function f(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function n(e){e=e||{};var t,_,v,T,b,S,A,R,I,w,r,C=this.context,N=e.errHandler,D=e.dashMetrics,M=e.mediaPlayerModel,O=e.requestModifier,P=e.boxParser,n=e.errors,L=e.requestTimeout||0,F=(0,s.default)(C).getInstance(),x=(0,l.default)(C).getInstance();function j(r,t){var i=r.request,o=[],n=!0,s=!0,l=new Date,a=l,u=0,c=null;if(!O||!D||!N)throw new Error("config object is not correct or missing");function f(e){var t,r,n,a;s=!1,i.requestStartDate=l,i.requestEndDate=new Date,i.firstByteDate=i.firstByteDate||l,i.fileLoaderType=c,i.checkExistenceOnly||(t=E.response?E.response.responseURL:null,r=E.response?E.response.status:null,n=E.response&&E.response.getAllResponseHeaders?E.response.getAllResponseHeaders():E.response?E.response.responseHeaders:null,a=x.get().streaming.cmsd&&x.get().streaming.cmsd.enabled?A.parseResponseHeaders(n,i.mediaType):null,D.addHttpRequest(i,t,r,n,e?o:null,a),i.type===B.HTTPRequest.MPD_TYPE&&D.addManifestUpdate(i))}function e(){if(-1!==_.indexOf(E)&&(_.splice(_.indexOf(E),1),s))if(f(!1),0<t){try{x.get().streaming.utcSynchronization.enableBackgroundSyncAfterSegmentDownloadError&&i.type===B.HTTPRequest.MEDIA_SEGMENT_TYPE&&M.getRetryAttemptsForType(B.HTTPRequest.MEDIA_SEGMENT_TYPE)===t&&F.trigger(H.default.ATTEMPT_BACKGROUND_SYNC)}catch(e){}t--;var e={config:r};T.push(e),e.timeout=setTimeout(function(){-1!==T.indexOf(e)&&(T.splice(T.indexOf(e),1),j(r,t))},M.getRetryIntervalsForType(i.type))}else i.type!==B.HTTPRequest.MSS_FRAGMENT_INFO_SEGMENT_TYPE&&(N.error(new G.default(b[i.type],i.url+" is not available",{request:i,response:E.response})),r.error&&r.error(i,"error",E.response.statusText),r.complete&&r.complete(i,E.response.statusText))}var d,g,h,c=i.hasOwnProperty("availabilityTimeComplete")&&!1===i.availabilityTimeComplete&&window.fetch&&"arraybuffer"===i.responseType&&i.type===B.HTTPRequest.MEDIA_SEGMENT_TYPE?((d=(0,U.default)(C).create({requestModifier:O,lowLatencyThroughputModel:I,boxParser:P})).setup({dashMetrics:D}),Y.default.FILE_LOADER_TYPES.FETCH):(d=(0,k.default)(C).create({requestModifier:O}),Y.default.FILE_LOADER_TYPES.XHR),m=null,p=O.modifyRequestURL?O.modifyRequestURL(i.url):i.url;x.get().streaming.cmcd&&x.get().streaming.cmcd.enabled&&((g=x.get().streaming.cmcd.mode)===Y.default.CMCD_MODE_QUERY?(h=function(e){try{var t=[],r=S.getQueryParameter(e);return r&&t.push(r),t}catch(e){return[]}}(i),p=q.default.addAditionalQueryParameterToUrl(p,h)):g===Y.default.CMCD_MODE_HEADER&&(m=S.getHeaderParameters(i)));var y,E={url:i.url=p,method:i.checkExistenceOnly?B.HTTPRequest.HEAD:B.HTTPRequest.GET,withCredentials:R.getXHRWithCredentialsForType(i.type),request:i,onload:function(){200<=E.response.status&&E.response.status<=299&&(f(!0),r.success&&r.success(E.response.response,E.response.statusText,E.response.responseURL),r.complete&&r.complete(i,E.response.statusText))},onend:e,onerror:e,progress:function(e){var t=new Date;n&&(n=!1,(!e.lengthComputable||e.lengthComputable&&e.total!==e.loaded)&&(i.firstByteDate=t)),e.lengthComputable&&(i.bytesLoaded=e.loaded,i.bytesTotal=e.total),e.noTrace||(o.push({s:a,d:e.time||t.getTime()-a.getTime(),b:[e.loaded?e.loaded-u:0]}),a=t,u=e.loaded),r.progress&&e&&r.progress(e)},onabort:function(){r.abort&&r.abort(i)},ontimeout:function(e){var t;t=e.lengthComputable?(t=e.loaded/e.total*100,"Request timeout: loaded: "+e.loaded+", out of: "+e.total+" : "+t.toFixed(3)+"% Completed"):"Request timeout: non-computable download size",w.warn(t)},loader:d,timeout:L,headers:m},m=(new Date).getTime();isNaN(i.delayLoadingTime)||m>=i.delayLoadingTime?(_.push(E),d.load(E)):(y={httpRequest:E},v.push(y),y.delayTimeout=setTimeout(function(){if(-1!==v.indexOf(y)){v.splice(v.indexOf(y),1);try{l=new Date,a=l,_.push(y.httpRequest),d.load(y.httpRequest)}catch(e){y.httpRequest.onerror()}}},i.delayLoadingTime-m))}return t={load:function(e){e.request?j(e,M.getRetryAttemptsForType(e.request.type)):e.error&&e.error(e.request,"error")},abort:function(){T.forEach(function(e){clearTimeout(e.timeout),e.config.request&&e.config.abort&&e.config.abort(e.config.request)}),T=[],v.forEach(function(e){return clearTimeout(e.delayTimeout)}),v=[],_.forEach(function(e){e.request.type!==B.HTTPRequest.MSS_FRAGMENT_INFO_SEGMENT_TYPE&&(e.onloadend=e.onerror=e.onprogress=void 0,e.loader.abort(e))}),_=[]}},w=(0,o.default)(C).getInstance().getLogger(t),_=[],v=[],T=[],S=(0,a.default)(C).getInstance(),A=(0,i.default)(C).getInstance(),I=(0,u.default)(C).getInstance(),R=(0,c.default)(C).getInstance(),f(r={},B.HTTPRequest.MPD_TYPE,n.DOWNLOAD_ERROR_ID_MANIFEST_CODE),f(r,B.HTTPRequest.XLINK_EXPANSION_TYPE,n.DOWNLOAD_ERROR_ID_XLINK_CODE),f(r,B.HTTPRequest.INIT_SEGMENT_TYPE,n.DOWNLOAD_ERROR_ID_INITIALIZATION_CODE),f(r,B.HTTPRequest.MEDIA_SEGMENT_TYPE,n.DOWNLOAD_ERROR_ID_CONTENT_CODE),f(r,B.HTTPRequest.INDEX_SEGMENT_TYPE,n.DOWNLOAD_ERROR_ID_CONTENT_CODE),f(r,B.HTTPRequest.BITSTREAM_SWITCHING_SEGMENT_TYPE,n.DOWNLOAD_ERROR_ID_CONTENT_CODE),f(r,B.HTTPRequest.OTHER_TYPE,n.DOWNLOAD_ERROR_ID_CONTENT_CODE),b=r,t}n.__dashjs_factory_name="HTTPLoader";const d=t.default.getClassFactory(n)},"./src/streaming/net/SchemeLoaderFactory.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>i});var t=r("./src/core/FactoryMaker.js"),n=r("./src/streaming/net/HTTPLoader.js");function a(){var r;function e(){r={}}function t(){e()}return t(),{getLoader:function(e){for(var t in r)if(r.hasOwnProperty(t)&&e.startsWith(t))return r[t];return n.default},registerLoader:function(e,t){r[e]=t},unregisterLoader:function(e){r[e]&&delete r[e]},unregisterAllLoader:e,reset:t}}a.__dashjs_factory_name="SchemeLoaderFactory";const i=t.default.getSingletonFactory(a)},"./src/streaming/net/URLLoader.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>a});var t=r("./src/core/FactoryMaker.js"),o=r("./src/streaming/net/SchemeLoaderFactory.js");function n(r){r=r||{};var n,a,i=this.context;return n=(0,o.default)(i).getInstance(),{load:function(e){var t;a||(t=n.getLoader(e&&e.request?e.request.url:null),a=t(i).create({errHandler:r.errHandler,mediaPlayerModel:r.mediaPlayerModel,requestModifier:r.requestModifier,dashMetrics:r.dashMetrics,boxParser:r.boxParser||null,constants:r.constants||null,dashConstants:r.dashConstants||null,urlUtils:r.urlUtils||null,requestTimeout:isNaN(r.requestTimeout)?0:r.requestTimeout,errors:r.errors})),a.load(e)},abort:function(){a&&a.abort()}}}n.__dashjs_factory_name="URLLoader";const a=t.default.getClassFactory(n)},"./src/streaming/net/XHRLoader.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>i});var t=r("./src/core/FactoryMaker.js"),n=r("./src/streaming/utils/RequestModifier.js");function a(e){var o=(e=e||{}).requestModifier;function t(e){var t=new Date,r=e.request,n=new XMLHttpRequest;if(n.open(e.method,e.url,!0),r.responseType&&(n.responseType=r.responseType),r.range&&n.setRequestHeader("Range","bytes="+r.range),r.requestStartDate||(r.requestStartDate=t),o&&o.modifyRequestHeader&&(n=o.modifyRequestHeader(n,{url:e.url})),e.headers)for(var a in e.headers){var i=e.headers[a];i&&n.setRequestHeader(a,i)}n.withCredentials=e.withCredentials,n.onload=e.onload,n.onloadend=e.onend,n.onerror=e.onerror,n.onprogress=e.progress,n.onabort=e.onabort,n.ontimeout=e.ontimeout,n.timeout=e.timeout,n.send(),e.response=n}return{load:function(e){o&&o.modifyRequest?(0,n.modifyRequest)(e,o).then(function(){return t(e)}):t(e)},abort:function(e){(e=e.response).onloadend=e.onerror=e.onprogress=void 0,e.abort()}}}a.__dashjs_factory_name="XHRLoader";const i=t.default.getClassFactory(a)},"./src/streaming/protection/CommonEncryption.js":(e,t,r)=>{function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}r.r(t),r.d(t,{default:()=>n});var d={attributes:["Laurl","laurl"],prefixes:["clearkey","dashif"]};const n=function(){function r(){!function(e){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}(this)}var e,t,n;return e=r,n=[{key:"findCencContentProtection",value:function(e){for(var t=null,r=0;r<e.length;++r){var n=e[r];"urn:mpeg:dash:mp4protection:2011"!==n.schemeIdUri.toLowerCase()||"cenc"!==n.value.toLowerCase()&&"cbcs"!==n.value.toLowerCase()||(t=n)}return t}},{key:"getPSSHData",value:function(e){var t=8,r=new DataView(e),n=r.getUint8(t);return t+=20,0<n&&(t+=4+16*r.getUint32(t)),t+=4,e.slice(t)}},{key:"getPSSHForKeySystem",value:function(e,t){t=r.parsePSSHList(t);return e&&t.hasOwnProperty(e.uuid.toLowerCase())?t[e.uuid.toLowerCase()]:null}},{key:"parseInitDataFromContentProtection",value:function(e,t){return"pssh"in e?(e.pssh.__text=e.pssh.__text.replace(/\r?\n|\r/g,"").replace(/\s+/g,""),t.decodeArray(e.pssh.__text).buffer):null}},{key:"parsePSSHList",value:function(e){if(null==e)return[];for(var t=new DataView(e.buffer||e),r={},n=0;;){var a,i,o=void 0,s=n;if(n>=t.buffer.byteLength)break;if(a=n+t.getUint32(n),n+=4,1886614376===t.getUint32(n))if(n+=4,0===(i=t.getUint8(n))||1===i){n++,n+=3;for(var o="",l=void 0,u=void 0,l=0;l<4;l++)o+=1===(u=t.getUint8(n+l).toString(16)).length?"0"+u:u;for(n+=4,o+="-",l=0;l<2;l++)o+=1===(u=t.getUint8(n+l).toString(16)).length?"0"+u:u;for(n+=2,o+="-",l=0;l<2;l++)o+=1===(u=t.getUint8(n+l).toString(16)).length?"0"+u:u;for(n+=2,o+="-",l=0;l<2;l++)o+=1===(u=t.getUint8(n+l).toString(16)).length?"0"+u:u;for(n+=2,o+="-",l=0;l<6;l++)o+=1===(u=t.getUint8(n+l).toString(16)).length?"0"+u:u;n+=6,n+=4,r[o=o.toLowerCase()]=t.buffer.slice(s,a),n=a}else n=a;else n=a}return r}},{key:"getLicenseServerUrlFromMediaInfo",value:function(e,t){try{if(!e||0===e.length)return null;for(var r=0,n=null;r<e.length&&!n;){var a=e[r];if(a&&a.contentProtection&&0<a.contentProtection.length){var i=a.contentProtection.filter(function(e){return e.schemeIdUri&&e.schemeIdUri===t});if(i&&0<i.length)for(var o=0;o<i.length&&!n;){for(var s=i[o],l=0;l<d.attributes.length&&!n;){for(var u=0,c=d.attributes[l];u<d.prefixes.length&&!n;){var f=d.prefixes[u];s[c]&&s[c].__prefix&&s[c].__prefix===f&&s[c].__text&&(n=s[c].__text),u+=1}l+=1}o+=1}}r+=1}return n}catch(e){return null}}}],(t=null)&&a(e.prototype,t),n&&a(e,n),r}()},"./src/streaming/protection/Protection.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>i});var d=r("./src/streaming/protection/controllers/ProtectionController.js"),g=r("./src/streaming/protection/controllers/ProtectionKeyController.js"),n=r("./src/streaming/protection/ProtectionEvents.js"),t=r("./src/streaming/protection/errors/ProtectionErrors.js"),h=r("./src/streaming/protection/models/ProtectionModel_21Jan2015.js"),m=r("./src/streaming/protection/models/ProtectionModel_3Feb2014.js"),p=r("./src/streaming/protection/models/ProtectionModel_01b.js"),y=[{generateKeyRequest:"generateKeyRequest",addKey:"addKey",cancelKeyRequest:"cancelKeyRequest",needkey:"needkey",keyerror:"keyerror",keyadded:"keyadded",keymessage:"keymessage"},{generateKeyRequest:"webkitGenerateKeyRequest",addKey:"webkitAddKey",cancelKeyRequest:"webkitCancelKeyRequest",needkey:"webkitneedkey",keyerror:"webkitkeyerror",keyadded:"webkitkeyadded",keymessage:"webkitkeymessage"}],E=[{setMediaKeys:"setMediaKeys",MediaKeys:"MediaKeys",release:"close",needkey:"needkey",error:"keyerror",message:"keymessage",ready:"keyadded",close:"keyclose"},{setMediaKeys:"msSetMediaKeys",MediaKeys:"MSMediaKeys",release:"close",needkey:"msneedkey",error:"mskeyerror",message:"mskeymessage",ready:"mskeyadded",close:"mskeyclose"}];function a(){var u,c=this.context;function f(e,t){for(var r=0;r<t.length;r++){var n=t[r];if("function"==typeof e[n[Object.keys(n)[0]]])return n}return null}return u={createProtectionSystem:function(e){var t=null,r=(0,g.default)(c).getInstance();r.setConfig({debug:e.debug,BASE64:e.BASE64,settings:e.settings}),r.initialize();var n,a,i,o,s,l=(n=(l=e).debug,a=n.getLogger(u),i=l.eventBus,o=l.errHandler,(s=l.videoModel?l.videoModel.getElement():null)&&void 0===s.onencrypted||s&&void 0===s.mediaKeys?f(s,E)?(a.info("EME detected on this user agent! (ProtectionModel_3Feb2014)"),(0,m.default)(c).create({debug:n,eventBus:i,events:l.events,api:f(s,E)})):f(s,y)?(a.info("EME detected on this user agent! (ProtectionModel_01b)"),(0,p.default)(c).create({debug:n,eventBus:i,errHandler:o,events:l.events,api:f(s,y)})):(a.warn("No supported version of EME detected on this user agent! - Attempts to play encrypted content will fail!"),null):(a.info("EME detected on this user agent! (ProtectionModel_21Jan2015)"),(0,h.default)(c).create({debug:n,eventBus:i,events:l.events})));return!t&&l&&(t=(0,d.default)(c).create({protectionModel:l,protectionKeyController:r,eventBus:e.eventBus,debug:e.debug,events:e.events,BASE64:e.BASE64,constants:e.constants,cmcdModel:e.cmcdModel,customParametersModel:e.customParametersModel,settings:e.settings}),e.capabilities.setEncryptedMediaSupported(!0)),t}}}a.__dashjs_factory_name="Protection";r=dashjs.FactoryMaker.getClassFactory(a);r.events=n.default,r.errors=t.default,dashjs.FactoryMaker.updateClassFactory(a.__dashjs_factory_name,r);const i=r},"./src/streaming/protection/ProtectionEvents.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>l});var n=r("./src/core/events/EventsBase.js");function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){return(i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function o(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=s(r);return e=n?(e=s(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),t=this,!(e=e)||"object"!==a(e)&&"function"!=typeof e?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(t):e}}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}const l=new(function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&i(e,t)}(r,n["default"]);var t=o(r);function r(){var e;return function(e){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}(this),(e=t.call(this)).INTERNAL_KEY_MESSAGE="internalKeyMessage",e.INTERNAL_KEY_STATUS_CHANGED="internalkeyStatusChanged",e.KEY_ADDED="public_keyAdded",e.KEY_ERROR="public_keyError",e.KEY_MESSAGE="public_keyMessage",e.KEY_SESSION_CLOSED="public_keySessionClosed",e.KEY_SESSION_CREATED="public_keySessionCreated",e.KEY_SESSION_REMOVED="public_keySessionRemoved",e.KEY_STATUSES_CHANGED="public_keyStatusesChanged",e.KEY_SYSTEM_ACCESS_COMPLETE="public_keySystemAccessComplete",e.KEY_SYSTEM_SELECTED="public_keySystemSelected",e.LICENSE_REQUEST_COMPLETE="public_licenseRequestComplete",e.LICENSE_REQUEST_SENDING="public_licenseRequestSending",e.NEED_KEY="needkey",e.PROTECTION_CREATED="public_protectioncreated",e.PROTECTION_DESTROYED="public_protectiondestroyed",e.SERVER_CERTIFICATE_UPDATED="serverCertificateUpdated",e.TEARDOWN_COMPLETE="protectionTeardownComplete",e.VIDEO_ELEMENT_SELECTED="videoElementSelected",e.KEY_SESSION_UPDATED="public_keySessionUpdated",e}return r}())},"./src/streaming/protection/controllers/ProtectionController.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>a});var U=r("./src/streaming/protection/CommonEncryption.js"),B=r("./src/streaming/protection/vo/MediaCapability.js"),G=r("./src/streaming/protection/vo/KeySystemConfiguration.js"),q=r("./src/streaming/protection/errors/ProtectionErrors.js"),H=r("./src/streaming/vo/DashJSError.js"),Y=r("./src/streaming/protection/vo/LicenseRequest.js"),V=r("./src/streaming/protection/vo/LicenseResponse.js"),K=r("./src/streaming/vo/metrics/HTTPRequest.js"),z=r("./src/core/Utils.js"),W=r("./src/streaming/constants/Constants.js"),r=r("./src/core/FactoryMaker.js");function X(e){return(X="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function n(e){var t,E,a,_,o,i,s,v,l,T,b,S=(e=e||{}).protectionKeyController,A=e.protectionModel,R=e.eventBus,I=e.events,r=e.debug,u=e.BASE64,c=e.constants,f=[],w=e.cmcdModel,C=e.settings,N=e.customParametersModel;function n(){if(!(R&&R.hasOwnProperty("on")&&S&&S.hasOwnProperty("getSupportedKeySystemsFromContentProtection")))throw new Error("Missing config parameter(s)")}function d(e,t){v||l?v&&g():function(r,t){if(!l){l=!0;var e=[];r=r.sort(function(e,t){return(o&&o[e.ks.systemString]&&0<=o[e.ks.systemString].priority?o[e.ks.systemString].priority:r.length)-(o&&o[t.ks.systemString]&&0<=o[t.ks.systemString].priority?o[t.ks.systemString].priority:r.length)});for(var n,a=0;a<r.length;a++){var i=function(e){var t=e.protData,r=[],n=[],a=t&&t.audioRobustness&&0<t.audioRobustness.length?t.audioRobustness:s,i=t&&t.videoRobustness&&0<t.videoRobustness.length?t.videoRobustness:s,o=e.sessionType,e=t&&t.distinctiveIdentifier?t.distinctiveIdentifier:"optional",t=t&&t.persistentState?t.persistentState:"temporary"===o?"optional":"required";return _.forEach(function(e){e.type===c.AUDIO?r.push(new B.default(e.codec,a)):e.type===c.VIDEO&&n.push(new B.default(e.codec,i))}),new G.default(r,n,e,t,[o])}(r[a]);e.push({ks:r[a].ks,configs:[i],protData:r[a].protData})}A.requestKeySystemAccess(e).then(function(e){e=(n=e.data).mksa&&n.mksa.selectedSystemString?n.mksa.selectedSystemString:n.keySystem.systemString;return E.info("DRM: KeySystem Access Granted for system string ("+e+")!  Selecting key system..."),A.selectKeySystem(n)}).then(function(e){v=e,l=!1,A&&(R.trigger(I.KEY_SYSTEM_SELECTED,{data:n}),(e=p(v))&&e.serverCertificate&&0<e.serverCertificate.length&&A.setServerCertificate(u.decodeArray(e.serverCertificate).buffer),g())}).catch(function(e){v=null,l=!1,t||R.trigger(I.KEY_SYSTEM_SELECTED,{data:null,error:new H.default(q.default.KEY_SYSTEM_ACCESS_DENIED_ERROR_CODE,q.default.KEY_SYSTEM_ACCESS_DENIED_ERROR_MESSAGE+"Error selecting key system! -- "+e.error)})})}}(e,t)}function g(){for(var e,t,r=0;r<a.length;r++)for(e=0;e<a[r].length;e++)if(v===a[r][e].ks){var n=a[r][e];t=n,n=void 0,S.isClearKey(v)&&t.protData&&t.protData.hasOwnProperty("clearkeys")&&0!==Object.keys(t.protData.clearkeys).length&&(n={kids:Object.keys(t.protData.clearkeys)},t.initData=(new TextEncoder).encode(JSON.stringify(n))),!void(t.sessionId?h(t):null!==t.initData&&m(t));break}a=[]}function h(e){n(),A.loadKeySession(e)}function m(e){var t=U.default.getPSSHForKeySystem(v,e?e.initData:null);if(t){if(!function(e){if(!e)return!1;try{for(var t=A.getSessions(),r=0;r<t.length;r++)if(t[r].getKeyId()===e)return!0;return!1}catch(e){return!1}}(e.keyId)&&!y(t))try{e.initData=t,A.createKeySession(e)}catch(e){R.trigger(I.KEY_SESSION_CREATED,{data:null,error:new H.default(q.default.KEY_SESSION_CREATED_ERROR_CODE,q.default.KEY_SESSION_CREATED_ERROR_MESSAGE+e.message)})}}else e&&e.initData?A.createKeySession(e):R.trigger(I.KEY_SESSION_CREATED,{data:null,error:new H.default(q.default.KEY_SESSION_CREATED_ERROR_CODE,q.default.KEY_SESSION_CREATED_ERROR_MESSAGE+"Selected key system is "+(v?v.systemString:null)+".  needkey/encrypted event contains no initData corresponding to that key system!")})}function p(e){if(e){e=e.systemString;if(o)return e in o?o[e]:null}return null}function y(e){if(e)try{for(var t=A.getAllInitData(),r=0;r<t.length;r++)if(S.initDataEquals(e,t[r]))return E.debug("DRM: Ignoring initData because we have already seen it!"),1;return}catch(e){return}}function D(e){n(),e?(A.setMediaElement(e),R.on(I.NEED_KEY,k,t)):null===e&&(A.setMediaElement(e),R.off(I.NEED_KEY,k,t))}function M(e){e.error?R.trigger(I.KEY_STATUSES_CHANGED,{data:null,error:e.error}):E.debug("DRM: key status = "+e.status)}function O(e){E.debug("DRM: onKeyMessage");var t=e.data;R.trigger(I.KEY_MESSAGE,{data:t});var r=t.messageType||"license-request",n=t.message,a=t.sessionToken,i=p(v),o=S.getLicenseServerModelInstance(v,i,r),r={sessionToken:a,messageType:r};if(n&&0!==n.byteLength){if(!o)return E.debug("DRM: License server request not required for this message (type = "+e.data.messageType+").  Session ID = "+a.getSessionId()),void P(r);if(S.isClearKey(v)){n=S.processClearKeyLicenseRequest(v,i,n);if(n&&n.keyPairs&&0<n.keyPairs.length)return E.debug("DRM: ClearKey license request handled by application!"),P(r),void A.updateKeySession(a,n)}!function(e,n,t){var a=e.sessionToken,i=e.messageType||"license-request",o={sessionToken:a,messageType:i},s=v?v.systemString:null,r=function(e,t,r,n,a){var i=null,o=n.message;{var s;e&&e.serverURL?"string"==typeof(s=e.serverURL)&&""!==s?i=s:"object"===X(s)&&s.hasOwnProperty(t)&&(i=s[t]):e&&e.laURL&&""!==e.laURL?i=e.laURL:(i=U.default.getLicenseServerUrlFromMediaInfo(_,v.schemeIdURI))||S.isClearKey(v)||(r=U.default.getPSSHData(r.initData),i=(i=v.getLicenseServerURLFromInitData(r))||n.laURL)}return i=a.getServerURLFromMessage(i,o,t)}(t,i,a,e,n);if(!r)return P(o,new H.default(q.default.MEDIA_KEY_MESSAGE_NO_LICENSE_SERVER_URL_ERROR_CODE,q.default.MEDIA_KEY_MESSAGE_NO_LICENSE_SERVER_URL_ERROR_MESSAGE)),0;var l={},u=!1;t&&F(l,t.httpRequestHeaders);var c=e.message,f=v.getRequestHeadersFromMessage(c);function d(t){var e,r;A&&(200<=t.status&&t.status<=299?(e=z.default.parseHttpHeaders(t.getAllResponseHeaders?t.getAllResponseHeaders():null),r=new V.default(t.responseURL,e,t.response),j(N.getLicenseResponseFilters(),r).then(function(){var e=n.getLicenseMessage(r.data,s,i);null!==e?(P(o),A.updateKeySession(a,e)):x(t,o,s,i,n)})):x(t,o,s,i,n))}function g(e){P(o,new H.default(q.default.MEDIA_KEY_MESSAGE_LICENSER_ERROR_CODE,q.default.MEDIA_KEY_MESSAGE_LICENSER_ERROR_MESSAGE+s+' update, XHR aborted. status is "'+e.statusText+'" ('+e.status+"), readyState is "+e.readyState))}function h(e){P(o,new H.default(q.default.MEDIA_KEY_MESSAGE_LICENSER_ERROR_CODE,q.default.MEDIA_KEY_MESSAGE_LICENSER_ERROR_MESSAGE+s+' update, XHR error. status is "'+e.statusText+'" ('+e.status+"), readyState is "+e.readyState))}F(l,f),Object.keys(l).forEach(function(e){"authorization"===e.toLowerCase()&&(u=!0)}),t&&"boolean"==typeof t.withCredentials&&(u=t.withCredentials);var e=v.getLicenseRequestFromMessage(c),f=n.getHTTPMethod(i),c=n.getResponseType(s,i),m=t&&!isNaN(t.httpTimeout)?t.httpTimeout:8e3,t=a.getSessionId()||null,p=new Y.default(r,f,c,l,u,i,t,e),y=isNaN(C.get().streaming.retryAttempts[K.HTTPRequest.LICENSE])?3:C.get().streaming.retryAttempts[K.HTTPRequest.LICENSE];j(N.getLicenseRequestFilters(),p).then(function(){!function t(r,n,a,i,o,s){var e=new XMLHttpRequest;C.get().streaming.cmcd&&C.get().streaming.cmcd.enabled&&(C.get().streaming.cmcd.mode!==W.default.CMCD_MODE_QUERY||(u=w.getQueryParameter({url:r.url,type:K.HTTPRequest.LICENSE}))&&(r.url=z.default.addAditionalQueryParameterToUrl(r.url,[u])));e.open(r.method,r.url,!0);e.responseType=r.responseType;e.withCredentials=r.withCredentials;0<a&&(e.timeout=a);for(var l in r.headers)e.setRequestHeader(l,r.headers[l]);if(C.get().streaming.cmcd&&C.get().streaming.cmcd.enabled){var u=C.get().streaming.cmcd.mode;if(u===W.default.CMCD_MODE_HEADER){var c=w.getHeaderParameters({url:r.url,type:K.HTTPRequest.LICENSE});if(c)for(var f in c){var d=c[f];d&&e.setRequestHeader(f,d)}}}var g=function(){n--;var e=isNaN(C.get().streaming.retryIntervals[K.HTTPRequest.LICENSE])?1e3:C.get().streaming.retryIntervals[K.HTTPRequest.LICENSE];b=setTimeout(function(){t(r,n,a,i,o,s)},e)};e.onload=function(){T=null,200<=this.status&&this.status<=299||n<=0?i(this):(E.warn("License request failed ("+this.status+"). Retrying it... Pending retries: "+n),g())};e.ontimeout=e.onerror=function(){T=null,n<=0?s(this):(E.warn("License request network request failed . Retrying it... Pending retries: "+n),g())};e.onabort=function(){o(this)};R.trigger(I.LICENSE_REQUEST_SENDING,{url:r.url,headers:r.headers,payload:r.data,sessionId:r.sessionId});T=e;e.send(r.data)}(p,y,m,d,g,h)})}(t,o,i)}else P(r,new H.default(q.default.MEDIA_KEY_MESSAGE_NO_CHALLENGE_ERROR_CODE,q.default.MEDIA_KEY_MESSAGE_NO_CHALLENGE_ERROR_MESSAGE))}function P(e,t){R.trigger(I.LICENSE_REQUEST_COMPLETE,{data:e,error:t})}function L(){T&&(T.onloadend=T.onerror=T.onprogress=void 0,T.abort(),T=null),b&&(clearTimeout(b),b=null)}function F(e,t){if(t)for(var r in t)e[r]=t[r]}function x(e,t,r,n,a){var i="NONE",o=null;e.response&&(i=a.getErrorResponse(e.response,r,n),o={serverResponse:e.response||null,responseCode:e.status||null,responseText:e.statusText||null}),P(t,new H.default(q.default.MEDIA_KEY_MESSAGE_LICENSER_ERROR_CODE,q.default.MEDIA_KEY_MESSAGE_LICENSER_ERROR_MESSAGE+r+' update, XHR complete. status is "'+e.statusText+'" ('+e.status+"), readyState is "+e.readyState+".  Response is "+i,o))}function j(e,r){return e?e.reduce(function(e,t){return e.then(function(){return t(r)})},Promise.resolve()):Promise.resolve()}function k(e,t){if(!C.get().streaming.protection.ignoreEmeEncryptedEvent)if(E.debug("DRM: onNeedKey"),"cenc"===e.key.initDataType)if(0===_.length&&(E.warn("DRM: onNeedKey called before initializeForMedia, wait until initialized"),(t=void 0===t?1:t+1)<5))f.push(setTimeout(function(){k(e,t)},500));else{var r=e.key.initData;if(ArrayBuffer.isView(r)&&(r=r.buffer),v){var n=U.default.getPSSHForKeySystem(v,r);if(n&&y(n))return}E.debug("DRM: initData:",String.fromCharCode.apply(null,new Uint8Array(r)));r=S.getSupportedKeySystemsFromSegmentPssh(r,o,i);0!==r.length?(r=r,a.push(r),d(r,!1)):E.debug("DRM: Received needkey event with initData, but we don't support any of the key systems!")}else E.warn("DRM:  Only 'cenc' initData is supported!  Ignoring initData of type: "+e.key.initDataType)}return t={initializeForMedia:function(e){if(!e)throw new Error("mediaInfo can not be null or undefined");n(),_.push(e)},clearMediaInfoArray:function(){_=[]},handleKeySystemFromManifest:function(){var t;_&&0!==_.length&&(t=[],_.forEach(function(e){e=S.getSupportedKeySystemsFromContentProtection(e.contentProtection,o,i);0<e.length&&(0===t.length&&(t=e),a.push(e))}),t&&0<t.length&&d(t,!0))},createKeySession:m,loadKeySession:h,removeKeySession:function(e){n(),A.removeKeySession(e)},closeKeySession:function(e){n(),A.closeKeySession(e)},setServerCertificate:function(e){n(),A.setServerCertificate(e)},setMediaElement:D,setSessionType:function(e){i=e},setRobustnessLevel:function(e){s=e},setProtectionData:function(e){o=e,S.setProtectionData(e)},getSupportedKeySystemsFromContentProtection:function(e){return n(),S.getSupportedKeySystemsFromContentProtection(e,o,i)},getKeySystems:function(){return S?S.getKeySystems():[]},setKeySystems:function(e){S&&S.setKeySystems(e)},stop:function(){L(),A&&A.stop()},reset:function(){R.off(I.INTERNAL_KEY_MESSAGE,O,t),R.off(I.INTERNAL_KEY_STATUS_CHANGED,M,t),n(),L(),D(null),v=null,l=!1,A&&(A.reset(),A=null),f.forEach(function(e){return clearTimeout(e)}),f=[],_=[],a=[]}},E=r.getLogger(t),a=[],_=[],i="temporary",s="",b=T=null,R.on(I.INTERNAL_KEY_MESSAGE,O,t),R.on(I.INTERNAL_KEY_STATUS_CHANGED,M,t),t}n.__dashjs_factory_name="ProtectionController";const a=r.default.getClassFactory(n)},"./src/streaming/protection/controllers/ProtectionKeyController.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>a});var m=r("./src/streaming/protection/CommonEncryption.js"),u=r("./src/streaming/protection/drm/KeySystemClearKey.js"),c=r("./src/streaming/protection/drm/KeySystemW3CClearKey.js"),p=r("./src/streaming/protection/drm/KeySystemWidevine.js"),y=r("./src/streaming/protection/drm/KeySystemPlayReady.js"),E=r("./src/streaming/protection/servers/DRMToday.js"),_=r("./src/streaming/protection/servers/PlayReady.js"),v=r("./src/streaming/protection/servers/Widevine.js"),T=r("./src/streaming/protection/servers/ClearKey.js"),b=r("./src/streaming/constants/ProtectionConstants.js");function n(){var t,r,n,f,a,i,o,s,l=this.context;function d(e,t){return t&&e in t?t[e]:null}function g(e,t){return e&&e.sessionId?e.sessionId:t&&t.sessionId?t.sessionId:null}function h(e,t){return e&&e.sessionType?e.sessionType:t}return t={initialize:function(){var e;f=[],e=(0,y.default)(l).getInstance({BASE64:a,settings:i}),f.push(e),e=(0,p.default)(l).getInstance({BASE64:a}),f.push(e),e=(0,u.default)(l).getInstance({BASE64:a}),f.push(e),o=e,e=(0,c.default)(l).getInstance({BASE64:a,debug:r}),f.push(e),s=e},setProtectionData:function(e){for(var t,r=0;r<f.length;r++){var n=f[r];n.hasOwnProperty("init")&&n.init((t=n.systemString,n=void 0,n=null,n=e?t in e?e[t]:null:n))}},isClearKey:function(e){return e===o||e===s},initDataEquals:function(e,t){if(e.byteLength!==t.byteLength)return!1;for(var r=new Uint8Array(e),n=new Uint8Array(t),a=0;a<r.length;a++)if(r[a]!==n[a])return!1;return!0},getKeySystems:function(){return f},setKeySystems:function(e){f=e},getKeySystemBySystemString:function(e){for(var t=0;t<f.length;t++)if(f[t].systemString===e)return f[t];return null},getSupportedKeySystemsFromContentProtection:function(e,t,r){var n=[];if(e)for(var a=m.default.findCencContentProtection(e),i=0;i<f.length;++i)for(var o,s,l,u=d((o=f[i]).systemString,t),c=0;c<e.length;++c)(l=e[c]).schemeIdUri.toLowerCase()===o.schemeIdURI&&(s=o.getInitData(l,a),n.push({ks:f[i],keyId:l.keyId,initData:s,protData:u,cdmData:o.getCDMData(u?u.cdmData:null),sessionId:g(u,l),sessionType:h(u,r)}));return n},getSupportedKeySystemsFromSegmentPssh:function(e,t,r){for(var n=[],a=m.default.parsePSSHList(e),i=0;i<f.length;++i){var o,s=d((o=f[i]).systemString,t);o.uuid in a&&n.push({ks:o,initData:a[o.uuid],protData:s,cdmData:o.getCDMData(s?s.cdmData:null),sessionId:g(s),sessionType:h(s,r)})}return n},getLicenseServerModelInstance:function(e,t,r){return"license-release"===r||"individualization-request"===r?null:(r=null,t&&t.hasOwnProperty("drmtoday")?r=(0,E.default)(l).getInstance({BASE64:a}):e.systemString===b.default.WIDEVINE_KEYSTEM_STRING?r=(0,v.default)(l).getInstance():e.systemString===b.default.PLAYREADY_KEYSTEM_STRING?r=(0,_.default)(l).getInstance():e.systemString===b.default.CLEARKEY_KEYSTEM_STRING&&(r=(0,T.default)(l).getInstance()),r)},processClearKeyLicenseRequest:function(e,t,r){try{return e.getClearKeysFromProtectionData(t,r)}catch(e){return n.error("Failed to retrieve clearkeys from ProtectionData"),null}},setConfig:function(e){e&&(e.debug&&(r=e.debug,n=r.getLogger(t)),e.BASE64&&(a=e.BASE64),e.settings&&(i=e.settings))}}}n.__dashjs_factory_name="ProtectionKeyController";const a=dashjs.FactoryMaker.getSingletonFactory(n)},"./src/streaming/protection/drm/KeySystemClearKey.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>s});var l=r("./src/streaming/protection/vo/KeyPair.js"),u=r("./src/streaming/protection/vo/ClearKeyKeySet.js"),i=r("./src/streaming/protection/CommonEncryption.js"),r=r("./src/streaming/constants/ProtectionConstants.js"),n="e2719d58-a985-b3c9-781a-b030af78d30e",o=r.default.CLEARKEY_KEYSTEM_STRING;function a(e){var a=(e=e||{}).BASE64;return{uuid:n,schemeIdURI:"urn:uuid:e2719d58-a985-b3c9-781a-b030af78d30e",systemString:o,getInitData:function(e,t){try{var r,n=i.default.parseInitDataFromContentProtection(e,a);return!n&&t&&(r={kids:[function(e){try{var t=e.replace(/-/g,"");return(t=btoa(t.match(/\w{2}/g).map(function(e){return String.fromCharCode(parseInt(e,16))}).join(""))).replace(/=/g,"").replace(/\//g,"_").replace(/\+/g,"-")}catch(e){return null}}(t["cenc:default_KID"])]},n=(new TextEncoder).encode(JSON.stringify(r))),n}catch(e){return null}},getRequestHeadersFromMessage:function(){return{"Content-Type":"application/json"}},getLicenseRequestFromMessage:function(e){return JSON.stringify(JSON.parse(String.fromCharCode.apply(null,new Uint8Array(e))))},getLicenseServerURLFromInitData:function(){return null},getCDMData:function(){return null},getClearKeysFromProtectionData:function(e,t){var r=null;if(e){for(var n=JSON.parse(String.fromCharCode.apply(null,new Uint8Array(t))),a=[],i=0;i<n.kids.length;i++){var o=n.kids[i],s=e.clearkeys&&e.clearkeys.hasOwnProperty(o)?e.clearkeys[o]:null;if(!s)throw new Error("DRM: ClearKey keyID ("+o+") is not known!");a.push(new l.default(o,s))}r=new u.default(a)}return r}}}a.__dashjs_factory_name="KeySystemClearKey";const s=dashjs.FactoryMaker.getSingletonFactory(a)},"./src/streaming/protection/drm/KeySystemPlayReady.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>o});var c=r("./src/streaming/protection/CommonEncryption.js"),r=r("./src/streaming/constants/ProtectionConstants.js"),n="9a04f079-9840-4286-ab92-e65be0885f95",a=r.default.PLAYREADY_KEYSTEM_STRING;function i(e){var o="utf-16",l=(e=e||{}).BASE64,s=e.settings;function u(){if(!l||!l.hasOwnProperty("decodeArray")||!l.hasOwnProperty("decodeArray"))throw new Error("Missing config parameter(s)")}return{uuid:n,schemeIdURI:"urn:uuid:9a04f079-9840-4286-ab92-e65be0885f95",systemString:a,getInitData:function(e){var t,r,n,a=new Uint8Array([112,115,115,104,0,0,0,0]),i=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]),o=0,s=null;if(u(),!e)return null;if("pssh"in e)return c.default.parseInitDataFromContentProtection(e,l);if("pro"in e)s=l.decodeArray(e.pro.__text);else{if(!("prheader"in e))return null;s=l.decodeArray(e.prheader.__text)}return t=s.length,r=4+a.length+i.length+4+t,n=new ArrayBuffer(r),e=new Uint8Array(n),(n=new DataView(n)).setUint32(0,r),o+=4,e.set(a,4),o+=a.length,e.set(i,o),o+=i.length,n.setUint32(o,t),o+=4,e.set(s,o),e.buffer},getRequestHeadersFromMessage:function(e){var t={},r=new DOMParser;if(s&&s.get().streaming.protection.detectPlayreadyMessageFormat&&"utf-16"===o&&e&&e.byteLength%2==1)return t["Content-Type"]="text/xml; charset=utf-8",t;for(var e=new("utf-16"===o?Uint16Array:Uint8Array)(e),e=String.fromCharCode.apply(null,e),n=(e=r.parseFromString(e,"application/xml")).getElementsByTagName("name"),a=e.getElementsByTagName("value"),i=0;i<n.length;i++)t[n[i].childNodes[0].nodeValue]=a[i].childNodes[0].nodeValue;return t.hasOwnProperty("Content")&&(t["Content-Type"]=t.Content,delete t.Content),t.hasOwnProperty("Content-Type")||(t["Content-Type"]="text/xml; charset=utf-8"),t},getLicenseRequestFromMessage:function(e){var t=null,r=new DOMParser;if(s&&s.get().streaming.protection.detectPlayreadyMessageFormat&&"utf-16"===o&&e&&e.byteLength%2==1)return e;var n=new("utf-16"===o?Uint16Array:Uint8Array)(e);return u(),n=String.fromCharCode.apply(null,n),(n=r.parseFromString(n,"application/xml")).getElementsByTagName("PlayReadyKeyMessage")[0]?(n=n.getElementsByTagName("Challenge")[0].childNodes[0].nodeValue,t=n?l.decode(n):t):e},getLicenseServerURLFromInitData:function(e){if(e)for(var t=new DataView(e),r=t.getUint16(4,!0),n=6,a=new DOMParser,i=0;i<r;i++){var o=t.getUint16(n,!0);n+=2;var s=t.getUint16(n,!0);if(n+=2,1===o){var l=e.slice(n,n+s),o=String.fromCharCode.apply(null,new Uint16Array(l)),l=a.parseFromString(o,"application/xml");if(l.getElementsByTagName("LA_URL")[0]){o=l.getElementsByTagName("LA_URL")[0].childNodes[0].nodeValue;if(o)return o}if(l.getElementsByTagName("LUI_URL")[0]){l=l.getElementsByTagName("LUI_URL")[0].childNodes[0].nodeValue;if(l)return l}}else n+=s}return null},getCDMData:function(e){var t,r,n,a;if(u(),!e)return null;for(t=[],a=0;a<e.length;++a)t.push(e.charCodeAt(a)),t.push(0);for(t=String.fromCharCode.apply(null,t),t=l.encode(t),r='<PlayReadyCDMData type="LicenseAcquisition"><LicenseAcquisition version="1.0" Proactive="false"><CustomData encoding="base64encoded">%CUSTOMDATA%</CustomData></LicenseAcquisition></PlayReadyCDMData>'.replace("%CUSTOMDATA%",t),n=[],a=0;a<r.length;++a)n.push(r.charCodeAt(a)),n.push(0);return new Uint8Array(n).buffer},setPlayReadyMessageFormat:function(e){if("utf-8"!==e&&"utf-16"!==e)throw new Error('Specified message format is not one of "utf-8" or "utf-16"');o=e}}}i.__dashjs_factory_name="KeySystemPlayReady";const o=dashjs.FactoryMaker.getSingletonFactory(i)},"./src/streaming/protection/drm/KeySystemW3CClearKey.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>s});var u=r("./src/streaming/protection/vo/KeyPair.js"),c=r("./src/streaming/protection/vo/ClearKeyKeySet.js"),n=r("./src/streaming/protection/CommonEncryption.js"),r=r("./src/streaming/constants/ProtectionConstants.js"),a="1077efec-c0b2-4d02-ace3-3c1e52e2fb4b",i=r.default.CLEARKEY_KEYSTEM_STRING;function o(e){var t=e.BASE64,l=e.debug.getLogger(void 0);return{uuid:a,schemeIdURI:"urn:uuid:1077efec-c0b2-4d02-ace3-3c1e52e2fb4b",systemString:i,getInitData:function(e){return n.default.parseInitDataFromContentProtection(e,t)},getRequestHeadersFromMessage:function(){return null},getLicenseRequestFromMessage:function(e){return new Uint8Array(e)},getLicenseServerURLFromInitData:function(){return null},getCDMData:function(){return null},getClearKeysFromProtectionData:function(e,t){var r=null;if(e){for(var n=JSON.parse(String.fromCharCode.apply(null,new Uint8Array(t))),a=[],i=0;i<n.kids.length;i++){var o=n.kids[i],s=e.clearkeys&&e.clearkeys.hasOwnProperty(o)?e.clearkeys[o]:null;if(!s)throw new Error("DRM: ClearKey keyID ("+o+") is not known!");a.push(new u.default(o,s))}r=new c.default(a),l.warn("ClearKey schemeIdURI is using W3C Common PSSH systemID (1077efec-c0b2-4d02-ace3-3c1e52e2fb4b) in Content Protection. See DASH-IF IOP v4.1 section 7.6.2.4")}return r}}}o.__dashjs_factory_name="KeySystemW3CClearKey";const s=dashjs.FactoryMaker.getSingletonFactory(o)},"./src/streaming/protection/drm/KeySystemWidevine.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>s});var n=r("./src/streaming/protection/CommonEncryption.js"),r=r("./src/streaming/constants/ProtectionConstants.js"),a="edef8ba9-79d6-4ace-a3c8-27dcd51d21ed",i=r.default.WIDEVINE_KEYSTEM_STRING;function o(e){var t=(e=e||{}).BASE64;return{uuid:a,schemeIdURI:"urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed",systemString:i,getInitData:function(e){return n.default.parseInitDataFromContentProtection(e,t)},getRequestHeadersFromMessage:function(){return null},getLicenseRequestFromMessage:function(e){return new Uint8Array(e)},getLicenseServerURLFromInitData:function(){return null},getCDMData:function(){return null}}}o.__dashjs_factory_name="KeySystemWidevine";const s=dashjs.FactoryMaker.getSingletonFactory(o)},"./src/streaming/protection/errors/ProtectionErrors.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>l});var n=r("./src/core/errors/ErrorsBase.js");function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){return(i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function o(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=s(r);return e=n?(e=s(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),t=this,!(e=e)||"object"!==a(e)&&"function"!=typeof e?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(t):e}}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}const l=new(function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&i(e,t)}(r,n["default"]);var t=o(r);function r(){var e;return function(e){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}(this),(e=t.call(this)).MEDIA_KEYERR_CODE=100,e.MEDIA_KEYERR_UNKNOWN_CODE=101,e.MEDIA_KEYERR_CLIENT_CODE=102,e.MEDIA_KEYERR_SERVICE_CODE=103,e.MEDIA_KEYERR_OUTPUT_CODE=104,e.MEDIA_KEYERR_HARDWARECHANGE_CODE=105,e.MEDIA_KEYERR_DOMAIN_CODE=106,e.MEDIA_KEY_MESSAGE_ERROR_CODE=107,e.MEDIA_KEY_MESSAGE_NO_CHALLENGE_ERROR_CODE=108,e.SERVER_CERTIFICATE_UPDATED_ERROR_CODE=109,e.KEY_STATUS_CHANGED_EXPIRED_ERROR_CODE=110,e.MEDIA_KEY_MESSAGE_NO_LICENSE_SERVER_URL_ERROR_CODE=111,e.KEY_SYSTEM_ACCESS_DENIED_ERROR_CODE=112,e.KEY_SESSION_CREATED_ERROR_CODE=113,e.MEDIA_KEY_MESSAGE_LICENSER_ERROR_CODE=114,e.MEDIA_KEYERR_UNKNOWN_MESSAGE="An unspecified error occurred. This value is used for errors that don't match any of the other codes.",e.MEDIA_KEYERR_CLIENT_MESSAGE="The Key System could not be installed or updated.",e.MEDIA_KEYERR_SERVICE_MESSAGE="The message passed into update indicated an error from the license service.",e.MEDIA_KEYERR_OUTPUT_MESSAGE="There is no available output device with the required characteristics for the content protection system.",e.MEDIA_KEYERR_HARDWARECHANGE_MESSAGE="A hardware configuration change caused a content protection error.",e.MEDIA_KEYERR_DOMAIN_MESSAGE="An error occurred in a multi-device domain licensing configuration. The most common error is a failure to join the domain.",e.MEDIA_KEY_MESSAGE_ERROR_MESSAGE="Multiple key sessions were creates with a user-agent that does not support sessionIDs!! Unpredictable behavior ahead!",e.MEDIA_KEY_MESSAGE_NO_CHALLENGE_ERROR_MESSAGE="DRM: Empty key message from CDM",e.SERVER_CERTIFICATE_UPDATED_ERROR_MESSAGE="Error updating server certificate -- ",e.KEY_STATUS_CHANGED_EXPIRED_ERROR_MESSAGE="DRM: KeyStatusChange error! -- License has expired",e.MEDIA_KEY_MESSAGE_NO_LICENSE_SERVER_URL_ERROR_MESSAGE="DRM: No license server URL specified!",e.KEY_SYSTEM_ACCESS_DENIED_ERROR_MESSAGE="DRM: KeySystem Access Denied! -- ",e.KEY_SESSION_CREATED_ERROR_MESSAGE="DRM: unable to create session! --",e.MEDIA_KEY_MESSAGE_LICENSER_ERROR_MESSAGE="DRM: licenser error! --",e}return r}())},"./src/streaming/protection/models/ProtectionModel_01b.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>a});var v=r("./src/streaming/protection/controllers/ProtectionKeyController.js"),T=r("./src/streaming/protection/vo/NeedKey.js"),b=r("./src/streaming/vo/DashJSError.js"),S=r("./src/streaming/protection/vo/KeyMessage.js"),A=r("./src/streaming/protection/vo/KeySystemConfiguration.js"),R=r("./src/streaming/protection/vo/KeySystemAccess.js"),I=r("./src/streaming/protection/errors/ProtectionErrors.js");function n(e){e=e||{};var t,i,p,a,y,o,s,l,r,n=this.context,E=e.eventBus,_=e.events,u=e.debug,c=e.api,f=e.errHandler;function d(){p&&m();for(var e=0;e<s.length;e++)g(s[e]);E.trigger(_.TEARDOWN_COMPLETE)}function g(t){try{p[c.cancelKeyRequest](a.systemString,t.sessionId)}catch(e){E.trigger(_.KEY_SESSION_CLOSED,{data:null,error:"Error closing session ("+t.sessionId+") "+e.message})}}function h(e,t){if(t&&e){for(var r=e.length,n=0;n<r;n++)if(e[n].sessionId==t)return e[n];return null}return null}function m(){p.removeEventListener(c.keyerror,r),p.removeEventListener(c.needkey,r),p.removeEventListener(c.keymessage,r),p.removeEventListener(c.keyadded,r)}return t={getAllInitData:function(){for(var e=[],t=0;t<o.length;t++)e.push(o[t].initData);for(var r=0;r<s.length;r++)e.push(s[r].initData);return e},getSessions:function(){return s.concat(o)},requestKeySystemAccess:function(m){return new Promise(function(e,t){for(var r,n=(n=p)||document.createElement("video"),a=!1,i=0;i<m.length;i++)for(var o=m[i].ks.systemString,s=m[i].configs,l=null,u=null,c=0;c<s.length;c++){var f=s[c].videoCapabilities;if(f&&0!==f.length)for(var u=[],d=0;d<f.length;d++)""!==n.canPlayType(f[d].contentType,o)&&u.push(f[d]);if(u&&(!u||0!==u.length)){var a=!0,g=new A.default(l,u),h=y.getKeySystemBySystemString(o),g=new R.default(h,g);E.trigger(_.KEY_SYSTEM_ACCESS_COMPLETE,{data:g}),e({data:g});break}}a||(r="Key system access denied! -- No valid audio/video content configurations detected!",E.trigger(_.KEY_SYSTEM_ACCESS_COMPLETE,{error:r}),t({error:r}))})},selectKeySystem:function(e){return a=e.keySystem,Promise.resolve(a)},setMediaElement:function(e){if(p!==e){if(p){m();for(var t=0;t<s.length;t++)g(s[t]);s=[]}(p=e)&&(p.addEventListener(c.keyerror,r),p.addEventListener(c.needkey,r),p.addEventListener(c.keymessage,r),p.addEventListener(c.keyadded,r),E.trigger(_.VIDEO_ELEMENT_SELECTED))}},createKeySession:function(e){if(!a)throw new Error("Can not create sessions until you have selected a key system");if(l||0===s.length){var t={sessionId:null,keyId:e.keyId,initData:e.initData,getKeyId:function(){return this.keyId},getSessionId:function(){return this.sessionId},getExpirationTime:function(){return NaN},getSessionType:function(){return"temporary"}};return o.push(t),p[c.generateKeyRequest](a.systemString,new Uint8Array(e.initData)),t}throw new Error("Multiple sessions not allowed!")},updateKeySession:function(e,t){var r=e.sessionId;if(y.isClearKey(a))for(var n=0;n<t.keyPairs.length;n++)p[c.addKey](a.systemString,t.keyPairs[n].key,t.keyPairs[n].keyID,r);else p[c.addKey](a.systemString,new Uint8Array(t),new Uint8Array(e.initData),r);E.trigger(_.KEY_SESSION_UPDATED)},closeKeySession:g,setServerCertificate:function(){},loadKeySession:function(){},removeKeySession:function(){},stop:d,reset:d},i=u.getLogger(t),o=[],s=[],y=(a=p=null,v.default)(n).getInstance(),r={handleEvent:function(e){var t=null;switch(e.type){case c.needkey:var r=ArrayBuffer.isView(e.initData)?e.initData.buffer:e.initData;E.trigger(_.NEED_KEY,{key:new T.default(r,"cenc")});break;case c.keyerror:if(t=(t=h(s,e.sessionId))||h(o,e.sessionId)){var n=I.default.MEDIA_KEYERR_CODE,a="";switch(e.errorCode.code){case 1:n=I.default.MEDIA_KEYERR_UNKNOWN_CODE,a+="MEDIA_KEYERR_UNKNOWN - "+I.default.MEDIA_KEYERR_UNKNOWN_MESSAGE;break;case 2:n=I.default.MEDIA_KEYERR_CLIENT_CODE,a+="MEDIA_KEYERR_CLIENT - "+I.default.MEDIA_KEYERR_CLIENT_MESSAGE;break;case 3:n=I.default.MEDIA_KEYERR_SERVICE_CODE,a+="MEDIA_KEYERR_SERVICE - "+I.default.MEDIA_KEYERR_SERVICE_MESSAGE;break;case 4:n=I.default.MEDIA_KEYERR_OUTPUT_CODE,a+="MEDIA_KEYERR_OUTPUT - "+I.default.MEDIA_KEYERR_OUTPUT_MESSAGE;break;case 5:n=I.default.MEDIA_KEYERR_HARDWARECHANGE_CODE,a+="MEDIA_KEYERR_HARDWARECHANGE - "+I.default.MEDIA_KEYERR_HARDWARECHANGE_MESSAGE;break;case 6:n=I.default.MEDIA_KEYERR_DOMAIN_CODE,a+="MEDIA_KEYERR_DOMAIN - "+I.default.MEDIA_KEYERR_DOMAIN_MESSAGE}a+="  System Code = "+e.systemCode,E.trigger(_.KEY_ERROR,{error:new b.default(n,a,t)})}else i.error("No session token found for key error");break;case c.keyadded:(t=(t=h(s,e.sessionId))||h(o,e.sessionId))?(i.debug("DRM: Key added."),E.trigger(_.KEY_ADDED,{data:t})):i.debug("No session token found for key added");break;case c.keymessage:(l=null!==e.sessionId&&void 0!==e.sessionId)?!(t=h(s,e.sessionId))&&0<o.length&&(t=o.shift(),s.push(t),t.sessionId=e.sessionId,E.trigger(_.KEY_SESSION_CREATED,{data:t})):0<o.length&&(t=o.shift(),s.push(t),0!==o.length&&f.error(new b.default(I.default.MEDIA_KEY_MESSAGE_ERROR_CODE,I.default.MEDIA_KEY_MESSAGE_ERROR_MESSAGE))),t?(r=ArrayBuffer.isView(e.message)?e.message.buffer:e.message,t.keyMessage=r,E.trigger(_.INTERNAL_KEY_MESSAGE,{data:new S.default(t,r,e.defaultURL)})):i.warn("No session token found for key message")}}},t}n.__dashjs_factory_name="ProtectionModel_01b";const a=dashjs.FactoryMaker.getClassFactory(n)},"./src/streaming/protection/models/ProtectionModel_21Jan2015.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>a});var E=r("./src/streaming/protection/controllers/ProtectionKeyController.js"),_=r("./src/streaming/protection/vo/NeedKey.js"),v=r("./src/streaming/protection/errors/ProtectionErrors.js"),T=r("./src/streaming/vo/DashJSError.js"),b=r("./src/streaming/protection/vo/KeyMessage.js"),S=r("./src/streaming/protection/vo/KeySystemAccess.js"),A=r("./src/streaming/constants/ProtectionConstants.js"),R={};function n(e){e=e||{};var t,l,i,a,o,s,u,n,r=this.context,c=e.eventBus,f=e.events,d=e.debug;function g(r,n){return new Promise(function(e,t){!function t(r,n,a,i,o){var s=r[a];l.debug("Requesting key system access for system string ".concat(s));navigator.requestMediaKeySystemAccess(s,n).then(function(e){e.selectedSystemString=s,i(e)}).catch(function(e){a+1<r.length?t(r,n,a+1,i,o):o(e)})}(r,n,0,e,t)})}function h(e){var t=e.session;return t.removeEventListener("keystatuseschange",e),t.removeEventListener("message",e),t.close()}function m(e){for(var t=0;t<s.length;t++)if(s[t]===e){s.splice(t,1);break}}function p(e){var t,r;return e&&0<e.length&&(e[0]&&("string"==typeof e[0]?t=e[0]:r=e[0]),e[1]&&("string"==typeof e[1]?t=e[1]:r=e[1])),{status:t,keyId:r}}function y(t,e){var r={session:t,keyId:e.keyId,initData:e.initData,sessionId:e.sessionId,sessionType:e.sessionType,handleEvent:function(e){switch(e.type){case"keystatuseschange":c.trigger(f.KEY_STATUSES_CHANGED,{data:this}),e.target.keyStatuses.forEach(function(){var e=p(arguments);"expired"===e.status?c.trigger(f.INTERNAL_KEY_STATUS_CHANGED,{error:new T.default(v.default.KEY_STATUS_CHANGED_EXPIRED_ERROR_CODE,v.default.KEY_STATUS_CHANGED_EXPIRED_ERROR_MESSAGE)}):c.trigger(f.INTERNAL_KEY_STATUS_CHANGED,e)});break;case"message":var t=ArrayBuffer.isView(e.message)?e.message.buffer:e.message;c.trigger(f.INTERNAL_KEY_MESSAGE,{data:new b.default(this,t,void 0,e.messageType)})}},getKeyId:function(){return this.keyId},getSessionId:function(){return t.sessionId},getSessionType:function(){return this.sessionType},getExpirationTime:function(){return t.expiration},getKeyStatuses:function(){return t.keyStatuses},getUsable:function(){var e=!1;return t.keyStatuses.forEach(function(){"usable"===p(arguments).status&&(e=!0)}),e}};return t.addEventListener("keystatuseschange",r),t.addEventListener("message",r),t.closed.then(function(){m(r),l.debug("DRM: Session closed.  SessionID = "+r.getSessionId()),c.trigger(f.KEY_SESSION_CLOSED,{data:r.getSessionId()})}),s.push(r),r}return t={getAllInitData:function(){for(var e=[],t=0;t<s.length;t++)s[t].initData&&e.push(s[t].initData);return e},getSessions:function(){return s},requestKeySystemAccess:function(r){return new Promise(function(e,t){!function r(n,a,i,o){if(void 0===navigator.requestMediaKeySystemAccess||"function"!=typeof navigator.requestMediaKeySystemAccess){var e="Insecure origins are not allowed";return c.trigger(f.KEY_SYSTEM_ACCESS_COMPLETE,{error:e}),void o({error:e})}var t=n[a].protData&&n[a].protData.systemStringPriority?n[a].protData.systemStringPriority:null;var s=n[a].configs;var l=n[a].ks;e=l.systemString;var e=t||R[e]||[e];g(e,s).then(function(e){var t="function"==typeof e.getConfiguration?e.getConfiguration():null,t=new S.default(l,t);t.mksa=e,c.trigger(f.KEY_SYSTEM_ACCESS_COMPLETE,{data:t}),i({data:t})}).catch(function(e){var t;a+1<n.length?r(n,a+1,i,o):(t="Key system access denied! ",c.trigger(f.KEY_SYSTEM_ACCESS_COMPLETE,{error:t+e.message}),o({error:t+e.message}))})}(r,0,e,t)})},selectKeySystem:function(r){return new Promise(function(e,t){r.mksa.createMediaKeys().then(function(e){return i=r.keySystem,o=e,a?a.setMediaKeys(o):Promise.resolve()}).then(function(){e(i)}).catch(function(){t({error:"Error selecting keys system ("+r.keySystem.systemString+")! Could not create MediaKeys -- TODO"})})})},setMediaElement:function(e){a!==e&&(a&&(a.removeEventListener("encrypted",u),a.setMediaKeys&&a.setMediaKeys(null)),(a=e)&&(a.addEventListener("encrypted",u),a.setMediaKeys&&o&&a.setMediaKeys(o)))},setServerCertificate:function(e){if(!i||!o)throw new Error("Can not set server certificate until you have selected a key system");o.setServerCertificate(e).then(function(){l.info("DRM: License server certificate successfully updated."),c.trigger(f.SERVER_CERTIFICATE_UPDATED)}).catch(function(e){c.trigger(f.SERVER_CERTIFICATE_UPDATED,{error:new T.default(v.default.SERVER_CERTIFICATE_UPDATED_ERROR_CODE,v.default.SERVER_CERTIFICATE_UPDATED_ERROR_MESSAGE+e.name)})})},createKeySession:function(e){if(!i||!o)throw new Error("Can not create sessions until you have selected a key system");var t=o.createSession(e.sessionType),r=y(t,e),n=i.systemString===A.default.CLEARKEY_KEYSTEM_STRING&&(e.initData||e.protData&&e.protData.clearkeys)?A.default.INITIALIZATION_DATA_TYPE_KEYIDS:A.default.INITIALIZATION_DATA_TYPE_CENC;t.generateRequest(n,e.initData).then(function(){l.debug("DRM: Session created.  SessionID = "+r.getSessionId()),c.trigger(f.KEY_SESSION_CREATED,{data:r})}).catch(function(e){m(r),c.trigger(f.KEY_SESSION_CREATED,{data:null,error:new T.default(v.default.KEY_SESSION_CREATED_ERROR_CODE,v.default.KEY_SESSION_CREATED_ERROR_MESSAGE+"Error generating key request -- "+e.name)})})},updateKeySession:function(t,e){var r=t.session;n.isClearKey(i)&&(e=e.toJWK()),r.update(e).then(function(){c.trigger(f.KEY_SESSION_UPDATED)}).catch(function(e){c.trigger(f.KEY_ERROR,{error:new T.default(v.default.MEDIA_KEYERR_CODE,"Error sending update() message! "+e.name,t)})})},loadKeySession:function(e){if(!i||!o)throw new Error("Can not load sessions until you have selected a key system");for(var t=e.sessionId,r=0;r<s.length;r++)if(t===s[r].sessionId)return void l.warn("DRM: Ignoring session ID because we have already seen it!");var n=o.createSession(e.sessionType),a=y(n,e);n.load(t).then(function(e){e?(l.debug("DRM: Session loaded.  SessionID = "+a.getSessionId()),c.trigger(f.KEY_SESSION_CREATED,{data:a})):(m(a),c.trigger(f.KEY_SESSION_CREATED,{data:null,error:new T.default(v.default.KEY_SESSION_CREATED_ERROR_CODE,v.default.KEY_SESSION_CREATED_ERROR_MESSAGE+"Could not load session! Invalid Session ID ("+t+")")}))}).catch(function(e){m(a),c.trigger(f.KEY_SESSION_CREATED,{data:null,error:new T.default(v.default.KEY_SESSION_CREATED_ERROR_CODE,v.default.KEY_SESSION_CREATED_ERROR_MESSAGE+"Could not load session ("+t+")! "+e.name)})})},removeKeySession:function(t){t.session.remove().then(function(){l.debug("DRM: Session removed.  SessionID = "+t.getSessionId()),c.trigger(f.KEY_SESSION_REMOVED,{data:t.getSessionId()})},function(e){c.trigger(f.KEY_SESSION_REMOVED,{data:null,error:"Error removing session ("+t.getSessionId()+"). "+e.name})})},closeKeySession:function(t){h(t).catch(function(e){m(t),c.trigger(f.KEY_SESSION_CLOSED,{data:null,error:"Error closing session ("+t.getSessionId()+") "+e.name})})},stop:function(){for(var e,t=0;t<s.length;t++)(e=s[t]).getUsable()||h(e).catch(function(){m(e)})},reset:function(){var r,n=s.length;0!==n?function(){for(var t=function(e){m(e),0===s.length&&(a?(a.removeEventListener("encrypted",u),a.setMediaKeys(null).then(function(){c.trigger(f.TEARDOWN_COMPLETE)})):c.trigger(f.TEARDOWN_COMPLETE))},e=0;e<n;e++)!function(e){r.session.closed.then(function(){t(e)}),h(r).catch(function(){t(e)})}(r=s[e])}():c.trigger(f.TEARDOWN_COMPLETE)}},l=d.getLogger(t),s=[],n=(o=a=i=null,E.default)(r).getInstance(),u={handleEvent:function(e){var t;"encrypted"===e.type&&e.initData&&(t=ArrayBuffer.isView(e.initData)?e.initData.buffer:e.initData,c.trigger(f.NEED_KEY,{key:new _.default(t,e.initDataType)}))}},t}R[A.default.PLAYREADY_KEYSTEM_STRING]=[A.default.PLAYREADY_KEYSTEM_STRING,A.default.PLAYREADY_RECOMMENDATION_KEYSTEM_STRING],R[A.default.WIDEVINE_KEYSTEM_STRING]=[A.default.WIDEVINE_KEYSTEM_STRING],R[A.default.CLEARKEY_KEYSTEM_STRING]=[A.default.CLEARKEY_KEYSTEM_STRING],n.__dashjs_factory_name="ProtectionModel_21Jan2015";const a=dashjs.FactoryMaker.getClassFactory(n)},"./src/streaming/protection/models/ProtectionModel_3Feb2014.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>a});var h=r("./src/streaming/protection/controllers/ProtectionKeyController.js"),m=r("./src/streaming/protection/vo/NeedKey.js"),p=r("./src/streaming/vo/DashJSError.js"),T=r("./src/streaming/protection/errors/ProtectionErrors.js"),b=r("./src/streaming/protection/vo/KeyMessage.js"),S=r("./src/streaming/protection/vo/KeySystemConfiguration.js"),A=r("./src/streaming/protection/vo/KeySystemAccess.js");function n(e){e=e||{};var t,r,n,a,i,o,s,l,y,u=this.context,E=e.eventBus,_=e.events,c=e.debug,v=e.api;function f(){try{for(var e=0;e<s.length;e++)d(s[e]);n&&n.removeEventListener(v.needkey,l),E.trigger(_.TEARDOWN_COMPLETE)}catch(e){E.trigger(_.TEARDOWN_COMPLETE,{error:"Error tearing down key sessions and MediaKeys! -- "+e.message})}}function d(e){var t=e.session;t.removeEventListener(v.error,e),t.removeEventListener(v.message,e),t.removeEventListener(v.ready,e),t.removeEventListener(v.close,e);for(var r=0;r<s.length;r++)if(s[r]===e){s.splice(r,1);break}t[v.release]()}function g(){function e(){n.removeEventListener("loadedmetadata",t),n[v.setMediaKeys](i),E.trigger(_.VIDEO_ELEMENT_SELECTED)}var t=null;1<=n.readyState?e():(t=e.bind(this),n.addEventListener("loadedmetadata",t))}return t={getAllInitData:function(){for(var e=[],t=0;t<s.length;t++)e.push(s[t].initData);return e},getSessions:function(){return s},requestKeySystemAccess:function(p){return new Promise(function(e,t){for(var r,n=!1,a=0;a<p.length;a++)for(var i=p[a].ks.systemString,o=p[a].configs,s=null,l=null,u=0;u<o.length;u++){var c=o[u].audioCapabilities,f=o[u].videoCapabilities;if(c&&0!==c.length)for(var s=[],d=0;d<c.length;d++)window[v.MediaKeys].isTypeSupported(i,c[d].contentType)&&s.push(c[d]);if(f&&0!==f.length)for(var l=[],g=0;g<f.length;g++)window[v.MediaKeys].isTypeSupported(i,f[g].contentType)&&l.push(f[g]);if(!(!s&&!l||s&&0===s.length||l&&0===l.length)){var n=!0,h=new S.default(s,l),m=y.getKeySystemBySystemString(i),h=new A.default(m,h);E.trigger(_.KEY_SYSTEM_ACCESS_COMPLETE,{data:h}),e({data:h});break}}n||(r="Key system access denied! -- No valid audio/video content configurations detected!",E.trigger(_.KEY_SYSTEM_ACCESS_COMPLETE,{error:r}),t({error:r}))})},selectKeySystem:function(r){return new Promise(function(e,t){try{i=r.mediaKeys=new window[v.MediaKeys](r.keySystem.systemString),a=r.keySystem,o=r,n&&g(),e(a)}catch(e){t({error:"Error selecting keys system ("+a.systemString+")! Could not create MediaKeys -- TODO"})}})},setMediaElement:function(e){n!==e&&(n&&n.removeEventListener(v.needkey,l),(n=e)&&(n.addEventListener(v.needkey,l),i&&g()))},createKeySession:function(e){if(!a||!i||!o)throw new Error("Can not create sessions until you have selected a key system");var t=null;if(null===(t=null===(t=o.ksConfiguration.videoCapabilities&&0<o.ksConfiguration.videoCapabilities.length?o.ksConfiguration.videoCapabilities[0]:t)&&o.ksConfiguration.audioCapabilities&&0<o.ksConfiguration.audioCapabilities.length?o.ksConfiguration.audioCapabilities[0]:t))throw new Error("Can not create sessions for unknown content types.");t=t.contentType,t=i.createSession(t,new Uint8Array(e.initData),e.cdmData?new Uint8Array(e.cdmData):null),e={session:t,keyId:(e=e).keyId,initData:e.initData,getKeyId:function(){return this.keyId},getSessionId:function(){return this.session.sessionId},getExpirationTime:function(){return NaN},getSessionType:function(){return"temporary"},handleEvent:function(e){switch(e.type){case v.error:E.trigger(_.KEY_ERROR,{error:new p.default(T.default.MEDIA_KEYERR_CODE,"KeyError",this)});break;case v.message:var t=ArrayBuffer.isView(e.message)?e.message.buffer:e.message;E.trigger(_.INTERNAL_KEY_MESSAGE,{data:new b.default(this,t,e.destinationURL)});break;case v.ready:r.debug("DRM: Key added."),E.trigger(_.KEY_ADDED);break;case v.close:r.debug("DRM: Session closed.  SessionID = "+this.getSessionId()),E.trigger(_.KEY_SESSION_CLOSED,{data:this.getSessionId()})}}},t.addEventListener(v.error,e),t.addEventListener(v.message,e),t.addEventListener(v.ready,e),t.addEventListener(v.close,e),s.push(e),r.debug("DRM: Session created.  SessionID = "+e.getSessionId()),E.trigger(_.KEY_SESSION_CREATED,{data:e})},updateKeySession:function(e,t){e=e.session,y.isClearKey(a)?e.update(new Uint8Array(t.toJWK())):e.update(new Uint8Array(t)),E.trigger(_.KEY_SESSION_UPDATED)},closeKeySession:d,setServerCertificate:function(){},loadKeySession:function(){},removeKeySession:function(){},stop:f,reset:f},r=c.getLogger(t),s=[],y=(o=i=a=n=null,h.default)(u).getInstance(),l={handleEvent:function(e){e.type===v.needkey&&e.initData&&(e=ArrayBuffer.isView(e.initData)?e.initData.buffer:e.initData,E.trigger(_.NEED_KEY,{key:new m.default(e,"cenc")}))}},t}n.__dashjs_factory_name="ProtectionModel_3Feb2014";const a=dashjs.FactoryMaker.getClassFactory(n)},"./src/streaming/protection/servers/ClearKey.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>a});var i=r("./src/streaming/protection/vo/KeyPair.js"),o=r("./src/streaming/protection/vo/ClearKeyKeySet.js");function n(){return{getServerURLFromMessage:function(e){return e},getHTTPMethod:function(){return"POST"},getResponseType:function(){return"json"},getLicenseMessage:function(e){if(!e.hasOwnProperty("keys"))return null;for(var t=[],r=0;r<e.keys.length;r++){var n=e.keys[r],a=n.kid.replace(/=/g,""),n=n.k.replace(/=/g,"");t.push(new i.default(a,n))}return new o.default(t)},getErrorResponse:function(e){return String.fromCharCode.apply(null,new Uint8Array(e))}}}n.__dashjs_factory_name="ClearKey";const a=dashjs.FactoryMaker.getSingletonFactory(n)},"./src/streaming/protection/servers/DRMToday.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>i});var a=r("./src/streaming/constants/ProtectionConstants.js");function n(e){var r=(e=e||{}).BASE64,n={};return n[a.default.WIDEVINE_KEYSTEM_STRING]={responseType:"json",getLicenseMessage:function(e){return r.decodeArray(e.license)},getErrorResponse:function(e){return e}},n[a.default.PLAYREADY_KEYSTEM_STRING]={responseType:"arraybuffer",getLicenseMessage:function(e){return e},getErrorResponse:function(e){return String.fromCharCode.apply(null,new Uint8Array(e))}},{getServerURLFromMessage:function(e){return e},getHTTPMethod:function(){return"POST"},getResponseType:function(e){return n[e].responseType},getLicenseMessage:function(e,t){return function(){if(!r||!r.hasOwnProperty("decodeArray"))throw new Error("Missing config parameter(s)")}(),n[t].getLicenseMessage(e)},getErrorResponse:function(e,t){return n[t].getErrorResponse(e)}}}n.__dashjs_factory_name="DRMToday";const i=dashjs.FactoryMaker.getSingletonFactory(n)},"./src/streaming/protection/servers/PlayReady.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>a});r=r("./src/core/FactoryMaker.js");function n(){var s="http://schemas.xmlsoap.org/soap/envelope/";function l(e){e=String.fromCharCode.apply(null,new Uint8Array(e));return decodeURIComponent(escape(e))}return{getServerURLFromMessage:function(e){return e},getHTTPMethod:function(){return"POST"},getResponseType:function(){return"arraybuffer"},getLicenseMessage:function(e){return function(e){if(window.DOMParser){var t=l(e),t=(new window.DOMParser).parseFromString(t,"text/xml"),t=t?t.getElementsByTagNameNS(s,"Envelope")[0]:null,t=t?t.getElementsByTagNameNS(s,"Body")[0]:null;if(t?t.getElementsByTagNameNS(s,"Fault")[0]:null)return null}return e}.call(this,e)},getErrorResponse:function(e){return function(e){var t="",r="",n="";if(window.DOMParser){var a=l(e),i=(new window.DOMParser).parseFromString(a,"text/xml"),o=i?i.getElementsByTagNameNS(s,"Envelope")[0]:null,e=o?o.getElementsByTagNameNS(s,"Body")[0]:null,i=e?e.getElementsByTagNameNS(s,"Fault")[0]:null,o=i?i.getElementsByTagName("detail")[0]:null,e=o?o.getElementsByTagName("Exception")[0]:null,o=null;if(null===i)return a;t=(o=i.getElementsByTagName("faultstring")[0].firstChild)?o.nodeValue:null,null!==e&&(r=(o=e.getElementsByTagName("StatusCode")[0])?o.firstChild.nodeValue:null,e=(n=(o=e.getElementsByTagName("Message")[0])?o.firstChild.nodeValue:null)?n.lastIndexOf("[")+1:-1,o=n?n.indexOf("]"):-1,n=n?n.substring(e,o):"")}return t="code: ".concat(r,", name: ").concat(t),n&&(t+=", message: ".concat(n)),t}.call(this,e)}}}n.__dashjs_factory_name="PlayReady";const a=r.default.getSingletonFactory(n)},"./src/streaming/protection/servers/Widevine.js":(e,t,r)=>{function n(){return{getServerURLFromMessage:function(e){return e},getHTTPMethod:function(){return"POST"},getResponseType:function(){return"arraybuffer"},getLicenseMessage:function(e){return e},getErrorResponse:function(e){return String.fromCharCode.apply(null,new Uint8Array(e))}}}r.r(t),r.d(t,{default:()=>a}),n.__dashjs_factory_name="Widevine";const a=dashjs.FactoryMaker.getSingletonFactory(n)},"./src/streaming/protection/vo/ClearKeyKeySet.js":(e,t,r)=>{function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}r.r(t),r.d(t,{default:()=>n});const n=function(){function r(e,t){if(!function(e){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}(this),t&&"persistent"!==t&&"temporary"!==t)throw new Error("Invalid ClearKey key set type!  Must be one of 'persistent' or 'temporary'");this.keyPairs=e,this.type=t}var e,t,n;return e=r,(t=[{key:"toJWK",value:function(){for(var e=this.keyPairs.length,t={keys:[]},r=0;r<e;r++){var n={kty:"oct",alg:"A128KW",kid:this.keyPairs[r].keyID,k:this.keyPairs[r].key};t.keys.push(n)}this.type&&(t.type=this.type);var a=JSON.stringify(t),i=a.length,o=new ArrayBuffer(i),s=new Uint8Array(o);for(r=0;r<i;r++)s[r]=a.charCodeAt(r);return o}}])&&a(e.prototype,t),n&&a(e,n),r}()},"./src/streaming/protection/vo/KeyMessage.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>n});const n=function t(e,r,n,a){!function(e){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),this.sessionToken=e,this.message=r,this.defaultURL=n,this.messageType=a||"license-request"}},"./src/streaming/protection/vo/KeyPair.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>n});const n=function t(e,r){!function(e){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),this.keyID=e,this.key=r}},"./src/streaming/protection/vo/KeySystemAccess.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>n});const n=function t(e,r){!function(e){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),this.keySystem=e,this.ksConfiguration=r}},"./src/streaming/protection/vo/KeySystemConfiguration.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>n});const n=function t(e,r,n,a,i){!function(e){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),this.initDataTypes=["cenc"],e&&e.length&&(this.audioCapabilities=e),r&&r.length&&(this.videoCapabilities=r),this.distinctiveIdentifier=n,this.persistentState=a,this.sessionTypes=i}},"./src/streaming/protection/vo/LicenseRequest.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>n});const n=function t(e,r,n,a,i,o,s,l){!function(e){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),this.url=e,this.method=r,this.responseType=n,this.headers=a,this.withCredentials=i,this.messageType=o,this.sessionId=s,this.data=l}},"./src/streaming/protection/vo/LicenseResponse.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>n});const n=function t(e,r,n){!function(e){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),this.url=e,this.headers=r,this.data=n}},"./src/streaming/protection/vo/MediaCapability.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>n});const n=function t(e,r){!function(e){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),this.contentType=e,this.robustness=r}},"./src/streaming/protection/vo/NeedKey.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>n});const n=function t(e,r){!function(e){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),this.initData=e,this.initDataType=r}},"./src/streaming/rules/DroppedFramesHistory.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>a});r=r("./src/core/FactoryMaker.js");function n(){var i={},o={},s={};return{push:function(e,t,r){var n,a;t&&(i[e]||(i[e]=[],o[e]=0,s[e]=0),a=r&&r.droppedVideoFrames?r.droppedVideoFrames:0,n=r&&r.totalVideoFrames?r.totalVideoFrames:0,r=a-o[e],o[e]=a,a=n-s[e],s[e]=n,e=i[e],isNaN(t)||(e[t]?(e[t].droppedVideoFrames+=r,e[t].totalVideoFrames+=a):e[t]={droppedVideoFrames:r,totalVideoFrames:a}))},getFrameHistory:function(e){return i[e]},clearForStream:function(e){try{delete i[e],delete o[e],delete s[e]}catch(e){}},reset:function(){i={},o={},s={}}}}n.__dashjs_factory_name="DroppedFramesHistory";const a=r.default.getClassFactory(n)},"./src/streaming/rules/RulesContext.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>a});r=r("./src/core/FactoryMaker.js");function n(e){var t=(e=e||{}).abrController,r=e.switchHistory,n=e.droppedFramesHistory,a=e.currentRequest,i=e.useBufferOccupancyABR,o=e.useL2AABR,s=e.useLoLPABR,l=e.streamProcessor?e.streamProcessor.getScheduleController():null,u=e.streamProcessor?e.streamProcessor.getRepresentationInfo():null,c=e.videoModel||null;function f(){return u?u.mediaInfo:null}return{getMediaType:function(){var e=f();return e?e.type:null},getMediaInfo:f,getDroppedFramesHistory:function(){return n},getCurrentRequest:function(){return a},getSwitchHistory:function(){return r},getStreamInfo:function(){var e=f();return e?e.streamInfo:null},getScheduleController:function(){return l},getAbrController:function(){return t},getRepresentationInfo:function(){return u},useBufferOccupancyABR:function(){return i},useL2AABR:function(){return o},useLoLPABR:function(){return s},getVideoModel:function(){return c}}}n.__dashjs_factory_name="RulesContext";const a=r.default.getClassFactory(n)},"./src/streaming/rules/SwitchRequest.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>i});var t=r("./src/core/FactoryMaker.js"),a={DEFAULT:.5,STRONG:1,WEAK:0};function n(e,t,r){var n;return{quality:void 0===e?-1:e,reason:void 0===t?null:t,priority:(n=r)!==a.DEFAULT&&n!==a.STRONG&&n!==a.WEAK?a.DEFAULT:n}}n.__dashjs_factory_name="SwitchRequest";r=t.default.getClassFactory(n);r.NO_CHANGE=-1,r.PRIORITY=a,t.default.updateClassFactory(n.__dashjs_factory_name,r);const i=r},"./src/streaming/rules/SwitchRequestHistory.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>a});var t=r("./src/core/FactoryMaker.js"),o=r("./src/streaming/rules/SwitchRequest.js");function n(){var a=[],i=[];return{push:function(e){e.newValue===o.default.NO_CHANGE&&(e.newValue=e.oldValue),a[e.oldValue]||(a[e.oldValue]={noDrops:0,drops:0,dropSize:0});var t=(n=e.newValue-e.oldValue)<0?1:0,r=t?-n:0,n=t?0:1;a[e.oldValue].drops+=t,a[e.oldValue].dropSize+=r,a[e.oldValue].noDrops+=n,i.push({idx:e.oldValue,noDrop:n,drop:t,dropSize:r}),8<i.length&&(r=i.shift(),a[r.idx].drops-=r.drop,a[r.idx].dropSize-=r.dropSize,a[r.idx].noDrops-=r.noDrop)},getSwitchRequests:function(){return a},reset:function(){a=[],i=[]}}}n.__dashjs_factory_name="SwitchRequestHistory";const a=t.default.getClassFactory(n)},"./src/streaming/rules/ThroughputHistory.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>a});var v=r("./src/streaming/constants/Constants.js"),r=r("./src/core/FactoryMaker.js");function n(e){var c,f,d,g,h,s=3,l=4,u=4,m=1.3,p=1.3,y=(e=e||{}).settings;function E(e,t,r,n){var a=Math.pow(.5,r/n.fast);e.fastEstimate=(1-a)*t+a*e.fastEstimate;n=Math.pow(.5,r/n.slow);e.slowEstimate=(1-n)*t+n*e.slowEstimate,e.totalWeight+=r}function r(e,t,r){return y.get().streaming.abr.movingAverageMethod!==v.default.MOVING_AVERAGE_SLIDING_WINDOW?function(e,t){var r=e?h.throughputHalfLife:h.latencyHalfLife,n=(e?d:g)[t];if(!n||n.totalWeight<=0)return NaN;t=n.fastEstimate/(1-Math.pow(.5,n.totalWeight/r.fast)),r=n.slowEstimate/(1-Math.pow(.5,n.totalWeight/r.slow));return e?Math.min(t,r):Math.max(t,r)}(e,t):function(e,t,r){r=function(e,t,r){var n,a=e?(n=c[t],r?s:l):(n=f[t],u);if(n){if(a>=n.length)a=n.length;else if(e)for(var i=1;i<a;++i){var o=n[n.length-i]/n[n.length-i-1];if((p<=o||o<=1/m)&&(a+=1)===n.length)break}}else a=0;return a}(e,t,r),t=(e?c:f)[t];return 0!==r&&t&&0!==t.length?(t=t.slice(-r)).reduce(function(e,t){return e+t})/t.length:NaN}(e,t,r)}function n(e,t){return r(!0,e,t)}function _(e){c[e]=c[e]||[],f[e]=f[e]||[],d[e]=d[e]||{fastEstimate:0,slowEstimate:0,totalWeight:0},g[e]=g[e]||{fastEstimate:0,slowEstimate:0,totalWeight:0}}function t(){c={},f={},d={},g={}}e={push:function(e,t,r){if(t.trace&&t.trace.length){var n,a,i=t.tresponse.getTime()-t.trequest.getTime()||1,o=t._tfinish.getTime()-t.tresponse.getTime()||1,s=t.trace.reduce(function(e,t){return e+t.b[0]},0),l=0,u=0;if(0!==(l=t._fileLoaderType&&t._fileLoaderType===v.default.FILE_LOADER_TYPES.FETCH?t.trace.reduce(function(e,t){return e+t.d},0):r?o:i+o)&&(u=Math.round(8*s/l)),t.cmsd&&(!(a=t.cmsd.dynamic&&t.cmsd.dynamic.etp?t.cmsd.dynamic.etp:null)||0<(n=y.get().streaming.cmsd.abr.etpWeightRatio)&&n<=1&&(u=u*(1-n)+a*n)),_(e),a=o,(n=e)===v.default.VIDEO?a<y.get().streaming.cacheLoadThresholds[v.default.VIDEO]:n===v.default.AUDIO&&a<y.get().streaming.cacheLoadThresholds[v.default.AUDIO]){if(0<c[e].length&&!c[e].hasCachedEntries)return;c[e].hasCachedEntries=!0}else c[e]&&c[e].hasCachedEntries&&(delete c[a=e],delete f[a],delete d[a],delete g[a],_(a));c[e].push(u),20<c[e].length&&c[e].shift(),f[e].push(i),20<f[e].length&&f[e].shift(),E(d[e],u,.001*o,h.throughputHalfLife),E(g[e],i,1,h.latencyHalfLife)}},getAverageThroughput:n,getSafeAverageThroughput:function(e,t){return t=n(e,t),isNaN(t)||(t*=y.get().streaming.abr.bandwidthSafetyFactor),t},getAverageLatency:function(e){return r(!1,e)},reset:t};return h={throughputHalfLife:{fast:3,slow:8},latencyHalfLife:{fast:1,slow:2}},t(),e}n.__dashjs_factory_name="ThroughputHistory";const a=r.default.getClassFactory(n)},"./src/streaming/rules/abr/ABRRulesCollection.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>a});var c=r("./src/streaming/rules/abr/ThroughputRule.js"),f=r("./src/streaming/rules/abr/InsufficientBufferRule.js"),d=r("./src/streaming/rules/abr/AbandonRequestsRule.js"),g=r("./src/streaming/rules/abr/DroppedFramesRule.js"),h=r("./src/streaming/rules/abr/SwitchHistoryRule.js"),m=r("./src/streaming/rules/abr/BolaRule.js"),p=r("./src/streaming/rules/abr/L2ARule.js"),y=r("./src/streaming/rules/abr/lolp/LoLpRule.js"),t=r("./src/core/FactoryMaker.js"),E=r("./src/streaming/rules/SwitchRequest.js"),_=r("./src/streaming/constants/Constants.js"),v="qualitySwitchRules",T="abandonFragmentRules";function n(e){e=e||{};var r,n,l=this.context,t=e.mediaPlayerModel,a=e.customParametersModel,i=e.dashMetrics,o=e.settings;function s(e){return e.filter(function(e){return e.quality>E.default.NO_CHANGE})}function u(e){var t,r,n,a,i,o={},s=null;if(0!==e.length){for(o[E.default.PRIORITY.STRONG]={quality:E.default.NO_CHANGE,reason:null},o[E.default.PRIORITY.WEAK]={quality:E.default.NO_CHANGE,reason:null},o[E.default.PRIORITY.DEFAULT]={quality:E.default.NO_CHANGE,reason:null},t=0,r=e.length;t<r;t+=1)(n=e[t]).quality!==E.default.NO_CHANGE&&(o[n.priority].quality===E.default.NO_CHANGE||o[n.priority].quality>n.quality)&&(o[n.priority].quality=n.quality,o[n.priority].reason=n.reason||null);return o[E.default.PRIORITY.WEAK].quality!==E.default.NO_CHANGE&&(s=o[E.default.PRIORITY.WEAK]),o[E.default.PRIORITY.DEFAULT].quality!==E.default.NO_CHANGE&&(s=o[E.default.PRIORITY.DEFAULT]),(s=o[E.default.PRIORITY.STRONG].quality!==E.default.NO_CHANGE?o[E.default.PRIORITY.STRONG]:s)&&(a=s.quality,i=s.reason),(0,E.default)(l).create(a,i)}}return{initialize:function(){r=[],n=[],o.get().streaming.abr.useDefaultABRRules&&(o.get().streaming.abr.ABRStrategy===_.default.ABR_STRATEGY_L2A?r.push((0,p.default)(l).create({dashMetrics:i,settings:o})):o.get().streaming.abr.ABRStrategy===_.default.ABR_STRATEGY_LoLP?r.push((0,y.default)(l).create({dashMetrics:i})):(r.push((0,m.default)(l).create({dashMetrics:i,mediaPlayerModel:t,settings:o})),r.push((0,c.default)(l).create({dashMetrics:i})),o.get().streaming.abr.additionalAbrRules.insufficientBufferRule&&r.push((0,f.default)(l).create({dashMetrics:i,settings:o})),o.get().streaming.abr.additionalAbrRules.switchHistoryRule&&r.push((0,h.default)(l).create()),o.get().streaming.abr.additionalAbrRules.droppedFramesRule&&r.push((0,g.default)(l).create()),o.get().streaming.abr.additionalAbrRules.abandonRequestsRule&&n.push((0,d.default)(l).create({dashMetrics:i,mediaPlayerModel:t,settings:o})))),a.getAbrCustomRules().forEach(function(e){e.type===v&&r.push(e.rule(l).create()),e.type===T&&n.push(e.rule(l).create())})},reset:function(){[r,n].forEach(function(e){e&&e.length&&e.forEach(function(e){return e.reset&&e.reset()})}),r=[],n=[]},getMaxQuality:function(t){return u(s(r.map(function(e){return e.getMaxIndex(t)})))||(0,E.default)(l).create()},getMinSwitchRequest:u,shouldAbandonFragment:function(t,r){return u(s(n.map(function(e){return e.shouldAbandon(t,r)})))||(0,E.default)(l).create()},getQualitySwitchRules:function(){return r}}}n.__dashjs_factory_name="ABRRulesCollection";r=t.default.getClassFactory(n);r.QUALITY_SWITCH_RULES=v,r.ABANDON_FRAGMENT_RULES=T,t.default.updateSingletonFactory(n.__dashjs_factory_name,r);const a=r},"./src/streaming/rules/abr/AbandonRequestsRule.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>a});var E=r("./src/streaming/rules/SwitchRequest.js"),t=r("./src/core/FactoryMaker.js"),n=r("./src/core/Debug.js");function _(e){e=e||{};var t,c,f,d,g,h=this.context,m=e.mediaPlayerModel,p=e.dashMetrics,y=e.settings;function r(){f={},d={},g=[]}return t={shouldAbandon:function(e){var t=(0,E.default)(h).create(E.default.NO_CHANGE,{name:_.__dashjs_factory_name});if(!(e&&e.hasOwnProperty("getMediaInfo")&&e.hasOwnProperty("getMediaType")&&e.hasOwnProperty("getCurrentRequest")&&e.hasOwnProperty("getRepresentationInfo")&&e.hasOwnProperty("getAbrController")))return t;var r,n=e.getMediaInfo(),a=e.getMediaType(),i=e.getStreamInfo(),o=i?i.id:null,s=e.getCurrentRequest();if(!isNaN(s.index)){if(r=a,i=s.index,f[r]=f[r]||{},f[r][i]=f[r][i]||{},m.getStableBufferTime()<p.getCurrentBufferLevel(a))return t;i=f[a][s.index];if(null===i||null===s.firstByteDate||d.hasOwnProperty(i.id))return t;if(void 0===i.firstByteTime&&(g[a]=[],i.firstByteTime=s.firstByteDate.getTime(),i.segmentDuration=s.duration,i.bytesTotal=s.bytesTotal,i.id=s.index),i.bytesLoaded=s.bytesLoaded,i.elapsedTime=(new Date).getTime()-i.firstByteTime,0<i.bytesLoaded&&0<i.elapsedTime&&(l=a,u=Math.round(8*i.bytesLoaded/i.elapsedTime),g[l]=g[l]||[],g[l].push(u)),5<=g[a].length&&500<i.elapsedTime&&i.bytesLoaded<i.bytesTotal){var l,u,s=g[a].reduce(function(e,t){return e+t},0);if(i.measuredBandwidthInKbps=Math.round(s/g[a].length),i.estimatedTimeOfDownload=+(8*i.bytesTotal/i.measuredBandwidthInKbps/1e3).toFixed(2),i.estimatedTimeOfDownload<1.8*i.segmentDuration||0===e.getRepresentationInfo().quality)return t;d.hasOwnProperty(i.id)||(l=e.getAbrController(),u=i.bytesTotal-i.bytesLoaded,s=l.getBitrateList(n),e=l.getQualityForBitrate(n,i.measuredBandwidthInKbps*y.get().streaming.abr.bandwidthSafetyFactor,o),e=void 0!==(n=l.getMinAllowedIndexFor(a,o))?Math.max(n,e):e,i.bytesTotal*s[e].bitrate/s[l.getQualityFor(a,o)].bitrate<u&&(t.quality=e,t.reason.throughput=i.measuredBandwidthInKbps,t.reason.fragmentID=i.id,d[i.id]=i,c.debug("["+a+"] frag id",i.id," is asking to abandon and switch to quality to ",e," measured bandwidth was",i.measuredBandwidthInKbps),delete f[a][i.id]))}else i.bytesLoaded===i.bytesTotal&&delete f[a][i.id]}return t},reset:r},c=(0,n.default)(h).getInstance().getLogger(t),r(),t}_.__dashjs_factory_name="AbandonRequestsRule";const a=t.default.getClassFactory(_)},"./src/streaming/rules/abr/BolaRule.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>a});var g=r("./src/streaming/constants/MetricsConstants.js"),D=r("./src/streaming/rules/SwitchRequest.js"),t=r("./src/core/FactoryMaker.js"),h=r("./src/streaming/vo/metrics/HTTPRequest.js"),m=r("./src/core/EventBus.js"),p=r("./src/core/events/Events.js"),y=r("./src/core/Debug.js"),E=r("./src/streaming/MediaPlayerEvents.js"),_=r("./src/streaming/constants/Constants.js");function n(e){e=e||{};var t,T,b,S=this.context,A=e.dashMetrics,i=e.mediaPlayerModel,r=(0,m.default)(S).getInstance();function o(e,t,n){var r=n.reduce(function(e,t,r){return t>n[e]?r:e},0);if(0===r)return null;t=Math.max(e,10+2*t.length),t=(n[r]-1)/(t/10-1);return{gp:t,Vp:10/t}}function R(e){var t={},r=e.getMediaInfo().bitrateList.map(function(e){return e.bandwidth}),n=(n=r.map(function(e){return Math.log(e)})).map(function(e){return e-n[0]+1}),a=i.getStableBufferTime(),e=o(a,r,n);return e?(t.state=1,t.bitrates=r,t.utilities=n,t.stableBufferTime=a,t.Vp=e.Vp,t.gp=e.gp,t.lastQuality=0,I(t)):t.state=0,t}function I(e){e.placeholderBuffer=0,e.mostAdvancedSegmentStart=NaN,e.lastSegmentWasReplacement=!1,e.lastSegmentStart=NaN,e.lastSegmentDurationS=NaN,e.lastSegmentRequestTimeMs=NaN,e.lastSegmentFinishTimeMs=NaN}function w(e,t){var r,n,a=i.getStableBufferTime();e.stableBufferTime!==a&&((r=o(a,e.bitrates,e.utilities)).Vp===e.Vp&&r.gp===e.gp||(t=(n=A.getCurrentBufferLevel(t))+e.placeholderBuffer,t-=10,t*=r.Vp/e.Vp,t+=10,e.stableBufferTime=a,e.Vp=r.Vp,e.gp=r.gp,e.placeholderBuffer=Math.max(0,t-n)))}function C(e,t){return e.Vp*(e.utilities[t]+e.gp)}function N(e,t){for(var r,n,a=e.bitrates[t],i=e.utilities[t],o=0,s=t-1;0<=s;--s)e.utilities[s]<e.utilities[t]&&(n=e.bitrates[s],r=e.utilities[s],n=e.Vp*(e.gp+(a*r-n*i)/(a-n)),o=Math.max(o,n));return o}function n(e){for(var t in e.mediaType===_.default.AUDIO?[_.default.AUDIO]:b)b.hasOwnProperty(t)&&2===b[t].state&&(b[t].placeholderBuffer=0)}function a(){for(var e in b)!b.hasOwnProperty(e)||0!==(e=b[e]).state&&(e.state=1,I(e))}function s(e){var t,r;e&&e.chunk&&e.chunk.mediaInfo&&((t=b[e.chunk.mediaInfo.type])&&0!==t.state&&(r=e.chunk.start,isNaN(t.mostAdvancedSegmentStart)||r>t.mostAdvancedSegmentStart?(t.mostAdvancedSegmentStart=r,t.lastSegmentWasReplacement=!1):t.lastSegmentWasReplacement=!0,t.lastSegmentStart=r,t.lastSegmentDurationS=e.chunk.duration,t.lastQuality=e.chunk.quality,u(t,e.chunk.mediaInfo.type)))}function l(e){var t;e&&e.metric===g.default.HTTP_REQUEST&&e.value&&e.value.type===h.HTTPRequest.MEDIA_SEGMENT_TYPE&&e.value.trace&&e.value.trace.length&&((t=b[e.mediaType])&&0!==t.state&&(t.lastSegmentRequestTimeMs=e.value.trequest.getTime(),t.lastSegmentFinishTimeMs=e.value._tfinish.getTime(),u(t,e.mediaType)))}function u(e,t){var r;isNaN(e.lastSegmentStart)||isNaN(e.lastSegmentRequestTimeMs)||isNaN(e.placeholderBuffer)||(e.placeholderBuffer*=.99,isNaN(e.lastSegmentFinishTimeMs)||(r=A.getCurrentBufferLevel(t)+.001*(e.lastSegmentFinishTimeMs-e.lastSegmentRequestTimeMs),t=C(e,e.lastQuality),r=Math.max(0,t-r),e.placeholderBuffer=Math.min(r,e.placeholderBuffer)),e.lastSegmentWasReplacement&&!isNaN(e.lastSegmentDurationS)&&(e.placeholderBuffer+=e.lastSegmentDurationS),e.lastSegmentStart=NaN,e.lastSegmentRequestTimeMs=NaN)}function c(e){var t;!e||(t=b[e.mediaType])&&0!==t.state&&(t.abrQuality=e.newQuality)}function f(e){var t,r;!e||(t=b[e.mediaType])&&0!==t.state&&(r=A.getCurrentBufferLevel(e.mediaType),e=0<t.abrQuality?N(t,t.abrQuality):10,r=Math.max(0,e-r),t.placeholderBuffer=Math.min(t.placeholderBuffer,r))}function d(){b={}}return t={getMaxIndex:function(e){var t=(0,D.default)(S).create();if(!(e&&e.hasOwnProperty("getMediaInfo")&&e.hasOwnProperty("getMediaType")&&e.hasOwnProperty("getScheduleController")&&e.hasOwnProperty("getStreamInfo")&&e.hasOwnProperty("getAbrController")&&e.hasOwnProperty("useBufferOccupancyABR")))return t;var r=e.getMediaInfo(),n=e.getMediaType(),a=e.getScheduleController(),i=e.getStreamInfo(),o=e.getAbrController(),s=o.getThroughputHistory(),l=i?i.id:null,u=i&&i.manifestInfo&&i.manifestInfo.isDynamic,c=e.useBufferOccupancyABR();if(t.reason=t.reason||{},!c)return t;a.setTimeToLoadDelay(0);var f=(c=(i=e).getMediaType(),(e=b[c])?0!==e.state&&w(e,c):(e=R(i),b[c]=e),e);if(0===f.state)return t;var d,g,h,m=A.getCurrentBufferLevel(n),p=s.getAverageThroughput(n,u),y=s.getSafeAverageThroughput(n,u),E=s.getAverageLatency(n);if(t.reason.state=f.state,t.reason.throughput=p,t.reason.latency=E,isNaN(p))return t;switch(f.state){case 1:_=o.getQualityForBitrate(r,y,l,E),t.quality=_,t.reason.throughput=y,f.placeholderBuffer=Math.max(0,N(f,_)-m),f.lastQuality=_,!isNaN(f.lastSegmentDurationS)&&m>=f.lastSegmentDurationS&&(f.state=2);break;case 2:d=f,v=n,h=Date.now(),isNaN(d.lastSegmentFinishTimeMs)?isNaN(d.lastCallTimeMs)||(g=.001*(h-d.lastCallTimeMs),d.placeholderBuffer+=Math.max(0,g)):(g=.001*(h-d.lastSegmentFinishTimeMs),d.placeholderBuffer+=Math.max(0,g)),d.lastCallTimeMs=h,d.lastSegmentStart=NaN,d.lastSegmentRequestTimeMs=NaN,d.lastSegmentFinishTimeMs=NaN,w(d,v);var _=function(e,t){for(var r=e.bitrates.length,n=NaN,a=NaN,i=0;i<r;++i){var o=(e.Vp*(e.utilities[i]+e.gp)-t)/e.bitrates[i];(isNaN(a)||a<=o)&&(a=o,n=i)}return n}(f,m+f.placeholderBuffer),v=o.getQualityForBitrate(r,y,l,E);_>f.lastQuality&&v<_&&(_=Math.max(v,f.lastQuality));v=Math.max(0,m+f.placeholderBuffer-C(f,_));v<=f.placeholderBuffer?(f.placeholderBuffer-=v,v=0):(v-=f.placeholderBuffer,f.placeholderBuffer=0,_<o.getMaxAllowedIndexFor(n,l)?a.setTimeToLoadDelay(1e3*v):v=0),t.quality=_,t.reason.throughput=p,t.reason.latency=E,t.reason.bufferLevel=m,t.reason.placeholderBuffer=f.placeholderBuffer,t.reason.delay=v,f.lastQuality=_;break;default:T.debug("BOLA ABR rule invoked in bad state."),t.quality=o.getQualityForBitrate(r,y,l,E),t.reason.state=f.state,t.reason.throughput=y,t.reason.latency=E,f.state=1,I(f)}return t},reset:function(){d(),r.off(E.default.BUFFER_EMPTY,n,t),r.off(E.default.PLAYBACK_SEEKING,a,t),r.off(E.default.METRIC_ADDED,l,t),r.off(E.default.QUALITY_CHANGE_REQUESTED,c,t),r.off(E.default.FRAGMENT_LOADING_ABANDONED,f,t),r.off(p.default.MEDIA_FRAGMENT_LOADED,s,t)}},T=(0,y.default)(S).getInstance().getLogger(t),d(),r.on(E.default.BUFFER_EMPTY,n,t),r.on(E.default.PLAYBACK_SEEKING,a,t),r.on(E.default.METRIC_ADDED,l,t),r.on(E.default.QUALITY_CHANGE_REQUESTED,c,t),r.on(E.default.FRAGMENT_LOADING_ABANDONED,f,t),r.on(p.default.MEDIA_FRAGMENT_LOADED,s,t),t}n.__dashjs_factory_name="BolaRule";const a=t.default.getClassFactory(n)},"./src/streaming/rules/abr/DroppedFramesRule.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>i});var t=r("./src/core/FactoryMaker.js"),c=r("./src/streaming/rules/SwitchRequest.js"),n=r("./src/core/Debug.js");function a(){var e,l,u=this.context;return e={getMaxIndex:function(e){var t=(0,c.default)(u).create();if(!e||!e.hasOwnProperty("getDroppedFramesHistory"))return t;var r=e.getDroppedFramesHistory(),e=e.getStreamInfo().id;if(r){var n=r.getFrameHistory(e);if(!n||0===n.length)return t;for(var a,i=0,o=c.default.NO_CHANGE,s=1;s<n.length;s++)if(n[s]&&(i=n[s].droppedVideoFrames,375<(a=n[s].totalVideoFrames)&&.15<i/a)){o=s-1,l.debug("index: "+o+" Dropped Frames: "+i+" Total Frames: "+a);break}return(0,c.default)(u).create(o,{droppedFrames:i})}return t}},l=(0,n.default)(u).getInstance().getLogger(e),e}a.__dashjs_factory_name="DroppedFramesRule";const i=t.default.getClassFactory(a)},"./src/streaming/rules/abr/InsufficientBufferRule.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>a});var s=r("./src/core/EventBus.js"),l=r("./src/core/events/Events.js"),t=r("./src/core/FactoryMaker.js"),h=r("./src/core/Debug.js"),m=r("./src/streaming/rules/SwitchRequest.js"),p=r("./src/streaming/constants/Constants.js"),y=r("./src/streaming/constants/MetricsConstants.js"),E=r("./src/streaming/MediaPlayerEvents.js");function n(e){e=e||{};var t,u,c,f=.5,r=2,d=this.context,n=(0,s.default)(d).getInstance(),g=e.dashMetrics;function a(){(c={})[p.default.VIDEO]={ignoreCount:r},c[p.default.AUDIO]={ignoreCount:r}}function i(){a()}function o(e){isNaN(e.startTime)||e.mediaType!==p.default.AUDIO&&e.mediaType!==p.default.VIDEO||0<c[e.mediaType].ignoreCount&&c[e.mediaType].ignoreCount--}return t={getMaxIndex:function(e){var t=(0,m.default)(d).create();if(!e||!e.hasOwnProperty("getMediaType"))return t;!function(){if(!g||!g.hasOwnProperty("getCurrentBufferLevel")||!g.hasOwnProperty("getCurrentBufferState"))throw new Error(p.default.MISSING_CONFIG_ERROR)}();var r=e.getMediaType(),n=g.getCurrentBufferState(r),a=e.getRepresentationInfo().fragmentDuration,i=(l=e.getStreamInfo())?l.id:null,o=e.getScheduleController(),s=l&&l.manifestInfo&&l.manifestInfo.isDynamic,l=o.getPlaybackController().getLowLatencyModeEnabled();return o=r,!l&&0<c[o].ignoreCount||!a||(n&&n.state===y.default.BUFFER_EMPTY?(u.debug("["+r+"] Switch to index 0; buffer is empty."),t.quality=0,t.reason="InsufficientBufferRule: Buffer is empty"):(l=e.getMediaInfo(),n=(o=e.getAbrController()).getThroughputHistory(),e=g.getCurrentBufferLevel(r),s=n.getAverageThroughput(r,s),r=n.getAverageLatency(r),a=s*(e/a)*f,t.quality=o.getQualityForBitrate(l,a,i,r),t.reason="InsufficientBufferRule: being conservative to avoid immediate rebuffering")),t},reset:function(){a(),n.off(E.default.PLAYBACK_SEEKING,i,t),n.off(l.default.BYTES_APPENDED_END_FRAGMENT,o,t)}},u=(0,h.default)(d).getInstance().getLogger(t),a(),n.on(E.default.PLAYBACK_SEEKING,i,t),n.on(l.default.BYTES_APPENDED_END_FRAGMENT,o,t),t}n.__dashjs_factory_name="InsufficientBufferRule";const a=t.default.getClassFactory(n)},"./src/streaming/rules/abr/L2ARule.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>a});var u=r("./src/streaming/constants/MetricsConstants.js"),G=r("./src/streaming/rules/SwitchRequest.js"),t=r("./src/core/FactoryMaker.js"),c=r("./src/streaming/vo/metrics/HTTPRequest.js"),f=r("./src/core/EventBus.js"),d=r("./src/core/events/Events.js"),g=r("./src/core/Debug.js"),q=r("./src/streaming/constants/Constants.js");function n(e){e=e||{};var t,P,L,F,x=this.context,j=e.dashMetrics,r=(0,f.default)(x).getInstance();function k(e){var t={},r=e.getMediaInfo(),e=r.bitrateList.map(function(e){return e.bandwidth/1e3});return t.state=1,t.bitrates=e,t.lastQuality=0,(r=r)&&r.type&&(L[r.type]={},L[r.type].w=[],L[r.type].prev_w=[],L[r.type].Q=0,L[r.type].segment_request_start_s=0,L[r.type].segment_download_finish_s=0,L[r.type].B_target=1.5),U(t),t}function U(e){e.placeholderBuffer=0,e.mostAdvancedSegmentStart=NaN,e.lastSegmentWasReplacement=!1,e.lastSegmentStart=NaN,e.lastSegmentDurationS=NaN,e.lastSegmentRequestTimeMs=NaN,e.lastSegmentFinishTimeMs=NaN}function n(){for(var e in P)!P.hasOwnProperty(e)||0!==(e=P[e]).state&&(e.state=1,U(e))}function a(e){var t,r,n;e&&e.chunk&&e.chunk.mediaInfo&&(t=P[e.chunk.mediaInfo.type],r=L[e.chunk.mediaInfo.type],t&&0!==t.state&&(n=e.chunk.start,isNaN(t.mostAdvancedSegmentStart)||n>t.mostAdvancedSegmentStart?(t.mostAdvancedSegmentStart=n,t.lastSegmentWasReplacement=!1):t.lastSegmentWasReplacement=!0,t.lastSegmentStart=n,t.lastSegmentDurationS=e.chunk.duration,t.lastQuality=e.chunk.quality,o(t,r)))}function i(e){var t,r;e&&e.metric===u.default.HTTP_REQUEST&&e.value&&e.value.type===c.HTTPRequest.MEDIA_SEGMENT_TYPE&&e.value.trace&&e.value.trace.length&&(t=P[e.mediaType],r=L[e.mediaType],t&&0!==t.state&&(t.lastSegmentRequestTimeMs=e.value.trequest.getTime(),t.lastSegmentFinishTimeMs=e.value._tfinish.getTime(),o(t,r)))}function o(e,t){isNaN(e.lastSegmentStart)||isNaN(e.lastSegmentRequestTimeMs)||(t.segment_request_start_s=.001*e.lastSegmentRequestTimeMs,t.segment_download_finish_s=.001*e.lastSegmentFinishTimeMs,e.lastSegmentStart=NaN,e.lastSegmentRequestTimeMs=NaN)}function s(e){var t;e&&e.mediaType&&((t=P[e.mediaType])&&0!==t.state&&(t.abrQuality=e.newQuality))}function B(e,t){if(e.length!==t.length)return-1;for(var r=0,n=0;n<e.length;n++)r+=e[n]*t[n];return r}function l(){P={},L={}}return t={getMaxIndex:function(e){var t,r=(0,G.default)(x).create(),n=Math.pow(4,.99),a=Math.max(Math.pow(4,1),n*Math.sqrt(4)),i=e.getMediaInfo(),o=e.getMediaType(),s=i.bitrateList.map(function(e){return e.bandwidth}),l=s.length,u=e.getScheduleController(),c=e.getStreamInfo(),f=e.getAbrController(),d=f.getThroughputHistory(),g=c&&c.manifestInfo&&c.manifestInfo.isDynamic,h=e.useL2AABR(),m=j.getCurrentBufferLevel(o,!0),p=d.getSafeAverageThroughput(o,g),y=d.getAverageThroughput(o,g),E=d.getAverageLatency(o),_=e.getVideoModel().getPlaybackRate();if(!(e&&e.hasOwnProperty("getMediaInfo")&&e.hasOwnProperty("getMediaType")&&e.hasOwnProperty("getScheduleController")&&e.hasOwnProperty("getStreamInfo")&&e.hasOwnProperty("getAbrController")&&e.hasOwnProperty("useL2AABR")))return r;if(r.reason=r.reason||{},!h||o===q.default.AUDIO)return r;u.setTimeToLoadDelay(0);var v=(u=(h=e).getMediaType(),(e=P[u])||(e=k(h),P[u]=e),e);if(0===v.state)return r;var T=L[o];if(!T)return r;if(r.reason.state=v.state,r.reason.throughput=y,r.reason.latency=E,isNaN(y))return r;switch(v.state){case 1:if(t=f.getQualityForBitrate(i,p,c.id,E),r.quality=t,r.reason.throughput=p,v.lastQuality=t,!isNaN(v.lastSegmentDurationS)&&m>=T.B_target){v.state=2,T.Q=n;for(var b=0;b<l;++b)b===v.lastQuality?T.prev_w[b]=1:T.prev_w[b]=0}break;case 2:var S=[],A=j.getCurrentHttpRequest(o).trace.reduce(function(e,t){return e+t.d},0),R=j.getCurrentHttpRequest(o).trace.reduce(function(e,t){return e+t.b[0]},0),I=Math.round(8*R/A);I<1&&(I=1);for(var w=v.lastSegmentDurationS,C=1,N=0;N<l;++N)s[N]=s[N]/1e3,_*s[N]>I&&(C=-1),T.w[N]=T.prev_w[N]+C*(w/(2*a))*((T.Q+n)*(_*s[N]/I));T.w=function(e){for(var t=e.length,r=!1,n=[],a=0;a<t;++a)n[a]=e[a];for(var i=e.sort(function(e,t){return t-e}),o=0,s=0,l=[],u=0;u<t-1;++u)if((s=((o+=i[u])-1)/(u+1))>=i[u+1]){r=!0;break}r||(s=(o+i[t-1]-1)/t);for(var c=0;c<t;++c)l[c]=Math.max(n[c]-s,0);return l}(T.w);for(var D=0;D<l;++D)S[D]=T.w[D]-T.prev_w[D],T.prev_w[D]=T.w[D];T.Q=Math.max(0,T.Q-w+w*_*((B(s,T.prev_w)+B(s,S))/I));for(var M=[],O=0;O<l;++O)M[O]=Math.abs(s[O]-B(T.w,s));s[t=(t=M.indexOf(Math.min.apply(Math,M)))>v.lastQuality&&s[v.lastQuality+1]<=I?v.lastQuality+1:t]>=I&&(T.Q=2*Math.max(n,T.Q)),r.quality=t,r.reason.throughput=y,r.reason.latency=E,r.reason.bufferLevel=m,v.lastQuality=r.quality;break;default:F.debug("L2A ABR rule invoked in bad state."),r.quality=f.getQualityForBitrate(i,p,c.id,E),r.reason.state=v.state,r.reason.throughput=p,r.reason.latency=E,v.state=1,U(v)}return r},reset:function(){l(),r.off(d.default.PLAYBACK_SEEKING,n,t),r.off(d.default.MEDIA_FRAGMENT_LOADED,a,t),r.off(d.default.METRIC_ADDED,i,t),r.off(d.default.QUALITY_CHANGE_REQUESTED,s,t)}},F=(0,g.default)(x).getInstance().getLogger(t),l(),r.on(d.default.PLAYBACK_SEEKING,n,t),r.on(d.default.MEDIA_FRAGMENT_LOADED,a,t),r.on(d.default.METRIC_ADDED,i,t),r.on(d.default.QUALITY_CHANGE_REQUESTED,s,t),t}n.__dashjs_factory_name="L2ARule";const a=t.default.getClassFactory(n)},"./src/streaming/rules/abr/SwitchHistoryRule.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>i});var t=r("./src/core/FactoryMaker.js"),n=r("./src/core/Debug.js"),u=r("./src/streaming/rules/SwitchRequest.js");function a(){var e,s,l=this.context;return e={getMaxIndex:function(e){for(var t=(e=e?e.getSwitchHistory():null)?e.getSwitchRequests():[],r=0,n=0,a=0,i=(0,u.default)(l).create(),o=0;o<t.length;o++)if(void 0!==t[o]&&(r+=t[o].drops,n+=t[o].noDrops,a+=t[o].dropSize,6<=r+n&&.075<r/n)){i.quality=0<o&&0<t[o].drops?o-1:o,i.reason={index:i.quality,drops:r,noDrops:n,dropSize:a},s.debug("Switch history rule index: "+i.quality+" samples: "+(r+n)+" drops: "+r);break}return i}},s=(0,n.default)(l).getInstance().getLogger(e),e}a.__dashjs_factory_name="SwitchHistoryRule";const i=t.default.getClassFactory(a)},"./src/streaming/rules/abr/ThroughputRule.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>a});var t=r("./src/core/FactoryMaker.js"),g=r("./src/streaming/rules/SwitchRequest.js"),h=r("./src/streaming/constants/Constants.js"),m=r("./src/streaming/constants/MetricsConstants.js");function n(e){e=e||{};var f=this.context,d=e.dashMetrics;return{getMaxIndex:function(e){var t=(0,g.default)(f).create();if(!(e&&e.hasOwnProperty("getMediaInfo")&&e.hasOwnProperty("getMediaType")&&e.hasOwnProperty("useBufferOccupancyABR")&&e.hasOwnProperty("getAbrController")&&e.hasOwnProperty("getScheduleController")))return t;!function(){if(!d||!d.hasOwnProperty("getCurrentBufferState"))throw new Error(h.default.MISSING_CONFIG_ERROR)}();var r=e.getMediaInfo(),n=e.getMediaType(),a=d.getCurrentBufferState(n),i=e.getScheduleController(),o=e.getAbrController(),s=(u=e.getStreamInfo())?u.id:null,l=u&&u.manifestInfo?u.manifestInfo.isDynamic:null,u=(c=o.getThroughputHistory()).getSafeAverageThroughput(n,l),c=c.getAverageLatency(n),e=e.useBufferOccupancyABR();return isNaN(u)||!a||e||o.getAbandonmentStateFor(s,n)!==m.default.ABANDON_LOAD&&(a.state!==m.default.BUFFER_LOADED&&!l||(t.quality=o.getQualityForBitrate(r,u,s,c),i.setTimeToLoadDelay(0),t.reason={throughput:u,latency:c})),t},reset:function(){}}}n.__dashjs_factory_name="ThroughputRule";const a=t.default.getClassFactory(n)},"./src/streaming/rules/abr/lolp/LearningAbrController.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>i});var t=r("./src/core/FactoryMaker.js"),n=r("./src/core/Debug.js"),F="manual_weight_selection",x="random_weight_selection",j="dynamic_weight_selection";function a(){var e,S,A,R,I,w,C,N,D,t=this.context;function r(){R=1,I=100,w=0,N=C=A=null,D=j}function M(){var e=0;if(A)for(var t=0;t<A.length;t++){var r=A[t];r.state.throughput>e&&(e=r.state.throughput)}return e}function O(e,r,n){e=e.map(function(e,t){return n[t]*Math.pow(e-r[t],2)}).reduce(function(e,t){return e+t});return(e<0?-1:1)*Math.sqrt(Math.abs(e))}function P(e,t,r){for(var n,a=0;a<t.length;a++){var i=t[a],o=(n=e,O([(s=i).state.throughput,s.state.latency,s.state.rebuffer,s.state.switch],[n.state.throughput,n.state.latency,n.state.rebuffer,n.state.switch],[1,1,1,1])),s=Math.exp(-1*Math.pow(o,2)/(2*Math.pow(.1,2)));n=r,o=s,s=void 0,s=(i=i).state,i=[.01,.01,.01,.01],s.throughput=s.throughput+(n[0]-s.throughput)*i[0]*o,s.latency=s.latency+(n[1]-s.latency)*i[1]*o,s.rebuffer=s.rebuffer+(n[2]-s.rebuffer)*i[2]*o,s.switch=s.switch+(n[3]-s.switch)*i[3]*o}}function L(e,t,r,n,a,i,o){C=C||N[N.length-1];o=e.findWeightVector(t,r,n,a,i,o);null!==o&&-1!==o&&(C=o)}return e={getNextQuality:function(e,t,r,n,a,i,o){var s=r,l=n,u=t,c=function(e){if(!A){A=[];var t=e.bitrateList,r=[];w=t[0].bandwidth,t.forEach(function(e){r.push(e.bandwidth),e.bandwidth<w&&(w=e.bandwidth)}),R=function(e){return e=e.map(function(e){return Math.pow(e,2)}).reduce(function(e,t){return e+t}),Math.sqrt(e)}(r);for(var n=0;n<t.length;n++){var a={qualityIndex:n,bitrate:t[n].bandwidth,state:{throughput:t[n].bandwidth/R,latency:0,rebuffer:0,switch:0}};A.push(a)}N=function(e){var t=[],r=function(e){for(var t=[],r=0;r<e;r++){var n=[Math.random()*M(),Math.random(),Math.random(),Math.random()];t.push(n)}return t}(Math.pow(e.length,2));t.push(r[0]);for(var n=[1,1,1,1],a=1;a<e.length;a++){for(var i=null,o=null,s=0;s<r.length;s++){for(var l=r[s],u=null,c=0;c<t.length;c++){var f=O(l,t[c],n);(null===u||f<u)&&(u=f)}(null===o||o<u)&&(i=l,o=u)}t.push(i)}for(var d=null,g=null,h=0;h<t.length;h++){for(var m=0,p=0;p<t.length;p++)h!==p&&(m+=O(t[h],t[p],n));(null===d||d<m)&&(d=m,g=h)}var y=[];y.push(t[g]),t.splice(g,1);for(;0<t.length;){for(var E=null,_=null,v=0;v<t.length;v++){var T=O(y[0],t[v],n);(null===E||T<E)&&(E=T,_=v)}y.push(t[_]),t.splice(_,1)}return y}(A)}return A}(e),f=t/R;1<f&&(f=M()),r/=I,S.debug("getNextQuality called throughput:".concat(f," latency:").concat(r," bufferSize:").concat(n," currentQualityIndex:").concat(i," playbackRate:").concat(a));var d=(n=c[i]).bitrate*o.getSegmentDuration()/u,g=Math.max(0,d-l);if(l-d<o.getMinBuffer())return S.debug("Buffer is low for bitrate= ".concat(n.bitrate," downloadTime=").concat(d," currentBuffer=").concat(l," rebuffer=").concat(g)),function(e,t){var r=0,n=e;if(A)for(var a=0;a<A.length;a++){var i=A[a];i.bitrate<e.bitrate&&i.bitrate>r&&t>i.bitrate&&(r=i.bitrate,n=i)}return n}(n,u).qualityIndex;switch(D){case F:C=[.4,.4,.4,.4];break;case x:C=function(e,t){for(var r=[],n=Math.sqrt(2/e),a=0;a<t;a++)r.push(Math.random()*n);return C=r}(c.length,4);break;case j:L(o,c,s,l,g,u,a);break;default:L(o,c,s,l,g,u,a)}for(var h=null,m=null,p=null,y=0;y<c.length;y++){var E=c[y],_=E.state,v=[_.throughput,_.latency,_.rebuffer,_.switch],T=C.slice(),b=o.getNextBufferWithBitrate(E.bitrate,l,u),_=b<o.getMinBuffer();_&&S.debug("Buffer is low for bitrate=".concat(E.bitrate," downloadTime=").concat(d," currentBuffer=").concat(l," nextBuffer=").concat(b)),(E.bitrate>t-1e4||_)&&E.bitrate!==w&&(T[0]=100);T=O(v,[f,0,0,0],T);(null===h||T<h)&&(h=T,m=E.qualityIndex,p=E)}return i=Math.abs(n.bitrate-p.bitrate)/R,P(n,c,[f,r,g,i]),P(p,c,[f,0,0,i]),m},reset:function(){r()}},S=(0,n.default)(t).getInstance().getLogger(e),r(),e}a.__dashjs_factory_name="LearningAbrController";const i=t.default.getClassFactory(a)},"./src/streaming/rules/abr/lolp/LoLpQoEEvaluator.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>a});var t=r("./src/core/FactoryMaker.js"),c=r("./src/streaming/rules/abr/lolp/QoeInfo.js");function n(){var e,a,i,o,s;function t(){s=o=i=a=null}function l(e,t,r,n){var a=new c.default;return a.type=e,a.weights.bitrateReward=t||1,a.weights.bitrateSwitchPenalty=1,a.weights.rebufferPenalty=r||1e3,a.weights.latencyPenalty=[],a.weights.latencyPenalty.push({threshold:1.1,penalty:.05*n}),a.weights.latencyPenalty.push({threshold:1e8,penalty:.1*r}),a.weights.playbackSpeedPenalty=n||200,a}function u(e,t,r,n,a){a.bitrateWSum+=a.weights.bitrateReward*e,a.lastBitrate&&(a.bitrateSwitchWSum+=a.weights.bitrateSwitchPenalty*Math.abs(e-a.lastBitrate)),a.lastBitrate=e,a.rebufferWSum+=a.weights.rebufferPenalty*t;for(var i=0;i<a.weights.latencyPenalty.length;i++){var o=a.weights.latencyPenalty[i];if(r<=o.threshold){a.latencyWSum+=o.penalty*r;break}}a.playbackSpeedWSum+=a.weights.playbackSpeedPenalty*Math.abs(1-n),a.totalQoe=a.bitrateWSum-a.bitrateSwitchWSum-a.rebufferWSum-a.latencyWSum-a.playbackSpeedWSum}return e={setupPerSegmentQoe:function(e,t,r){a=l("segment",e,t,r),i=e,o=t,s=r},logSegmentMetrics:function(e,t,r,n){a&&u(e,t,r,n,a)},getPerSegmentQoe:function(){return a},calculateSingleUseQoe:function(e,t,r,n){var a=null;return(a=i&&o&&s?l("segment",i,o,s):a)?(u(e,t,r,n,a),a.totalQoe):0},reset:function(){t()}},t(),e}n.__dashjs_factory_name="LoLpQoeEvaluator";const a=t.default.getClassFactory(n)},"./src/streaming/rules/abr/lolp/LoLpRule.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>s});var n=r("./src/core/Debug.js"),t=r("./src/core/FactoryMaker.js"),a=r("./src/streaming/rules/abr/lolp/LearningAbrController.js"),i=r("./src/streaming/rules/abr/lolp/LoLpQoEEvaluator.js"),S=r("./src/streaming/rules/SwitchRequest.js"),A=r("./src/streaming/constants/MetricsConstants.js"),R=r("./src/streaming/rules/abr/lolp/LoLpWeightSelector.js"),I=r("./src/streaming/constants/Constants.js");function o(e){var E,t,_,v,T=(e=e||{}).dashMetrics,b=this.context;return t={getMaxIndex:function(e){try{var t=(0,S.default)(b).create(),r=e.getMediaInfo().type,n=e.getAbrController(),a=e.getStreamInfo(),i=n.getQualityFor(r,a.id),o=e.getMediaInfo(),s=T.getCurrentBufferState(r),l=e.getScheduleController(),u=T.getCurrentBufferLevel(r,!0),c=a&&a.manifestInfo?a.manifestInfo.isDynamic:null,f=l.getPlaybackController(),d=f.getCurrentLiveLatency();if(!e.useLoLPABR()||r===I.default.AUDIO)return t;d=d||0,f=f.getPlaybackRate(),c=n.getThroughputHistory().getSafeAverageThroughput(r,c);if(E.debug("Throughput ".concat(Math.round(c)," kbps")),isNaN(c)||!s)return t;if(n.getAbandonmentStateFor(a.id,r)===A.default.ABANDON_LOAD)return t;for(var g=o.bitrateList,s=e.getRepresentationInfo().fragmentDuration,h=g[0].bandwidth/1e3,m=g[g.length-1].bandwidth/1e3,p=0;p<g.length;p++){var y=g[p].bandwidth/1e3;m<y?m=y:y<h&&(h=y)}n=g[i].bandwidth/1e3,a=T.getCurrentHttpRequest(r,!0),a=(a.tresponse.getTime()-a.trequest.getTime())/1e3,a=s<a?a-s:0;v.setupPerSegmentQoe(s,m,h),v.logSegmentMetrics(n,a,d,f);s=(0,R.default)(b).create({targetLatency:1.5,bufferMin:.3,segmentDuration:s,qoeEvaluator:v});return t.quality=_.getNextQuality(o,1e3*c,d,u,f,i,s),t.reason={throughput:c,latency:d},t.priority=S.default.PRIORITY.STRONG,l.setTimeToLoadDelay(0),t.quality!==i&&console.log("[TgcLearningRule]["+r+"] requesting switch to index: ",t.quality,"Average throughput",Math.round(c),"kbps"),t}catch(e){throw e}},reset:function(){_.reset(),v.reset()}},E=(0,n.default)(b).getInstance().getLogger(t),_=(0,a.default)(b).create(),v=(0,i.default)(b).create(),t}o.__dashjs_factory_name="LoLPRule";const s=t.default.getClassFactory(o)},"./src/streaming/rules/abr/lolp/LoLpWeightSelector.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>a});r=r("./src/core/FactoryMaker.js");function n(e){var r,n,h=e.targetLatency,m=e.bufferMin,p=e.segmentDuration,y=e.qoeEvaluator;function t(){return p}function E(e,t){t=p<t?e-p:e+p-t;return t}return e={getMinBuffer:function(){return m},getSegmentDuration:t,getNextBufferWithBitrate:function(e,t,r){return E(t,e*p/r)},getNextBuffer:E,findWeightVector:function(e,o,s,t,l,u){var c=null,f=null,d=null,g=Math.abs(o-n);return e.forEach(function(i){r.forEach(function(e){e[0];var t=e[1],r=e[2],n=(e[3],i.bitrate*p/l),a=E(s,n),r=0===r?10:1/r,n=r*Math.max(1e-5,n-a),r=(r=0===t?10:1/t)*i.state.latency,r=y.calculateSingleUseQoe(i.bitrate,n,r,u);(null===c||c<r)&&function(e,t,r){if(h+r<e)return!1;return m<=t}(o,a,g)&&(c=r,f=e,d=i.bitrate)})}),n=o,f=null===f&&null===d?-1:f}},r=function(l,e){return function e(t,r,n){if(n===r)return t;for(var a=t.length,i=0;i<a;i++)for(var o=t.shift(),s=0;s<l.length;s++)t.push(o.concat(l[s]));return e(t,r,n+1)}(l.map(function(e){return[e]}),e,1)}([.2,.4,.6,.8,1],4),n=0,e}n.__dashjs_factory_name="LoLpWeightSelector";const a=r.default.getClassFactory(n)},"./src/streaming/rules/abr/lolp/QoeInfo.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>n});const n=function t(){!function(e){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),this.type=null,this.lastBitrate=null,this.weights={},this.weights.bitrateReward=null,this.weights.bitrateSwitchPenalty=null,this.weights.rebufferPenalty=null,this.weights.latencyPenalty=null,this.weights.playbackSpeedPenalty=null,this.bitrateWSum=0,this.bitrateSwitchWSum=0,this.rebufferWSum=0,this.latencyWSum=0,this.playbackSpeedWSum=0,this.totalQoe=0}},"./src/streaming/text/EmbeddedTextHtmlRender.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>a});r=r("./src/core/FactoryMaker.js");function n(){var j=0;function r(e){return"red"===e?"rgb(255, 0, 0)":"green"===e?"rgb(0, 255, 0)":"blue"===e?"rgb(0, 0, 255)":"cyan"===e?"rgb(0, 255, 255)":"magenta"===e?"rgb(255, 0, 255)":"yellow"===e?"rgb(255, 255, 0)":"white"===e?"rgb(255, 255, 255)":"black"===e?"rgb(0, 0, 0)":e}function k(e,t){e=e.videoHeight/15;return t?"font-size: "+e+"px; font-family: Menlo, Consolas, 'Cutive Mono', monospace; color: "+(t.foreground?r(t.foreground):"rgb(255, 255, 255)")+"; font-style: "+(t.italics?"italic":"normal")+"; text-decoration: "+(t.underline?"underline":"none")+"; white-space: pre; background-color: "+(t.background?r(t.background):"transparent")+";":"font-size: "+e+"px; font-family: Menlo, Consolas, 'Cutive Mono', monospace; justify-content: flex-start; text-align: left; color: rgb(255, 255, 255); font-style: normal; white-space: pre; line-height: normal; font-weight: normal; text-decoration: none; width: 100%; display: flex;"}return{createHTMLCaptionsFromScreen:function(e,t,r,n){for(var a=null,i=!1,o=-1,s={start:t,end:r,spans:[]},l="style_cea608_white_black",u={},c={},f=[],d=0;d<15;++d){var g=n.rows[d],h="",m=null;if(!1===g.isEmpty()){var p=function(e){for(var t="",r=0;r<e.length;++r)t+=e[r].uchar;return t.length-t.replace(/^\s+/,"").length}(g.chars);null===a&&(a={x:p,y1:d,y2:d+1,p:[]}),p!==o&&i&&(a.p.push(s),s={start:t,end:r,spans:[]},a.y2=d,a.name="region_"+a.x+"_"+a.y1+"_"+a.y2,!1===u.hasOwnProperty(a.name)?(f.push(a),u[a.name]=a):u[a.name].p.contat(a.p),a={x:p,y1:d,y2:d+1,p:[]});for(var y=0;y<g.chars.length;++y){var E,_=g.chars[y],v=_.penState;null!==m&&v.equals(m)||(0<h.trim().length&&(s.spans.push({name:l,line:h,row:d}),h=""),E="style_cea608_"+v.foreground+"_"+v.background,v.underline&&(E+="_underline"),v.italics&&(E+="_italics"),c.hasOwnProperty(E)||(c[E]=JSON.parse(JSON.stringify(v))),m=v,l=E),h+=_.uchar}0<h.trim().length&&s.spans.push({name:l,line:h,row:d}),i=!0,o=p}else i=!1,o=-1,a&&(a.p.push(s),s={start:t,end:r,spans:[]},a.y2=d,a.name="region_"+a.x+"_"+a.y1+"_"+a.y2,!1===u.hasOwnProperty(a.name)?(f.push(a),u[a.name]=a):u[a.name].p.contat(a.p),a=null)}a&&(a.p.push(s),a.y2=d+1,a.name="region_"+a.x+"_"+a.y1+"_"+a.y2,!1===u.hasOwnProperty(a.name)?(f.push(a),u[a.name]=a):u[a.name].p.contat(a.p),a=null);var T=[];for(d=0;d<f.length;++d){var b=f[d],S="sub_cea608_"+j++,A=document.createElement("div");A.id=S;var R="left: "+3.125*(R=b).x+"%; top: "+6.66*R.y1+"%; width: "+(100-3.125*R.x)+"%; height: "+6.66*Math.max(R.y2-1-R.y1,1)+"%; align-items: flex-start; overflow: visible; -webkit-writing-mode: horizontal-tb;";A.style.cssText="position: absolute; margin: 0; display: flex; box-sizing: border-box; pointer-events: none;"+R;R=document.createElement("div");R.className="paragraph bodyStyle",R.style.cssText=k(e);var I=document.createElement("div");I.className="cueUniWrapper",I.style.cssText="unicode-bidi: normal; direction: ltr;";for(var w=0;w<b.p.length;++w)for(var C=b.p[w],N=0,D=0;D<C.spans.length;++D){var M,O,P,L=C.spans[D];0<L.line.length&&(0!==D&&N!=L.row&&((P=document.createElement("br")).className="lineBreak",I.appendChild(P)),M=!1,N===L.row&&(M=!0),N=L.row,O=c[L.name],(P=document.createElement("span")).className="spanPadding "+L.name+" customSpanColor",P.style.cssText=k(e,O),0!==D&&M?D===C.spans.length-1?P.textContent=L.line.replace(/\s+$/g,""):P.textContent=L.line:1<C.spans.length&&D<C.spans.length-1&&L.row===C.spans[D+1].row?P.textContent=L.line.replace(/^\s+/g,""):P.textContent=L.line.trim(),I.appendChild(P))}R.appendChild(I),A.appendChild(R);var F,x={bodyStyle:["%",90]};for(F in c)c.hasOwnProperty(F)&&(x[F]=["%",90]);T.push({type:"html",start:t,end:r,cueHTMLElement:A,cueID:S,cellResolution:[32,15],isFromCEA608:!0,fontSize:x,lineHeight:{},linePadding:{}})}return T}}}n.__dashjs_factory_name="EmbeddedTextHtmlRender";const a=r.default.getSingletonFactory(n)},"./src/streaming/text/NotFragmentedTextBufferController.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>a});var p=r("./src/core/EventBus.js"),y=r("./src/core/events/Events.js"),t=r("./src/core/FactoryMaker.js"),E=r("./src/streaming/utils/InitCache.js"),_=r("./src/streaming/SourceBufferSink.js"),v=r("./src/streaming/vo/DashJSError.js"),T=r("./src/core/errors/Errors.js"),b="NotFragmentedTextBufferController";function n(e){e=e||{};var t,r,n,a,i,o,s=this.context,l=(0,p.default)(s).getInstance(),u=e.textController,c=e.errHandler,f=e.streamInfo,d=e.type;function g(e){a=e}function h(e){var t;r!==e&&(r=e)&&(e=y.default.BUFFERING_COMPLETED,t=t||{},l.trigger(e,t,{streamId:f.id,mediaType:d}))}function m(e){e.chunk.bytes&&!r&&(o.save(e.chunk),i.append(e.chunk),h(!0))}return t={initialize:function(e){g(e)},getStreamId:function(){return f.id},getType:function(){return d},getBufferControllerType:function(){return b},createBufferSink:function(r){return new Promise(function(e,t){try{(i=(0,_.default)(s).create({mediaSource:a,textController:u,eventBus:l})).initializeForFirstUse(f,r),n||(i.getBuffer()&&"function"==typeof i.getBuffer().initialize&&i.getBuffer().initialize(),n=!0),e(i)}catch(e){c.error(new v.default(T.default.MEDIASOURCE_TYPE_UNSUPPORTED_CODE,T.default.MEDIASOURCE_TYPE_UNSUPPORTED_MESSAGE+d)),t(e)}})},dischargePreBuffer:function(){},getBuffer:function(){return i},getBufferLevel:function(){return 0},getRangeAt:function(){return null},pruneBuffer:function(){},hasBufferAtTime:function(){return!0},getAllRangesWithSafetyFactor:function(){return[]},getContinuousBufferTimeForTargetTime:function(){return Number.POSITIVE_INFINITY},setMediaSource:g,getMediaSource:function(){return a},appendInitSegmentFromCache:function(e){return null!==o.extract(f.id,e)},getIsBufferingCompleted:function(){return r},setIsBufferingCompleted:h,getIsPruningInProgress:function(){return!1},reset:function(e){l.off(y.default.INIT_FRAGMENT_LOADED,m,t),!e&&i&&(i.abort(),i.reset(),i=null)},clearBuffers:function(){return Promise.resolve()},prepareForPlaybackSeek:function(){return Promise.resolve()},prepareForReplacementTrackSwitch:function(){return r=!1,Promise.resolve()},setSeekTarget:function(){},updateAppendWindow:function(){return Promise.resolve()},pruneAllSafely:function(){return Promise.resolve()},updateBufferTimestampOffset:function(){return Promise.resolve()},segmentRequestingCompleted:function(){}},a=null,o=(r=n=!1,E.default)(s).getInstance(),l.on(y.default.INIT_FRAGMENT_LOADED,m,t),t}n.__dashjs_factory_name=b;const a=t.default.getClassFactory(n)},"./src/streaming/text/TextController.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>a});var w=r("./src/streaming/constants/Constants.js"),t=r("./src/core/FactoryMaker.js"),C=r("./src/streaming/text/TextSourceBuffer.js"),N=r("./src/streaming/text/TextTracks.js"),D=r("./src/streaming/utils/VTTParser.js"),M=r("./src/streaming/utils/VttCustomRenderingParser.js"),O=r("./src/streaming/utils/TTMLParser.js"),P=r("./src/core/EventBus.js"),L=r("./src/core/events/Events.js"),F=r("./src/streaming/MediaPlayerEvents.js"),x=r("./src/streaming/utils/SupervisorTools.js");function n(e){var t,i,s,l,n,a,o,u,c,r,f,d,g=this.context,h=e.adapter,m=e.errHandler,p=e.manifestModel,y=e.mediaController,E=e.videoModel,_=e.settings;function v(e){var r,t=e.tracks,n=e.index,a=e.streamId;!1===_.get().streaming.text.defaultEnabled&&!S()||d?A(a,-1):((e=y.getCurrentTrackFor(w.default.TEXT,a))&&(r={lang:e.lang,role:e.roles[0],index:e.index,codec:e.codec,accessibility:e.accessibility[0]},t.some(function(e,t){if(y.matchSettings(r,e))return A(a,t),n=t,!0})),c=!1),i[a].lastEnabledIndex=n,u.trigger(F.default.TEXT_TRACKS_ADDED,{enabled:S(),index:n,tracks:t,streamId:a}),f=!0}function T(e){try{var t=e.streamId;if(!l[t]||isNaN(e.time))return;l[t].manualCueProcessing(e.time)}catch(e){}}function b(e){try{var t=e.streamId;if(!l[t])return;l[t].disableManualTracks()}catch(e){}}function S(){return c&&!r?!1:!0}function A(e,t){(c=-1===t)&&y&&y.saveTextSettingsDisabled();var r=R(e);r!==t&&l[e]&&(l[e].disableManualTracks(),l[e].setModeForTrackIdx(r,w.default.TEXT_HIDDEN),l[e].setCurrentTrackIdx(t),l[e].setModeForTrackIdx(t,w.default.TEXT_SHOWING),(t=l[e].getCurrentTrackInfo())&&t.isFragmented&&!t.isEmbedded?function(e,t,r){if(s[e])for(var n=s[e].getConfig().fragmentedTracks,a=0;a<n.length;a++){var i,o=n[a];t.lang===o.lang&&(o.id?t.id===o.id:t.index===o.index)&&(i=y.getCurrentTrackFor(w.default.TEXT,e),(o.id?i.id!==o.id:i.index!==o.index)?(l[e].deleteCuesFromTrackIdx(r),s[e].setCurrentFragmentedTrackIdx(a)):-1===r&&u.trigger(L.default.SET_FRAGMENTED_TEXT_AFTER_DISABLED,{},{streamId:e,mediaType:w.default.TEXT}))}}(e,t,r):t&&!t.isFragmented&&(r=e,e=t,u.trigger(L.default.SET_NON_FRAGMENTED_TEXT,{currentTrackInfo:e},{streamId:r,mediaType:w.default.TEXT})),y.setTrack(t))}function R(e){return l[e].getCurrentTrackIdx()}function I(){s={},l={},i={},d=f=!(c=!0)}return n=(d=f=r=!(t={deactivateStream:function(e){e&&(e=e.id,s[e]&&s[e].resetMediaInfos(),l[e]&&l[e].deleteAllTextTracks())},initialize:function(){u.on(L.default.TEXT_TRACKS_QUEUE_INITIALIZED,v,t),_.get().streaming.text.webvtt.customRenderingEnabled&&(u.on(L.default.PLAYBACK_TIME_UPDATED,T,t),u.on(L.default.PLAYBACK_SEEKING,b,t))},initializeForStream:function(e){var t=e.id,r=(0,N.default)(g).create({videoModel:E,settings:_,streamInfo:e});r.initialize(),l[t]=r,(e=(0,C.default)(g).create({errHandler:m,adapter:h,manifestModel:p,mediaController:y,videoModel:E,textTracks:r,vttParser:n,vttCustomRenderingParser:a,ttmlParser:o,streamInfo:e,settings:_})).initialize(),s[t]=e,i[t]={},i[t].lastEnabledIndex=-1},createTracks:function(e){e=e.id,l[e]&&l[e].createTracks()},getTextSourceBuffer:function(e){if(e=e.id,s&&s[e])return s[e]},getAllTracksAreDisabled:function(){return c},addEmbeddedTrack:function(e,t){e=e.id,s[e]&&s[e].addEmbeddedTrack(t)},enableText:function(e,t){(0,x.checkParameterType)(t,"boolean"),S()!==t&&(t&&A(e,i[e].lastEnabledIndex),t||(i[e].lastEnabledIndex=R(e),f?A(e,-1):d=!0))},isTextEnabled:S,setTextTrack:A,getCurrentTrackIdx:R,enableForcedTextStreaming:function(e){(0,x.checkParameterType)(e,"boolean"),r=e},addMediaInfosToBuffer:function(e,t,r){var n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null,e=e.id;s[e]&&s[e].addMediaInfos(t,r,n)},reset:function(){I(),u.off(L.default.TEXT_TRACKS_QUEUE_INITIALIZED,v,t),_.get().streaming.text.webvtt.customRenderingEnabled&&(u.off(L.default.PLAYBACK_TIME_UPDATED,T,t),u.off(L.default.PLAYBACK_SEEKING,b,t)),Object.keys(s).forEach(function(e){s[e].resetEmbedded(),s[e].reset()})}}),D.default)(g).getInstance(),a=(0,M.default)(g).getInstance(),o=(0,O.default)(g).getInstance(),u=(0,P.default)(g).getInstance(),I(),t}n.__dashjs_factory_name="TextController";const a=t.default.getClassFactory(n)},"./src/streaming/text/TextSourceBuffer.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>i});var j=r("./src/streaming/constants/Constants.js"),k=r("./src/streaming/vo/metrics/HTTPRequest.js"),U=r("./src/streaming/vo/TextTrackInfo.js"),B=r("./src/streaming/utils/BoxParser.js"),G=r("./src/streaming/utils/CustomTimeRanges.js"),n=r("./src/core/FactoryMaker.js"),q=r("./src/core/Debug.js"),H=r("./src/streaming/text/EmbeddedTextHtmlRender.js"),Y=r("./node_modules/codem-isoboxer/dist/iso_boxer.js"),t=r("./externals/cea608-parser.js"),V=r.n(t),K=r("./src/core/EventBus.js"),z=r("./src/core/events/Events.js"),W=r("./src/streaming/vo/DashJSError.js"),X=r("./src/core/errors/Errors.js");function a(e){var m,p,l,y,o,E,u,_,s,h,v,c,g,f,d,T,b=e.errHandler,S=e.manifestModel,A=e.mediaController,R=e.videoModel,I=e.textTracks,r=e.vttParser,n=e.vttCustomRenderingParser,a=e.ttmlParser,w=e.streamInfo,i=e.settings,C=this.context,t=(0,K.default)(C).getInstance(),N=!1;function D(){_=NaN,h=E=null,u=!(s=[]),o=[],y=null}function M(e){e=e.chunk;e.mediaInfo.embeddedCaptions&&P(e.bytes,e)}function O(e){v=e}function P(e,t){var r,n,a=t.mediaInfo,i=a.type,o=a.mimeType,s=a.codec||o;s?-1!==a.codec.indexOf("application/mp4")?(r=e,n=s,"InitializationSegment"===(o=t).segmentType?(u=!0,_=l.getMediaTimescaleFromMoov(r)):u&&(0<(a=(a=l.getSamplesInfo(r)).sampleList).length&&(h=a[0].cts-o.start*_),0<=n.search(j.default.STPP)?function(e,t,r){var n,a;for(y=null!==y?y:F(r),n=0;n<t.length;n++){var i=t[n],o=i.cts,s=L(),l=s+o/_,u=l+i.duration/_;m.buffered.add(l,u);var u=new DataView(e,i.offset,i.subSizes[0]),c=Y.Utils.dataViewToString(u,j.default.UTF8),f=[],d=i.offset+i.subSizes[0];for(a=1;a<i.subSizes.length;a++){var g=new Uint8Array(e,d,i.subSizes[a]),g=String.fromCharCode.apply(null,g);f.push(g),d+=i.subSizes[a]}try{var h=S.getValue().ttmlTimeIsRelative?o/_:0,h=y.parse(c,h,o/_,(o+i.duration)/_,f);I.addCaptions(v,s,h)}catch(e){E.removeExecutedRequestsBeforeTime(),this.remove(),p.error("TTML parser error: "+e.message)}}}(r,a,n):function(e,t){var r,n,a,i=[];for(r=0;r<t.length;r++){var o=t[r];o.cts-=h;var s=L()+o.cts/_,l=s+o.duration/_;m.buffered.add(s,l);var l=e.slice(o.offset,o.offset+o.size),u=Y.parseBuffer(l);for(n=0;n<u.boxes.length;n++){var c=u.boxes[n];if(p.debug("VTT box1: "+c.type),"vtte"!==c.type&&"vttc"===c.type)for(p.debug("VTT vttc boxes.length = "+c.boxes.length),a=0;a<c.boxes.length;a++){var f,d,g=c.boxes[a];p.debug("VTT box2: "+g.type),"payl"===g.type&&(f=g.cue_text,p.debug("VTT cue_text = "+f),d=o.cts/_,g=(o.cts+o.duration)/_,i.push({start:d,end:g,data:f,styles:{}}),p.debug("VTT "+d+"-"+g+" : "+f))}}}0<i.length&&I.addCaptions(v,0,i)}(r,a))):i===j.default.VIDEO?function(e,t){var r,n;if(t.segmentType===k.HTTPRequest.INIT_SEGMENT_TYPE)0===g&&(g=l.getMediaTimescaleFromMoov(e));else if(t.segmentType===k.HTTPRequest.MEDIA_SEGMENT_TYPE)if(0!==g){t=(n=l.getSamplesInfo(e)).lastSequenceNumber;if(d[0]||d[1]||function(){for(var e=0;e<c.length;e++){if(-1===(t=I.getTrackIdxForId(c[e].id)))return p.warn("CEA-608: data before track is ready.");var t=function(n){return function(e,t,r){(r=R.getTTMLRenderingDiv()?T.createHTMLCaptionsFromScreen(R.getElement(),e,t,r):[{start:e,end:t,data:r.getDisplayText(),styles:{}}])&&I.addCaptions(n,0,r)}}(t);d[e]=new(V().Cea608Parser)(e+1,{newCue:t},null)}}(),g){if(null!==f&&t!==f+n.numSequences)for(r=0;r<d.length;r++)d[r]&&d[r].reset();for(var a=function(e,t){if(0===t.length)return null;for(var r={splits:[],fields:[[],[]]},n=new DataView(e),a=0;a<t.length;a++)for(var i=t[a],o=V().findCea608Nalus(n,i.offset,i.size),s=null,l=0,u=0;u<o.length;u++)for(var c,f=V().extractCea608DataFromRange(n,o[u]),d=0;d<2;d++)0<f[d].length&&(i.cts!==s?l=0:l+=1,c=L(),r.fields[d].push([i.cts+c*g,f[d],l]),s=i.cts);return r.fields.forEach(function(e){e.sort(function(e,t){return e[0]===t[0]?e[2]-t[2]:e[0]-t[0]})}),r}(e,n.sampleList),i=0;i<d.length;i++){var o=a.fields[i],s=d[i];if(s)for(r=0;r<o.length;r++)s.addData(o[r][0]/g,o[r][1])}f=t}}else p.warn("CEA-608: No timescale for embeddedTextTrack yet")}(e,t):function(e,t,r){var n,a,e=new DataView(e,0,e.byteLength);a=Y.Utils.dataViewToString(e,j.default.UTF8);try{n=F(r).parse(a,0),I.addCaptions(I.getCurrentTrackIdx(),0,n),m.buffered&&m.buffered.add(t.start,t.end)}catch(e){b.error(new W.default(X.default.TIMED_TEXT_ERROR_ID_PARSE_CODE,X.default.TIMED_TEXT_ERROR_MESSAGE_PARSE+e.message,a))}}(e,t,s):p.error("No text type defined")}function L(){return isNaN(m.timestampOffset)?0:m.timestampOffset}function F(e){var t;return 0<=e.search(j.default.VTT)?t=i.get().streaming.text.webvtt.customRenderingEnabled&&n?n:r:(0<=e.search(j.default.TTML)||0<=e.search(j.default.STPP))&&(t=a),t}function x(t){c.forEach(function(e){e=I.getTrackIdxForId(e.id);0<=e&&I.deleteCuesFromTrackIdx(e,t.from,t.to)})}return m={initialize:function(){N||(c=[],d=[],N=!(g=0),T=(f=v=null,H.default)(C).getInstance(),t.on(z.default.VIDEO_CHUNK_RECEIVED,M,m),t.on(z.default.BUFFER_CLEARED,x,m))},addMediaInfos:function(e,t,r){if(o=o.concat(t),e===j.default.TEXT&&t[0].isFragmented&&!t[0].isEmbedded){E=r,m.buffered=(0,G.default)(C).create(),s=A.getTracksFor(j.default.TEXT,w.id).filter(function(e){return e.isFragmented});for(var n=A.getCurrentTrackFor(j.default.TEXT,w.id),a=0;a<s.length;a++)if(s[a]===n){O(a);break}}for(var i=0;i<t.length;i++)!function(e){var t,r=new U.default;for(t in e)r[t]=e[t];r.labels=e.labels,r.defaultTrack=function(e){var t=!1;1<c.length&&e.isEmbedded?t=e.id&&e.id===j.default.CC1:1===c.length?e.id&&"string"==typeof e.id&&"CC"===e.id.substring(0,2)&&(t=!0):0===c.length&&(t=e.index===o[0].index);return t}(e),r.isFragmented=e.isFragmented,r.isEmbedded=!!e.isEmbedded,r.isTTML=function(e){return e.codec&&0<=e.codec.search(j.default.STPP)||e.mimeType&&0<=e.mimeType.search(j.default.TTML)}(e),r.kind=function(e,t){e=e.roles&&0<e.roles.length?t[e.roles[0]]:t.caption;return e=e===t.caption||e===t.subtitle?e:t.caption}(e,{subtitle:"subtitles",caption:"captions"}),I.addTextTrack(r)}(t[i])},resetMediaInfos:function(){o=[]},getStreamId:function(){return w.id},append:P,abort:function(){},addEmbeddedTrack:function(e){if(N&&e)if(e.id===j.default.CC1||e.id===j.default.CC3){for(var t=0;t<c.length;t++)if(c[t].id===e.id)return;c.push(e)}else p.warn("Embedded track "+e.id+" not supported!")},resetEmbedded:function(){t.off(z.default.VIDEO_CHUNK_RECEIVED,M,m),t.off(z.default.BUFFER_CLEARED,x,m),I&&I.deleteAllTextTracks(),N=!1,c=[],d=[null,null],f=null},getConfig:function(){return{fragmentModel:E,fragmentedTracks:s,videoModel:R}},setCurrentFragmentedTrackIdx:O,remove:function(e,t){void 0===e&&e===t&&(e=m.buffered.start(0),t=m.buffered.end(m.buffered.length-1)),m.buffered.remove(e,t),I.deleteCuesFromTrackIdx(v,e,t)},reset:function(){D(),o=[],l=null}},p=(0,q.default)(C).getInstance().getLogger(m),l=(0,B.default)(C).getInstance(),D(),m}a.__dashjs_factory_name="TextSourceBuffer";const i=n.default.getClassFactory(a)},"./src/streaming/text/TextTracks.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>a});var F=r("./src/streaming/constants/Constants.js"),x=r("./src/core/EventBus.js"),j=r("./src/core/events/Events.js"),k=r("./src/streaming/MediaPlayerEvents.js"),t=r("./src/core/FactoryMaker.js"),U=r("./src/core/Debug.js"),B=r("./node_modules/imsc/src/main/js/main.js");function G(e,t){var r;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return s(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return s(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,t=function(){};return{s:t,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:t}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,o=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return i=e.done,e},e:function(e){o=!0,a=e},f:function(){try{i||null==r.return||r.return()}finally{if(o)throw a}}}}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var q=["text","images","embeddedImages","align","fontSize","id","isd","line","lineAlign","lineHeight","linePadding","position","positionAlign","region","size","snapToLines","vertical"];function n(e){var t,s,l,c,f,d,h,m,p,y,E,g,n,_,v,r,T,a,i=this.context,b=(0,x.default)(i).getInstance(),S=e.videoModel,A=e.streamInfo,u=e.settings;function R(e,t){var r=S.getClientWidth(),n=S.getClientHeight(),a=S.getVideoWidth(),i=S.getVideoHeight(),o=S.getVideoRelativeOffsetTop(),s=S.getVideoRelativeOffsetLeft();if(0!==a&&0!==i){var l=a/i,u=!1;e.isFromCEA608&&(l=3.5/3,u=!0);a=function(e,t,r,n,a,i){var o=0,s=0;r/n<e/t?o=(s=t)/n*r:s=(o=e)/r*n;r=0,n=0;return a<o/s?r=(n=s)*a:n=(r=o)/a,e=(e-r)/2,t=(t-n)/2,i?{x:e+.1*r,y:t+.1*n,w:.8*r,h:.8*n}:{x:e,y:t,w:r,h:n}}.call(this,r,n,a,i,l,u),i=a.w,l=a.h,u=a.x,a=a.y;if(i!=p||l!=y||u!=h||a!=m||t){h=u+s,m=a+o,p=i,y=l,!E||(l=E.style)&&(l.left=h+"px",l.top=m+"px",l.width=p+"px",l.height=y+"px",l.zIndex=_&&document[_]||v?T:null,b.trigger(k.default.CAPTION_CONTAINER_RESIZE));var c=e.activeCues;if(c)for(var f=c.length,d=0;d<f;++d){var g=c[d];g.scaleCue(g)}}}}function I(e){var t,r,n,a;if(e.cellResolution){var i=[p/e.cellResolution[0],y/e.cellResolution[1]];if(e.linePadding)for(t in e.linePadding)if(e.linePadding.hasOwnProperty(t))for(var o=(e.linePadding[t]*i[0]).toString(),s=document.getElementsByClassName("spanPadding"),l=0;l<s.length;l++)s[l].style.cssText=s[l].style.cssText.replace(/(padding-left\s*:\s*)[\d.,]+(?=\s*px)/gi,"$1"+o),s[l].style.cssText=s[l].style.cssText.replace(/(padding-right\s*:\s*)[\d.,]+(?=\s*px)/gi,"$1"+o);if(e.fontSize){for(t in e.fontSize)if(e.fontSize.hasOwnProperty(t)){"%"===e.fontSize[t][0]?r=e.fontSize[t][1]/100:"c"===e.fontSize[t][0]&&(r=e.fontSize[t][1]),o=(r*i[1]).toString();for(var u="defaultFontSize"!==t?document.getElementsByClassName(t):document.getElementsByClassName("paragraph"),c=0;c<u.length;c++)u[c].style.cssText=u[c].style.cssText.replace(/(font-size\s*:\s*)[\d.,]+(?=\s*px)/gi,"$1"+o)}if(e.lineHeight)for(t in e.lineHeight)if(e.lineHeight.hasOwnProperty(t)){"%"===e.lineHeight[t][0]?n=e.lineHeight[t][1]/100:"c"===e.fontSize[t][0]&&(n=e.lineHeight[t][1]),o=(n*i[1]).toString(),u=document.getElementsByClassName(t);for(var f=0;f<u.length;f++)u[f].style.cssText=u[f].style.cssText.replace(/(line-height\s*:\s*)[\d.,]+(?=\s*px)/gi,"$1"+o)}}}e.isd&&((a=document.getElementById(e.cueID))&&E.removeChild(a),w(e))}function w(n){var e;E&&(e=document.createElement("div"),E.appendChild(e),r=(0,B.renderHTML)(n.isd,e,function(e){var t=/^(urn:)(mpeg:[a-z0-9][a-z0-9-]{0,31}:)(subs:)([0-9]+)$/,r=/^#(.*)$/;if(t.test(e)){t=t.exec(e),t=parseInt(t[4],10)-1;return"data:image/png;base64,"+btoa(n.images[t])}if(r.test(e)){e=r.exec(e)[1];return"data:image/png;base64,"+n.embeddedImages[e]}return null},E.clientHeight,E.clientWidth,!1,function(e){s.info("renderCaption :",e)},r,!0),e.id=n.cueID,b.trigger(k.default.CAPTION_RENDERED,{captionDiv:e,currentTrackIdx:d}))}function C(e,t){if(u.get().streaming.text.extendSegmentedCues&&t.cues&&0!==t.cues.length){t=t.cues[t.cues.length-1];return t.endTime===e.startTime?function(e,t,r){for(var n=0;n<r.length;n++){var a=r[n];if(JSON.stringify(e[a])!==JSON.stringify(t[a]))return!1}return!0}(t,e,q)&&(t.endTime=e.endTime,1):void 0}}function N(e,t,r){var n=D(e);if(n&&Array.isArray(r)&&0!==r.length)for(var a=0;a<r.length;a++){var i=void 0,o=r[a];n.cellResolution=o.cellResolution,n.isFromCEA608=o.isFromCEA608,isNaN(o.start)||isNaN(o.end)||(i="html"===o.type&&E?function(e,t,r){var n=this,t=new l(e.start+t,e.end+t,"");return t.cueHTMLElement=e.cueHTMLElement,t.isd=e.isd,t.images=e.images,t.embeddedImages=e.embeddedImages,t.cueID=e.cueID,t.scaleCue=I.bind(n),t.cellResolution=e.cellResolution,t.lineHeight=e.lineHeight,t.linePadding=e.linePadding,t.fontSize=e.fontSize,E.style.left=h+"px",E.style.top=m+"px",E.style.width=p+"px",E.style.height=y+"px",t.onenter=function(){r.mode===F.default.TEXT_SHOWING&&(this.isd?(w(this),s.debug("Cue enter id:"+this.cueID)):(E.appendChild(this.cueHTMLElement),I.call(n,this),b.trigger(k.default.CAPTION_RENDERED,{captionDiv:this.cueHTMLElement,currentTrackIdx:d})))},t.onexit=function(){if(E)for(var e=E.childNodes,t=0;t<e.length;++t)e[t].id===this.cueID&&(s.debug("Cue exit id:"+e[t].id),E.removeChild(e[t]),--t)},t}(o,t,n):o.data?function(e,t,r){var n=new l(e.start-t,e.end-t,e.data);if(n.cueID="".concat(n.startTime,"_").concat(n.endTime),n.isActive=!1,e.styles)try{void 0!==e.styles.align&&"align"in n&&(n.align=e.styles.align),void 0!==e.styles.line&&"line"in n&&(n.line=e.styles.line),void 0!==e.styles.position&&"position"in n&&(n.position=e.styles.position),void 0!==e.styles.size&&"size"in n&&(n.size=e.styles.size)}catch(e){s.error(e)}return n.onenter=function(){r.mode===F.default.TEXT_SHOWING&&b.trigger(k.default.CAPTION_RENDERED,{currentTrackIdx:d})},n}(o,t,n):null);try{i?function(e,t){if(!e.cues)return!1;for(var r=0;r<e.cues.length;r++)if(e.cues[r].startTime===t.startTime&&e.cues[r].endTime===t.endTime)return!0;return!1}(n,i)||(u.get().streaming.text.webvtt.customRenderingEnabled?(n.manualCueList||(n.manualCueList=[]),n.manualCueList.push(i)):C(i,n)||n.addCue(i)):s.error("Impossible to display subtitles. You might have missed setting a TTML rendering div via player.attachTTMLRenderingDiv(TTMLRenderingDiv)")}catch(e){throw O(n),n.addCue(i),e}}}function o(){var e=[],t=G(S.getTextTracks());try{for(t.s();!(r=t.n()).done;){var r=r.value;r.manualMode===F.default.TEXT_SHOWING&&e.push(r)}}catch(e){t.e(e)}finally{t.f()}return e}function D(e){return 0<=e&&c[e]?S.getTextTrack(c[e].kind,c[e].id,c[e].lang,c[e].isTTML,c[e].isEmbedded):null}function M(e){var t,r=this;e!==d&&(t=D(d=e),function(e){L.call(this),(e&&"html"===e.renderingType?function(){var e=document.getElementById("native-cue-style");if(e)return;(e=document.createElement("style")).id="native-cue-style",document.head.appendChild(e);var t=e.sheet,r=S.getElement();try{r&&(r.id?t.insertRule("#"+r.id+"::cue {background: transparent}",0):0!==r.classList.length?t.insertRule("."+r.className+"::cue {background: transparent}",0):t.insertRule("video::cue {background: transparent}",0))}catch(e){s.info(""+e.message)}}:P).call(this)}.call(this,t),n&&(clearInterval(n),n=null),t&&"html"===t.renderingType&&(R.call(this,t,!0),window.ResizeObserver?(a=new window.ResizeObserver(function(){R.call(r,t,!0)})).observe(S.getElement()):n=setInterval(R.bind(this,t),500)))}function O(e,t,r){var n=!(3<arguments.length&&void 0!==arguments[3])||arguments[3];if(e.cues)for(var a=e.cues,i=a.length-1;0<=i;i--)!function(e,t,r,n){return n=!(3<arguments.length&&void 0!==n)||n,(isNaN(t)||(n?e.startTime:e.endTime)>=t)&&(isNaN(r)||(n?e.endTime:e.startTime)<=r)}(a[i],t,r,n)||(a[i].onexit&&a[i].onexit(),e.removeCue(a[i]))}function P(){var e=document.getElementById("native-cue-style");e&&document.head.removeChild(e)}function L(){if(E)for(;E.firstChild;)E.removeChild(E.firstChild)}return t={initialize:function(){"undefined"!=typeof window&&"undefined"!=typeof navigator&&(l=window.VTTCue||window.TextTrackCue,c=[],f=[],v=!(d=-1),T=2147483647,r=n=g=E=null,void(y=p=m=h=0)!==document.fullscreenElement?_="fullscreenElement":void 0!==document.webkitIsFullScreen?_="webkitIsFullScreen":document.msFullscreenElement?_="msFullscreenElement":document.mozFullScreen&&(_="mozFullScreen"))},getStreamId:function(){return A.id},addTextTrack:function(e){c.push(e)},addCaptions:N,createTracks:function(){c.sort(function(e,t){return e.index-t.index}),E=S.getTTMLRenderingDiv(),g=S.getVttRenderingDiv();for(var e,t,r,n,a=-1,i=0;i<c.length;i++){var o=(o=c[i],n=r=t=e=void 0,e=o.kind,t=void 0!==o.id?o.id:o.lang,r=o.lang,n=o.isTTML,o=o.isEmbedded,S.addTextTrack(e,t,r,n,o));f.push(o),c[i].defaultTrack&&(o.default=!0,a=i);o=D(i);o&&(o.mode=F.default.TEXT_SHOWING,E&&(c[i].isTTML||c[i].isEmbedded)?o.renderingType="html":o.renderingType="default"),N(i,0,c[i].captionData),b.trigger(k.default.TEXT_TRACK_ADDED)}if(M.call(this,a),0<=a){var s=function e(){var t=D(a);t&&"html"===t.renderingType&&R.call(this,t,!0),b.off(k.default.PLAYBACK_METADATA_LOADED,e,this)};b.on(k.default.PLAYBACK_METADATA_LOADED,s,this);for(var l=0;l<c.length;l++){var u=D(l);u&&(u.mode=l===a?F.default.TEXT_SHOWING:F.default.TEXT_HIDDEN,u.manualMode=l===a?F.default.TEXT_SHOWING:F.default.TEXT_HIDDEN)}}b.trigger(j.default.TEXT_TRACKS_QUEUE_INITIALIZED,{index:d,tracks:c,streamId:A.id})},getCurrentTrackIdx:function(){return d},setCurrentTrackIdx:M,getTrackIdxForId:function(e){for(var t=-1,r=0;r<c.length;r++)if(c[r].id===e){t=r;break}return t},getCurrentTrackInfo:function(){return c[d]},setModeForTrackIdx:function(e,t){(e=D(e))&&e.mode!==t&&(e.mode=t),e&&e.manualMode!==t&&(e.manualMode=t)},deleteCuesFromTrackIdx:function(e,t,r){(e=D(e))&&O(e,t,r)},deleteAllTextTracks:function(){for(var e=f?f.length:0,t=0;t<e;t++){var r=D(t);r&&O.call(this,r,A.start,A.start+A.duration,!1)}f=[],c=[],n&&(clearInterval(n),n=null),a&&S&&(a.unobserve(S.getElement()),a=null),d=-1,L.call(this)},deleteTextTrack:function(e){S.removeChild(f[e]),f.splice(e,1)},manualCueProcessing:function(n){var e=o();e&&0<e.length&&((e=e[0].manualCueList)&&0<e.length&&e.forEach(function(e){if(e.startTime<=n&&e.endTime>=n&&!e.isActive)e.isActive=!0,WebVTT.processCues(window,[e],g,e.cueID);else if(e.isActive&&(e.startTime>n||e.endTime<n)&&(e.isActive=!1,g))for(var t=g.childNodes,r=0;r<t.length;++r)t[r].id===e.cueID&&(g.removeChild(t[r]),--r)}))},disableManualTracks:function(){var e=o();e&&0<e.length&&((e=e[0].manualCueList)&&0<e.length&&e.forEach(function(e){if(e.isActive&&(e.isActive=!1,g))for(var t=g.childNodes,r=0;r<t.length;++r)t[r].id===e.cueID&&(g.removeChild(t[r]),--r)}))}},s=(0,U.default)(i).getInstance().getLogger(t),t}n.__dashjs_factory_name="TextTracks";const a=t.default.getClassFactory(n)},"./src/streaming/thumbnail/ThumbnailController.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>a});var t=r("./src/core/FactoryMaker.js"),s=r("./src/streaming/constants/Constants.js"),l=r("./src/streaming/vo/Thumbnail.js"),u=r("./src/streaming/thumbnail/ThumbnailTracks.js"),c=r("./src/streaming/vo/BitrateInfo.js"),f=r("./src/dash/utils/SegmentsUtils.js");function n(e){var t,o,r=this.context,n=e.streamInfo;function a(e){o.setTrackByIndex(e)}function i(){o&&o.reset()}return t={getStreamId:function(){return n.id},initialize:function(){o.addTracks();var e=o.getTracks();e&&0<e.length&&a(0)},provide:function(e,t){if("function"==typeof t){var r=o.getCurrentTrack();if(!r||r.segmentDuration<=0||null==e)t(null);else{(n=o.getThumbnailRequestForTime(e))&&(r.segmentDuration=n.duration);var n,a=e%r.segmentDuration,a=Math.floor(a*r.tilesHor*r.tilesVert/r.segmentDuration),i=new l.default;if(i.width=Math.floor(r.widthPerTile),i.height=Math.floor(r.heightPerTile),i.x=Math.floor(a%r.tilesHor)*r.widthPerTile,i.y=Math.floor(a/r.tilesHor)*r.heightPerTile,"readThumbnail"in r)return r.readThumbnail(e,function(e){i.url=e,t(i)});n?(i.url=n.url,r.segmentDuration=NaN):(n=Math.floor(e/r.segmentDuration),i.url=(r=(e=n)+(n=r).startNumber,e=(0,f.replaceTokenForTemplate)(n.templateUrl,"Number",r),e=(0,f.replaceTokenForTemplate)(e,"Time",(r-1)*n.segmentDuration*n.timescale),e=(0,f.replaceTokenForTemplate)(e,"Bandwidth",n.bandwidth),(0,f.unescapeDollarsInTemplate)(e))),t(i)}}},setTrackByIndex:a,getCurrentTrackIndex:function(){return o.getCurrentTrackIndex()},getBitrateList:function(){var e=o.getTracks(),r=0;return e.map(function(e){var t=new c.default;return t.mediaType=s.default.IMAGE,t.qualityIndex=r++,t.bitrate=e.bitrate,t.width=e.width,t.height=e.height,t})},reset:i},i(),o=(0,u.default)(r).create({streamInfo:n,adapter:e.adapter,baseURLController:e.baseURLController,timelineConverter:e.timelineConverter,debug:e.debug,eventBus:e.eventBus,events:e.events,dashConstants:e.dashConstants,dashMetrics:e.dashMetrics,segmentBaseController:e.segmentBaseController}),t}n.__dashjs_factory_name="ThumbnailController";const a=t.default.getClassFactory(n)},"./src/streaming/thumbnail/ThumbnailTracks.js":(e,t,r)=>{r.r(t),r.d(t,{THUMBNAILS_SCHEME_ID_URIS:()=>D,default:()=>a});var T=r("./src/streaming/constants/Constants.js"),b=r("./src/dash/constants/DashConstants.js"),t=r("./src/core/FactoryMaker.js"),S=r("./src/streaming/vo/ThumbnailTrackInfo.js"),A=r("./src/streaming/utils/URLUtils.js"),R=r("./src/dash/utils/SegmentsUtils.js"),I=r("./src/streaming/utils/BoxParser.js"),w=r("./src/streaming/net/XHRLoader.js"),C=r("./src/dash/DashHandler.js"),N=r("./src/dash/controllers/SegmentsController.js"),D=["http://dashif.org/thumbnail_tile","http://dashif.org/guidelines/thumbnail_tile"];function n(e){var t,a,i,o,s,l,u,c,r=this.context,f=e.adapter,d=e.baseURLController,n=e.streamInfo,g=e.timelineConverter,h=e.debug,m=e.eventBus,p=e.events,y=e.dashConstants,E=(0,A.default)(r).getInstance();function _(r,e){var t,n=new S.default;n.id=r.id,n.bitrate=r.bandwidth,n.width=r.width,n.height=r.height,n.tilesHor=1,n.tilesVert=1,r.essentialProperties&&r.essentialProperties.forEach(function(e){0<=D.indexOf(e.schemeIdUri)&&e.value&&(2!==(e=e.value.split("x")).length||isNaN(e[0])||isNaN(e[1])||(n.tilesHor=parseInt(e[0],10),n.tilesVert=parseInt(e[1],10)))}),e?l.updateSegmentData(r).then(function(e){var t,a,i;t=n,i=[],e=function(e,t){var r,n,a,i=[],o=0;for(r=0,n=e.segments.length;r<n;r++)a=e.segments[r],(a=(0,R.getTimeBasedSegment)(g,f.getIsDynamic(),t,a.startTime,a.duration,a.timescale,a.media,a.mediaRange,o))&&(i.push(a),a=null,o++);return i}(e=e,a=r),a.segments=e,t.segmentDuration=a.segments[0].duration,t.readThumbnail=function(t,n){var r=null;i.some(function(e){if(e.start<=t&&e.end>t)return r=e.url,!0}),r?n(r):a.segments.some(function(r){if(r.mediaStartTime<=t&&r.mediaStartTime+r.duration>t){var e=d.resolve(a.path);return u.load({method:"get",url:e.url,request:{range:r.mediaRange,responseType:"arraybuffer"},onload:function(e){var t=c.getSamplesInfo(e.target.response),t=new Blob([e.target.response.slice(t.sampleList[0].offset,t.sampleList[0].offset+t.sampleList[0].size)],{type:"image/jpeg"}),t=window.URL.createObjectURL(t);i.push({start:r.mediaStartTime,end:r.mediaStartTime+r.duration,url:t}),n&&n(t)}}),!0}})}}):(n.startNumber=r.startNumber,n.segmentDuration=r.segmentDuration,n.timescale=r.timescale,n.templateUrl=(t=r,(e=E.isRelative(t.media)?E.resolve(t.media,d.resolve(t.path).url):t.media)?(0,R.replaceIDForTemplate)(e,t.id):"")),0<n.tilesHor&&0<n.tilesVert&&(n.widthPerTile=n.width/n.tilesHor,n.heightPerTile=n.height/n.tilesVert,a.push(n))}function v(){a=[],o=-1,s=null}return t={getTracks:function(){return a},addTracks:function(){var e;n&&f&&(s=f.getMediaInfoForType(n,T.default.IMAGE))&&((e=f.getVoRepresentations(s))&&0<e.length&&e.forEach(function(e){(e.segmentInfoType===b.default.SEGMENT_TEMPLATE&&0<e.segmentDuration&&e.media||e.segmentInfoType===b.default.SEGMENT_TIMELINE)&&_(e),e.segmentInfoType===b.default.SEGMENT_BASE&&_(e,!0)}),0<a.length&&a.sort(function(e,t){return e.bitrate-t.bitrate}))},reset:v,setTrackByIndex:function(e){a&&0!==a.length&&(e>=a.length&&(e=a.length-1),o=e)},getCurrentTrack:function(){return o<0?null:a[o]},getCurrentTrackIndex:function(){return o},getThumbnailRequestForTime:function(e){for(var t,r=f.getVoRepresentations(s),n=0;n<r.length;n++)if(a[o].id===r[n].id){t=r[n];break}return i.getSegmentRequestForTime(s,t,e)}},v(),u=(0,w.default)(r).create({}),c=(0,I.default)(r).getInstance(),l=(0,N.default)(r).create({events:p,eventBus:m,streamInfo:n,timelineConverter:g,dashConstants:y,dashMetrics:e.dashMetrics,segmentBaseController:e.segmentBaseController,type:T.default.IMAGE}),(i=(0,C.default)(r).create({streamInfo:n,type:T.default.IMAGE,timelineConverter:g,segmentsController:l,baseURLController:d,debug:h,eventBus:m,events:p,dashConstants:y,urlUtils:E})).initialize(!!f&&f.getIsDynamic()),t}n.__dashjs_factory_name="ThumbnailTracks";const a=t.default.getClassFactory(n)},"./src/streaming/utils/BaseURLSelector.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>a});var c=r("./src/core/errors/Errors.js"),f=r("./src/core/EventBus.js"),d=r("./src/core/events/Events.js"),g=r("./src/streaming/controllers/BlacklistController.js"),h=r("./src/streaming/utils/baseUrlResolution/DVBSelector.js"),m=r("./src/streaming/utils/baseUrlResolution/BasicSelector.js"),t=r("./src/core/FactoryMaker.js"),p=r("./src/streaming/vo/DashJSError.js"),y=r("./src/streaming/utils/SupervisorTools.js"),E=r("./src/streaming/utils/baseUrlResolution/ContentSteeringSelector.js"),_=r("./src/core/Settings.js");function n(){var e,t,r,n,a,i,o=this.context,s=(0,f.default)(o).getInstance(),l=(0,_.default)(o).getInstance();function u(){t.reset()}return e={chooseSelector:function(e){(0,y.checkParameterType)(e,"boolean"),i=e?n:r},select:function(e){if(e){if(l.get().streaming.applyContentSteering&&(t=a.selectBaseUrlIndex(e),isNaN(t)||-1===t||(e.selectedIdx=t)),!isNaN(e.selectedIdx))return e.baseUrls[e.selectedIdx];var t=i.select(e.baseUrls);return t?(e.selectedIdx=e.baseUrls.indexOf(t),t):(s.trigger(d.default.URL_RESOLUTION_FAILED,{error:new p.default(c.default.URL_RESOLUTION_FAILED_GENERIC_ERROR_CODE,c.default.URL_RESOLUTION_FAILED_GENERIC_ERROR_MESSAGE)}),void(i===r&&u()))}},reset:u,setConfig:function(e){e.selector&&(i=e.selector),e.contentSteeringSelector&&(a=e.contentSteeringSelector)}},t=(0,g.default)(o).create({updateEventName:d.default.SERVICE_LOCATION_BLACKLIST_CHANGED,addBlacklistEventName:d.default.SERVICE_LOCATION_BLACKLIST_ADD}),r=(0,m.default)(o).create({blacklistController:t}),n=(0,h.default)(o).create({blacklistController:t}),(a=(0,E.default)(o).create()).setConfig({blacklistController:t}),i=r,e}n.__dashjs_factory_name="BaseURLSelector";const a=t.default.getClassFactory(n)},"./src/streaming/utils/BoxParser.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>s});var a=r("./src/core/Debug.js"),i=r("./src/streaming/utils/IsoFile.js"),t=r("./src/core/FactoryMaker.js"),o=r("./node_modules/codem-isoboxer/dist/iso_boxer.js"),c=r("./src/streaming/vo/IsoBoxSearchInfo.js");function n(){var n,e,r=this.context;function D(e){if(!e)return null;void 0===e.fileStart&&(e.fileStart=0);var t=o.parseBuffer(e),e=(0,i.default)(r).create();return e.setData(t),e}function l(e,t){return e[t+3]>>>0|e[t+2]<<8>>>0|e[t+1]<<16>>>0|e[t]<<24>>>0}function u(e,t){return String.fromCharCode(e[t++])+String.fromCharCode(e[t++])+String.fromCharCode(e[t++])+String.fromCharCode(e[t])}return e={parse:D,findLastTopIsoBoxCompleted:function(e,t,r){if(void 0===r&&(r=0),!t||r+8>=t.byteLength)return new c.default(0,!1);for(var n,a=t instanceof ArrayBuffer?new Uint8Array(t):t,i=0;r<a.byteLength;){var o=l(a,r),s=u(a,r+4);if(0===o)break;r+o<=a.byteLength&&(0<=e.indexOf(s)?n=new c.default(r,!0,o):i=r+o),r+=o}return n||new c.default(i,!1)},getMediaTimescaleFromMoov:function(e){return(e=(e=D(e))?e.getBox("mdhd"):void 0)?e.timescale:NaN},getSamplesInfo:function(e){if(!e||0===e.byteLength)return{sampleList:[],lastSequenceNumber:NaN,totalDuration:NaN,numSequences:NaN};for(var t,r,n=(a=D(e)).getBoxes("moof"),e=a.getBoxes("mfhd"),a=a.getBoxes("moof").length,e=e[e.length-1].sequence_number,i=[],o=-1,s=-1,l=0;l<n.length;l++)for(var u=n[l],c=u.getChildBoxes("traf"),f=0;f<c.length;f++){for(var d=c[f],g=d.getChildBox("tfhd"),h=d.getChildBox("tfdt"),m=h.baseMediaDecodeTime,p=d.getChildBoxes("trun"),y=d.getChildBoxes("subs"),E=0;E<p.length;E++)for(var _=p[E],v=_.sample_count,T=(g.base_data_offset||0)+(_.data_offset||0),b=0;b<v;b++){var S,A=void 0!==(S=_.samples[b]).sample_duration?S.sample_duration:g.default_sample_duration,R=void 0!==S.sample_size?S.sample_size:g.default_sample_size,I={dts:m,cts:m+(void 0!==S.sample_composition_time_offset?S.sample_composition_time_offset:0),duration:A,offset:u.offset+T,size:R,subSizes:[R]};if(y)for(t=0;t<y.length;t++){var w=y[t];if(o<w.entry_count-1&&s<b&&(o++,s+=w.entries[o].sample_delta),b==s){I.subSizes=[];for(var C=w.entries[o],N=0;N<C.subsample_count;N++)I.subSizes.push(C.subsamples[N].subsample_size)}}i.push(I),T+=R,m+=A}r=m-h.baseMediaDecodeTime}return{sampleList:i,lastSequenceNumber:e,totalDuration:r,numSequences:a}},findInitRange:function(e){var t=null,r=D(e);return r&&(e=r.getBox("ftyp"),r=r.getBox("moov"),n.debug("Searching for initialization."),r&&r.isComplete&&(t=(e||r).offset+"-"+(r.offset+r.size-1),n.debug("Found the initialization.  Range: "+t))),t},parsePayload:function(e,t,r){if(void 0===r&&(r=0),!t||r+8>=t.byteLength)return new c.default(0,!1);for(var n,a=t instanceof ArrayBuffer?new Uint8Array(t):t,i=0;r<a.byteLength;){var o=l(a,r),s=u(a,r+4);if(0===o)break;r+o<=a.byteLength&&(0<=e.indexOf(s)?n=new c.default(r,!0,o,s):i=r+o),r+=o}return n||new c.default(i,!1)}},n=(0,a.default)(r).getInstance().getLogger(e),e}n.__dashjs_factory_name="BoxParser";const s=t.default.getSingletonFactory(n)},"./src/streaming/utils/Capabilities.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>s,supportsMediaSource:()=>a});var t=r("./src/core/FactoryMaker.js"),n=r("./src/streaming/thumbnail/ThumbnailTracks.js"),l=r("./src/streaming/constants/Constants.js"),i=[{codec:"avc1",compatibleCodecs:["avc3"]},{codec:"avc3",compatibleCodecs:["avc1"]}];function a(){var e="WebKitMediaSource"in window,t="MediaSource"in window;return e||t}function o(){var e,s,t;return t=!(e={setConfig:function(e){e&&e.settings&&(s=e.settings)},supportsMediaSource:a,supportsEncryptedMedia:function(){return t},supportsCodec:function(e,t){return t!==l.default.AUDIO&&t!==l.default.VIDEO?Promise.resolve(!0):(a=e,i=t,s.get().streaming.capabilities.useMediaCapabilitiesApi&&navigator.mediaCapabilities&&navigator.mediaCapabilities.decodingInfo&&(a.codec&&i===l.default.AUDIO||i===l.default.VIDEO&&a.codec&&a.width&&a.height&&a.bitrate&&a.framerate)?(r=e,n=t,new Promise(function(t){var e;r&&r.codec?((e={type:"media-source"})[n]={},e[n].contentType=r.codec,e[n].width=r.width,e[n].height=r.height,e[n].bitrate=parseInt(r.bitrate),e[n].framerate=parseFloat(r.framerate),navigator.mediaCapabilities.decodingInfo(e).then(function(e){t(e.supported)}).catch(function(){t(!1)})):t(!1)})):(o=e,new Promise(function(e){var t;o&&o.codec?(t=o.codec,o.width&&o.height&&(t+=';width="'+o.width+'";height="'+o.height+'"'),"MediaSource"in window&&MediaSource.isTypeSupported(t)||"WebKitMediaSource"in window&&WebKitMediaSource.isTypeSupported(t)?e(!0):e(!1)):e(!1)})));var r,n,a,i,o},setEncryptedMediaSupported:function(e){t=e},supportsEssentialProperty:function(e){try{return-1!==n.THUMBNAILS_SCHEME_ID_URIS.indexOf(e.schemeIdUri)}catch(e){return!0}},codecRootCompatibleWithCodec:function(e,t){for(var r,n=e.split(".")[0],e=0===t.indexOf(n),a=0;a<i.length;a++)if(i[a].codec===n){r=i[a];break}return r?e||r.compatibleCodecs.some(function(e){return 0===t.indexOf(e)}):e}}),e}o.__dashjs_factory_name="Capabilities";const s=t.default.getSingletonFactory(o)},"./src/streaming/utils/CapabilitiesFilter.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>i});var t=r("./src/core/FactoryMaker.js"),n=r("./src/core/Debug.js"),c=r("./src/streaming/constants/Constants.js"),f=r("./src/core/EventBus.js"),d=r("./src/core/events/Events.js");function a(){var e,o,s,a,i,l,t=this.context,u=(0,f.default)(t).getInstance();function r(t,e){if(!e||!e.Period_asArray||0===e.Period_asArray.length)return Promise.resolve();var a=[];return e.Period_asArray.forEach(function(e){var r,n;a.push((r=e,n=t,new Promise(function(e){var t;r&&r.AdaptationSet_asArray&&0!==r.AdaptationSet_asArray.length?(t=[],r.AdaptationSet_asArray.forEach(function(e){var a,i;o.getIsTypeOf(e,n)&&t.push((a=e,i=n,new Promise(function(e){var r,n;a.Representation_asArray&&0!==a.Representation_asArray.length?(r=[],n=[],a.Representation_asArray.forEach(function(e,t){t=o.getCodec(a,t,!1),t=function(e,t,r){switch(e){case c.default.VIDEO:return function(e,t){var r=e.width||null,n=e.height||null,a=e.frameRate||null,e=e.bandwidth||null;return{codec:t,width:r,height:n,framerate:a,bitrate:e}}(t,r);case c.default.AUDIO:return function(e,t){var r=e.audioSamplingRate||null,e=e.bandwidth||null;return{codec:t,bitrate:e,samplerate:r}}(t,r);default:return null}}(i,e,t);n.push(t),r.push(s.supportsCodec(t,i))}),Promise.all(r).then(function(r){a.Representation_asArray=a.Representation_asArray.filter(function(e,t){return r[t]||l.debug("[Stream] Codec ".concat(n[t].codec," not supported ")),r[t]}),e()}).catch(function(){e()})):e()})))}),Promise.all(t).then(function(){r.AdaptationSet_asArray=r.AdaptationSet_asArray.filter(function(e){var t=e.Representation_asArray&&0<e.Representation_asArray.length;return t||(u.trigger(d.default.ADAPTATION_SET_REMOVED_NO_CAPABILITIES,{adaptationSet:e}),l.warn("AdaptationSet has been removed because of no supported Representation")),t}),e()}).catch(function(){e()})):e()})))}),Promise.all(a)}return e={setConfig:function(e){e&&(e.adapter&&(o=e.adapter),e.capabilities&&(s=e.capabilities),e.settings&&(a=e.settings),e.customParametersModel&&(i=e.customParametersModel))},filterUnsupportedFeatures:function(n){return new Promise(function(t){var e=[];e.push(r(c.default.VIDEO,n)),e.push(r(c.default.AUDIO,n)),Promise.all(e).then(function(){var e,r;!a.get().streaming.capabilities.filterUnsupportedEssentialProperties||(e=n)&&e.Period_asArray&&0!==e.Period_asArray.length&&e.Period_asArray.forEach(function(e){e.AdaptationSet_asArray=e.AdaptationSet_asArray.filter(function(e){return!e.Representation_asArray||0===e.Representation_asArray.length||(e.Representation_asArray=e.Representation_asArray.filter(function(e){var t=o.getEssentialPropertiesForRepresentation(e);if(t&&0<t.length)for(var r=0;r<t.length;){if(!s.supportsEssentialProperty(t[r]))return l.debug("[Stream] EssentialProperty not supported: "+t[r].schemeIdUri),!1;r+=1}return!0}),e.Representation_asArray&&0<e.Representation_asArray.length)})}),e=n,(r=i.getCustomCapabilitiesFilters())&&0!==r.length&&e&&e.Period_asArray&&0!==e.Period_asArray.length&&e.Period_asArray.forEach(function(e){e.AdaptationSet_asArray=e.AdaptationSet_asArray.filter(function(e){return!e.Representation_asArray||0===e.Representation_asArray.length||(e.Representation_asArray=e.Representation_asArray.filter(function(t){return!r.some(function(e){return!e(t)})}),e.Representation_asArray&&0<e.Representation_asArray.length)})}),t()}).catch(function(){t()})})}},l=(0,n.default)(t).getInstance().getLogger(e),e}a.__dashjs_factory_name="CapabilitiesFilter";const i=t.default.getSingletonFactory(a)},"./src/streaming/utils/CustomTimeRanges.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>i});var t=r("./src/core/FactoryMaker.js"),n=r("./src/streaming/utils/SupervisorTools.js");function a(){return{customTimeRangeArray:[],length:0,add:function(e,t){for(var r=0,r=0;r<this.customTimeRangeArray.length&&e>this.customTimeRangeArray[r].start;r++);for(this.customTimeRangeArray.splice(r,0,{start:e,end:t}),r=0;r<this.customTimeRangeArray.length-1;r++)this.mergeRanges(r,r+1)&&r--;this.length=this.customTimeRangeArray.length},clear:function(){this.customTimeRangeArray=[],this.length=0},remove:function(e,t){for(var r=0;r<this.customTimeRangeArray.length;r++)if(e<=this.customTimeRangeArray[r].start&&t>=this.customTimeRangeArray[r].end)this.customTimeRangeArray.splice(r,1),r--;else{if(e>this.customTimeRangeArray[r].start&&t<this.customTimeRangeArray[r].end){this.customTimeRangeArray.splice(r+1,0,{start:t,end:this.customTimeRangeArray[r].end}),this.customTimeRangeArray[r].end=e;break}e>this.customTimeRangeArray[r].start&&e<this.customTimeRangeArray[r].end?this.customTimeRangeArray[r].end=e:t>this.customTimeRangeArray[r].start&&t<this.customTimeRangeArray[r].end&&(this.customTimeRangeArray[r].start=t)}this.length=this.customTimeRangeArray.length},mergeRanges:function(e,t){var r=this.customTimeRangeArray[e],n=this.customTimeRangeArray[t];return r.start<=n.start&&n.start<=r.end&&r.end<=n.end?(r.end=n.end,this.customTimeRangeArray.splice(t,1),!0):n.start<=r.start&&r.start<=n.end&&n.end<=r.end?(r.start=n.start,this.customTimeRangeArray.splice(t,1),!0):n.start<=r.start&&r.start<=n.end&&r.end<=n.end?(this.customTimeRangeArray.splice(e,1),!0):r.start<=n.start&&n.start<=r.end&&n.end<=r.end&&(this.customTimeRangeArray.splice(t,1),!0)},start:function(e){return(0,n.checkInteger)(e),e>=this.customTimeRangeArray.length||e<0?NaN:this.customTimeRangeArray[e].start},end:function(e){return(0,n.checkInteger)(e),e>=this.customTimeRangeArray.length||e<0?NaN:this.customTimeRangeArray[e].end}}}a.__dashjs_factory_name="CustomTimeRanges";const i=t.default.getClassFactory(a)},"./src/streaming/utils/DOMStorage.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>a});var t=r("./src/core/FactoryMaker.js"),c=r("./src/core/Debug.js"),f=r("./src/streaming/constants/Constants.js"),d=[{oldKey:"dashjs_vbitrate",newKey:"dashjs_video_bitrate"},{oldKey:"dashjs_abitrate",newKey:"dashjs_audio_bitrate"},{oldKey:"dashjs_vsettings",newKey:"dashjs_video_settings"},{oldKey:"dashjs_asettings",newKey:"dashjs_audio_settings"}],g="dashjs_?_bitrate",h="dashjs_?_settings",m="localStorage",p="lastBitrate",y="lastMediaSettings";function n(e){e=e||{};var t,i,r,n=this.context,o=e.settings;function a(e){if(void 0!==r)return r;r=!1;var t;try{"undefined"!=typeof window&&(t=window[e])}catch(e){return i.warn("DOMStorage access denied: "+e.message),r}if(!t||e!==m&&"sessionStorage"!==e)return r;try{t.setItem("1","1"),t.removeItem("1"),r=!0}catch(e){i.warn("DOMStorage is supported, but cannot be used: "+e.message)}return r}function s(){return 6e5*Math.round((new Date).getTime()/6e5)}function l(e,t){return a(e)&&o.get().streaming[t+"CachingInfo"].enabled}function u(){if(!o)throw new Error(f.default.MISSING_CONFIG_ERROR)}return t={getSavedBitrateSettings:function(e){if(u(),!o.get().streaming.lastBitrateCachingInfo.enabled)return NaN;var t=NaN;if(l(m,p)){var r=g.replace(/\?/,e);try{var n=JSON.parse(localStorage.getItem(r))||{},a=(new Date).getTime()-parseInt(n.timestamp,10)>=o.get().streaming.lastBitrateCachingInfo.ttl||!1,n=parseFloat(n.bitrate);isNaN(n)||a?a&&localStorage.removeItem(r):(t=n,i.debug("Last saved bitrate for "+e+" was "+n))}catch(e){return null}}return t},setSavedBitrateSettings:function(e,t){if(l(m,p)&&t){var r=g.replace(/\?/,e);try{localStorage.setItem(r,JSON.stringify({bitrate:t.toFixed(3),timestamp:s()}))}catch(e){i.error(e.message)}}},getSavedMediaSettings:function(e){if(u(),!o.get().streaming.lastMediaSettingsCachingInfo.enabled)return null;var t=null;if(l(m,y)){var r=h.replace(/\?/,e);try{var n=JSON.parse(localStorage.getItem(r))||{},a=(new Date).getTime()-parseInt(n.timestamp,10)>=o.get().streaming.lastMediaSettingsCachingInfo.ttl||!1,t=n.settings;a&&(localStorage.removeItem(r),t=null)}catch(e){return null}}return t},setSavedMediaSettings:function(e,t){if(l(m,y)){var r=h.replace(/\?/,e);try{localStorage.setItem(r,JSON.stringify({settings:t,timestamp:s()}))}catch(e){i.error(e.message)}}}},i=(0,c.default)(n).getInstance().getLogger(t),a(m)&&d.forEach(function(e){var t=localStorage.getItem(e.oldKey);if(t){localStorage.removeItem(e.oldKey);try{localStorage.setItem(e.newKey,t)}catch(e){i.error(e.message)}}}),t}n.__dashjs_factory_name="DOMStorage";const a=t.default.getSingletonFactory(n)},"./src/streaming/utils/DefaultURLUtils.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>a});r=r("./src/core/FactoryMaker.js");function n(){function e(t,e){try{return new window.URL(t,e).toString()}catch(e){return t}}function t(e,t){var r=s;return t&&c(e)?(f(e)&&(r=l),r=(r=d(e)?u:r)(t),t="/"!==r.charAt(r.length-1)&&"/"!==e.charAt(0)?"/":"",[r,e].join(t)):e}var r,n=/^[a-z][a-z0-9+\-_.]*:/i,a=/^https?:\/\//i,i=/^https:\/\//i,o=/^([a-z][a-z0-9+\-_.]*:\/\/[^\/]+)\/?/i;function s(e){var t=e.indexOf("/"),r=e.lastIndexOf("/");return-1!==t?r===t+1?e:(e=-1!==e.indexOf("?")?e.substring(0,e.indexOf("?")):e).substring(0,r+1):""}function l(e){e=e.match(o);return e?e[1]:""}function u(e){e=e.match(n);return e?e[0]:""}function c(e){return!n.test(e)}function f(e){return c(e)&&"/"===e.charAt(0)}function d(e){return 0===e.indexOf("//")}return function(){try{new window.URL("x","http://y");r=e}catch(e){}finally{r=r||t}}(),{parseBaseUrl:s,parseOrigin:l,parseScheme:u,isRelative:c,isPathAbsolute:f,isSchemeRelative:d,isHTTPURL:function(e){return a.test(e)},isHTTPS:function(e){return i.test(e)},removeHostname:function(e){return/^(?:\w+\:\/\/)?([^\/]+)(.*)$/.exec(e)[2].substring(1)},resolve:function(e,t){return r(e,t)}}}n.__dashjs_factory_name="DefaultURLUtils";const a=r.default.getSingletonFactory(n)},"./src/streaming/utils/EBMLParser.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>a});r=r("./src/core/FactoryMaker.js");function n(e){var r;e=e||{};var s=new DataView(e.data),l=0;function n(e,t){var r=!0,n=0;if(void 0===t&&(t=!1),n=16777215<e.tag?(s.getUint32(l)!==e.tag&&(r=!1),4):65535<e.tag?(256*s.getUint16(l)+s.getUint8(l+2)!==e.tag&&(r=!1),3):255<e.tag?(s.getUint16(l)!==e.tag&&(r=!1),2):(s.getUint8(l)!==e.tag&&(r=!1),1),!r&&e.required&&!t)throw new Error("required tag not found");return r&&(l+=n),r}function a(e){for(var t=1,r=128,n=-1,a=0,i=s.getUint8(l),o=0,o=0;o<8;o+=1){if((i&r)===r){a=void 0===e?i&~r:i,n=o;break}r>>=1}for(o=0;o<n;o+=1,t+=1)a=a<<8|255&s.getUint8(l+t);return l+=t,a}return r={getPos:function(){return l},setPos:function(e){l=e},consumeTag:n,consumeTagAndSize:function(e,t){return(t=n(e,t))&&a(),t},parseTag:function(e){var t;return n(e),t=a(),r[e.parse](t)},skipOverElement:function(e,t){return(e=n(e,t))&&(t=a(),l+=t),e},getMatroskaCodedNum:a,getMatroskaFloat:function(e){var t;switch(e){case 4:t=s.getFloat32(l),l+=4;break;case 8:t=s.getFloat64(l),l+=8}return t},getMatroskaUint:function(e){for(var t=0,r=0;r<e;r+=1)t<<=8,t|=255&s.getUint8(l+r);return l+=e,t},moreData:function(){return l<s.byteLength}}}n.__dashjs_factory_name="EBMLParser";const a=r.default.getClassFactory(n)},"./src/streaming/utils/ErrorHandler.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>o});var n=r("./src/core/EventBus.js"),a=r("./src/core/events/Events.js"),r=r("./src/core/FactoryMaker.js");function i(){var e=this.context,t=(0,n.default)(e).getInstance();return{error:function(e){t.trigger(a.default.ERROR,{error:e})}}}i.__dashjs_factory_name="ErrorHandler";const o=r.default.getSingletonFactory(i)},"./src/streaming/utils/InitCache.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>a});r=r("./src/core/FactoryMaker.js");function n(){var n={};return{save:function(e){var t=e.streamId,r=e.representationId;n[t]=n[t]||{},n[t][r]=e},extract:function(e,t){return n&&n[e]&&n[e][t]?n[e][t]:null},reset:function(){n={}}}}n.__dashjs_factory_name="InitCache";const a=r.default.getSingletonFactory(n)},"./src/streaming/utils/IsoFile.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>i});var n=r("./src/streaming/vo/IsoBox.js"),r=r("./src/core/FactoryMaker.js");function a(){var o;function t(e){var t=[];if(!e||!o||"function"!=typeof o.fetchAll)return t;for(var r,n=o.fetchAll(e),a=0,i=n.length;a<i;a++)(r=s(n[a]))&&t.push(r);return t}function s(e){if(!e)return null;var t=new n.default(e);return e.hasOwnProperty("_incomplete")&&(t.isComplete=!e._incomplete),t}return{getBox:function(e){return e&&o&&o.boxes&&0!==o.boxes.length&&"function"==typeof o.fetch?s(o.fetch(e)):null},getBoxes:t,setData:function(e){o=e},getLastBox:function(){if(!o||!o.boxes||!o.boxes.length)return null;var e=t(o.boxes[o.boxes.length-1].type);return 0<e.length?e[e.length-1]:null}}}a.__dashjs_factory_name="IsoFile";const i=r.default.getClassFactory(a)},"./src/streaming/utils/ObjectUtils.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>o});var n=r("./src/core/FactoryMaker.js"),t=r("./node_modules/fast-deep-equal/index.js"),a=r.n(t);function i(){return{areEqual:function(e,t){return a()(e,t)}}}i.__dashjs_factory_name="ObjectUtils";const o=n.default.getSingletonFactory(i)},"./src/streaming/utils/RequestModifier.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>a,modifyRequest:()=>function(e,t){var r={url:e.url,method:e.method,headers:Object.assign({},e.headers),credentials:e.withCredentials?"include":void 0};return Promise.resolve(t.modifyRequest(r)).then(function(){return Object.assign(e,r,{withCredentials:"include"===r.credentials})})}});r=r("./src/core/FactoryMaker.js");function n(){return{modifyRequest:null,modifyRequestURL:function(e){return e},modifyRequestHeader:function(e,t){return t.url,e}}}n.__dashjs_factory_name="RequestModifier";const a=r.default.getSingletonFactory(n)},"./src/streaming/utils/SegmentResponseModifier.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>a});r=r("./src/core/FactoryMaker.js");function n(){return{modifyResponseAsync:function(e){return Promise.resolve(e)}}}n.__dashjs_factory_name="SegmentResponseModifier";const a=r.default.getSingletonFactory(n)},"./src/streaming/utils/SupervisorTools.js":(e,t,r)=>{r.r(t),r.d(t,{checkInteger:()=>function(e){if(null===e||isNaN(e)||e%1!=0)throw n.default.BAD_ARGUMENT_ERROR+" : argument is not an integer"},checkIsVideoOrAudioType:()=>function(e){if("string"!=typeof e||e!==n.default.AUDIO&&e!==n.default.VIDEO)throw n.default.BAD_ARGUMENT_ERROR},checkParameterType:()=>function(e,t){if(a(e)!==t)throw n.default.BAD_ARGUMENT_ERROR},checkRange:()=>function(e,t,r){if(e<t||r<e)throw n.default.BAD_ARGUMENT_ERROR+" : argument out of range"}});var n=r("./src/streaming/constants/Constants.js");function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}},"./src/streaming/utils/TTMLParser.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>o});var t=r("./src/core/FactoryMaker.js"),n=r("./src/core/Debug.js"),a=r("./src/core/EventBus.js"),b=r("./src/core/events/Events.js"),S=r("./node_modules/imsc/src/main/js/main.js"),A=r("./src/streaming/MediaPlayerEvents.js"),R=r("./src/streaming/constants/ConformanceViolationConstants.js");function i(){var e,_,t=this.context,v=(0,a.default)(t).getInstance(),T=0;return e={parse:function(e,t,r,n,a){var i,o,s="",l=[],u={},c={},f="",d="",g={onOpenTag:function(e,t,r){r[" imagetype"]&&!r[" imageType"]&&(v.trigger(A.default.CONFORMANCE_VIOLATION,{level:R.default.LEVELS.ERROR,event:R.default.EVENTS.NON_COMPLIANT_SMPTE_IMAGE_ATTRIBUTE}),r[" imageType"]=r[" imagetype"]),"image"!==t||"http://www.smpte-ra.org/schemas/2052-1/2010/smpte-tt"!==e&&"http://www.smpte-ra.org/schemas/2052-1/2013/smpte-tt"!==e||(r[" imageType"]&&"PNG"===r[" imageType"].value?f=r["http://www.w3.org/XML/1998/namespace id"].value:_.warn("smpte-tt imageType != PNG. Discarded"))},onCloseTag:function(){f&&(c[f]=d.trim()),f=d=""},onText:function(e){f&&(d+=e)}};if(!e)throw s="no ttml data to parse",new Error(s);u.data=e,v.trigger(b.default.TTML_TO_PARSE,u);var h=(0,S.fromXML)(u.data,function(e){s=e},g);v.trigger(b.default.TTML_PARSED,{ttmlString:u.data,ttmlDoc:h});for(var m,p=h.getMediaTimeEvents(),y=0;y<p.length;y++){var E=(0,S.generateISD)(h,p[y],function(e){s=e});E.contents.some(function(e){return e.contents.length})&&(i=p[y]+t<r?r:p[y]+t)<(o=p[y+1]+t>n?n:p[y+1]+t)&&l.push({start:i,end:o,type:"html",cueID:(m=void 0,m="cue_TTML_"+T,T++,m),isd:E,images:a,embeddedImages:c})}if(""!==s)throw _.error(s),new Error(s);return l}},_=(0,n.default)(t).getInstance().getLogger(e),e}i.__dashjs_factory_name="TTMLParser";const o=t.default.getSingletonFactory(i)},"./src/streaming/utils/URLUtils.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>i});var t=r("./src/core/FactoryMaker.js"),n=r("./src/streaming/utils/DefaultURLUtils.js");function a(){var a,i=[],e=this.context;function r(e,t,r){var n=function(e){for(var t=0;t<i.length;t++)if(i[t].regex.test(e))return i[t].utils;return a}(r||t);return(n&&"function"==typeof n[e]?n:a)[e](t,r)}return a=(0,n.default)(e).getInstance(),{registerUrlRegex:function(e,t){i.push({regex:e,utils:t})},parseBaseUrl:function(e){return r("parseBaseUrl",e)},parseOrigin:function(e){return r("parseOrigin",e)},parseScheme:function(e){return r("parseScheme",e)},isRelative:function(e){return r("isRelative",e)},isPathAbsolute:function(e){return r("isPathAbsolute",e)},isSchemeRelative:function(e){return r("isSchemeRelative",e)},isHTTPURL:function(e){return r("isHTTPURL",e)},isHTTPS:function(e){return r("isHTTPS",e)},removeHostname:function(e){return r("removeHostname",e)},resolve:function(e,t){return r("resolve",e,t)}}}a.__dashjs_factory_name="URLUtils";const i=t.default.getSingletonFactory(a)},"./src/streaming/utils/VTTParser.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>i});var t=r("./src/core/FactoryMaker.js"),n=r("./src/core/Debug.js");function a(){var e,u,c,f,d,g,t=this.context;function h(e){var t=e.split(":"),r=t.length-1;return e=60*parseInt(t[r-1],10)+parseFloat(t[r]),2==r&&(e+=3600*parseInt(t[0],10)),e}return e={parse:function(e){var t=[];if(!e)return t;for(var r=(e=e.split(c)).length,n=-1,a=0;a<r;a++){var i,o,s,l=e[a];0<l.length&&"WEBVTT"!==l&&l.match(f)&&(i=void 0,(o=(i=(o=l).split(f))[1].split(g)).shift(),i[1]=o[0],o.shift(),l=(s={cuePoints:i,styles:function(e){var r={};return e.forEach(function(e){var t;1<e.split(/:/).length&&((t=e.split(/:/)[1])&&-1!=t.search(/%/)&&(t=parseInt(t.replace(/%/,""),10)),(e.match(/align/)||e.match(/A/))&&(r.align=t),(e.match(/line/)||e.match(/L/))&&(r.line=t),(e.match(/position/)||e.match(/P/))&&(r.position=t),(e.match(/size/)||e.match(/S/))&&(r.size=t))}),r}(o)}).cuePoints,i=s.styles,o=function(e,t){var r,n=t,a="",i="";for(;""!==e[n]&&n<e.length;)n++;if(1<(r=n-t))for(var o=0;o<r;o++){if((i=e[t+o]).match(f)){a="";break}a+=i,o!==r-1&&(a+="\n")}else(i=e[t]).match(f)||(a=i);return a}(e,a+1),s=h(l[0].replace(d,"")),l=h(l[1].replace(d,"")),!isNaN(s)&&!isNaN(l)&&n<=s&&s<l?""!==o?(n=s,t.push({start:s,end:l,data:o,styles:i})):u.error("Skipping cue due to empty/malformed cue text"):u.error("Skipping cue due to incorrect cue timing"))}return t}},u=(0,n.default)(t).getInstance().getLogger(e),c=/(?:\r\n|\r|\n)/gm,f=/-->/,d=/(^[\s]+|[\s]+$)/g,g=/\s\b/g,e}a.__dashjs_factory_name="VTTParser";const i=t.default.getSingletonFactory(a)},"./src/streaming/utils/VttCustomRenderingParser.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>a});r=r("./src/core/FactoryMaker.js");function n(){var e,r;return e={parse:function(e){var t=[];return r.oncue=function(e){e.start=e.startTime,e.end=e.endTime,e.data=e.text,e.styles={align:e.align,line:e.line,position:e.position,size:e.size},t.push(e)},r.parse(e),t}},function(){try{window&&window.WebVTT&&window.WebVTT.Parser&&(r=new window.WebVTT.Parser(window,window.vttjs,window.WebVTT.StringDecoder()))}catch(e){}}(),e}n.__dashjs_factory_name="VttCustomRenderingParser";const a=r.default.getSingletonFactory(n)},"./src/streaming/utils/baseUrlResolution/BasicSelector.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>a});r=r("./src/core/FactoryMaker.js");function n(e){var n=(e=e||{}).blacklistController;return{select:function(e){var t,r=0;return t=e&&e.some(function(e,t){return r=t,!n.contains(e.serviceLocation)})?e[r]:t}}}n.__dashjs_factory_name="BasicSelector";const a=r.default.getClassFactory(n)},"./src/streaming/utils/baseUrlResolution/ContentSteeringSelector.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>a});var t=r("./src/core/FactoryMaker.js"),i=r("./src/dash/controllers/ContentSteeringController.js");function n(){var e,n,o,t=this.context;function a(e,t){for(var r=0<arguments.length&&void 0!==e?e:[],n=1<arguments.length&&void 0!==t?t:[],a=0,i=NaN;a<r.length;)if("break"===function(){var t=r[a],e=n.findIndex(function(e){return e.serviceLocation&&e.serviceLocation===t});if(-1!==e&&!o.contains(n[e].serviceLocation))return i=e,"break";a+=1}())break;return i}return e={selectBaseUrlIndex:function(e){var t=NaN;!isNaN(e.selectedIdx)||(r=n.getSteeringDataFromManifest())&&r.defaultServiceLocation&&(t=a([r.defaultServiceLocation],e.baseUrls));var r=n.getCurrentSteeringResponseData();return t=e.baseUrls&&e.baseUrls.length&&r&&r.serviceLocationPriority&&r.serviceLocationPriority.length?a(r.serviceLocationPriority,e.baseUrls):t},setConfig:function(e){e.blacklistController&&(o=e.blacklistController),e.contentSteeringController&&(n=e.contentSteeringController)}},n=(0,i.default)(t).getInstance(),e}n.__dashjs_factory_name="ContentSteeringSelector";const a=t.default.getClassFactory(n)},"./src/streaming/utils/baseUrlResolution/DVBSelector.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>a});r=r("./src/core/FactoryMaker.js");function n(e){var r=(e=e||{}).blacklistController;return{select:function(e){return e&&function(e){var r,t=0,n=[],a=0;if((e=e.sort(function(e,t){t=e.dvb_priority-t.dvb_priority;return isNaN(t)?0:t}).filter(function(e,t,r){return!t||r[0].dvb_priority&&e.dvb_priority&&r[0].dvb_priority===e.dvb_priority})).length)return 1<e.length&&(e.forEach(function(e){t+=e.dvb_weight,n.push(t)}),r=Math.floor(Math.random()*(t-1)),n.every(function(e,t){return a=t,!(r<e)})),e[a]}((t=[],e.filter(function(e){return!r.contains(e.serviceLocation)||(e.dvb_priority&&t.push(e.dvb_priority),!1)}).filter(function(e){return!t.length||!e.dvb_priority||-1===t.indexOf(e.dvb_priority)})));var t}}}n.__dashjs_factory_name="DVBSelector";const a=r.default.getClassFactory(n)},"./src/streaming/vo/BitrateInfo.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>n});const n=function t(){!function(e){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),this.mediaType=null,this.bitrate=null,this.width=null,this.height=null,this.scanType=null,this.qualityIndex=NaN}},"./src/streaming/vo/DashJSError.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>n});const n=function t(e,r,n){!function(e){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),this.code=e||null,this.message=r||null,this.data=n||null}},"./src/streaming/vo/DataChunk.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>n});const n=function t(){!function(e){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),this.streamId=null,this.mediaInfo=null,this.segmentType=null,this.quality=NaN,this.index=NaN,this.bytes=null,this.start=NaN,this.end=NaN,this.duration=NaN,this.representationId=null,this.endFragment=null}},"./src/streaming/vo/FragmentRequest.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>n});var a=r("./src/streaming/vo/metrics/HTTPRequest.js");function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}r=function(){function t(e){!function(e){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),this.action=t.ACTION_DOWNLOAD,this.startTime=NaN,this.mediaStartTime=NaN,this.mediaType=null,this.mediaInfo=null,this.type=null,this.duration=NaN,this.timescale=NaN,this.range=null,this.url=e||null,this.serviceLocation=null,this.requestStartDate=null,this.firstByteDate=null,this.requestEndDate=null,this.quality=NaN,this.index=NaN,this.availabilityStartTime=null,this.availabilityEndTime=null,this.wallStartTime=null,this.bytesLoaded=NaN,this.bytesTotal=NaN,this.delayLoadingTime=NaN,this.responseType="arraybuffer",this.representationId=null}var e,r,n;return e=t,(r=[{key:"isInitializationRequest",value:function(){return this.type&&this.type===a.HTTPRequest.INIT_SEGMENT_TYPE}},{key:"setInfo",value:function(e){this.type=e&&e.init?a.HTTPRequest.INIT_SEGMENT_TYPE:a.HTTPRequest.MEDIA_SEGMENT_TYPE,this.url=e&&e.url?e.url:null,this.range=e&&e.range?e.range.start+"-"+e.range.end:null,this.mediaType=e&&e.mediaType?e.mediaType:null}}])&&i(e.prototype,r),n&&i(e,n),t}();r.ACTION_DOWNLOAD="download",r.ACTION_COMPLETE="complete";const n=r},"./src/streaming/vo/HeadRequest.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>l});var n=r("./src/streaming/vo/FragmentRequest.js");function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){return(i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function o(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=s(r);return e=n?(e=s(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),t=this,!(e=e)||"object"!==a(e)&&"function"!=typeof e?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(t):e}}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}const l=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&i(e,t)}(r,n["default"]);var t=o(r);function r(e){return function(e){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}(this),(e=t.call(this,e)).checkForExistenceOnly=!0,e}return r}()},"./src/streaming/vo/IsoBox.js":(e,t,r)=>{function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}r.r(t),r.d(t,{default:()=>a});const a=function(){function s(e){if(!function(e){if(!(e instanceof s))throw new TypeError("Cannot call a class as a function")}(this),this.offset=e._offset,this.type=e.type,this.size=e.size,this.boxes=[],e.boxes)for(var t=0;t<e.boxes.length;t++)this.boxes.push(new s(e.boxes[t]));switch(this.isComplete=!0,e.type){case"sidx":if(this.timescale=e.timescale,this.earliest_presentation_time=e.earliest_presentation_time,this.first_offset=e.first_offset,this.references=e.references,e.references){this.references=[];for(var r=0;r<e.references.length;r++){var n={reference_type:e.references[r].reference_type,referenced_size:e.references[r].referenced_size,subsegment_duration:e.references[r].subsegment_duration};this.references.push(n)}}break;case"emsg":this.id=e.id,this.version=1===e.version?1:0,this.value=e.value,this.timescale=e.timescale,this.scheme_id_uri=e.scheme_id_uri,this.presentation_time_delta=1===e.version?e.presentation_time:e.presentation_time_delta,this.event_duration=e.event_duration,this.message_data=e.message_data;break;case"mdhd":this.timescale=e.timescale;break;case"mfhd":this.sequence_number=e.sequence_number;break;case"subs":this.entry_count=e.entry_count,this.entries=e.entries;break;case"tfhd":this.base_data_offset=e.base_data_offset,this.sample_description_index=e.sample_description_index,this.default_sample_duration=e.default_sample_duration,this.default_sample_size=e.default_sample_size,this.default_sample_flags=e.default_sample_flags,this.flags=e.flags;break;case"tfdt":this.version=e.version,this.baseMediaDecodeTime=e.baseMediaDecodeTime,this.flags=e.flags;break;case"trun":if(this.sample_count=e.sample_count,this.first_sample_flags=e.first_sample_flags,this.data_offset=e.data_offset,this.flags=e.flags,this.samples=e.samples,e.samples){this.samples=[];for(var a=0,i=e.samples.length;a<i;a++){var o={sample_size:e.samples[a].sample_size,sample_duration:e.samples[a].sample_duration,sample_composition_time_offset:e.samples[a].sample_composition_time_offset};this.samples.push(o)}}}}var e,t,r;return e=s,(t=[{key:"getChildBox",value:function(e){for(var t=0;t<this.boxes.length;t++)if(this.boxes[t].type===e)return this.boxes[t]}},{key:"getChildBoxes",value:function(e){for(var t=[],r=0;r<this.boxes.length;r++)this.boxes[r].type===e&&t.push(this.boxes[r]);return t}}])&&n(e.prototype,t),r&&n(e,r),s}()},"./src/streaming/vo/IsoBoxSearchInfo.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>n});const n=function t(e,r,n){!function(e){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),this.lastCompletedOffset=e,this.found=r,this.size=n}},"./src/streaming/vo/MetricsList.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>n});const n=function t(){!function(e){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),this.TcpList=[],this.HttpList=[],this.RepSwitchList=[],this.BufferLevel=[],this.BufferState=[],this.PlayList=[],this.DroppedFrames=[],this.SchedulingInfo=[],this.DVRInfo=[],this.ManifestUpdate=[],this.RequestsQueue=null,this.DVBErrors=[]}},"./src/streaming/vo/TextRequest.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>n});var i=r("./src/streaming/constants/Constants.js"),o=r("./src/streaming/vo/FragmentRequest.js");function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(e,t){return(s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function l(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=u(r);return e=n?(e=u(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),t=this,!(e=e)||"object"!==a(e)&&"function"!=typeof e?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(t):e}}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}const n=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&s(e,t)}(a,o["default"]);var n=l(a);function a(e,t){var r;return function(e){if(!(e instanceof a))throw new TypeError("Cannot call a class as a function")}(this),(r=n.call(this)).url=e||null,r.type=t||null,r.mediaType=i.default.STREAM,r.responseType="",r}return a}()},"./src/streaming/vo/TextTrackInfo.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>l});var n=r("./src/dash/vo/MediaInfo.js");function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){return(i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function o(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=s(r);return e=n?(e=s(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),t=this,!(e=e)||"object"!==a(e)&&"function"!=typeof e?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(t):e}}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}const l=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&i(e,t)}(r,n["default"]);var t=o(r);function r(){var e;return function(e){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}(this),(e=t.call(this)).captionData=null,e.label=null,e.defaultTrack=!1,e.kind=null,e.isFragmented=!1,e.isEmbedded=!1,e.isTTML=null,e}return r}()},"./src/streaming/vo/Thumbnail.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>n});const n=function t(){!function(e){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),this.url=null,this.width=null,this.height=null,this.x=null,this.y=null}},"./src/streaming/vo/ThumbnailTrackInfo.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>n});const n=function t(){!function(e){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),this.bitrate=0,this.width=0,this.height=0,this.tilesHor=0,this.tilesVert=0,this.widthPerTile=0,this.heightPerTile=0,this.startNumber=0,this.segmentDuration=0,this.timescale=0,this.templateUrl="",this.id=""}},"./src/streaming/vo/URIFragmentData.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>n});const n=function t(){!function(e){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),this.t=null,this.xywh=null,this.track=null,this.id=null,this.s=null,this.r=null}},"./src/streaming/vo/metrics/BufferLevel.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>n});const n=function t(){!function(e){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),this.t=null,this.level=null}},"./src/streaming/vo/metrics/BufferState.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>a});var n=r("./src/streaming/constants/MetricsConstants.js");const a=function t(){!function(e){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),this.target=null,this.state=n.default.BUFFER_EMPTY}},"./src/streaming/vo/metrics/DVRInfo.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>n});const n=function t(){!function(e){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),this.time=null,this.range=null,this.manifestInfo=null}},"./src/streaming/vo/metrics/DroppedFrames.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>n});const n=function t(){!function(e){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),this.time=null,this.droppedFrames=null}},"./src/streaming/vo/metrics/HTTPRequest.js":(e,t,r)=>{function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}r.r(t),r.d(t,{HTTPRequest:()=>a,HTTPRequestTrace:()=>i});var a=function e(){n(this,e),this.tcpid=null,this.type=null,this.url=null,this.actualurl=null,this.range=null,this.trequest=null,this.tresponse=null,this.responsecode=null,this.interval=null,this.trace=[],this.cmsd=null,this._stream=null,this._tfinish=null,this._mediaduration=null,this._quality=null,this._responseHeaders=null,this._serviceLocation=null,this._fileLoaderType=null},i=function e(){n(this,e),this.s=null,this.d=null,this.b=[]};a.GET="GET",a.HEAD="HEAD",a.MPD_TYPE="MPD",a.XLINK_EXPANSION_TYPE="XLinkExpansion",a.INIT_SEGMENT_TYPE="InitializationSegment",a.INDEX_SEGMENT_TYPE="IndexSegment",a.MEDIA_SEGMENT_TYPE="MediaSegment",a.BITSTREAM_SWITCHING_SEGMENT_TYPE="BitstreamSwitchingSegment",a.MSS_FRAGMENT_INFO_SEGMENT_TYPE="FragmentInfoSegment",a.DVB_REPORTING_TYPE="DVBReporting",a.LICENSE="license",a.CONTENT_STEERING_TYPE="ContentSteering",a.OTHER_TYPE="other"},"./src/streaming/vo/metrics/ManifestUpdate.js":(e,t,r)=>{function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}r.r(t),r.d(t,{ManifestUpdate:()=>a,ManifestUpdateRepresentationInfo:()=>o,ManifestUpdateStreamInfo:()=>i});var a=function e(){n(this,e),this.mediaType=null,this.type=null,this.requestTime=null,this.fetchTime=null,this.availabilityStartTime=null,this.presentationStartTime=0,this.clientTimeOffset=0,this.currentTime=null,this.buffered=null,this.latency=0,this.streamInfo=[],this.representationInfo=[]},i=function e(){n(this,e),this.id=null,this.index=null,this.start=null,this.duration=null},o=function e(){n(this,e),this.id=null,this.index=null,this.mediaType=null,this.streamIndex=null,this.presentationTimeOffset=null,this.startNumber=null,this.fragmentInfoType=null}},"./src/streaming/vo/metrics/PlayList.js":(e,t,r)=>{function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}r.r(t),r.d(t,{PlayList:()=>a,PlayListTrace:()=>i});var a=function e(){n(this,e),this.start=null,this.mstart=null,this.starttype=null,this.trace=[]};a.INITIAL_PLAYOUT_START_REASON="initial_playout",a.SEEK_START_REASON="seek",a.RESUME_FROM_PAUSE_START_REASON="resume",a.METRICS_COLLECTION_START_REASON="metrics_collection_start";var i=function e(){n(this,e),this.representationid=null,this.subreplevel=null,this.start=null,this.mstart=null,this.duration=null,this.playbackspeed=null,this.stopreason=null};i.REPRESENTATION_SWITCH_STOP_REASON="representation_switch",i.REBUFFERING_REASON="rebuffering",i.USER_REQUEST_STOP_REASON="user_request",i.END_OF_PERIOD_STOP_REASON="end_of_period",i.END_OF_CONTENT_STOP_REASON="end_of_content",i.METRICS_COLLECTION_STOP_REASON="metrics_collection_end",i.FAILURE_STOP_REASON="failure"},"./src/streaming/vo/metrics/RepresentationSwitch.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>n});const n=function t(){!function(e){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),this.t=null,this.mt=null,this.to=null,this.lto=null}},"./src/streaming/vo/metrics/RequestsQueue.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>n});const n=function t(){!function(e){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),this.loadingRequests=[],this.executedRequests=[]}},"./src/streaming/vo/metrics/SchedulingInfo.js":(e,t,r)=>{r.r(t),r.d(t,{default:()=>n});const n=function t(){!function(e){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),this.mediaType=null,this.t=null,this.type=null,this.startTime=null,this.availabilityStartTime=null,this.duration=null,this.quality=null,this.range=null,this.state=null}},"./node_modules/bcp-47-match/index.js":(e,t)=>{function r(u,c){return function(e,t){var r,n,a,i=f(e,"tag"),o=f(null==t?"*":t,"range"),s=[],l=-1;for(;++l<o.length;)if(r=o[l].toLowerCase(),c||"*"!==r){for(n=-1,a=[];++n<i.length;)if(u(i[n].toLowerCase(),r)){if(!c)return i[n];s.push(i[n])}else a.push(i[n]);i=a}return c?s:void 0}}function f(e,t){e=e&&"string"==typeof e?[e]:e;if(!(e&&"object"==typeof e&&"length"in e))throw new Error("Invalid "+t+" `"+e+"`, expected non-empty string");return e}t.basicFilter=r(function(e,t){return"*"===t||e===t||-1<e.indexOf(t+"-")},!0),t.extendedFilter=r(function(e,t){var r=e.split("-"),n=t.split("-"),a=0,i=0;if("*"!==n[i]&&r[a]!==n[i])return;a++,i++;for(;i<n.length;)if("*"!==n[i]){if(!r[a])return;if(r[a]!==n[i]){if(1===r[a].length)return;a++}else a++,i++}else i++;return 1},!0),t.lookup=r(function(e,t){var r,n=t;for(;;){if("*"===n||e===n)return 1;if((r=n.lastIndexOf("-"))<0)return;"-"===n.charAt(r-2)&&(r-=2),n=n.slice(0,r)}})},"./node_modules/bcp-47-normalize/index.js":(e,t,r)=>{e.exports=r("./node_modules/bcp-47-normalize/lib/index.js")},"./node_modules/bcp-47-normalize/lib/index.js":(e,t,r)=>{var s=r("./node_modules/bcp-47/index.js"),l=r("./node_modules/bcp-47-match/index.js"),u=r("./node_modules/bcp-47-normalize/lib/matches.json"),c=r("./node_modules/bcp-47-normalize/lib/fields.json"),f=r("./node_modules/bcp-47-normalize/lib/defaults.json"),d=r("./node_modules/bcp-47-normalize/lib/many.json");e.exports=function(e,t){var r,n=t||{},a=s.parse(String(e||"").toLowerCase(),n),i=s.stringify(a),o=-1;if(!i)return i;for(;++o<u.length;)l.extendedFilter(i,u[o].from).length&&(m(a,u[o].from,u[o].to),i=s.stringify(a));o=-1;for(;++o<c.length;)p(a,c[o].from.field,c[o].from.value)&&y(a,c[o].to.field,c[o].to.value);i=s.stringify(Object.assign({},a,h)),o=-1;for(;++o<f.length;)i===f[o]&&(m(a,f[o],f[o].split("-").slice(0,-1).join("-")),i=s.stringify(Object.assign({},a,h)));if(a.extensions.sort(E),n.warning)for(r in d)g.call(d[r],a[r])&&n.warning("Deprecated "+r+" `"+a[r]+"`, expected one of `"+d[r][a[r]].join("`, `")+"`",null,7);a.script&&(a.script=a.script.charAt(0).toUpperCase()+a.script.slice(1));a.region&&(a.region=a.region.toUpperCase());return s.stringify(a)};var g={}.hasOwnProperty,n=new Intl.Collator,h={variants:[],extensions:[],privateuse:[],irregular:null,regular:null};function m(e,t,r){var n,a=s.parse(t),i=s.parse(r),o=[];for(n in a)a[n]&&a[n].length&&p(e,n,a[n])&&o.push(n);for(n in i)i[n]&&i[n].length&&(-1<o.indexOf(n)||!e[n]||!e[n].length)&&y(e,n,i[n])}function p(e,t,r){var n,a,i,o,s=!1;if(r){if((a=n=e[t])&&"object"==typeof n)for(a=[],i=-1;++i<n.length;)o=n[i],r.indexOf(o)<0?a.push(o):s=!0;else n===r&&(s=!(a=null));e[t]=a}return s}function y(e,t,r){var n,a,i,o=e[t];if(o&&"object"==typeof o)for(n=[].concat(r),a=-1;++a<n.length;)i=n[a],o.indexOf(i)<0&&o.push(i);else e[t]=r}function E(e,t){return n.compare(e.singleton,t.singleton)}},"./node_modules/bcp-47/index.js":(e,t,r)=>{t.parse=r("./node_modules/bcp-47/lib/parse.js"),t.stringify=r("./node_modules/bcp-47/lib/stringify.js")},"./node_modules/bcp-47/lib/parse.js":(e,t,r)=>{var d=r("./node_modules/is-alphanumerical/index.js"),g=r("./node_modules/is-alphabetical/index.js"),h=r("./node_modules/is-decimal/index.js"),m=r("./node_modules/bcp-47/lib/regular.json"),p=r("./node_modules/bcp-47/lib/normalize.json");e.exports=function e(t,r){var n=r||{};var a=E();var i=String(t);var o=i.toLowerCase();var s=0;var l;var u;var c;if(null==t)throw new Error("Expected string, got `"+t+"`");if(y.call(p,o))return(null==n.normalize||n.normalize)&&p[o]?e(p[o]):(a[-1===m.indexOf(o)?"irregular":"regular"]=i,a);for(;g(o.charCodeAt(s))&&s<9;)s++;if(1<s&&s<9){if(a.language=i.slice(0,s),s<4)for(u=0;45===o.charCodeAt(s)&&g(o.charCodeAt(s+1))&&g(o.charCodeAt(s+2))&&g(o.charCodeAt(s+3))&&!g(o.charCodeAt(s+4));){if(2<u)return f(s,3,"Too many extended language subtags, expected at most 3 subtags");a.extendedLanguageSubtags.push(i.slice(s+1,s+4)),s+=4,u++}for(45===o.charCodeAt(s)&&g(o.charCodeAt(s+1))&&g(o.charCodeAt(s+2))&&g(o.charCodeAt(s+3))&&g(o.charCodeAt(s+4))&&!g(o.charCodeAt(s+5))&&(a.script=i.slice(s+1,s+5),s+=5),45===o.charCodeAt(s)&&(g(o.charCodeAt(s+1))&&g(o.charCodeAt(s+2))&&!g(o.charCodeAt(s+3))?(a.region=i.slice(s+1,s+3),s+=3):h(o.charCodeAt(s+1))&&h(o.charCodeAt(s+2))&&h(o.charCodeAt(s+3))&&!h(o.charCodeAt(s+4))&&(a.region=i.slice(s+1,s+4),s+=4));45===o.charCodeAt(s);){for(c=l=s+1;d(o.charCodeAt(c));){if(7<c-l)return f(c,1,"Too long variant, expected at most 8 characters");c++}if(!(4<c-l||3<c-l&&h(o.charCodeAt(l))))break;a.variants.push(i.slice(l,c)),s=c}for(;45===o.charCodeAt(s)&&120!==o.charCodeAt(s+1)&&d(o.charCodeAt(s+1))&&45===o.charCodeAt(s+2)&&d(o.charCodeAt(s+3));){for(c=s+2,u=0;45===o.charCodeAt(c)&&d(o.charCodeAt(c+1))&&d(o.charCodeAt(c+2));)for(c=(l=c+1)+2,u++;d(o.charCodeAt(c));){if(7<c-l)return f(c,2,"Too long extension, expected at most 8 characters");c++}if(!u)return f(c,4,"Empty extension, extensions must have at least 2 characters of content");a.extensions.push({singleton:i.charAt(s+1),extensions:i.slice(s+3,c).split("-")}),s=c}}else s=0;if(0===s&&120===o.charCodeAt(s)||45===o.charCodeAt(s)&&120===o.charCodeAt(s+1))for(c=s=s?s+2:1;45===o.charCodeAt(c)&&d(o.charCodeAt(c+1));){for(c=l=s+1;d(o.charCodeAt(c));){if(7<c-l)return f(c,5,"Too long private-use area, expected at most 8 characters");c++}a.privateuse.push(i.slice(s+1,c)),s=c}if(s!==i.length)return f(s,6,"Found superfluous content after tag");return a;function f(e,t,r){return n.warning&&n.warning(r,t,e),n.forgiving?a:E()}};var y={}.hasOwnProperty;function E(){return{language:null,extendedLanguageSubtags:[],script:null,region:null,variants:[],extensions:[],privateuse:[],irregular:null,regular:null}}},"./node_modules/bcp-47/lib/stringify.js":e=>{e.exports=function(e){var t,r,n,e=e||{},a=[];if(e.irregular||e.regular)return e.irregular||e.regular;if(e.language)for(a=a.concat(e.language,e.extendedLanguageSubtags||[],e.script||[],e.region||[],e.variants||[]),t=e.extensions||[],r=-1;++r<t.length;)(n=t[r]).singleton&&n.extensions&&n.extensions.length&&(a=a.concat(n.singleton,n.extensions));e.privateuse&&e.privateuse.length&&(a=a.concat("x",e.privateuse));return a.join("-")}},"./node_modules/buffer/index.js":(e,r,t)=>{
/*!
             * The buffer module from node.js, for the browser.
             *
             * @author   Feross Aboukhadijeh <https://feross.org>
             * @license  MIT
             */
var s=t("./node_modules/buffer/node_modules/base64-js/index.js"),i=t("./node_modules/buffer/node_modules/ieee754/index.js"),t="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;r.Buffer=f,r.SlowBuffer=function(e){+e!=e&&(e=0);return f.alloc(+e)},r.INSPECT_MAX_BYTES=50;var n=2147483647;function a(e){if(n<e)throw new RangeError('The value "'+e+'" is invalid for option "size"');e=new Uint8Array(e);return Object.setPrototypeOf(e,f.prototype),e}function f(e,t,r){if("number"!=typeof e)return o(e,t,r);if("string"==typeof t)throw new TypeError('The "string" argument must be of type string. Received type number');return u(e)}function o(e,t,r){if("string"==typeof e)return function(e,t){"string"==typeof t&&""!==t||(t="utf8");if(!f.isEncoding(t))throw new TypeError("Unknown encoding: "+t);var r=0|h(e,t),n=a(r),t=n.write(e,t);t!==r&&(n=n.slice(0,t));return n}(e,t);if(ArrayBuffer.isView(e))return function(e){if(O(e,Uint8Array)){var t=new Uint8Array(e);return d(t.buffer,t.byteOffset,t.byteLength)}return c(e)}(e);if(null==e)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);if(O(e,ArrayBuffer)||e&&O(e.buffer,ArrayBuffer))return d(e,t,r);if("undefined"!=typeof SharedArrayBuffer&&(O(e,SharedArrayBuffer)||e&&O(e.buffer,SharedArrayBuffer)))return d(e,t,r);if("number"==typeof e)throw new TypeError('The "value" argument must not be of type number. Received type number');var n=e.valueOf&&e.valueOf();if(null!=n&&n!==e)return f.from(n,t,r);n=function(e){if(f.isBuffer(e)){var t=0|g(e.length),r=a(t);return 0===r.length?r:(e.copy(r,0,0,t),r)}if(void 0!==e.length)return"number"!=typeof e.length||P(e.length)?a(0):c(e);if("Buffer"===e.type&&Array.isArray(e.data))return c(e.data)}(e);if(n)return n;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof e[Symbol.toPrimitive])return f.from(e[Symbol.toPrimitive]("string"),t,r);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}function l(e){if("number"!=typeof e)throw new TypeError('"size" argument must be of type number');if(e<0)throw new RangeError('The value "'+e+'" is invalid for option "size"')}function u(e){return l(e),a(e<0?0:0|g(e))}function c(e){for(var t=e.length<0?0:0|g(e.length),r=a(t),n=0;n<t;n+=1)r[n]=255&e[n];return r}function d(e,t,r){if(t<0||e.byteLength<t)throw new RangeError('"offset" is outside of buffer bounds');if(e.byteLength<t+(r||0))throw new RangeError('"length" is outside of buffer bounds');r=void 0===t&&void 0===r?new Uint8Array(e):void 0===r?new Uint8Array(e,t):new Uint8Array(e,t,r);return Object.setPrototypeOf(r,f.prototype),r}function g(e){if(n<=e)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+n.toString(16)+" bytes");return 0|e}function h(e,t){if(f.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||O(e,ArrayBuffer))return e.byteLength;if("string"!=typeof e)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);var r=e.length,n=2<arguments.length&&!0===arguments[2];if(!n&&0===r)return 0;for(var a=!1;;)switch(t){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":return N(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return D(e).length;default:if(a)return n?-1:N(e).length;t=(""+t).toLowerCase(),a=!0}}function m(e,t,r){var n,a,i,o=!1;if((t=void 0===t||t<0?0:t)>this.length)return"";if((r=void 0===r||r>this.length?this.length:r)<=0)return"";if((r>>>=0)<=(t>>>=0))return"";for(e=e||"utf8";;)switch(e){case"hex":return function(e,t,r){var n=e.length;(!t||t<0)&&(t=0);(!r||r<0||n<r)&&(r=n);for(var a="",i=t;i<r;++i)a+=L[e[i]];return a}(this,t,r);case"utf8":case"utf-8":return T(this,t,r);case"ascii":return function(e,t,r){var n="";r=Math.min(e.length,r);for(var a=t;a<r;++a)n+=String.fromCharCode(127&e[a]);return n}(this,t,r);case"latin1":case"binary":return function(e,t,r){var n="";r=Math.min(e.length,r);for(var a=t;a<r;++a)n+=String.fromCharCode(e[a]);return n}(this,t,r);case"base64":return n=this,i=r,0===(a=t)&&i===n.length?s.fromByteArray(n):s.fromByteArray(n.slice(a,i));case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return function(e,t,r){for(var n=e.slice(t,r),a="",i=0;i<n.length-1;i+=2)a+=String.fromCharCode(n[i]+256*n[i+1]);return a}(this,t,r);default:if(o)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),o=!0}}function p(e,t,r){var n=e[t];e[t]=e[r],e[r]=n}function y(e,t,r,n,a){if(0===e.length)return-1;if("string"==typeof r?(n=r,r=0):2147483647<r?r=2147483647:r<-2147483648&&(r=-2147483648),(r=(r=P(r=+r)?a?0:e.length-1:r)<0?e.length+r:r)>=e.length){if(a)return-1;r=e.length-1}else if(r<0){if(!a)return-1;r=0}if("string"==typeof t&&(t=f.from(t,n)),f.isBuffer(t))return 0===t.length?-1:E(e,t,r,n,a);if("number"==typeof t)return t&=255,"function"==typeof Uint8Array.prototype.indexOf?(a?Uint8Array.prototype.indexOf:Uint8Array.prototype.lastIndexOf).call(e,t,r):E(e,[t],r,n,a);throw new TypeError("val must be string, number or Buffer")}function E(e,t,r,n,a){var i=1,o=e.length,s=t.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(e.length<2||t.length<2)return-1;o/=i=2,s/=2,r/=2}function l(e,t){return 1===i?e[t]:e.readUInt16BE(t*i)}if(a)for(var u=-1,c=r;c<o;c++)if(l(e,c)===l(t,-1===u?0:c-u)){if(c-(u=-1===u?c:u)+1===s)return u*i}else-1!==u&&(c-=c-u),u=-1;else for(c=r=o<r+s?o-s:r;0<=c;c--){for(var f=!0,d=0;d<s;d++)if(l(e,c+d)!==l(t,d)){f=!1;break}if(f)return c}return-1}function _(e,t,r,n){return M(function(e){for(var t=[],r=0;r<e.length;++r)t.push(255&e.charCodeAt(r));return t}(t),e,r,n)}function v(e,t,r,n){return M(function(e,t){for(var r,n,a=[],i=0;i<e.length&&!((t-=2)<0);++i)n=e.charCodeAt(i),r=n>>8,n=n%256,a.push(n),a.push(r);return a}(t,e.length-r),e,r,n)}function T(e,t,r){r=Math.min(e.length,r);for(var n=[],a=t;a<r;){var i,o,s,l,u=e[a],c=null,f=239<u?4:223<u?3:191<u?2:1;if(a+f<=r)switch(f){case 1:u<128&&(c=u);break;case 2:128==(192&(i=e[a+1]))&&127<(l=(31&u)<<6|63&i)&&(c=l);break;case 3:i=e[a+1],o=e[a+2],128==(192&i)&&128==(192&o)&&2047<(l=(15&u)<<12|(63&i)<<6|63&o)&&(l<55296||57343<l)&&(c=l);break;case 4:i=e[a+1],o=e[a+2],s=e[a+3],128==(192&i)&&128==(192&o)&&128==(192&s)&&65535<(l=(15&u)<<18|(63&i)<<12|(63&o)<<6|63&s)&&l<1114112&&(c=l)}null===c?(c=65533,f=1):65535<c&&(c-=65536,n.push(c>>>10&1023|55296),c=56320|1023&c),n.push(c),a+=f}return function(e){var t=e.length;if(t<=b)return String.fromCharCode.apply(String,e);var r="",n=0;for(;n<t;)r+=String.fromCharCode.apply(String,e.slice(n,n+=b));return r}(n)}r.kMaxLength=n,(f.TYPED_ARRAY_SUPPORT=function(){try{var e=new Uint8Array(1),t={foo:function(){return 42}};return Object.setPrototypeOf(t,Uint8Array.prototype),Object.setPrototypeOf(e,t),42===e.foo()}catch(e){return!1}}())||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(f.prototype,"parent",{enumerable:!0,get:function(){if(f.isBuffer(this))return this.buffer}}),Object.defineProperty(f.prototype,"offset",{enumerable:!0,get:function(){if(f.isBuffer(this))return this.byteOffset}}),f.poolSize=8192,f.from=o,Object.setPrototypeOf(f.prototype,Uint8Array.prototype),Object.setPrototypeOf(f,Uint8Array),f.alloc=function(e,t,r){return t=t,r=r,l(e=e),!(e<=0)&&void 0!==t?"string"==typeof r?a(e).fill(t,r):a(e).fill(t):a(e)},f.allocUnsafe=u,f.allocUnsafeSlow=u,f.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==f.prototype},f.compare=function(e,t){if(O(e,Uint8Array)&&(e=f.from(e,e.offset,e.byteLength)),O(t,Uint8Array)&&(t=f.from(t,t.offset,t.byteLength)),!f.isBuffer(e)||!f.isBuffer(t))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;for(var r=e.length,n=t.length,a=0,i=Math.min(r,n);a<i;++a)if(e[a]!==t[a]){r=e[a],n=t[a];break}return r<n?-1:n<r?1:0},f.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},f.concat=function(e,t){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return f.alloc(0);if(void 0===t)for(a=t=0;a<e.length;++a)t+=e[a].length;for(var r=f.allocUnsafe(t),n=0,a=0;a<e.length;++a){var i=e[a];if(O(i,Uint8Array))n+i.length>r.length?f.from(i).copy(r,n):Uint8Array.prototype.set.call(r,i,n);else{if(!f.isBuffer(i))throw new TypeError('"list" argument must be an Array of Buffers');i.copy(r,n)}n+=i.length}return r},f.byteLength=h,f.prototype._isBuffer=!0,f.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)p(this,t,t+1);return this},f.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)p(this,t,t+3),p(this,t+1,t+2);return this},f.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)p(this,t,t+7),p(this,t+1,t+6),p(this,t+2,t+5),p(this,t+3,t+4);return this},f.prototype.toLocaleString=f.prototype.toString=function(){var e=this.length;return 0===e?"":0===arguments.length?T(this,0,e):m.apply(this,arguments)},f.prototype.equals=function(e){if(!f.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===f.compare(this,e)},f.prototype.inspect=function(){var e="",t=r.INSPECT_MAX_BYTES,e=this.toString("hex",0,t).replace(/(.{2})/g,"$1 ").trim();return this.length>t&&(e+=" ... "),"<Buffer "+e+">"},t&&(f.prototype[t]=f.prototype.inspect),f.prototype.compare=function(e,t,r,n,a){if(O(e,Uint8Array)&&(e=f.from(e,e.offset,e.byteLength)),!f.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(void 0===t&&(t=0),void 0===r&&(r=e?e.length:0),void 0===n&&(n=0),void 0===a&&(a=this.length),t<0||r>e.length||n<0||a>this.length)throw new RangeError("out of range index");if(a<=n&&r<=t)return 0;if(a<=n)return-1;if(r<=t)return 1;if(this===e)return 0;for(var i=(a>>>=0)-(n>>>=0),o=(r>>>=0)-(t>>>=0),s=Math.min(i,o),l=this.slice(n,a),u=e.slice(t,r),c=0;c<s;++c)if(l[c]!==u[c]){i=l[c],o=u[c];break}return i<o?-1:o<i?1:0},f.prototype.includes=function(e,t,r){return-1!==this.indexOf(e,t,r)},f.prototype.indexOf=function(e,t,r){return y(this,e,t,r,!0)},f.prototype.lastIndexOf=function(e,t,r){return y(this,e,t,r,!1)},f.prototype.write=function(e,t,r,n){if(void 0===t)n="utf8",r=this.length,t=0;else if(void 0===r&&"string"==typeof t)n=t,r=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t>>>=0,isFinite(r)?(r>>>=0,void 0===n&&(n="utf8")):(n=r,r=void 0)}var a=this.length-t;if((void 0===r||a<r)&&(r=a),0<e.length&&(r<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");n=n||"utf8";for(var i,o,s,l=!1;;)switch(n){case"hex":return function(e,t,r,n){r=Number(r)||0;var a=e.length-r;(!n||a<(n=Number(n)))&&(n=a),(a=t.length)/2<n&&(n=a/2);for(var i=0;i<n;++i){var o=parseInt(t.substr(2*i,2),16);if(P(o))return i;e[r+i]=o}return i}(this,e,t,r);case"utf8":case"utf-8":return o=t,s=r,M(N(e,(i=this).length-o),i,o,s);case"ascii":case"latin1":case"binary":return _(this,e,t,r);case"base64":return i=this,o=t,s=r,M(D(e),i,o,s);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return v(this,e,t,r);default:if(l)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),l=!0}},f.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var b=4096;function S(e,t,r){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(r<e+t)throw new RangeError("Trying to access beyond buffer length")}function A(e,t,r,n,a,i){if(!f.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(a<t||t<i)throw new RangeError('"value" argument is out of bounds');if(r+n>e.length)throw new RangeError("Index out of range")}function R(e,t,r,n){if(r+n>e.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function I(e,t,r,n,a){return t=+t,r>>>=0,a||R(e,0,r,4),i.write(e,t,r,n,23,4),r+4}function w(e,t,r,n,a){return t=+t,r>>>=0,a||R(e,0,r,8),i.write(e,t,r,n,52,8),r+8}f.prototype.slice=function(e,t){var r=this.length;(e=~~e)<0?(e+=r)<0&&(e=0):r<e&&(e=r),(t=void 0===t?r:~~t)<0?(t+=r)<0&&(t=0):r<t&&(t=r),t<e&&(t=e);t=this.subarray(e,t);return Object.setPrototypeOf(t,f.prototype),t},f.prototype.readUintLE=f.prototype.readUIntLE=function(e,t,r){e>>>=0,t>>>=0,r||S(e,t,this.length);for(var n=this[e],a=1,i=0;++i<t&&(a*=256);)n+=this[e+i]*a;return n},f.prototype.readUintBE=f.prototype.readUIntBE=function(e,t,r){e>>>=0,t>>>=0,r||S(e,t,this.length);for(var n=this[e+--t],a=1;0<t&&(a*=256);)n+=this[e+--t]*a;return n},f.prototype.readUint8=f.prototype.readUInt8=function(e,t){return e>>>=0,t||S(e,1,this.length),this[e]},f.prototype.readUint16LE=f.prototype.readUInt16LE=function(e,t){return e>>>=0,t||S(e,2,this.length),this[e]|this[e+1]<<8},f.prototype.readUint16BE=f.prototype.readUInt16BE=function(e,t){return e>>>=0,t||S(e,2,this.length),this[e]<<8|this[e+1]},f.prototype.readUint32LE=f.prototype.readUInt32LE=function(e,t){return e>>>=0,t||S(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},f.prototype.readUint32BE=f.prototype.readUInt32BE=function(e,t){return e>>>=0,t||S(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},f.prototype.readIntLE=function(e,t,r){e>>>=0,t>>>=0,r||S(e,t,this.length);for(var n=this[e],a=1,i=0;++i<t&&(a*=256);)n+=this[e+i]*a;return(a*=128)<=n&&(n-=Math.pow(2,8*t)),n},f.prototype.readIntBE=function(e,t,r){e>>>=0,t>>>=0,r||S(e,t,this.length);for(var n=t,a=1,i=this[e+--n];0<n&&(a*=256);)i+=this[e+--n]*a;return(a*=128)<=i&&(i-=Math.pow(2,8*t)),i},f.prototype.readInt8=function(e,t){return e>>>=0,t||S(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},f.prototype.readInt16LE=function(e,t){e>>>=0,t||S(e,2,this.length);e=this[e]|this[e+1]<<8;return 32768&e?4294901760|e:e},f.prototype.readInt16BE=function(e,t){e>>>=0,t||S(e,2,this.length);e=this[e+1]|this[e]<<8;return 32768&e?4294901760|e:e},f.prototype.readInt32LE=function(e,t){return e>>>=0,t||S(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},f.prototype.readInt32BE=function(e,t){return e>>>=0,t||S(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},f.prototype.readFloatLE=function(e,t){return e>>>=0,t||S(e,4,this.length),i.read(this,e,!0,23,4)},f.prototype.readFloatBE=function(e,t){return e>>>=0,t||S(e,4,this.length),i.read(this,e,!1,23,4)},f.prototype.readDoubleLE=function(e,t){return e>>>=0,t||S(e,8,this.length),i.read(this,e,!0,52,8)},f.prototype.readDoubleBE=function(e,t){return e>>>=0,t||S(e,8,this.length),i.read(this,e,!1,52,8)},f.prototype.writeUintLE=f.prototype.writeUIntLE=function(e,t,r,n){e=+e,t>>>=0,r>>>=0,n||A(this,e,t,r,Math.pow(2,8*r)-1,0);var a=1,i=0;for(this[t]=255&e;++i<r&&(a*=256);)this[t+i]=e/a&255;return t+r},f.prototype.writeUintBE=f.prototype.writeUIntBE=function(e,t,r,n){e=+e,t>>>=0,r>>>=0,n||A(this,e,t,r,Math.pow(2,8*r)-1,0);var a=r-1,i=1;for(this[t+a]=255&e;0<=--a&&(i*=256);)this[t+a]=e/i&255;return t+r},f.prototype.writeUint8=f.prototype.writeUInt8=function(e,t,r){return e=+e,t>>>=0,r||A(this,e,t,1,255,0),this[t]=255&e,t+1},f.prototype.writeUint16LE=f.prototype.writeUInt16LE=function(e,t,r){return e=+e,t>>>=0,r||A(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},f.prototype.writeUint16BE=f.prototype.writeUInt16BE=function(e,t,r){return e=+e,t>>>=0,r||A(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},f.prototype.writeUint32LE=f.prototype.writeUInt32LE=function(e,t,r){return e=+e,t>>>=0,r||A(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},f.prototype.writeUint32BE=f.prototype.writeUInt32BE=function(e,t,r){return e=+e,t>>>=0,r||A(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},f.prototype.writeIntLE=function(e,t,r,n){e=+e,t>>>=0,n||A(this,e,t,r,(n=Math.pow(2,8*r-1))-1,-n);var a=0,i=1,o=0;for(this[t]=255&e;++a<r&&(i*=256);)e<0&&0===o&&0!==this[t+a-1]&&(o=1),this[t+a]=(e/i>>0)-o&255;return t+r},f.prototype.writeIntBE=function(e,t,r,n){e=+e,t>>>=0,n||A(this,e,t,r,(n=Math.pow(2,8*r-1))-1,-n);var a=r-1,i=1,o=0;for(this[t+a]=255&e;0<=--a&&(i*=256);)e<0&&0===o&&0!==this[t+a+1]&&(o=1),this[t+a]=(e/i>>0)-o&255;return t+r},f.prototype.writeInt8=function(e,t,r){return e=+e,t>>>=0,r||A(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=255&e,t+1},f.prototype.writeInt16LE=function(e,t,r){return e=+e,t>>>=0,r||A(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},f.prototype.writeInt16BE=function(e,t,r){return e=+e,t>>>=0,r||A(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},f.prototype.writeInt32LE=function(e,t,r){return e=+e,t>>>=0,r||A(this,e,t,4,2147483647,-2147483648),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},f.prototype.writeInt32BE=function(e,t,r){return e=+e,t>>>=0,r||A(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},f.prototype.writeFloatLE=function(e,t,r){return I(this,e,t,!0,r)},f.prototype.writeFloatBE=function(e,t,r){return I(this,e,t,!1,r)},f.prototype.writeDoubleLE=function(e,t,r){return w(this,e,t,!0,r)},f.prototype.writeDoubleBE=function(e,t,r){return w(this,e,t,!1,r)},f.prototype.copy=function(e,t,r,n){if(!f.isBuffer(e))throw new TypeError("argument should be a Buffer");if(r=r||0,n||0===n||(n=this.length),t=(t=t>=e.length?e.length:t)||0,(n=0<n&&n<r?r:n)===r)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length);var a=(n=e.length-t<n-r?e.length-t+r:n)-r;return this===e&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(t,r,n):Uint8Array.prototype.set.call(e,this.subarray(r,n),t),a},f.prototype.fill=function(e,t,r,n){if("string"==typeof e){if("string"==typeof t?(n=t,t=0,r=this.length):"string"==typeof r&&(n=r,r=this.length),void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!f.isEncoding(n))throw new TypeError("Unknown encoding: "+n);var a;1===e.length&&(a=e.charCodeAt(0),("utf8"===n&&a<128||"latin1"===n)&&(e=a))}else"number"==typeof e?e&=255:"boolean"==typeof e&&(e=Number(e));if(t<0||this.length<t||this.length<r)throw new RangeError("Out of range index");if(r<=t)return this;var i;if(t>>>=0,r=void 0===r?this.length:r>>>0,"number"==typeof(e=e||0))for(i=t;i<r;++i)this[i]=e;else{var o=f.isBuffer(e)?e:f.from(e,n),s=o.length;if(0===s)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(i=0;i<r-t;++i)this[i+t]=o[i%s]}return this};var C=/[^+/0-9A-Za-z-_]/g;function N(e,t){var r;t=t||1/0;for(var n=e.length,a=null,i=[],o=0;o<n;++o){if(55295<(r=e.charCodeAt(o))&&r<57344){if(!a){if(56319<r){-1<(t-=3)&&i.push(239,191,189);continue}if(o+1===n){-1<(t-=3)&&i.push(239,191,189);continue}a=r;continue}if(r<56320){-1<(t-=3)&&i.push(239,191,189),a=r;continue}r=65536+(a-55296<<10|r-56320)}else a&&-1<(t-=3)&&i.push(239,191,189);if(a=null,r<128){if(--t<0)break;i.push(r)}else if(r<2048){if((t-=2)<0)break;i.push(r>>6|192,63&r|128)}else if(r<65536){if((t-=3)<0)break;i.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;i.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return i}function D(e){return s.toByteArray(function(e){if((e=(e=e.split("=")[0]).trim().replace(C,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function M(e,t,r,n){for(var a=0;a<n&&!(a+r>=t.length||a>=e.length);++a)t[a+r]=e[a];return a}function O(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}function P(e){return e!=e}var L=function(){for(var e="0123456789abcdef",t=new Array(256),r=0;r<16;++r)for(var n=16*r,a=0;a<16;++a)t[n+a]=e[r]+e[a];return t}()},"./node_modules/buffer/node_modules/base64-js/index.js":(e,t)=>{t.byteLength=function(e){var t=c(e),e=t[0],t=t[1];return 3*(e+t)/4-t},t.toByteArray=function(e){var t,r,n=c(e),a=n[0],n=n[1],i=new u(function(e,t){return 3*(e+t)/4-t}(a,n)),o=0,s=0<n?a-4:a;for(r=0;r<s;r+=4)t=l[e.charCodeAt(r)]<<18|l[e.charCodeAt(r+1)]<<12|l[e.charCodeAt(r+2)]<<6|l[e.charCodeAt(r+3)],i[o++]=t>>16&255,i[o++]=t>>8&255,i[o++]=255&t;2===n&&(t=l[e.charCodeAt(r)]<<2|l[e.charCodeAt(r+1)]>>4,i[o++]=255&t);1===n&&(t=l[e.charCodeAt(r)]<<10|l[e.charCodeAt(r+1)]<<4|l[e.charCodeAt(r+2)]>>2,i[o++]=t>>8&255,i[o++]=255&t);return i},t.fromByteArray=function(e){for(var t,r=e.length,n=r%3,a=[],i=0,o=r-n;i<o;i+=16383)a.push(function(e,t,r){for(var n,a=[],i=t;i<r;i+=3)n=(e[i]<<16&16711680)+(e[i+1]<<8&65280)+(255&e[i+2]),a.push(function(e){return s[e>>18&63]+s[e>>12&63]+s[e>>6&63]+s[63&e]}(n));return a.join("")}(e,i,o<i+16383?o:i+16383));1==n?(t=e[r-1],a.push(s[t>>2]+s[t<<4&63]+"==")):2==n&&(t=(e[r-2]<<8)+e[r-1],a.push(s[t>>10]+s[t>>4&63]+s[t<<2&63]+"="));return a.join("")};for(var s=[],l=[],u="undefined"!=typeof Uint8Array?Uint8Array:Array,r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n=0,a=r.length;n<a;++n)s[n]=r[n],l[r.charCodeAt(n)]=n;function c(e){var t=e.length;if(0<t%4)throw new Error("Invalid string. Length must be a multiple of 4");e=e.indexOf("=");return[e=-1===e?t:e,e===t?0:4-e%4]}l["-".charCodeAt(0)]=62,l["_".charCodeAt(0)]=63},"./node_modules/buffer/node_modules/ieee754/index.js":(e,t)=>{t.read=function(e,t,r,n,a){var i,o,s=8*a-n-1,l=(1<<s)-1,u=l>>1,c=-7,f=r?a-1:0,d=r?-1:1,r=e[t+f];for(f+=d,i=r&(1<<-c)-1,r>>=-c,c+=s;0<c;i=256*i+e[t+f],f+=d,c-=8);for(o=i&(1<<-c)-1,i>>=-c,c+=n;0<c;o=256*o+e[t+f],f+=d,c-=8);if(0===i)i=1-u;else{if(i===l)return o?NaN:1/0*(r?-1:1);o+=Math.pow(2,n),i-=u}return(r?-1:1)*o*Math.pow(2,i-n)},t.write=function(e,t,r,n,a,i){var o,s,l=8*i-a-1,u=(1<<l)-1,c=u>>1,f=23===a?Math.pow(2,-24)-Math.pow(2,-77):0,d=n?0:i-1,g=n?1:-1,i=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,o=u):(o=Math.floor(Math.log(t)/Math.LN2),t*(n=Math.pow(2,-o))<1&&(o--,n*=2),2<=(t+=1<=o+c?f/n:f*Math.pow(2,1-c))*n&&(o++,n/=2),u<=o+c?(s=0,o=u):1<=o+c?(s=(t*n-1)*Math.pow(2,a),o+=c):(s=t*Math.pow(2,c-1)*Math.pow(2,a),o=0));8<=a;e[r+d]=255&s,d+=g,s/=256,a-=8);for(o=o<<a|s,l+=a;0<l;e[r+d]=255&o,d+=g,o/=256,l-=8);e[r+d-g]|=128*i}},"./node_modules/codem-isoboxer/dist/iso_boxer.js":(e,t)=>{var a={parseBuffer:function(e){return new i(e).parse()},addBoxProcessor:function(e,t){"string"==typeof e&&"function"==typeof t&&(n.prototype._boxProcessors[e]=t)},createFile:function(){return new i},createBox:function(e,t,r){e=n.create(e);return t&&t.append(e,r),e},createFullBox:function(e,t,r){r=a.createBox(e,t,r);return r.version=0,r.flags=0,r},Utils:{}};a.Utils.dataViewToString=function(e,t){t=t||"utf-8";if("undefined"!=typeof TextDecoder)return new TextDecoder(t).decode(e);var r=[],n=0;if("utf-8"===t)for(;n<e.byteLength;){var a=e.getUint8(n++);a<128||(a<224?a=(31&a)<<6:(a<240?a=(15&a)<<12:(a=(7&a)<<18,a|=(63&e.getUint8(n++))<<12),a|=(63&e.getUint8(n++))<<6),a|=63&e.getUint8(n++)),r.push(String.fromCharCode(a))}else for(;n<e.byteLength;)r.push(String.fromCharCode(e.getUint8(n++)));return r.join("")},a.Utils.utf8ToByteArray=function(e){var t,r;if("undefined"!=typeof TextEncoder)t=(new TextEncoder).encode(e);else for(t=[],r=0;r<e.length;++r){var n=e.charCodeAt(r);n<128?t.push(n):(n<2048?t.push(192|n>>6):(n<65536?t.push(224|n>>12):(t.push(240|n>>18),t.push(128|63&n>>12)),t.push(128|63&n>>6)),t.push(128|63&n))}return t},a.Utils.appendBox=function(e,t,r){if(t._offset=e._cursor.offset,t._root=e._root||e,t._raw=e._raw,t._parent=e,-1!==r)if(null!=r){var n,a=-1;if("number"==typeof r)a=r;else{if("string"==typeof r)n=r;else{if("object"!=typeof r||!r.type)return void e.boxes.push(t);n=r.type}for(var i=0;i<e.boxes.length;i++)if(n===e.boxes[i].type){a=i+1;break}}e.boxes.splice(a,0,t)}else e.boxes.push(t)},t.parseBuffer=a.parseBuffer,t.addBoxProcessor=a.addBoxProcessor,t.createFile=a.createFile,t.createBox=a.createBox,t.createFullBox=a.createFullBox,t.Utils=a.Utils,a.Cursor=function(e){this.offset=void 0===e?0:e};var i=function(e){this._cursor=new a.Cursor,this.boxes=[],e&&(this._raw=new DataView(e))};i.prototype.fetch=function(e){e=this.fetchAll(e,!0);return e.length?e[0]:null},i.prototype.fetchAll=function(e,t){var r=[];return i._sweep.call(this,e,r,t),r},i.prototype.parse=function(){for(this._cursor.offset=0,this.boxes=[];this._cursor.offset<this._raw.byteLength;){var e=n.parse(this);if(void 0===e.type)break;this.boxes.push(e)}return this},i._sweep=function(e,t,r){for(var n in this.type&&this.type==e&&t.push(this),this.boxes){if(t.length&&r)return;i._sweep.call(this.boxes[n],e,t,r)}},i.prototype.write=function(){for(var e=0,t=0;t<this.boxes.length;t++)e+=this.boxes[t].getLength(!1);var r=new Uint8Array(e);for(this._rawo=new DataView(r.buffer),this.bytes=r,t=this._cursor.offset=0;t<this.boxes.length;t++)this.boxes[t].write();return r.buffer},i.prototype.append=function(e,t){a.Utils.appendBox(this,e,t)};var n=function(){this._cursor=new a.Cursor};n.parse=function(e){var t=new n;return t._offset=e._cursor.offset,t._root=e._root||e,t._raw=e._raw,t._parent=e,t._parseBox(),e._cursor.offset=t._raw.byteOffset+t._raw.byteLength,t},n.create=function(e){var t=new n;return t.type=e,t.boxes=[],t},n.prototype._boxContainers=["dinf","edts","mdia","meco","mfra","minf","moof","moov","mvex","stbl","strk","traf","trak","tref","udta","vttc","sinf","schi","encv","enca"],n.prototype._boxProcessors={},n.prototype._procField=function(e,t,r){this._parsing?this[e]=this._readField(t,r):this._writeField(t,r,this[e])},n.prototype._procFieldArray=function(e,t,r,n){var a;if(this._parsing)for(this[e]=[],a=0;a<t;a++)this[e][a]=this._readField(r,n);else for(a=0;a<this[e].length;a++)this._writeField(r,n,this[e][a])},n.prototype._procFullBox=function(){this._procField("version","uint",8),this._procField("flags","uint",24)},n.prototype._procEntries=function(e,t,r){var n;if(this._parsing)for(this[e]=[],n=0;n<t;n++)this[e].push({}),r.call(this,this[e][n]);else for(n=0;n<t;n++)r.call(this,this[e][n])},n.prototype._procSubEntries=function(e,t,r,n){var a;if(this._parsing)for(e[t]=[],a=0;a<r;a++)e[t].push({}),n.call(this,e[t][a]);else for(a=0;a<r;a++)n.call(this,e[t][a])},n.prototype._procEntryField=function(e,t,r,n){this._parsing?e[t]=this._readField(r,n):this._writeField(r,n,e[t])},n.prototype._procSubBoxes=function(e,t){var r;if(this._parsing)for(this[e]=[],r=0;r<t;r++)this[e].push(n.parse(this));else for(r=0;r<t;r++)this._rawo?this[e][r].write():this.size+=this[e][r].getLength()},n.prototype._readField=function(e,t){switch(e){case"uint":return this._readUint(t);case"int":return this._readInt(t);case"template":return this._readTemplate(t);case"string":return-1===t?this._readTerminatedString():this._readString(t);case"data":return this._readData(t);case"utf8":return this._readUTF8String();default:return-1}},n.prototype._readInt=function(e){var t=null,r=this._cursor.offset-this._raw.byteOffset;switch(e){case 8:t=this._raw.getInt8(r);break;case 16:t=this._raw.getInt16(r);break;case 32:t=this._raw.getInt32(r);break;case 64:var n=this._raw.getInt32(r),a=this._raw.getInt32(4+r),t=n*Math.pow(2,32)+a}return this._cursor.offset+=e>>3,t},n.prototype._readUint=function(e){var t,r,n=null,a=this._cursor.offset-this._raw.byteOffset;switch(e){case 8:n=this._raw.getUint8(a);break;case 16:n=this._raw.getUint16(a);break;case 24:n=((t=this._raw.getUint16(a))<<8)+(r=this._raw.getUint8(2+a));break;case 32:n=this._raw.getUint32(a);break;case 64:t=this._raw.getUint32(a),r=this._raw.getUint32(4+a),n=t*Math.pow(2,32)+r}return this._cursor.offset+=e>>3,n},n.prototype._readString=function(e){for(var t="",r=0;r<e;r++){var n=this._readUint(8);t+=String.fromCharCode(n)}return t},n.prototype._readTemplate=function(e){return this._readUint(e/2)+this._readUint(e/2)/Math.pow(2,e/2)},n.prototype._readTerminatedString=function(){for(var e="";this._cursor.offset-this._offset<this._raw.byteLength;){var t=this._readUint(8);if(0===t)break;e+=String.fromCharCode(t)}return e},n.prototype._readData=function(e){var t=0<e?e:this._raw.byteLength-(this._cursor.offset-this._offset);if(0<t){e=new Uint8Array(this._raw.buffer,this._cursor.offset,t);return this._cursor.offset+=t,e}return null},n.prototype._readUTF8String=function(){var e=this._raw.byteLength-(this._cursor.offset-this._offset),t=null;return 0<e&&(t=new DataView(this._raw.buffer,this._cursor.offset,e),this._cursor.offset+=e),t&&a.Utils.dataViewToString(t)},n.prototype._parseBox=function(){if(this._parsing=!0,this._cursor.offset=this._offset,this._offset+8>this._raw.buffer.byteLength)this._root._incomplete=!0;else{switch(this._procField("size","uint",32),this._procField("type","string",4),1===this.size&&this._procField("largesize","uint",64),"uuid"===this.type&&this._procFieldArray("usertype",16,"uint",8),this.size){case 0:this._raw=new DataView(this._raw.buffer,this._offset,this._raw.byteLength-this._cursor.offset+8);break;case 1:this._offset+this.size>this._raw.buffer.byteLength?(this._incomplete=!0,this._root._incomplete=!0):this._raw=new DataView(this._raw.buffer,this._offset,this.largesize);break;default:this._offset+this.size>this._raw.buffer.byteLength?(this._incomplete=!0,this._root._incomplete=!0):this._raw=new DataView(this._raw.buffer,this._offset,this.size)}this._incomplete||(this._boxProcessors[this.type]&&this._boxProcessors[this.type].call(this),-1!==this._boxContainers.indexOf(this.type)?this._parseContainerBox():this._data=this._readData())}},n.prototype._parseFullBox=function(){this.version=this._readUint(8),this.flags=this._readUint(24)},n.prototype._parseContainerBox=function(){for(this.boxes=[];this._cursor.offset-this._raw.byteOffset<this._raw.byteLength;)this.boxes.push(n.parse(this))},n.prototype.append=function(e,t){a.Utils.appendBox(this,e,t)},n.prototype.getLength=function(){if(this._parsing=!1,this._rawo=null,this.size=0,this._procField("size","uint",32),this._procField("type","string",4),1===this.size&&this._procField("largesize","uint",64),"uuid"===this.type&&this._procFieldArray("usertype",16,"uint",8),this._boxProcessors[this.type]&&this._boxProcessors[this.type].call(this),-1!==this._boxContainers.indexOf(this.type))for(var e=0;e<this.boxes.length;e++)this.size+=this.boxes[e].getLength();return this._data&&this._writeData(this._data),this.size},n.prototype.write=function(){switch(this._parsing=!1,this._cursor.offset=this._parent._cursor.offset,this.size){case 0:this._rawo=new DataView(this._parent._rawo.buffer,this._cursor.offset,this.parent._rawo.byteLength-this._cursor.offset);break;case 1:this._rawo=new DataView(this._parent._rawo.buffer,this._cursor.offset,this.largesize);break;default:this._rawo=new DataView(this._parent._rawo.buffer,this._cursor.offset,this.size)}if(this._procField("size","uint",32),this._procField("type","string",4),1===this.size&&this._procField("largesize","uint",64),"uuid"===this.type&&this._procFieldArray("usertype",16,"uint",8),this._boxProcessors[this.type]&&this._boxProcessors[this.type].call(this),-1!==this._boxContainers.indexOf(this.type))for(var e=0;e<this.boxes.length;e++)this.boxes[e].write();return this._data&&this._writeData(this._data),this._parent._cursor.offset+=this.size,this.size},n.prototype._writeInt=function(e,t){if(this._rawo){var r=this._cursor.offset-this._rawo.byteOffset;switch(e){case 8:this._rawo.setInt8(r,t);break;case 16:this._rawo.setInt16(r,t);break;case 32:this._rawo.setInt32(r,t);break;case 64:var n=Math.floor(t/Math.pow(2,32)),a=t-n*Math.pow(2,32);this._rawo.setUint32(r,n),this._rawo.setUint32(4+r,a)}this._cursor.offset+=e>>3}else this.size+=e>>3},n.prototype._writeUint=function(e,t){if(this._rawo){var r,n,a=this._cursor.offset-this._rawo.byteOffset;switch(e){case 8:this._rawo.setUint8(a,t);break;case 16:this._rawo.setUint16(a,t);break;case 24:r=(16776960&t)>>8,n=255&t,this._rawo.setUint16(a,r),this._rawo.setUint8(2+a,n);break;case 32:this._rawo.setUint32(a,t);break;case 64:n=t-(r=Math.floor(t/Math.pow(2,32)))*Math.pow(2,32),this._rawo.setUint32(a,r),this._rawo.setUint32(4+a,n)}this._cursor.offset+=e>>3}else this.size+=e>>3},n.prototype._writeString=function(e,t){for(var r=0;r<e;r++)this._writeUint(8,t.charCodeAt(r))},n.prototype._writeTerminatedString=function(e){if(0!==e.length){for(var t=0;t<e.length;t++)this._writeUint(8,e.charCodeAt(t));this._writeUint(8,0)}},n.prototype._writeTemplate=function(e,t){var r=Math.floor(t),t=(t-r)*Math.pow(2,e/2);this._writeUint(e/2,r),this._writeUint(e/2,t)},n.prototype._writeData=function(e){if(e)if(this._rawo){if(e instanceof Array){for(var t=this._cursor.offset-this._rawo.byteOffset,r=0;r<e.length;r++)this._rawo.setInt8(t+r,e[r]);this._cursor.offset+=e.length}e instanceof Uint8Array&&(this._root.bytes.set(e,this._cursor.offset),this._cursor.offset+=e.length)}else this.size+=e.length},n.prototype._writeUTF8String=function(e){var t=a.Utils.utf8ToByteArray(e);if(this._rawo)for(var r=new DataView(this._rawo.buffer,this._cursor.offset,t.length),n=0;n<t.length;n++)r.setUint8(n,t[n]);else this.size+=t.length},n.prototype._writeField=function(e,t,r){switch(e){case"uint":this._writeUint(t,r);break;case"int":this._writeInt(t,r);break;case"template":this._writeTemplate(t,r);break;case"string":-1==t?this._writeTerminatedString(r):this._writeString(t,r);break;case"data":this._writeData(r);break;case"utf8":this._writeUTF8String(r)}},n.prototype._boxProcessors.avc1=n.prototype._boxProcessors.encv=function(){this._procFieldArray("reserved1",6,"uint",8),this._procField("data_reference_index","uint",16),this._procField("pre_defined1","uint",16),this._procField("reserved2","uint",16),this._procFieldArray("pre_defined2",3,"uint",32),this._procField("width","uint",16),this._procField("height","uint",16),this._procField("horizresolution","template",32),this._procField("vertresolution","template",32),this._procField("reserved3","uint",32),this._procField("frame_count","uint",16),this._procFieldArray("compressorname",32,"uint",8),this._procField("depth","uint",16),this._procField("pre_defined3","int",16),this._procField("config","data",-1)},n.prototype._boxProcessors.dref=function(){this._procFullBox(),this._procField("entry_count","uint",32),this._procSubBoxes("entries",this.entry_count)},n.prototype._boxProcessors.elst=function(){this._procFullBox(),this._procField("entry_count","uint",32),this._procEntries("entries",this.entry_count,function(e){this._procEntryField(e,"segment_duration","uint",1===this.version?64:32),this._procEntryField(e,"media_time","int",1===this.version?64:32),this._procEntryField(e,"media_rate_integer","int",16),this._procEntryField(e,"media_rate_fraction","int",16)})},n.prototype._boxProcessors.emsg=function(){this._procFullBox(),1==this.version?(this._procField("timescale","uint",32),this._procField("presentation_time","uint",64),this._procField("event_duration","uint",32),this._procField("id","uint",32),this._procField("scheme_id_uri","string",-1),this._procField("value","string",-1)):(this._procField("scheme_id_uri","string",-1),this._procField("value","string",-1),this._procField("timescale","uint",32),this._procField("presentation_time_delta","uint",32),this._procField("event_duration","uint",32),this._procField("id","uint",32)),this._procField("message_data","data",-1)},n.prototype._boxProcessors.free=n.prototype._boxProcessors.skip=function(){this._procField("data","data",-1)},n.prototype._boxProcessors.frma=function(){this._procField("data_format","uint",32)},n.prototype._boxProcessors.ftyp=n.prototype._boxProcessors.styp=function(){this._procField("major_brand","string",4),this._procField("minor_version","uint",32);var e=-1;this._parsing&&(e=(this._raw.byteLength-(this._cursor.offset-this._raw.byteOffset))/4),this._procFieldArray("compatible_brands",e,"string",4)},n.prototype._boxProcessors.hdlr=function(){this._procFullBox(),this._procField("pre_defined","uint",32),this._procField("handler_type","string",4),this._procFieldArray("reserved",3,"uint",32),this._procField("name","string",-1)},n.prototype._boxProcessors.mdat=function(){this._procField("data","data",-1)},n.prototype._boxProcessors.mdhd=function(){this._procFullBox(),this._procField("creation_time","uint",1==this.version?64:32),this._procField("modification_time","uint",1==this.version?64:32),this._procField("timescale","uint",32),this._procField("duration","uint",1==this.version?64:32),this._parsing||"string"!=typeof this.language||(this.language=this.language.charCodeAt(0)-96<<10|this.language.charCodeAt(1)-96<<5|this.language.charCodeAt(2)-96),this._procField("language","uint",16),this._parsing&&(this.language=String.fromCharCode(96+(this.language>>10&31),96+(this.language>>5&31),96+(31&this.language))),this._procField("pre_defined","uint",16)},n.prototype._boxProcessors.mehd=function(){this._procFullBox(),this._procField("fragment_duration","uint",1==this.version?64:32)},n.prototype._boxProcessors.mfhd=function(){this._procFullBox(),this._procField("sequence_number","uint",32)},n.prototype._boxProcessors.mfro=function(){this._procFullBox(),this._procField("mfra_size","uint",32)},n.prototype._boxProcessors.mp4a=n.prototype._boxProcessors.enca=function(){this._procFieldArray("reserved1",6,"uint",8),this._procField("data_reference_index","uint",16),this._procFieldArray("reserved2",2,"uint",32),this._procField("channelcount","uint",16),this._procField("samplesize","uint",16),this._procField("pre_defined","uint",16),this._procField("reserved3","uint",16),this._procField("samplerate","template",32),this._procField("esds","data",-1)},n.prototype._boxProcessors.mvhd=function(){this._procFullBox(),this._procField("creation_time","uint",1==this.version?64:32),this._procField("modification_time","uint",1==this.version?64:32),this._procField("timescale","uint",32),this._procField("duration","uint",1==this.version?64:32),this._procField("rate","template",32),this._procField("volume","template",16),this._procField("reserved1","uint",16),this._procFieldArray("reserved2",2,"uint",32),this._procFieldArray("matrix",9,"template",32),this._procFieldArray("pre_defined",6,"uint",32),this._procField("next_track_ID","uint",32)},n.prototype._boxProcessors.payl=function(){this._procField("cue_text","utf8")},n.prototype._boxProcessors.pssh=function(){this._procFullBox(),this._procFieldArray("SystemID",16,"uint",8),this._procField("DataSize","uint",32),this._procFieldArray("Data",this.DataSize,"uint",8)},n.prototype._boxProcessors.schm=function(){this._procFullBox(),this._procField("scheme_type","uint",32),this._procField("scheme_version","uint",32),1&this.flags&&this._procField("scheme_uri","string",-1)},n.prototype._boxProcessors.sdtp=function(){this._procFullBox();var e=-1;this._parsing&&(e=this._raw.byteLength-(this._cursor.offset-this._raw.byteOffset)),this._procFieldArray("sample_dependency_table",e,"uint",8)},n.prototype._boxProcessors.sidx=function(){this._procFullBox(),this._procField("reference_ID","uint",32),this._procField("timescale","uint",32),this._procField("earliest_presentation_time","uint",1==this.version?64:32),this._procField("first_offset","uint",1==this.version?64:32),this._procField("reserved","uint",16),this._procField("reference_count","uint",16),this._procEntries("references",this.reference_count,function(e){this._parsing||(e.reference=(1&e.reference_type)<<31,e.reference|=2147483647&e.referenced_size,e.sap=(1&e.starts_with_SAP)<<31,e.sap|=(3&e.SAP_type)<<28,e.sap|=268435455&e.SAP_delta_time),this._procEntryField(e,"reference","uint",32),this._procEntryField(e,"subsegment_duration","uint",32),this._procEntryField(e,"sap","uint",32),this._parsing&&(e.reference_type=e.reference>>31&1,e.referenced_size=2147483647&e.reference,e.starts_with_SAP=e.sap>>31&1,e.SAP_type=e.sap>>28&7,e.SAP_delta_time=268435455&e.sap)})},n.prototype._boxProcessors.smhd=function(){this._procFullBox(),this._procField("balance","uint",16),this._procField("reserved","uint",16)},n.prototype._boxProcessors.ssix=function(){this._procFullBox(),this._procField("subsegment_count","uint",32),this._procEntries("subsegments",this.subsegment_count,function(e){this._procEntryField(e,"ranges_count","uint",32),this._procSubEntries(e,"ranges",e.ranges_count,function(e){this._procEntryField(e,"level","uint",8),this._procEntryField(e,"range_size","uint",24)})})},n.prototype._boxProcessors.stsd=function(){this._procFullBox(),this._procField("entry_count","uint",32),this._procSubBoxes("entries",this.entry_count)},n.prototype._boxProcessors.subs=function(){this._procFullBox(),this._procField("entry_count","uint",32),this._procEntries("entries",this.entry_count,function(e){this._procEntryField(e,"sample_delta","uint",32),this._procEntryField(e,"subsample_count","uint",16),this._procSubEntries(e,"subsamples",e.subsample_count,function(e){this._procEntryField(e,"subsample_size","uint",1===this.version?32:16),this._procEntryField(e,"subsample_priority","uint",8),this._procEntryField(e,"discardable","uint",8),this._procEntryField(e,"codec_specific_parameters","uint",32)})})},n.prototype._boxProcessors.tenc=function(){this._procFullBox(),this._procField("default_IsEncrypted","uint",24),this._procField("default_IV_size","uint",8),this._procFieldArray("default_KID",16,"uint",8)},n.prototype._boxProcessors.tfdt=function(){this._procFullBox(),this._procField("baseMediaDecodeTime","uint",1==this.version?64:32)},n.prototype._boxProcessors.tfhd=function(){this._procFullBox(),this._procField("track_ID","uint",32),1&this.flags&&this._procField("base_data_offset","uint",64),2&this.flags&&this._procField("sample_description_offset","uint",32),8&this.flags&&this._procField("default_sample_duration","uint",32),16&this.flags&&this._procField("default_sample_size","uint",32),32&this.flags&&this._procField("default_sample_flags","uint",32)},n.prototype._boxProcessors.tfra=function(){this._procFullBox(),this._procField("track_ID","uint",32),this._parsing||(this.reserved=0,this.reserved|=(48&this.length_size_of_traf_num)<<4,this.reserved|=(12&this.length_size_of_trun_num)<<2,this.reserved|=3&this.length_size_of_sample_num),this._procField("reserved","uint",32),this._parsing&&(this.length_size_of_traf_num=(48&this.reserved)>>4,this.length_size_of_trun_num=(12&this.reserved)>>2,this.length_size_of_sample_num=3&this.reserved),this._procField("number_of_entry","uint",32),this._procEntries("entries",this.number_of_entry,function(e){this._procEntryField(e,"time","uint",1===this.version?64:32),this._procEntryField(e,"moof_offset","uint",1===this.version?64:32),this._procEntryField(e,"traf_number","uint",8*(this.length_size_of_traf_num+1)),this._procEntryField(e,"trun_number","uint",8*(this.length_size_of_trun_num+1)),this._procEntryField(e,"sample_number","uint",8*(this.length_size_of_sample_num+1))})},n.prototype._boxProcessors.tkhd=function(){this._procFullBox(),this._procField("creation_time","uint",1==this.version?64:32),this._procField("modification_time","uint",1==this.version?64:32),this._procField("track_ID","uint",32),this._procField("reserved1","uint",32),this._procField("duration","uint",1==this.version?64:32),this._procFieldArray("reserved2",2,"uint",32),this._procField("layer","uint",16),this._procField("alternate_group","uint",16),this._procField("volume","template",16),this._procField("reserved3","uint",16),this._procFieldArray("matrix",9,"template",32),this._procField("width","template",32),this._procField("height","template",32)},n.prototype._boxProcessors.trex=function(){this._procFullBox(),this._procField("track_ID","uint",32),this._procField("default_sample_description_index","uint",32),this._procField("default_sample_duration","uint",32),this._procField("default_sample_size","uint",32),this._procField("default_sample_flags","uint",32)},n.prototype._boxProcessors.trun=function(){this._procFullBox(),this._procField("sample_count","uint",32),1&this.flags&&this._procField("data_offset","int",32),4&this.flags&&this._procField("first_sample_flags","uint",32),this._procEntries("samples",this.sample_count,function(e){256&this.flags&&this._procEntryField(e,"sample_duration","uint",32),512&this.flags&&this._procEntryField(e,"sample_size","uint",32),1024&this.flags&&this._procEntryField(e,"sample_flags","uint",32),2048&this.flags&&this._procEntryField(e,"sample_composition_time_offset",1===this.version?"int":"uint",32)})},n.prototype._boxProcessors["url "]=n.prototype._boxProcessors["urn "]=function(){this._procFullBox(),"urn "===this.type&&this._procField("name","string",-1),this._procField("location","string",-1)},n.prototype._boxProcessors.vlab=function(){this._procField("source_label","utf8")},n.prototype._boxProcessors.vmhd=function(){this._procFullBox(),this._procField("graphicsmode","uint",16),this._procFieldArray("opcolor",3,"uint",16)},n.prototype._boxProcessors.vttC=function(){this._procField("config","utf8")},n.prototype._boxProcessors.vtte=function(){}},"./node_modules/es6-promise/auto.js":(e,t,r)=>{e.exports=r("./node_modules/es6-promise/dist/es6-promise.js").polyfill()},"./node_modules/es6-promise/dist/es6-promise.js":function(e,t,ne){
/*!
             * @overview es6-promise - a tiny implementation of Promises/A+.
             * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)
             * @license   Licensed under MIT license
             *            See https://raw.githubusercontent.com/stefanpenner/es6-promise/master/LICENSE
             * @version   v4.2.8+1e68dce6
             */
e.exports=function(){function n(e){var t=typeof e;return e!==null&&(t==="object"||t==="function")}function l(e){return typeof e==="function"}var e=void 0;if(Array.isArray)e=Array.isArray;else e=function(e){return Object.prototype.toString.call(e)==="[object Array]"};var r=e,a=0,t=void 0,i=void 0,o=function e(t,r){v[a]=t;v[a+1]=r;a+=2;if(a===2)if(i)i(T);else S()};function s(e){i=e}function u(e){o=e}var c=typeof window!=="undefined"?window:undefined,f=c||{},d=f.MutationObserver||f.WebKitMutationObserver,g=typeof self==="undefined"&&typeof ie!=="undefined"&&{}.toString.call(ie)==="[object process]",h=typeof Uint8ClampedArray!=="undefined"&&typeof importScripts!=="undefined"&&typeof MessageChannel!=="undefined";function m(){return function(){return ae(T)}}function p(){if(typeof t!=="undefined")return function(){t(T)};return _()}function y(){var e=0;var t=new d(T);var r=document.createTextNode("");t.observe(r,{characterData:true});return function(){r.data=e=++e%2}}function E(){var e=new MessageChannel;e.port1.onmessage=T;return function(){return e.port2.postMessage(0)}}function _(){var e=setTimeout;return function(){return e(T,1)}}var v=new Array(1e3);function T(){for(var e=0;e<a;e+=2){var t=v[e];var r=v[e+1];t(r);v[e]=undefined;v[e+1]=undefined}a=0}function b(){try{var e=Function("return this")().require("vertx");t=e.runOnLoop||e.runOnContext;return p()}catch(e){return _()}}var S=void 0;if(g)S=m();else if(d)S=y();else if(h)S=E();else if(c===undefined&&"function"==="function")S=b();else S=_();function A(e,t){var r=this;var n=new this.constructor(w);if(n[I]===undefined)z(n);var a=r._state;if(a){var i=arguments[a-1];o(function(){return H(a,n,i,r._result)})}else G(r,n,e,t);return n}function R(e){var t=this;if(e&&typeof e==="object"&&e.constructor===t)return e;var r=new t(w);j(r,e);return r}var I=Math.random().toString(36).substring(2);function w(){}var C=void 0,N=1,D=2;function M(){return new TypeError("You cannot resolve a promise with itself")}function O(){return new TypeError("A promises callback cannot return that same promise.")}function P(e,t,r,n){try{e.call(t,r,n)}catch(e){return e}}function L(e,n,a){o(function(t){var r=false;var e=P(a,n,function(e){if(r)return;r=true;if(n!==e)j(t,e);else U(t,e)},function(e){if(r)return;r=true;B(t,e)},"Settle: "+(t._label||" unknown promise"));if(!r&&e){r=true;B(t,e)}},e)}function F(t,e){if(e._state===N)U(t,e._result);else if(e._state===D)B(t,e._result);else G(e,undefined,function(e){return j(t,e)},function(e){return B(t,e)})}function x(e,t,r){if(t.constructor===e.constructor&&r===A&&t.constructor.resolve===R)F(e,t);else if(r===undefined)U(e,t);else if(l(r))L(e,t,r);else U(e,t)}function j(t,e){if(t===e)B(t,M());else if(n(e)){var r=void 0;try{r=e.then}catch(e){B(t,e);return}x(t,e,r)}else U(t,e)}function k(e){if(e._onerror)e._onerror(e._result);q(e)}function U(e,t){if(e._state!==C)return;e._result=t;e._state=N;if(e._subscribers.length!==0)o(q,e)}function B(e,t){if(e._state!==C)return;e._state=D;e._result=t;o(k,e)}function G(e,t,r,n){var a=e._subscribers;var i=a.length;e._onerror=null;a[i]=t;a[i+N]=r;a[i+D]=n;if(i===0&&e._state)o(q,e)}function q(e){var t=e._subscribers;var r=e._state;if(t.length===0)return;var n=void 0,a=void 0,i=e._result;for(var o=0;o<t.length;o+=3){n=t[o];a=t[o+r];if(n)H(r,n,a,i);else a(i)}e._subscribers.length=0}function H(e,t,r,n){var a=l(r),i=void 0,o=void 0,s=true;if(a){try{i=r(n)}catch(e){s=false;o=e}if(t===i){B(t,O());return}}else i=n;if(t._state!==C);else if(a&&s)j(t,i);else if(s===false)B(t,o);else if(e===N)U(t,i);else if(e===D)B(t,i)}function Y(r,e){try{e(function e(t){j(r,t)},function e(t){B(r,t)})}catch(e){B(r,e)}}var V=0;function K(){return V++}function z(e){e[I]=V++;e._state=undefined;e._result=undefined;e._subscribers=[]}function W(){return new Error("Array Methods must be provided an Array")}var X=function(){function e(e,t){this._instanceConstructor=e;this.promise=new e(w);if(!this.promise[I])z(this.promise);if(r(t)){this.length=t.length;this._remaining=t.length;this._result=new Array(this.length);if(this.length===0)U(this.promise,this._result);else{this.length=this.length||0;this._enumerate(t);if(this._remaining===0)U(this.promise,this._result)}}else B(this.promise,W())}e.prototype._enumerate=function e(t){for(var r=0;this._state===C&&r<t.length;r++)this._eachEntry(t[r],r)};e.prototype._eachEntry=function e(t,r){var n=this._instanceConstructor;var a=n.resolve;if(a===R){var i=void 0;var o=void 0;var s=false;try{i=t.then}catch(e){s=true;o=e}if(i===A&&t._state!==C)this._settledAt(t._state,r,t._result);else if(typeof i!=="function"){this._remaining--;this._result[r]=t}else if(n===te){var l=new n(w);if(s)B(l,o);else x(l,t,i);this._willSettleAt(l,r)}else this._willSettleAt(new n(function(e){return e(t)}),r)}else this._willSettleAt(a(t),r)};e.prototype._settledAt=function e(t,r,n){var a=this.promise;if(a._state===C){this._remaining--;if(t===D)B(a,n);else this._result[r]=n}if(this._remaining===0)U(a,this._result)};e.prototype._willSettleAt=function e(t,r){var n=this;G(t,undefined,function(e){return n._settledAt(N,r,e)},function(e){return n._settledAt(D,r,e)})};return e}();function Q(e){return new X(this,e).promise}function J(a){var i=this;if(r(a))return new i(function(e,t){for(var r=a.length,n=0;n<r;n++)i.resolve(a[n]).then(e,t)});else return new i(function(e,t){return t(new TypeError("You must pass an array to race."))})}function $(e){var t=new this(w);return B(t,e),t}function Z(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function ee(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}var te=function(){function t(e){this[I]=K();this._result=this._state=undefined;this._subscribers=[];if(w!==e){typeof e!=="function"&&Z();this instanceof t?Y(this,e):ee()}}t.prototype.catch=function e(t){return this.then(null,t)};t.prototype.finally=function e(t){var r=this;var n=r.constructor;if(l(t))return r.then(function(e){return n.resolve(t()).then(function(){return e})},function(e){return n.resolve(t()).then(function(){throw e})});return r.then(t,t)};return t}();function re(){var e=void 0;if(void 0!==ne.g)e=ne.g;else if("undefined"!=typeof self)e=self;else try{e=Function("return this")()}catch(e){throw new Error("polyfill failed because global object is unavailable in this environment")}var t=e.Promise;if(t){var r=null;try{r=Object.prototype.toString.call(t.resolve())}catch(e){}if("[object Promise]"===r&&!t.cast)return}e.Promise=te}return te.prototype.then=A,te.all=function(e){return new X(this,e).promise},te.race=function(a){var i=this;return r(a)?new i(function(e,t){for(var r=a.length,n=0;n<r;n++)i.resolve(a[n]).then(e,t)}):new i(function(e,t){return t(new TypeError("You must pass an array to race."))})},te.resolve=R,te.reject=function(e){var t=new this(w);return B(t,e),t},te._setScheduler=function(e){i=e},te._setAsap=function(e){o=e},te._asap=o,te.polyfill=function(){var e=void 0;if(void 0!==ne.g)e=ne.g;else if("undefined"!=typeof self)e=self;else try{e=Function("return this")()}catch(e){throw new Error("polyfill failed because global object is unavailable in this environment")}var t=e.Promise;if(t){var r=null;try{r=Object.prototype.toString.call(t.resolve())}catch(e){}if("[object Promise]"===r&&!t.cast)return}e.Promise=te},te.Promise=te}()},"./node_modules/events/events.js":e=>{var t="object"==typeof Reflect?Reflect:null,l=t&&"function"==typeof t.apply?t.apply:function(e,t,r){return Function.prototype.apply.call(e,t,r)};var r=t&&"function"==typeof t.ownKeys?t.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)},n=Number.isNaN||function(e){return e!=e};function a(){a.init.call(this)}e.exports=a,e.exports.once=function(s,l){return new Promise(function(e,t){function r(e){s.removeListener(l,n),t(e)}function n(){"function"==typeof s.removeListener&&s.removeListener("error",r),e([].slice.call(arguments))}var a,i,o;h(s,l,n,{once:!0}),"error"!==l&&(i=r,o={once:!0},"function"==typeof(a=s).on&&h(a,"error",i,o))})},(a.EventEmitter=a).prototype._events=void 0,a.prototype._eventsCount=0,a.prototype._maxListeners=void 0;var i=10;function s(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function o(e){return void 0===e._maxListeners?a.defaultMaxListeners:e._maxListeners}function u(e,t,r,n){var a,i;return s(r),void 0===(a=e._events)?(a=e._events=Object.create(null),e._eventsCount=0):(void 0!==a.newListener&&(e.emit("newListener",t,r.listener||r),a=e._events),i=a[t]),void 0===i?(i=a[t]=r,++e._eventsCount):("function"==typeof i?i=a[t]=n?[r,i]:[i,r]:n?i.unshift(r):i.push(r),0<(r=o(e))&&i.length>r&&!i.warned&&(i.warned=!0,(r=new Error("Possible EventEmitter memory leak detected. "+i.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit")).name="MaxListenersExceededWarning",r.emitter=e,r.type=t,r.count=i.length,r=r,console&&console.warn&&console.warn(r))),e}function c(e,t,r){e={fired:!1,wrapFn:void 0,target:e,type:t,listener:r},t=function(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}.bind(e);return t.listener=r,e.wrapFn=t}function f(e,t,r){e=e._events;if(void 0===e)return[];t=e[t];return void 0===t?[]:"function"==typeof t?r?[t.listener||t]:[t]:r?function(e){for(var t=new Array(e.length),r=0;r<t.length;++r)t[r]=e[r].listener||e[r];return t}(t):g(t,t.length)}function d(e){var t=this._events;if(void 0!==t){e=t[e];if("function"==typeof e)return 1;if(void 0!==e)return e.length}return 0}function g(e,t){for(var r=new Array(t),n=0;n<t;++n)r[n]=e[n];return r}function h(r,n,a,i){if("function"==typeof r.on)i.once?r.once(n,a):r.on(n,a);else{if("function"!=typeof r.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof r);r.addEventListener(n,function e(t){i.once&&r.removeEventListener(n,e),a(t)})}}Object.defineProperty(a,"defaultMaxListeners",{enumerable:!0,get:function(){return i},set:function(e){if("number"!=typeof e||e<0||n(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");i=e}}),a.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},a.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||n(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},a.prototype.getMaxListeners=function(){return o(this)},a.prototype.emit=function(e){for(var t=[],r=1;r<arguments.length;r++)t.push(arguments[r]);var n,a="error"===e,i=this._events;if(void 0!==i)a=a&&void 0===i.error;else if(!a)return!1;if(a){if((n=0<t.length?t[0]:n)instanceof Error)throw n;a=new Error("Unhandled error."+(n?" ("+n.message+")":""));throw a.context=n,a}e=i[e];if(void 0===e)return!1;if("function"==typeof e)l(e,this,t);else for(var o=e.length,s=g(e,o),r=0;r<o;++r)l(s[r],this,t);return!0},a.prototype.addListener=function(e,t){return u(this,e,t,!1)},a.prototype.on=a.prototype.addListener,a.prototype.prependListener=function(e,t){return u(this,e,t,!0)},a.prototype.once=function(e,t){return s(t),this.on(e,c(this,e,t)),this},a.prototype.prependOnceListener=function(e,t){return s(t),this.prependListener(e,c(this,e,t)),this},a.prototype.removeListener=function(e,t){var r,n,a,i,o;if(s(t),void 0===(n=this._events))return this;if(void 0===(r=n[e]))return this;if(r===t||r.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete n[e],n.removeListener&&this.emit("removeListener",e,r.listener||t));else if("function"!=typeof r){for(a=-1,i=r.length-1;0<=i;i--)if(r[i]===t||r[i].listener===t){o=r[i].listener,a=i;break}if(a<0)return this;0===a?r.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(r,a),1===r.length&&(n[e]=r[0]),void 0!==n.removeListener&&this.emit("removeListener",e,o||t)}return this},a.prototype.off=a.prototype.removeListener,a.prototype.removeAllListeners=function(e){var t,r=this._events;if(void 0===r)return this;if(void 0===r.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==r[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete r[e]),this;if(0===arguments.length){for(var n,a=Object.keys(r),i=0;i<a.length;++i)"removeListener"!==(n=a[i])&&this.removeAllListeners(n);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=r[e]))this.removeListener(e,t);else if(void 0!==t)for(i=t.length-1;0<=i;i--)this.removeListener(e,t[i]);return this},a.prototype.listeners=function(e){return f(this,e,!0)},a.prototype.rawListeners=function(e){return f(this,e,!1)},a.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):d.call(e,t)},a.prototype.listenerCount=d,a.prototype.eventNames=function(){return 0<this._eventsCount?r(this._events):[]}},"./node_modules/fast-deep-equal/index.js":e=>{var u=Array.isArray,c=Object.keys,f=Object.prototype.hasOwnProperty;e.exports=function e(t,r){if(t===r)return!0;if(t&&r&&"object"==typeof t&&"object"==typeof r){var n,a,i=u(t),o=u(r);if(i&&o){if((s=t.length)!=r.length)return!1;for(n=s;0!=n--;)if(!e(t[n],r[n]))return!1;return!0}if(i!=o)return!1;i=t instanceof Date,o=r instanceof Date;if(i!=o)return!1;if(i&&o)return t.getTime()==r.getTime();i=t instanceof RegExp,o=r instanceof RegExp;if(i!=o)return!1;if(i&&o)return t.toString()==r.toString();var s,l=c(t);if((s=l.length)!==c(r).length)return!1;for(n=s;0!=n--;)if(!f.call(r,l[n]))return!1;for(n=s;0!=n--;)if(!e(t[a=l[n]],r[a]))return!1;return!0}return t!=t&&r!=r}},"./node_modules/imsc/src/main/js/doc.js":(e,t,r)=>{function m(e,t,r,n){var a=n&&"seq"===n.timeContainer,i=0;n&&(i=a&&r?r.end:n.begin),t.begin=t.explicit_begin?t.explicit_begin+i:i;var o,s=t.begin,l=null;for(o in t.sets)m(e,t.sets[o],l,t),s="seq"===t.timeContainer?t.sets[o].end:Math.max(s,t.sets[o].end),l=t.sets[o];if("contents"in t)for(var u in t.contents)m(e,t.contents[u],l,t),s="seq"===t.timeContainer?t.contents[u].end:Math.max(s,t.contents[u].end),l=t.contents[u];else s=a?t.begin:Number.POSITIVE_INFINITY;null!==t.explicit_end&&null!==t.explicit_dur?t.end=Math.min(t.begin+t.explicit_dur,i+t.explicit_end):null===t.explicit_end&&null!==t.explicit_dur?t.end=t.begin+t.explicit_dur:null!==t.explicit_end&&null===t.explicit_dur?t.end=i+t.explicit_end:t.end=s,delete t.explicit_begin,delete t.explicit_dur,delete t.explicit_end,e._registerEvent(t)}function p(e){this.node=e}function y(){this.events=[],this.head=null,this.body=null}function E(){this.styling=null,this.layout=null}function _(){this.styles={}}function v(){this.id=null,this.styleAttrs=null,this.styleRefs=null}function T(){this.regions={}}function n(e){this.kind=e}function a(e){this.id=e}function i(e){this.regionID=e}function o(e){this.styleAttrs=e}function s(e){this.sets=e}function l(e){this.contents=e}function u(e,t,r){this.explicit_begin=e,this.explicit_end=t,this.explicit_dur=r}function b(){n.call(this,"body")}function S(){n.call(this,"div")}function A(){n.call(this,"p")}function R(){n.call(this,"span")}function I(){n.call(this,"span")}function w(){n.call(this,"br")}function C(){}function N(){}function c(e){return e&&"xml:id"in e.attributes&&e.attributes["xml:id"].value||null}function f(e){return e&&"style"in e.attributes?e.attributes.style.value.split(" "):[]}function d(e,t){var r={};if(null!==e)for(var n in e.attributes){var a,i=e.attributes[n].uri+" "+e.attributes[n].local,o=k.byQName[i];void 0!==o&&(null!==(a=o.parse(e.attributes[n].value))?(r[i]=a,o===k.byName.zIndex&&O(t,"zIndex attribute present but not used by IMSC1 since regions do not overlap")):P(t,"Cannot parse styling attribute "+i+" --\x3e "+e.attributes[n].value))}return r}function g(e,t,r){for(var n in e.attributes)if(e.attributes[n].uri===t&&e.attributes[n].local===r)return e.attributes[n].value;return null}function h(e,t,r){var n,a=null;return null!==(n=/^(\d+(?:\.\d+)?)f$/.exec(r))?null!==t&&(a=parseFloat(n[1])/t):null!==(n=/^(\d+(?:\.\d+)?)t$/.exec(r))?null!==e&&(a=parseFloat(n[1])/e):null!==(n=/^(\d+(?:\.\d+)?)ms$/.exec(r))?a=parseFloat(n[1])/1e3:null!==(n=/^(\d+(?:\.\d+)?)s$/.exec(r))?a=parseFloat(n[1]):null!==(n=/^(\d+(?:\.\d+)?)h$/.exec(r))?a=3600*parseFloat(n[1]):null!==(n=/^(\d+(?:\.\d+)?)m$/.exec(r))?a=60*parseFloat(n[1]):null!==(n=/^(\d{2,}):(\d\d):(\d\d(?:\.\d+)?)$/.exec(r))?a=3600*parseInt(n[1])+60*parseInt(n[2])+parseFloat(n[3]):null!==(n=/^(\d{2,}):(\d\d):(\d\d)\:(\d{2,})$/.exec(r))&&null!==t&&(a=3600*parseInt(n[1])+60*parseInt(n[2])+parseInt(n[3])+(null===n[4]?0:parseInt(n[4])/t)),a}function D(e,t,r,n){for(var a=t.length-1;0<=a;a--){var i=t[a];i in e.styles?M(e.styles[i].styleAttrs,r):P(n,"Non-existant style id referenced")}}function M(e,t){for(var r in e)r in t||(t[r]=e[r])}function O(e,t){if(e&&e.warn&&e.warn(t))throw t}function P(e,t){if(e&&e.error&&e.error(t))throw t}function L(e,t){throw e&&e.fatal&&e.fatal(t),t}function F(e,t){for(var r=0,n=e.length-1;r<=n;){var a,i=e[a=Math.floor((r+n)/2)];if(i<t)r=a+1;else{if(!(t<i))return{found:!0,index:a};n=a-1}}return{found:!1,index:r}}var x,j,k,U;t=t,x="undefined"==typeof sax?r("./node_modules/sax/lib/sax.js"):sax,j="undefined"==typeof imscNames?r("./node_modules/imsc/src/main/js/names.js"):imscNames,k="undefined"==typeof imscStyles?r("./node_modules/imsc/src/main/js/styles.js"):imscStyles,U="undefined"==typeof imscUtils?r("./node_modules/imsc/src/main/js/utils.js"):imscUtils,t.fromXML=function(e,l,u){var t=x.parser(!0,{xmlns:!0}),c=[],f=[],d=[],g=0,h=null;t.onclosetag=function(e){if(c[0]instanceof _)for(var t in c[0].styles)!function e(t,r,n){for(;0<r.styleRefs.length;){var a=r.styleRefs.pop();a in t.styles?(e(t,t.styles[a],n),M(t.styles[a].styleAttrs,r.styleAttrs)):P(n,"Non-existant style id referenced")}}(c[0],c[0].styles[t],l);else if(c[0]instanceof A||c[0]instanceof R){if(1<c[0].contents.length){for(var r=[c[0].contents[0]],n=1;n<c[0].contents.length;n++)c[0].contents[n]instanceof I&&r[r.length-1]instanceof I?r[r.length-1].text+=c[0].contents[n].text:r.push(c[0].contents[n]);c[0].contents=r}c[0]instanceof R&&1===c[0].contents.length&&c[0].contents[0]instanceof I&&(c[0].text=c[0].contents[0].text,delete c[0].contents)}else c[0]instanceof p&&(c[0].node.uri===j.ns_tt&&"metadata"===c[0].node.local?g--:0<g&&u&&"onCloseTag"in u&&u.onCloseTag());d.shift(),f.shift(),c.shift()},t.ontext=function(e){var t;void 0===c[0]||(c[0]instanceof R||c[0]instanceof A?((t=new I).initFromText(h,c[0],e,d[0],l),c[0].contents.push(t)):c[0]instanceof p&&0<g&&u&&"onText"in u&&u.onText(e))},t.onopentag=function(e){var t=e.attributes["xml:space"];t?d.unshift(t.value):0===d.length?d.unshift("default"):d.unshift(d[0]);var r,n,a,i,t=e.attributes["xml:lang"];if(t?f.unshift(t.value):0===f.length?f.unshift(""):f.unshift(f[0]),e.uri===j.ns_tt?"tt"===e.local?(null!==h&&L(l,"Two <tt> elements at ("+this.line+","+this.column+")"),(h=new y).initFromNode(e,l),c.unshift(h)):"head"===e.local?(c[0]instanceof y||L(l,"Parent of <head> element is not <tt> at ("+this.line+","+this.column+")"),null!==h.head&&L("Second <head> element at ("+this.line+","+this.column+")"),h.head=new E,c.unshift(h.head)):"styling"===e.local?(c[0]instanceof E||L(l,"Parent of <styling> element is not <head> at ("+this.line+","+this.column+")"),null!==h.head.styling&&L("Second <styling> element at ("+this.line+","+this.column+")"),h.head.styling=new _,c.unshift(h.head.styling)):"style"===e.local?c[0]instanceof _?((r=new v).initFromNode(e,l),r.id?h.head.styling.styles[r.id]=r:P(l,"<style> element missing @id attribute"),c.unshift(r)):c[0]instanceof C?((r=new v).initFromNode(e,l),M(r.styleAttrs,c[0].styleAttrs),c.unshift(r)):L(l,"Parent of <style> element is not <styling> or <region> at ("+this.line+","+this.column+")"):"layout"===e.local?(c[0]instanceof E||L(l,"Parent of <layout> element is not <head> at "+this.line+","+this.column+")"),null!==h.head.layout&&L(l,"Second <layout> element at "+this.line+","+this.column+")"),h.head.layout=new T,c.unshift(h.head.layout)):"region"===e.local?(c[0]instanceof T||L(l,"Parent of <region> element is not <layout> at "+this.line+","+this.column+")"),(r=new C).initFromNode(h,e,l),!r.id||r.id in h.head.layout.regions?P(l,"Ignoring <region> with duplicate or missing @id at "+this.line+","+this.column+")"):h.head.layout.regions[r.id]=r,c.unshift(r)):"body"===e.local?(c[0]instanceof y||L(l,"Parent of <body> element is not <tt> at "+this.line+","+this.column+")"),null!==h.body&&L(l,"Second <body> element at "+this.line+","+this.column+")"),(n=new b).initFromNode(h,e,l),h.body=n,c.unshift(n)):"div"===e.local?(c[0]instanceof S||c[0]instanceof b||L(l,"Parent of <div> element is not <body> or <div> at "+this.line+","+this.column+")"),(n=new S).initFromNode(h,c[0],e,l),c[0].contents.push(n),c.unshift(n)):"p"===e.local?(c[0]instanceof S||L(l,"Parent of <p> element is not <div> at "+this.line+","+this.column+")"),(a=new A).initFromNode(h,c[0],e,l),c[0].contents.push(a),c.unshift(a)):"span"===e.local?(c[0]instanceof R||c[0]instanceof A||L(l,"Parent of <span> element is not <span> or <p> at "+this.line+","+this.column+")"),(a=new R).initFromNode(h,c[0],e,d[0],l),c[0].contents.push(a),c.unshift(a)):"br"===e.local?(c[0]instanceof R||c[0]instanceof A||L(l,"Parent of <br> element is not <span> or <p> at "+this.line+","+this.column+")"),(i=new w).initFromNode(h,c[0],e,l),c[0].contents.push(i),c.unshift(i)):"set"===e.local?(c[0]instanceof R||c[0]instanceof A||c[0]instanceof S||c[0]instanceof b||c[0]instanceof C||c[0]instanceof w||L(l,"Parent of <set> element is not a content element or a region at "+this.line+","+this.column+")"),(i=new N).initFromNode(h,c[0],e,l),c[0].sets.push(i),c.unshift(i)):c.unshift(new p(e)):c.unshift(new p(e)),c[0]instanceof p)if(e.uri===j.ns_tt&&"metadata"===e.local)g++;else if(0<g&&u&&"onOpenTag"in u){var o,s=[];for(o in e.attributes)s[e.attributes[o].uri+" "+e.attributes[o].local]={uri:e.attributes[o].uri,local:e.attributes[o].local,value:e.attributes[o].value};u.onOpenTag(e.uri,e.local,s)}},t.write(e).close(),null!==h.head?delete h.head.styling:h.head=new E,null===h.head.layout&&(h.head.layout=new T);var r,n,a=!1;for(r in h.head.layout.regions){a=!0;break}for(n in a||(e=C.prototype.createDefaultRegion(),h.head.layout.regions[e.id]=e),h.head.layout.regions)m(h,h.head.layout.regions[n],null,null);return h.body&&m(h,h.body,null,null),h},y.prototype.initFromNode=function(e,t){this.cellResolution=function(e,t){var r=g(e,j.ns_ttp,"cellResolution"),n=15,e=32;null!==r&&(null!==(r=/(\d+) (\d+)/.exec(r))?(e=parseInt(r[1]),n=parseInt(r[2])):O(t,"Malformed cellResolution value (using initial value instead)"));return{w:e,h:n}}(e,t);var r=function(e,t){var r,n=g(e,j.ns_ttp,"frameRate"),a=30;null!==n&&(null!==(r=/(\d+)/.exec(n))?a=parseInt(r[1]):O(t,"Malformed frame rate attribute (using initial value instead)"));var i=g(e,j.ns_ttp,"frameRateMultiplier"),o=1;null!==i&&(null!==(r=/(\d+) (\d+)/.exec(i))?o=parseInt(r[1])/parseInt(r[2]):O(t,"Malformed frame rate multiplier attribute (using initial value instead)"));o*=a,a=1,e=g(e,j.ns_ttp,"tickRate");null===e?null!==n&&(a=o):null!==(r=/(\d+)/.exec(e))?a=parseInt(r[1]):O(t,"Malformed tick rate attribute (using initial value instead)");return{effectiveFrameRate:o,tickRate:a}}(e,t);this.effectiveFrameRate=r.effectiveFrameRate,this.tickRate=r.tickRate,this.aspectRatio=function(e,t){var r=g(e,j.ns_ittp,"aspectRatio"),n=null;null!==r&&(null!==(e=/(\d+) (\d+)/.exec(r))?(r=parseInt(e[1]),e=parseInt(e[2]),0!==r&&0!==e?n=r/e:P(t,"Illegal aspectRatio values (ignoring)")):P(t,"Malformed aspectRatio attribute (ignoring)"));return n}(e,t);r=g(e,j.ns_ttp,"timeBase");null!==r&&"media"!==r&&L(t,"Unsupported time base");e=function(e,t){var r=g(e,j.ns_tts,"extent");if(null===r)return null;e=r.split(" ");if(2!==e.length)return O(t,"Malformed extent (ignoring)"),null;r=U.parseLength(e[0]),e=U.parseLength(e[1]);return e&&r?{h:e,w:r}:(O(t,"Malformed extent values (ignoring)"),null)}(e,t);null===e?this.pxDimensions={h:480,w:640}:("px"===e.h.unit&&"px"===e.w.unit||L(t,"Extent on TT must be in px or absent"),this.pxDimensions={h:e.h.value,w:e.w.value})},y.prototype._registerEvent=function(e){var t;e.end<=e.begin||((t=F(this.events,e.begin)).found||this.events.splice(t.index,0,e.begin),e.end!==Number.POSITIVE_INFINITY&&((t=F(this.events,e.end)).found||this.events.splice(t.index,0,e.end)))},y.prototype.getMediaTimeRange=function(){return[this.events[0],this.events[this.events.length-1]]},y.prototype.getMediaTimeEvents=function(){return this.events},v.prototype.initFromNode=function(e,t){this.id=c(e),this.styleAttrs=d(e,t),this.styleRefs=f(e)},a.prototype.initFromNode=function(e,t,r,n){this.id=c(r)},i.prototype.initFromNode=function(e,t,r,n){this.regionID=(r=r)&&"region"in r.attributes?r.attributes.region.value:""},o.prototype.initFromNode=function(e,t,r,n){this.styleAttrs=d(r,n),null!==e.head&&null!==e.head.styling&&D(e.head.styling,f(r),this.styleAttrs,n)},s.prototype.initFromNode=function(e,t,r,n){this.sets=[]},l.prototype.initFromNode=function(e,t,r,n){this.contents=[]},u.prototype.initFromNode=function(e,t,r,n){e=function(e,t,r){var n=null;t&&"begin"in t.attributes&&null===(n=h(e.tickRate,e.effectiveFrameRate,t.attributes.begin.value))&&O(r,"Malformed begin value "+t.attributes.begin.value+" (using 0)");var a=null;t&&"dur"in t.attributes&&null===(a=h(e.tickRate,e.effectiveFrameRate,t.attributes.dur.value))&&O(r,"Malformed dur value "+t.attributes.dur.value+" (ignoring)");var i=null;t&&"end"in t.attributes&&null===(i=h(e.tickRate,e.effectiveFrameRate,t.attributes.end.value))&&O(r,"Malformed end value (ignoring)");return{explicit_begin:n,explicit_end:i,explicit_dur:a}}(e,r,n);this.explicit_begin=e.explicit_begin,this.explicit_end=e.explicit_end,this.explicit_dur=e.explicit_dur,this.timeContainer=function(e,t){e=e&&"timeContainer"in e.attributes?e.attributes.timeContainer.value:null;return e&&"par"!==e?"seq"===e?"seq":(P(t,"Illegal value of timeContainer (assuming 'par')"),"par"):"par"}(r,n)},b.prototype.initFromNode=function(e,t,r){o.prototype.initFromNode.call(this,e,null,t,r),u.prototype.initFromNode.call(this,e,null,t,r),s.prototype.initFromNode.call(this,e,null,t,r),i.prototype.initFromNode.call(this,e,null,t,r),l.prototype.initFromNode.call(this,e,null,t,r)},S.prototype.initFromNode=function(e,t,r,n){o.prototype.initFromNode.call(this,e,t,r,n),u.prototype.initFromNode.call(this,e,t,r,n),s.prototype.initFromNode.call(this,e,t,r,n),i.prototype.initFromNode.call(this,e,t,r,n),l.prototype.initFromNode.call(this,e,t,r,n)},A.prototype.initFromNode=function(e,t,r,n){o.prototype.initFromNode.call(this,e,t,r,n),u.prototype.initFromNode.call(this,e,t,r,n),s.prototype.initFromNode.call(this,e,t,r,n),i.prototype.initFromNode.call(this,e,t,r,n),l.prototype.initFromNode.call(this,e,t,r,n)},R.prototype.initFromNode=function(e,t,r,n,a){o.prototype.initFromNode.call(this,e,t,r,a),u.prototype.initFromNode.call(this,e,t,r,a),s.prototype.initFromNode.call(this,e,t,r,a),i.prototype.initFromNode.call(this,e,t,r,a),l.prototype.initFromNode.call(this,e,t,r,a),this.space=n},I.prototype.initFromText=function(e,t,r,n,a){u.prototype.initFromNode.call(this,e,t,null,a),this.text=r,this.space=n},w.prototype.initFromNode=function(e,t,r,n){i.prototype.initFromNode.call(this,e,t,r,n),u.prototype.initFromNode.call(this,e,t,r,n)},C.prototype.createDefaultRegion=function(){var e=new C;return a.call(e,""),o.call(e,{}),s.call(e,[]),u.call(e,0,Number.POSITIVE_INFINITY,null),e},C.prototype.initFromNode=function(e,t,r){a.prototype.initFromNode.call(this,e,null,t,r),o.prototype.initFromNode.call(this,e,null,t,r),u.prototype.initFromNode.call(this,e,null,t,r),s.prototype.initFromNode.call(this,e,null,t,r),null!==e.head&&null!==e.head.styling&&D(e.head.styling,f(t),this.styleAttrs,r)},N.prototype.initFromNode=function(e,t,r,n){u.prototype.initFromNode.call(this,e,t,r,n);var a,i=d(r,n);for(a in this.qname=null,this.value=null,i){if(this.qname){P(n,"More than one style specified on set");break}this.qname=a,this.value=i[a]}}},"./node_modules/imsc/src/main/js/html.js":(e,t,r)=>{!function(e,m){function p(e,t,r){for(var n in e){var a=e[n].elements.length,i=e[n].elements[e[n].start_elem],o=e[n].elements[e[n].end_elem],s=Math.ceil(t)+"px",n="-"+Math.ceil(t)+"px";0!==a&&("lr"===r.ipd?(i.node.style.borderLeftColor=i.bgcolor||"#00000000",i.node.style.borderLeftStyle="solid",i.node.style.borderLeftWidth=s,i.node.style.marginLeft=n):"rl"===r.ipd?(i.node.style.borderRightColor=i.bgcolor||"#00000000",i.node.style.borderRightStyle="solid",i.node.style.borderRightWidth=s,i.node.style.marginRight=n):"tb"===r.ipd&&(i.node.style.borderTopColor=i.bgcolor||"#00000000",i.node.style.borderTopStyle="solid",i.node.style.borderTopWidth=s,i.node.style.marginTop=n),"lr"===r.ipd?(o.node.style.borderRightColor=o.bgcolor||"#00000000",o.node.style.borderRightStyle="solid",o.node.style.borderRightWidth=s,o.node.style.marginRight=n):"rl"===r.ipd?(o.node.style.borderLeftColor=o.bgcolor||"#00000000",o.node.style.borderLeftStyle="solid",o.node.style.borderLeftWidth=s,o.node.style.marginLeft=n):"tb"===r.ipd&&(o.node.style.borderBottomColor=o.bgcolor||"#00000000",o.node.style.borderBottomStyle="solid",o.node.style.borderBottomWidth=s,o.node.style.marginBottom=n))}}function y(e){for(var t=0;t<e.length-1;t++){var r,n=e[t].elements.length;0!==n&&!1===e[t].br&&(r=document.createElement("br"),(n=e[t].elements[n-1].node).parentElement.insertBefore(r,n.nextSibling))}}function E(e,t,r,n){for(var a=Math.sign(r-t),i=0;i<=e.length;i++){var o,s,l=0===i?t:i===e.length?r:(e[i].before+e[i-1].after)/2;if(0<i)for(var u=0;u<e[i-1].elements.length;u++)null!==e[i-1].elements[u].bgcolor&&a*((s=e[i-1].elements[u]).after-l)<0&&(o=Math.ceil(Math.abs(l-s.after))+"px",s.node.style.backgroundColor=s.bgcolor,"lr"===n.bpd?s.node.style.paddingRight=o:"rl"===n.bpd?s.node.style.paddingLeft=o:"tb"===n.bpd&&(s.node.style.paddingBottom=o));if(i<e.length)for(var c=0;c<e[i].elements.length;c++)null!==(s=e[i].elements[c]).bgcolor&&0<a*(s.before-l)&&(o=Math.ceil(Math.abs(s.before-l))+"px",s.node.style.backgroundColor=s.bgcolor,"lr"===n.bpd?s.node.style.paddingLeft=o:"rl"===n.bpd?s.node.style.paddingRight=o:"tb"===n.bpd&&(s.node.style.paddingTop=o))}}function _(e,t){this.id=e,this.plist=t}function v(e,t){var r={before:null,after:null,start:null,end:null};return"tb"===t.bpd?(r.before=e.top,r.after=e.bottom,"lr"===t.ipd?(r.start=e.left,r.end=e.right):(r.start=e.right,r.end=e.left)):"lr"===t.bpd?(r.before=e.left,r.after=e.right,r.start=e.top,r.end=e.bottom):"rl"===t.bpd&&(r.before=e.right,r.after=e.left,r.start=e.top,r.end=e.bottom),r}function T(e,t,r,n){var a,i,o,s,l=t.style.backgroundColor||n;if(0===t.childElementCount)"span"===t.localName?0!==(s=t.getBoundingClientRect()).height&&0!==s.width&&(a=v(s,e),0!==r.length&&(i=a.before,n=a.after,o=r[r.length-1].before,s=r[r.length-1].after,n<s&&o<i||s<=n&&i<=o)?(i=Math.sign(a.after-a.before),o=Math.sign(a.end-a.start),i*(a.before-r[r.length-1].before)<0&&(r[r.length-1].before=a.before),0<i*(a.after-r[r.length-1].after)&&(r[r.length-1].after=a.after),o*(a.start-r[r.length-1].start)<0&&(r[r.length-1].start=a.start,r[r.length-1].start_elem=r[r.length-1].elements.length),0<o*(a.end-r[r.length-1].end)&&(r[r.length-1].end=a.end,r[r.length-1].end_elem=r[r.length-1].elements.length)):r.push({before:a.before,after:a.after,start:a.start,end:a.end,start_elem:0,end_elem:0,elements:[],text:"",br:!1}),r[r.length-1].text+=t.textContent,r[r.length-1].elements.push({node:t,bgcolor:l,before:a.before,after:a.after})):"br"===t.localName&&0!==r.length&&(r[r.length-1].br=!0);else for(var u=t.firstChild;u;)u.nodeType===Node.ELEMENT_NODE&&T(e,u,r,l),u=u.nextSibling}function t(e,t){this.qname=e,this.map=t}e.render=function(e,t,r,n,a,i,o,s,l){var u=n||t.clientHeight,n=a||t.clientWidth;null!==e.aspectRatio&&(n<(a=u*e.aspectRatio)?u=Math.round(n/e.aspectRatio):n=a);var c=document.createElement("div");c.style.position="relative",c.style.width=n+"px",c.style.height=u+"px",c.style.margin="auto",c.style.top=0,c.style.bottom=0,c.style.left=0,c.style.right=0,c.style.zIndex=0;var f,d={h:u,w:n,regionH:null,regionW:null,imgResolver:r,displayForcedOnlyMode:i||!1,isd:e,errorHandler:o,previousISDState:s,enableRollUp:l||!1,currentISDState:{},flg:null,lp:null,mra:null,ipd:null,bpd:null};for(f in t.appendChild(c),e.contents)!function e(t,r,n){var a;"region"===n.kind?(a=document.createElement("div")).style.position="absolute":"body"===n.kind||"div"===n.kind?a=document.createElement("div"):"p"===n.kind?a=document.createElement("p"):"span"===n.kind?a=document.createElement("span"):"br"===n.kind&&(a=document.createElement("br"));if(!a)return void S(t.errorHandler,"Error processing ISD element kind: "+n.kind);a.style.margin="0";for(var i in b){var o=b[i],i=n.styleAttrs[o.qname];void 0!==i&&null!==o.map&&o.map(t,a,n,i)}var s=a;"region"===n.kind&&("lrtb"===(l=n.styleAttrs[m.byName.writingMode.qname])||"lr"===l?(t.ipd="lr",t.bpd="tb"):"rltb"===l||"rl"===l?(t.ipd="rl",t.bpd="tb"):"tblr"===l?(t.ipd="tb",t.bpd="lr"):"tbrl"!==l&&"tb"!==l||(t.ipd="tb",t.bpd="rl"));var l=n.styleAttrs[m.byName.linePadding.qname];l&&0<l&&(u=Math.ceil(l*t.h)+"px","tb"===t.bpd?(s.style.paddingLeft=u,s.style.paddingRight=u):(s.style.paddingTop=u,s.style.paddingBottom=u),t.lp=l);var u=n.styleAttrs[m.byName.multiRowAlign.qname];u&&"auto"!==u&&((l=document.createElement("span")).style.display="inline-block",l.style.textAlign=u,a.appendChild(l),s=l,t.mra=u);n.styleAttrs[m.byName.fillLineGap.qname]&&(t.flg=!0);if("span"===n.kind&&n.text)if(t.lp||t.mra||t.flg)for(var c="",f=0;f<n.text.length;f++){c+=n.text.charAt(f);var d=n.text.charCodeAt(f);(d<55296||56319<d||f===n.text.length)&&((d=document.createElement("span")).textContent=c,a.appendChild(d),c="")}else a.textContent=n.text;r.appendChild(a);for(var g in n.contents)e(t,s,n.contents[g]);r=[];(t.lp||t.mra||t.flg)&&"p"===n.kind&&(T(t,s,r,null),t.mra&&(y(r),t.mra=null),t.lp&&(p(r,t.lp*t.h,t),t.lp=null),t.flg&&(h=v(s.getBoundingClientRect(),t),E(r,h.before,h.after,t),t.flg=null));{var h;"region"===n.kind&&(T(t,s,r),"tb"===t.bpd&&t.enableRollUp&&0<n.contents.length&&"after"===n.styleAttrs[m.byName.displayAlign.qname]&&(h=""===n.id?"_":n.id,h=new _(h,r),t.currentISDState[h.id]=h,t.previousISDState&&h.id in t.previousISDState&&0<t.previousISDState[h.id].plist.length&&1<h.plist.length&&h.plist[h.plist.length-2].text===t.previousISDState[h.id].plist[t.previousISDState[h.id].plist.length-1].text&&(r=a.firstElementChild,h=h.plist[h.plist.length-1].after-h.plist[h.plist.length-1].before,r.style.bottom="-"+h+"px",r.style.transition="transform 0.4s",r.style.position="relative",r.style.transform="translateY(-"+h+"px)")))}}(d,c,e.contents[f]);return d.currentISDState};var r,b=[new t("http://www.w3.org/ns/ttml#styling backgroundColor",function(e,t,r,n){0!==n[3]&&(t.style.backgroundColor="rgba("+n[0].toString()+","+n[1].toString()+","+n[2].toString()+","+(n[3]/255).toString()+")")}),new t("http://www.w3.org/ns/ttml#styling color",function(e,t,r,n){t.style.color="rgba("+n[0].toString()+","+n[1].toString()+","+n[2].toString()+","+(n[3]/255).toString()+")"}),new t("http://www.w3.org/ns/ttml#styling direction",function(e,t,r,n){t.style.direction=n}),new t("http://www.w3.org/ns/ttml#styling display",function(e,t,r,n){}),new t("http://www.w3.org/ns/ttml#styling displayAlign",function(e,t,r,n){t.style.display="flex",t.style.flexDirection="column","before"===n?t.style.justifyContent="flex-start":"center"===n?t.style.justifyContent="center":"after"===n&&(t.style.justifyContent="flex-end")}),new t("http://www.w3.org/ns/ttml#styling extent",function(e,t,r,n){e.regionH=n.h*e.h,e.regionW=n.w*e.w;var a=0,n=0,r=r.styleAttrs["http://www.w3.org/ns/ttml#styling padding"];r&&(a=(r[0]+r[2])*e.h,n=(r[1]+r[3])*e.w),t.style.height=e.regionH-a+"px",t.style.width=e.regionW-n+"px"}),new t("http://www.w3.org/ns/ttml#styling fontFamily",function(e,t,r,n){var a,i=[];for(a in n)"monospaceSerif"===n[a]?(i.push("Courier New"),i.push('"Liberation Mono"'),i.push("Courier"),i.push("monospace")):"proportionalSansSerif"===n[a]?(i.push("Arial"),i.push("Helvetica"),i.push('"Liberation Sans"'),i.push("sans-serif")):"monospace"===n[a]?i.push("monospace"):"sansSerif"===n[a]?i.push("sans-serif"):"serif"===n[a]?i.push("serif"):"monospaceSansSerif"===n[a]?(i.push("Consolas"),i.push("monospace")):"proportionalSerif"===n[a]?i.push("serif"):i.push(n[a]);t.style.fontFamily=i.join(",")}),new t("http://www.w3.org/ns/ttml#styling fontSize",function(e,t,r,n){t.style.fontSize=n*e.h+"px"}),new t("http://www.w3.org/ns/ttml#styling fontStyle",function(e,t,r,n){t.style.fontStyle=n}),new t("http://www.w3.org/ns/ttml#styling fontWeight",function(e,t,r,n){t.style.fontWeight=n}),new t("http://www.w3.org/ns/ttml#styling lineHeight",function(e,t,r,n){t.style.lineHeight="normal"===n?"normal":n*e.h+"px"}),new t("http://www.w3.org/ns/ttml#styling opacity",function(e,t,r,n){t.style.opacity=n}),new t("http://www.w3.org/ns/ttml#styling origin",function(e,t,r,n){t.style.top=n.h*e.h+"px",t.style.left=n.w*e.w+"px"}),new t("http://www.w3.org/ns/ttml#styling overflow",function(e,t,r,n){t.style.overflow=n}),new t("http://www.w3.org/ns/ttml#styling padding",function(e,t,r,n){var a=[];a[0]=n[0]*e.h+"px",a[1]=n[3]*e.w+"px",a[2]=n[2]*e.h+"px",a[3]=n[1]*e.w+"px",t.style.padding=a.join(" ")}),new t("http://www.w3.org/ns/ttml#styling showBackground",null),new t("http://www.w3.org/ns/ttml#styling textAlign",function(e,t,r,n){r=r.styleAttrs[m.byName.direction.qname],n="start"===n?"rtl"===r?"right":"left":"end"===n?"rtl"===r?"left":"right":n;t.style.textAlign=n}),new t("http://www.w3.org/ns/ttml#styling textDecoration",function(e,t,r,n){t.style.textDecoration=n.join(" ").replace("lineThrough","line-through")}),new t("http://www.w3.org/ns/ttml#styling textOutline",function(e,t,r,n){t.style.textShadow="none"===n?"":"rgba("+n.color[0].toString()+","+n.color[1].toString()+","+n.color[2].toString()+","+(n.color[3]/255).toString()+") 0px 0px "+n.thickness*e.h+"px"}),new t("http://www.w3.org/ns/ttml#styling unicodeBidi",function(e,t,r,n){n="bidiOverride"===n?"bidi-override":n;t.style.unicodeBidi=n}),new t("http://www.w3.org/ns/ttml#styling visibility",function(e,t,r,n){t.style.visibility=n}),new t("http://www.w3.org/ns/ttml#styling wrapOption",function(e,t,r,n){"wrap"===n?"preserve"===r.space?t.style.whiteSpace="pre-wrap":t.style.whiteSpace="normal":"preserve"===r.space?t.style.whiteSpace="pre":t.style.whiteSpace="noWrap"}),new t("http://www.w3.org/ns/ttml#styling writingMode",function(e,t,r,n){"lrtb"===n||"lr"===n||"rltb"===n||"rl"===n?t.style.writingMode="horizontal-tb":"tblr"===n?t.style.writingMode="vertical-lr":"tbrl"!==n&&"tb"!==n||(t.style.writingMode="vertical-rl")}),new t("http://www.w3.org/ns/ttml#styling zIndex",function(e,t,r,n){t.style.zIndex=n}),new t("http://www.smpte-ra.org/schemas/2052-1/2010/smpte-tt backgroundImage",function(e,t,r,n){var a;null!==e.imgResolver&&null!==n&&(a=document.createElement("img"),(n=e.imgResolver(n,a))&&(a.src=n),a.height=e.regionH,a.width=e.regionW,t.appendChild(a))}),new t("http://www.w3.org/ns/ttml/profile/imsc1#styling forcedDisplay",function(e,t,r,n){e.displayForcedOnlyMode&&!1===n&&(t.style.visibility="hidden")})],n={};for(r in b)n[b[r].qname]=b[r];function S(e,t){if(e&&e.error&&e.error(t))throw t}}(t,("undefined"==typeof imscNames&&r("./node_modules/imsc/src/main/js/names.js"),"undefined"==typeof imscStyles?r("./node_modules/imsc/src/main/js/styles.js"):imscStyles))},"./node_modules/imsc/src/main/js/isd.js":(e,t,r)=>{function D(e,t){if("contents"in e)for(var r in e.contents)D(e.contents[r],t);else t.push(e)}function M(e){if("br"!==e.kind){if("text"in e)return 0===e.text.length;if("contents"in e){for(var t=e.contents.length;t--;)M(e.contents[t])&&e.contents.splice(t,1);return 0===e.contents.length}}}function s(e){this.contents=[],this.aspectRatio=e.aspectRatio}function O(e){for(var t in this.kind=e.kind||"region",e.id&&(this.id=e.id),this.styleAttrs={},e.styleAttrs)this.styleAttrs[t]=e.styleAttrs[t];"text"in e?this.text=e.text:"br"!==e.kind&&(this.contents=[]),"space"in e&&(this.space=e.space)}function P(e,t){if(e&&e.error&&e.error(t))throw t}var L;t=t,"undefined"==typeof imscNames&&r("./node_modules/imsc/src/main/js/names.js"),L="undefined"==typeof imscStyles?r("./node_modules/imsc/src/main/js/styles.js"):imscStyles,t.generateISD=function(e,t,r){var n,a=new s(e),i={};for(n in e.head.layout.regions){var o=function e(t,r,n,a,i,o,s,l,u){if(r<s.begin||r>=s.end)return null;var c="regionID"in s&&""!==s.regionID?s.regionID:o;if(null!==i&&c!==n.id&&(!("contents"in s)||"contents"in s&&0===s.contents.length||""!==c))return null;var f=new O(s);for(var d in s.sets)r<s.sets[d].begin||r>=s.sets[d].end||(f.styleAttrs[s.sets[d].qname]=s.sets[d].value);var g={};for(var h in f.styleAttrs)g[h]=!0,h!==L.byName.writingMode.qname||L.byName.direction.qname in f.styleAttrs||("lrtb"===(h=f.styleAttrs[h])||"lr"===h?f.styleAttrs[L.byName.direction.qname]="ltr":"rltb"!==h&&"rl"!==h||(f.styleAttrs[L.byName.direction.qname]="rtl"));if(null!==i)for(var m in L.all){var p,y,E=L.all[m];E.qname===L.byName.textDecoration.qname?(p=i.styleAttrs[E.qname],y=f.styleAttrs[E.qname],m=[],void 0===y?m=p:-1===y.indexOf("none")?((-1===y.indexOf("noUnderline")&&-1!==p.indexOf("underline")||-1!==y.indexOf("underline"))&&m.push("underline"),(-1===y.indexOf("noLineThrough")&&-1!==p.indexOf("lineThrough")||-1!==y.indexOf("lineThrough"))&&m.push("lineThrough"),(-1===y.indexOf("noOverline")&&-1!==p.indexOf("overline")||-1!==y.indexOf("overline"))&&m.push("overline")):m.push("none"),f.styleAttrs[E.qname]=m):E.inherit&&E.qname in i.styleAttrs&&!(E.qname in f.styleAttrs)&&(f.styleAttrs[E.qname]=i.styleAttrs[E.qname])}for(var _ in L.all){var _=L.all[_];_.qname in f.styleAttrs||("region"===f.kind||!1===_.inherit&&null!==_.initial)&&(f.styleAttrs[_.qname]=_.parse(_.initial),g[_.qname]=!0)}for(var v in L.all){var T=L.all[v];T.qname in g&&null!==T.compute&&(null!==(v=T.compute(t,i,f,f.styleAttrs[T.qname],u))?f.styleAttrs[T.qname]=v:P(l,"Style '"+T.qname+"' on element '"+f.kind+"' cannot be computed"))}if("none"===f.styleAttrs[L.byName.display.qname])return null;var b;null===i?b=null===a?[]:[a]:"contents"in s&&(b=s.contents);for(var S in b){var S=e(t,r,n,a,f,c,b[S],l,u);null!==S&&f.contents.push(S.element)}for(var A in f.styleAttrs){var R=L.byQName[A];-1===R.applies.indexOf(f.kind)&&delete f.styleAttrs[A]}"span"===f.kind&&f.text&&"default"===f.space&&(o=f.text.replace(/\s+/g," "),f.text=o);if("p"===f.kind){var I=[];D(f,I);for(var w=0,C="after_br",N=0;;)if("after_br"===C)w>=I.length||"br"===I[w].kind?(C="before_br",N=w,w--):("preserve"!==I[w].space&&(I[w].text=I[w].text.replace(/^\s+/g,"")),0<I[w].text.length?(C="looking_br",w++):I.splice(w,1));else if("before_br"===C)if(w<0||"br"===I[w].kind){if(C="after_br",(w=N+1)>=I.length)break}else if("preserve"!==I[w].space&&(I[w].text=I[w].text.replace(/\s+$/g,"")),0<I[w].text.length){if(C="after_br",(w=N+1)>=I.length)break}else I.splice(w,1),w--;else w>=I.length||"br"===I[w].kind?(C="before_br",N=w,w--):w++;M(f)}if("div"===f.kind&&L.byName.backgroundImage.qname in f.styleAttrs||"br"===f.kind||"contents"in f&&0<f.contents.length||"span"===f.kind&&null!==f.text||"region"===f.kind&&"always"===f.styleAttrs[L.byName.showBackground.qname])return{region_id:c,element:f};return null}(e,t,e.head.layout.regions[n],e.body,null,"",e.head.layout.regions[n],r,i);null!==o&&a.contents.push(o.element)}return a}},"./node_modules/imsc/src/main/js/main.js":(e,t,r)=>{t.generateISD=r("./node_modules/imsc/src/main/js/isd.js").generateISD,t.fromXML=r("./node_modules/imsc/src/main/js/doc.js").fromXML,t.renderHTML=r("./node_modules/imsc/src/main/js/html.js").render},"./node_modules/imsc/src/main/js/names.js":(e,t)=>{(t=t).ns_tt="http://www.w3.org/ns/ttml",t.ns_tts="http://www.w3.org/ns/ttml#styling",t.ns_ttp="http://www.w3.org/ns/ttml#parameter",t.ns_xml="http://www.w3.org/XML/1998/namespace",t.ns_itts="http://www.w3.org/ns/ttml/profile/imsc1#styling",t.ns_ittp="http://www.w3.org/ns/ttml/profile/imsc1#parameter",t.ns_smpte="http://www.smpte-ra.org/schemas/2052-1/2010/smpte-tt",t.ns_ebutts="urn:ebu:tt:style"},"./node_modules/imsc/src/main/js/styles.js":(e,t,r)=>{!function(l,e,i){function t(e,t,r,n,a,i,o,s){this.name=t,this.ns=e,this.qname=e+" "+t,this.inherit=a,this.animatable=i,this.initial=r,this.applies=n,this.parse=o,this.compute=s}for(var r in l.all=[new t(e.ns_tts,"backgroundColor","transparent",["body","div","p","region","span"],!1,!0,i.parseColor,null),new t(e.ns_tts,"color","white",["span"],!0,!0,i.parseColor,null),new t(e.ns_tts,"direction","ltr",["p","span"],!0,!0,function(e){return e},null),new t(e.ns_tts,"display","auto",["body","div","p","region","span"],!1,!0,function(e){return e},null),new t(e.ns_tts,"displayAlign","before",["region"],!1,!0,function(e){return e},null),new t(e.ns_tts,"extent","auto",["tt","region"],!1,!0,function(e){if("auto"===e)return e;var t=e.split(" ");if(2!==t.length)return null;e=i.parseLength(t[0]),t=i.parseLength(t[1]);return t&&e?{h:t,w:e}:null},function(e,t,r,n,a){var i,o;if("auto"===n)i=1;else if("%"===n.h.unit)i=n.h.value/100;else{if("px"!==n.h.unit)return null;i=n.h.value/e.pxDimensions.h}if("auto"===n)o=1;else if("%"===n.w.unit)o=n.w.value/100;else{if("px"!==n.w.unit)return null;o=n.w.value/e.pxDimensions.w}return{h:i,w:o}}),new t(e.ns_tts,"fontFamily","default",["span"],!0,!0,function(e){var t,r=e.split(","),n=[];for(t in r)"'"!==r[t].charAt(0)&&'"'!==r[t].charAt(0)&&"default"===r[t]?n.push("monospaceSerif"):n.push(r[t]);return n},null),new t(e.ns_tts,"fontSize","1c",["span"],!0,!0,i.parseLength,function(e,t,r,n,a){var i;if("%"===n.unit)i=null!==t?t.styleAttrs[l.byName.fontSize.qname]*n.value/100:n.value/100/e.cellResolution.h;else if("em"===n.unit)i=null!==t?t.styleAttrs[l.byName.fontSize.qname]*n.value:n.value/e.cellResolution.h;else if("c"===n.unit)i=n.value/e.cellResolution.h;else{if("px"!==n.unit)return null;i=n.value/e.pxDimensions.h}return i}),new t(e.ns_tts,"fontStyle","normal",["span"],!0,!0,function(e){return e},null),new t(e.ns_tts,"fontWeight","normal",["span"],!0,!0,function(e){return e},null),new t(e.ns_tts,"lineHeight","normal",["p"],!0,!0,function(e){return"normal"===e?e:i.parseLength(e)},function(e,t,r,n,a){var i;if("normal"===n)i=n;else if("%"===n.unit)i=r.styleAttrs[l.byName.fontSize.qname]*n.value/100;else if("em"===n.unit)i=r.styleAttrs[l.byName.fontSize.qname]*n.value;else if("c"===n.unit)i=n.value/e.cellResolution.h;else{if("px"!==n.unit)return null;i=n.value/e.pxDimensions.h}return i}),new t(e.ns_tts,"opacity",1,["region"],!1,!0,parseFloat,null),new t(e.ns_tts,"origin","auto",["region"],!1,!0,function(e){if("auto"===e)return e;var t=e.split(" ");if(2!==t.length)return null;e=i.parseLength(t[0]),t=i.parseLength(t[1]);return t&&e?{h:t,w:e}:null},function(e,t,r,n,a){var i,o;if("auto"===n)i=0;else if("%"===n.h.unit)i=n.h.value/100;else{if("px"!==n.h.unit)return null;i=n.h.value/e.pxDimensions.h}if("auto"===n)o=0;else if("%"===n.w.unit)o=n.w.value/100;else{if("px"!==n.w.unit)return null;o=n.w.value/e.pxDimensions.w}return{h:i,w:o}}),new t(e.ns_tts,"overflow","hidden",["region"],!1,!0,function(e){return e},null),new t(e.ns_tts,"padding","0px",["region"],!1,!0,function(e){var t=e.split(" ");if(4<t.length)return null;var r,n=[];for(r in t){var a=i.parseLength(t[r]);if(!a)return null;n.push(a)}return n},function(e,t,r,n,a){var i;if(1===n.length)i=[n[0],n[0],n[0],n[0]];else if(2===n.length)i=[n[0],n[1],n[0],n[1]];else if(3===n.length)i=[n[0],n[1],n[2],n[1]];else{if(4!==n.length)return null;i=[n[0],n[1],n[2],n[3]]}n=r.styleAttrs[l.byName.writingMode.qname];if("lrtb"===n||"lr"===n)i=[i[0],i[3],i[2],i[1]];else if("rltb"===n||"rl"===n)i=[i[0],i[1],i[2],i[3]];else if("tblr"===n)i=[i[3],i[0],i[1],i[2]];else{if("tbrl"!==n&&"tb"!==n)return null;i=[i[3],i[2],i[1],i[0]]}var o,s=[];for(o in i)if(0===i[o].value)s[o]=0;else if("%"===i[o].unit)s[o]="0"===o||"2"===o?r.styleAttrs[l.byName.extent.qname].h*i[o].value/100:r.styleAttrs[l.byName.extent.qname].w*i[o].value/100;else if("em"===i[o].unit)s[o]=r.styleAttrs[l.byName.fontSize.qname]*i[o].value;else if("c"===i[o].unit)s[o]=i[o].value/e.cellResolution.h;else{if("px"!==i[o].unit)return null;s[o]="0"===o||"2"===o?i[o].value/e.pxDimensions.h:i[o].value/e.pxDimensions.w}return s}),new t(e.ns_tts,"showBackground","always",["region"],!1,!0,function(e){return e},null),new t(e.ns_tts,"textAlign","start",["p"],!0,!0,function(e){return e},function(e,t,r,n,a){return"left"===n?"start":"right"===n?"end":n}),new t(e.ns_tts,"textDecoration","none",["span"],!0,!0,function(e){return e.split(" ")},null),new t(e.ns_tts,"textOutline","none",["span"],!0,!0,function(e){if("none"===e)return e;var t={},r=e.split(" ");if(0===r.length||2<r.length)return null;e=i.parseColor(r[0]);if(null!==(t.color=e)&&r.shift(),1!==r.length)return null;r=i.parseLength(r[0]);return r?(t.thickness=r,t):null},function(e,t,r,n,a){if("none"===n)return n;var i={};if(null===n.color?i.color=r.styleAttrs[l.byName.color.qname]:i.color=n.color,"%"===n.thickness.unit)i.thickness=r.styleAttrs[l.byName.fontSize.qname]*n.thickness.value/100;else if("em"===n.thickness.unit)i.thickness=r.styleAttrs[l.byName.fontSize.qname]*n.thickness.value;else if("c"===n.thickness.unit)i.thickness=n.thickness.value/e.cellResolution.h;else{if("px"!==n.thickness.unit)return null;i.thickness=n.thickness.value/e.pxDimensions.h}return i}),new t(e.ns_tts,"unicodeBidi","normal",["span","p"],!1,!0,function(e){return e},null),new t(e.ns_tts,"visibility","visible",["body","div","p","region","span"],!0,!0,function(e){return e},null),new t(e.ns_tts,"wrapOption","wrap",["span"],!0,!0,function(e){return e},null),new t(e.ns_tts,"writingMode","lrtb",["region"],!1,!0,function(e){return e},null),new t(e.ns_tts,"zIndex","auto",["region"],!1,!0,function(e){var t;return"auto"===e?t=e:(t=parseInt(e),isNaN(t)&&(t=null)),t},null),new t(e.ns_ebutts,"linePadding","0c",["p"],!0,!1,i.parseLength,function(e,t,r,n,a){return"c"===n.unit?n.value/e.cellResolution.h:null}),new t(e.ns_ebutts,"multiRowAlign","auto",["p"],!0,!1,function(e){return e},null),new t(e.ns_smpte,"backgroundImage",null,["div"],!1,!1,function(e){return e},null),new t(e.ns_itts,"forcedDisplay","false",["body","div","p","region","span"],!0,!0,function(e){return"true"===e},null),new t(e.ns_itts,"fillLineGap","false",["p"],!0,!0,function(e){return"true"===e},null)],l.byQName={},l.all)l.byQName[l.all[r].qname]=l.all[r];for(var n in l.byName={},l.all)l.byName[l.all[n].name]=l.all[n]}(t,"undefined"==typeof imscNames?r("./node_modules/imsc/src/main/js/names.js"):imscNames,"undefined"==typeof imscUtils?r("./node_modules/imsc/src/main/js/utils.js"):imscUtils)},"./node_modules/imsc/src/main/js/utils.js":(e,t)=>{!function(e){var n=/#([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})?/,a=/rgb\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/,i=/rgba\(\s*(\d+),\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/,o={transparent:[0,0,0,0],black:[0,0,0,255],silver:[192,192,192,255],gray:[128,128,128,255],white:[255,255,255,255],maroon:[128,0,0,255],red:[255,0,0,255],purple:[128,0,128,255],fuchsia:[255,0,255,255],magenta:[255,0,255,255],green:[0,128,0,255],lime:[0,255,0,255],olive:[128,128,0,255],yellow:[255,255,0,255],navy:[0,0,128,255],blue:[0,0,255,255],teal:[0,128,128,255],aqua:[0,255,255,255],cyan:[0,255,255,255]};e.parseColor=function(e){var t=null,r=o[e.toLowerCase()];return void 0!==r?t=r:null!==(r=n.exec(e))?t=[parseInt(r[1],16),parseInt(r[2],16),parseInt(r[3],16),void 0!==r[4]?parseInt(r[4],16):255]:null!==(r=a.exec(e))?t=[parseInt(r[1]),parseInt(r[2]),parseInt(r[3]),255]:null!==(r=i.exec(e))&&(t=[parseInt(r[1]),parseInt(r[2]),parseInt(r[3]),parseInt(r[4])]),t};var r=/^((?:\+|\-)?\d*(?:\.\d+)?)(px|em|c|%)$/;e.parseLength=function(e){var t=null;return t=null!==(e=r.exec(e))?{value:parseFloat(e[1]),unit:e[2]}:t}}(t)},"./node_modules/is-alphabetical/index.js":e=>{e.exports=function(e){e="string"==typeof e?e.charCodeAt(0):e;return 97<=e&&e<=122||65<=e&&e<=90}},"./node_modules/is-alphanumerical/index.js":(e,t,r)=>{var n=r("./node_modules/is-alphabetical/index.js"),a=r("./node_modules/is-decimal/index.js");e.exports=function(e){return n(e)||a(e)}},"./node_modules/is-decimal/index.js":e=>{e.exports=function(e){e="string"==typeof e?e.charCodeAt(0):e;return 48<=e&&e<=57}},"./node_modules/path-browserify/index.js":e=>{function d(e){if("string"!=typeof e)throw new TypeError("Path must be a string. Received "+JSON.stringify(e))}function i(e,t){for(var r,n="",a=0,i=-1,o=0,s=0;s<=e.length;++s){if(s<e.length)r=e.charCodeAt(s);else{if(47===r)break;r=47}if(47===r){if(i!==s-1&&1!==o)if(i!==s-1&&2===o){if(n.length<2||2!==a||46!==n.charCodeAt(n.length-1)||46!==n.charCodeAt(n.length-2))if(2<n.length){var l=n.lastIndexOf("/");if(l!==n.length-1){a=-1===l?(n="",0):(n=n.slice(0,l)).length-1-n.lastIndexOf("/"),i=s,o=0;continue}}else if(2===n.length||1===n.length){n="",i=s,o=a=0;continue}t&&(0<n.length?n+="/..":n="..",a=2)}else 0<n.length?n+="/"+e.slice(i+1,s):n=e.slice(i+1,s),a=s-i-1;i=s,o=0}else 46===r&&-1!==o?++o:o=-1}return n}var g={resolve:function(){for(var e,t="",r=!1,n=arguments.length-1;-1<=n&&!r;n--){var a=0<=n?arguments[n]:e=void 0===e?ie.cwd():e;d(a),0!==a.length&&(t=a+"/"+t,r=47===a.charCodeAt(0))}return t=i(t,!r),r?0<t.length?"/"+t:"/":0<t.length?t:"."},normalize:function(e){if(d(e),0===e.length)return".";var t=47===e.charCodeAt(0),r=47===e.charCodeAt(e.length-1);return 0<(e=0===(e=i(e,!t)).length&&!t?".":e).length&&r&&(e+="/"),t?"/"+e:e},isAbsolute:function(e){return d(e),0<e.length&&47===e.charCodeAt(0)},join:function(){if(0===arguments.length)return".";for(var e,t=0;t<arguments.length;++t){var r=arguments[t];d(r),0<r.length&&(void 0===e?e=r:e+="/"+r)}return void 0===e?".":g.normalize(e)},relative:function(e,t){if(d(e),d(t),e===t)return"";if((e=g.resolve(e))===(t=g.resolve(t)))return"";for(var r=1;r<e.length&&47===e.charCodeAt(r);++r);for(var n=e.length,a=n-r,i=1;i<t.length&&47===t.charCodeAt(i);++i);for(var o=t.length-i,s=a<o?a:o,l=-1,u=0;u<=s;++u){if(u===s){if(s<o){if(47===t.charCodeAt(i+u))return t.slice(i+u+1);if(0===u)return t.slice(i+u)}else s<a&&(47===e.charCodeAt(r+u)?l=u:0===u&&(l=0));break}var c=e.charCodeAt(r+u);if(c!==t.charCodeAt(i+u))break;47===c&&(l=u)}for(var f="",u=r+l+1;u<=n;++u)u!==n&&47!==e.charCodeAt(u)||(0===f.length?f+="..":f+="/..");return 0<f.length?f+t.slice(i+l):(i+=l,47===t.charCodeAt(i)&&++i,t.slice(i))},_makeLong:function(e){return e},dirname:function(e){if(d(e),0===e.length)return".";for(var t=e.charCodeAt(0),r=47===t,n=-1,a=!0,i=e.length-1;1<=i;--i)if(47===e.charCodeAt(i)){if(!a){n=i;break}}else a=!1;return-1===n?r?"/":".":r&&1===n?"//":e.slice(0,n)},basename:function(e,t){if(void 0!==t&&"string"!=typeof t)throw new TypeError('"ext" argument must be a string');d(e);var r=0,n=-1,a=!0;if(void 0!==t&&0<t.length&&t.length<=e.length){if(t.length===e.length&&t===e)return"";for(var i=t.length-1,o=-1,s=e.length-1;0<=s;--s){var l=e.charCodeAt(s);if(47===l){if(!a){r=s+1;break}}else-1===o&&(a=!1,o=s+1),0<=i&&(l===t.charCodeAt(i)?-1==--i&&(n=s):(i=-1,n=o))}return r===n?n=o:-1===n&&(n=e.length),e.slice(r,n)}for(s=e.length-1;0<=s;--s)if(47===e.charCodeAt(s)){if(!a){r=s+1;break}}else-1===n&&(a=!1,n=s+1);return-1===n?"":e.slice(r,n)},extname:function(e){d(e);for(var t=-1,r=0,n=-1,a=!0,i=0,o=e.length-1;0<=o;--o){var s=e.charCodeAt(o);if(47===s){if(a)continue;r=o+1;break}-1===n&&(a=!1,n=o+1),46===s?-1===t?t=o:1!==i&&(i=1):-1!==t&&(i=-1)}return-1===t||-1===n||0===i||1===i&&t===n-1&&t===r+1?"":e.slice(t,n)},format:function(e){if(null===e||"object"!=typeof e)throw new TypeError('The "pathObject" argument must be of type Object. Received type '+typeof e);return t="/",n=(r=e).dir||r.root,e=r.base||(r.name||"")+(r.ext||""),n?n===r.root?n+e:n+t+e:e;var t,r,n},parse:function(e){d(e);var t={root:"",dir:"",base:"",ext:"",name:""};if(0===e.length)return t;for(var r=e.charCodeAt(0),n=47===r,a=n?(t.root="/",1):0,i=-1,o=0,s=-1,l=!0,u=e.length-1,c=0;a<=u;--u){if(47===(r=e.charCodeAt(u))){if(l)continue;o=u+1;break}-1===s&&(l=!1,s=u+1),46===r?-1===i?i=u:1!==c&&(c=1):-1!==i&&(c=-1)}return-1===i||-1===s||0===c||1===c&&i===s-1&&i===o+1?-1!==s&&(t.base=t.name=0===o&&n?e.slice(1,s):e.slice(o,s)):(0===o&&n?(t.name=e.slice(1,i),t.base=e.slice(1,s)):(t.name=e.slice(o,i),t.base=e.slice(o,s)),t.ext=e.slice(i,s)),0<o?t.dir=e.slice(0,o-1):n&&(t.dir="/"),t},sep:"/",delimiter:":",win32:null,posix:null};g.posix=g,e.exports=g},"./node_modules/safe-buffer/index.js":(e,t,r)=>{var n=r("./node_modules/buffer/index.js"),a=n.Buffer;function i(e,t){for(var r in e)t[r]=e[r]}function o(e,t,r){return a(e,t,r)}a.from&&a.alloc&&a.allocUnsafe&&a.allocUnsafeSlow?e.exports=n:(i(n,t),t.Buffer=o),i(a,o),o.from=function(e,t,r){if("number"==typeof e)throw new TypeError("Argument must not be a number");return a(e,t,r)},o.alloc=function(e,t,r){if("number"!=typeof e)throw new TypeError("Argument must be a number");e=a(e);return void 0!==t?"string"==typeof r?e.fill(t,r):e.fill(t):e.fill(0),e},o.allocUnsafe=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return a(e)},o.allocUnsafeSlow=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return n.SlowBuffer(e)}},"./node_modules/sax/lib/sax.js":(e,t,U)=>{!function(s){s.parser=function(e,t){return new a(e,t)},s.SAXParser=a,s.SAXStream=o,s.createStream=function(e,t){return new o(e,t)},s.MAX_BUFFER_LENGTH=65536;var n,l=["comment","sgmlDecl","textNode","tagName","doctype","procInstName","procInstBody","entity","attribName","attribValue","cdata","script"];function a(e,t){if(!(this instanceof a))return new a(e,t);var r=this;!function(e){for(var t=0,r=l.length;t<r;t++)e[l[t]]=""}(r),r.q=r.c="",r.bufferCheckPosition=s.MAX_BUFFER_LENGTH,r.opt=t||{},r.opt.lowercase=r.opt.lowercase||r.opt.lowercasetags,r.looseCase=r.opt.lowercase?"toLowerCase":"toUpperCase",r.tags=[],r.closed=r.closedRoot=r.sawRoot=!1,r.tag=r.error=null,r.strict=!!e,r.noscript=!(!e&&!r.opt.noscript),r.state=R.BEGIN,r.strictEntities=r.opt.strictEntities,r.ENTITIES=r.strictEntities?Object.create(s.XML_ENTITIES):Object.create(s.ENTITIES),r.attribList=[],r.opt.xmlns&&(r.ns=Object.create(m)),r.trackPosition=!1!==r.opt.position,r.trackPosition&&(r.position=r.line=r.column=0),I(r,"onready")}s.EVENTS=["text","processinginstruction","sgmldeclaration","doctype","comment","opentagstart","attribute","opentag","closetag","opencdata","cdata","closecdata","error","end","ready","script","opennamespace","closenamespace"],Object.create||(Object.create=function(e){function t(){}return t.prototype=e,new t}),Object.keys||(Object.keys=function(e){var t,r=[];for(t in e)e.hasOwnProperty(t)&&r.push(t);return r}),a.prototype={end:function(){M(this)},write:function(e){var t=this;if(this.error)throw this.error;if(t.closed)return D(t,"Cannot write after close. Assign an onready handler.");if(null===e)return M(t);"object"==typeof e&&(e=e.toString());var r,n,a=0,i="";for(;i=k(e,a++),t.c=i;)switch(t.trackPosition&&(t.position++,"\n"===i?(t.line++,t.column=0):t.column++),t.state){case R.BEGIN:if(t.state=R.BEGIN_WHITESPACE,"\ufeff"===i)continue;j(t,i);continue;case R.BEGIN_WHITESPACE:j(t,i);continue;case R.TEXT:if(t.sawRoot&&!t.closedRoot){for(var o=a-1;i&&"<"!==i&&"&"!==i;)(i=k(e,a++))&&t.trackPosition&&(t.position++,"\n"===i?(t.line++,t.column=0):t.column++);t.textNode+=e.substring(o,a-1)}"<"!==i||t.sawRoot&&t.closedRoot&&!t.strict?(!b(p,i)||t.sawRoot&&!t.closedRoot||O(t,"Text data outside of root node."),"&"===i?t.state=R.TEXT_ENTITY:t.textNode+=i):(t.state=R.OPEN_WAKA,t.startTagPosition=t.position);continue;case R.SCRIPT:"<"===i?t.state=R.SCRIPT_ENDING:t.script+=i;continue;case R.SCRIPT_ENDING:"/"===i?t.state=R.CLOSE_TAG:(t.script+="<"+i,t.state=R.SCRIPT);continue;case R.OPEN_WAKA:"!"===i?(t.state=R.SGML_DECL,t.sgmlDecl=""):T(p,i)||(T(y,i)?(t.state=R.OPEN_TAG,t.tagName=i):"/"===i?(t.state=R.CLOSE_TAG,t.tagName=""):"?"===i?(t.state=R.PROC_INST,t.procInstName=t.procInstBody=""):(O(t,"Unencoded <"),t.startTagPosition+1<t.position&&(o=t.position-t.startTagPosition,i=new Array(o).join(" ")+i),t.textNode+="<"+i,t.state=R.TEXT));continue;case R.SGML_DECL:(t.sgmlDecl+i).toUpperCase()===f?(w(t,"onopencdata"),t.state=R.CDATA,t.sgmlDecl="",t.cdata=""):t.sgmlDecl+i==="--"?(t.state=R.COMMENT,t.comment="",t.sgmlDecl=""):(t.sgmlDecl+i).toUpperCase()===d?(t.state=R.DOCTYPE,(t.doctype||t.sawRoot)&&O(t,"Inappropriately located doctype declaration"),t.doctype="",t.sgmlDecl=""):">"===i?(w(t,"onsgmldeclaration",t.sgmlDecl),t.sgmlDecl="",t.state=R.TEXT):(T(u,i)&&(t.state=R.SGML_DECL_QUOTED),t.sgmlDecl+=i);continue;case R.SGML_DECL_QUOTED:i===t.q&&(t.state=R.SGML_DECL,t.q=""),t.sgmlDecl+=i;continue;case R.DOCTYPE:">"===i?(t.state=R.TEXT,w(t,"ondoctype",t.doctype),t.doctype=!0):(t.doctype+=i,"["===i?t.state=R.DOCTYPE_DTD:T(u,i)&&(t.state=R.DOCTYPE_QUOTED,t.q=i));continue;case R.DOCTYPE_QUOTED:t.doctype+=i,i===t.q&&(t.q="",t.state=R.DOCTYPE);continue;case R.DOCTYPE_DTD:t.doctype+=i,"]"===i?t.state=R.DOCTYPE:T(u,i)&&(t.state=R.DOCTYPE_DTD_QUOTED,t.q=i);continue;case R.DOCTYPE_DTD_QUOTED:t.doctype+=i,i===t.q&&(t.state=R.DOCTYPE_DTD,t.q="");continue;case R.COMMENT:"-"===i?t.state=R.COMMENT_ENDING:t.comment+=i;continue;case R.COMMENT_ENDING:"-"===i?(t.state=R.COMMENT_ENDED,t.comment=N(t.opt,t.comment),t.comment&&w(t,"oncomment",t.comment),t.comment=""):(t.comment+="-"+i,t.state=R.COMMENT);continue;case R.COMMENT_ENDED:">"!==i?(O(t,"Malformed comment"),t.comment+="--"+i,t.state=R.COMMENT):t.state=R.TEXT;continue;case R.CDATA:"]"===i?t.state=R.CDATA_ENDING:t.cdata+=i;continue;case R.CDATA_ENDING:"]"===i?t.state=R.CDATA_ENDING_2:(t.cdata+="]"+i,t.state=R.CDATA);continue;case R.CDATA_ENDING_2:">"===i?(t.cdata&&w(t,"oncdata",t.cdata),w(t,"onclosecdata"),t.cdata="",t.state=R.TEXT):"]"===i?t.cdata+="]":(t.cdata+="]]"+i,t.state=R.CDATA);continue;case R.PROC_INST:"?"===i?t.state=R.PROC_INST_ENDING:T(p,i)?t.state=R.PROC_INST_BODY:t.procInstName+=i;continue;case R.PROC_INST_BODY:if(!t.procInstBody&&T(p,i))continue;"?"===i?t.state=R.PROC_INST_ENDING:t.procInstBody+=i;continue;case R.PROC_INST_ENDING:">"===i?(w(t,"onprocessinginstruction",{name:t.procInstName,body:t.procInstBody}),t.procInstName=t.procInstBody="",t.state=R.TEXT):(t.procInstBody+="?"+i,t.state=R.PROC_INST_BODY);continue;case R.OPEN_TAG:T(E,i)?t.tagName+=i:(function(e){e.strict||(e.tagName=e.tagName[e.looseCase]());var t=e.tags[e.tags.length-1]||e,r=e.tag={name:e.tagName,attributes:{}};e.opt.xmlns&&(r.ns=t.ns),e.attribList.length=0,w(e,"onopentagstart",r)}(t),">"===i?F(t):"/"===i?t.state=R.OPEN_TAG_SLASH:(b(p,i)&&O(t,"Invalid character in tag name"),t.state=R.ATTRIB));continue;case R.OPEN_TAG_SLASH:">"===i?(F(t,!0),x(t)):(O(t,"Forward-slash in opening tag not followed by >"),t.state=R.ATTRIB);continue;case R.ATTRIB:if(T(p,i))continue;">"===i?F(t):"/"===i?t.state=R.OPEN_TAG_SLASH:T(y,i)?(t.attribName=i,t.attribValue="",t.state=R.ATTRIB_NAME):O(t,"Invalid attribute name");continue;case R.ATTRIB_NAME:"="===i?t.state=R.ATTRIB_VALUE:">"===i?(O(t,"Attribute without value"),t.attribValue=t.attribName,L(t),F(t)):T(p,i)?t.state=R.ATTRIB_NAME_SAW_WHITE:T(E,i)?t.attribName+=i:O(t,"Invalid attribute name");continue;case R.ATTRIB_NAME_SAW_WHITE:if("="===i)t.state=R.ATTRIB_VALUE;else{if(T(p,i))continue;O(t,"Attribute without value"),t.tag.attributes[t.attribName]="",t.attribValue="",w(t,"onattribute",{name:t.attribName,value:""}),t.attribName="",">"===i?F(t):T(y,i)?(t.attribName=i,t.state=R.ATTRIB_NAME):(O(t,"Invalid attribute name"),t.state=R.ATTRIB)}continue;case R.ATTRIB_VALUE:if(T(p,i))continue;T(u,i)?(t.q=i,t.state=R.ATTRIB_VALUE_QUOTED):(O(t,"Unquoted attribute value"),t.state=R.ATTRIB_VALUE_UNQUOTED,t.attribValue=i);continue;case R.ATTRIB_VALUE_QUOTED:if(i!==t.q){"&"===i?t.state=R.ATTRIB_VALUE_ENTITY_Q:t.attribValue+=i;continue}L(t),t.q="",t.state=R.ATTRIB_VALUE_CLOSED;continue;case R.ATTRIB_VALUE_CLOSED:T(p,i)?t.state=R.ATTRIB:">"===i?F(t):"/"===i?t.state=R.OPEN_TAG_SLASH:T(y,i)?(O(t,"No whitespace between attributes"),t.attribName=i,t.attribValue="",t.state=R.ATTRIB_NAME):O(t,"Invalid attribute name");continue;case R.ATTRIB_VALUE_UNQUOTED:if(b(c,i)){"&"===i?t.state=R.ATTRIB_VALUE_ENTITY_U:t.attribValue+=i;continue}L(t),">"===i?F(t):t.state=R.ATTRIB;continue;case R.CLOSE_TAG:if(t.tagName)">"===i?x(t):T(E,i)?t.tagName+=i:t.script?(t.script+="</"+t.tagName,t.tagName="",t.state=R.SCRIPT):(b(p,i)&&O(t,"Invalid tagname in closing tag"),t.state=R.CLOSE_TAG_SAW_WHITE);else{if(T(p,i))continue;b(y,i)?t.script?(t.script+="</"+i,t.state=R.SCRIPT):O(t,"Invalid tagname in closing tag."):t.tagName=i}continue;case R.CLOSE_TAG_SAW_WHITE:if(T(p,i))continue;">"===i?x(t):O(t,"Invalid characters in closing tag");continue;case R.TEXT_ENTITY:case R.ATTRIB_VALUE_ENTITY_Q:case R.ATTRIB_VALUE_ENTITY_U:switch(t.state){case R.TEXT_ENTITY:r=R.TEXT,n="textNode";break;case R.ATTRIB_VALUE_ENTITY_Q:r=R.ATTRIB_VALUE_QUOTED,n="attribValue";break;case R.ATTRIB_VALUE_ENTITY_U:r=R.ATTRIB_VALUE_UNQUOTED,n="attribValue"}";"===i?(t[n]+=function(e){var t,r=e.entity,n=r.toLowerCase(),a="";if(e.ENTITIES[r])return e.ENTITIES[r];if(e.ENTITIES[n])return e.ENTITIES[n];"#"===(r=n).charAt(0)&&(a="x"===r.charAt(1)?(r=r.slice(2),(t=parseInt(r,16)).toString(16)):(r=r.slice(1),(t=parseInt(r,10)).toString(10)));return r=r.replace(/^0+/,""),a.toLowerCase()===r?String.fromCodePoint(t):(O(e,"Invalid character entity"),"&"+e.entity+";")}(t),t.entity="",t.state=r):T(t.entity.length?v:_,i)?t.entity+=i:(O(t,"Invalid character in entity name"),t[n]+="&"+t.entity+i,t.entity="",t.state=r);continue;default:throw new Error(t,"Unknown state: "+t.state)}t.position>=t.bufferCheckPosition&&function(e){for(var t=Math.max(s.MAX_BUFFER_LENGTH,10),r=0,n=0,a=l.length;n<a;n++){var i=e[l[n]].length;if(t<i)switch(l[n]){case"textNode":C(e);break;case"cdata":w(e,"oncdata",e.cdata),e.cdata="";break;case"script":w(e,"onscript",e.script),e.script="";break;default:D(e,"Max buffer length exceeded: "+l[n])}r=Math.max(r,i)}var o=s.MAX_BUFFER_LENGTH-r;e.bufferCheckPosition=o+e.position}(t);return t},resume:function(){return this.error=null,this},close:function(){return this.write(null)},flush:function(){var e;C(e=this),""!==e.cdata&&(w(e,"oncdata",e.cdata),e.cdata=""),""!==e.script&&(w(e,"onscript",e.script),e.script="")}};try{n=U("./node_modules/stream-browserify/index.js").Stream}catch(e){n=function(){}}var i=s.EVENTS.filter(function(e){return"error"!==e&&"end"!==e});function o(e,t){if(!(this instanceof o))return new o(e,t);n.apply(this),this._parser=new a(e,t),this.writable=!0,this.readable=!0;var r=this;this._parser.onend=function(){r.emit("end")},this._parser.onerror=function(e){r.emit("error",e),r._parser.error=null},this._decoder=null,i.forEach(function(t){Object.defineProperty(r,"on"+t,{get:function(){return r._parser["on"+t]},set:function(e){if(!e)return r.removeAllListeners(t),r._parser["on"+t]=e;r.on(t,e)},enumerable:!0,configurable:!1})})}(o.prototype=Object.create(n.prototype,{constructor:{value:o}})).write=function(e){var t;return ye(e)&&(this._decoder||(t=U("./node_modules/string_decoder/lib/string_decoder.js").StringDecoder,this._decoder=new t("utf8")),e=this._decoder.write(e)),this._parser.write(e.toString()),this.emit("data",e),!0},o.prototype.end=function(e){return e&&e.length&&this.write(e),this._parser.end(),!0},o.prototype.on=function(t,e){var r=this;return r._parser["on"+t]||-1===i.indexOf(t)||(r._parser["on"+t]=function(){var e=1===arguments.length?[arguments[0]]:Array.apply(null,arguments);e.splice(0,0,t),r.emit.apply(r,e)}),n.prototype.on.call(r,t,e)};var u="'\"",c=(p="\r\n\t ")+">",f="[CDATA[",d="DOCTYPE",g="http://www.w3.org/XML/1998/namespace",h="http://www.w3.org/2000/xmlns/",m={xml:g,xmlns:h},p=e(p),y=(e("0124356789"),e("abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"),/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/),E=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040\.\d-]/,_=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,v=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040\.\d-]/;function e(e){return e.split("").reduce(function(e,t){return e[t]=!0,e},{})}function T(e,t){return r=e,"[object RegExp]"===Object.prototype.toString.call(r)?t.match(e):e[t];var r}function b(e,t){return!T(e,t)}var t,S,A,u=e(u),c=e(c),R=0;for(t in s.STATE={BEGIN:R++,BEGIN_WHITESPACE:R++,TEXT:R++,TEXT_ENTITY:R++,OPEN_WAKA:R++,SGML_DECL:R++,SGML_DECL_QUOTED:R++,DOCTYPE:R++,DOCTYPE_QUOTED:R++,DOCTYPE_DTD:R++,DOCTYPE_DTD_QUOTED:R++,COMMENT_STARTING:R++,COMMENT:R++,COMMENT_ENDING:R++,COMMENT_ENDED:R++,CDATA:R++,CDATA_ENDING:R++,CDATA_ENDING_2:R++,PROC_INST:R++,PROC_INST_BODY:R++,PROC_INST_ENDING:R++,OPEN_TAG:R++,OPEN_TAG_SLASH:R++,ATTRIB:R++,ATTRIB_NAME:R++,ATTRIB_NAME_SAW_WHITE:R++,ATTRIB_VALUE:R++,ATTRIB_VALUE_QUOTED:R++,ATTRIB_VALUE_CLOSED:R++,ATTRIB_VALUE_UNQUOTED:R++,ATTRIB_VALUE_ENTITY_Q:R++,ATTRIB_VALUE_ENTITY_U:R++,CLOSE_TAG:R++,CLOSE_TAG_SAW_WHITE:R++,SCRIPT:R++,SCRIPT_ENDING:R++},s.XML_ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'"},s.ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'",AElig:198,Aacute:193,Acirc:194,Agrave:192,Aring:197,Atilde:195,Auml:196,Ccedil:199,ETH:208,Eacute:201,Ecirc:202,Egrave:200,Euml:203,Iacute:205,Icirc:206,Igrave:204,Iuml:207,Ntilde:209,Oacute:211,Ocirc:212,Ograve:210,Oslash:216,Otilde:213,Ouml:214,THORN:222,Uacute:218,Ucirc:219,Ugrave:217,Uuml:220,Yacute:221,aacute:225,acirc:226,aelig:230,agrave:224,aring:229,atilde:227,auml:228,ccedil:231,eacute:233,ecirc:234,egrave:232,eth:240,euml:235,iacute:237,icirc:238,igrave:236,iuml:239,ntilde:241,oacute:243,ocirc:244,ograve:242,oslash:248,otilde:245,ouml:246,szlig:223,thorn:254,uacute:250,ucirc:251,ugrave:249,uuml:252,yacute:253,yuml:255,copy:169,reg:174,nbsp:160,iexcl:161,cent:162,pound:163,curren:164,yen:165,brvbar:166,sect:167,uml:168,ordf:170,laquo:171,not:172,shy:173,macr:175,deg:176,plusmn:177,sup1:185,sup2:178,sup3:179,acute:180,micro:181,para:182,middot:183,cedil:184,ordm:186,raquo:187,frac14:188,frac12:189,frac34:190,iquest:191,times:215,divide:247,OElig:338,oelig:339,Scaron:352,scaron:353,Yuml:376,fnof:402,circ:710,tilde:732,Alpha:913,Beta:914,Gamma:915,Delta:916,Epsilon:917,Zeta:918,Eta:919,Theta:920,Iota:921,Kappa:922,Lambda:923,Mu:924,Nu:925,Xi:926,Omicron:927,Pi:928,Rho:929,Sigma:931,Tau:932,Upsilon:933,Phi:934,Chi:935,Psi:936,Omega:937,alpha:945,beta:946,gamma:947,delta:948,epsilon:949,zeta:950,eta:951,theta:952,iota:953,kappa:954,lambda:955,mu:956,nu:957,xi:958,omicron:959,pi:960,rho:961,sigmaf:962,sigma:963,tau:964,upsilon:965,phi:966,chi:967,psi:968,omega:969,thetasym:977,upsih:978,piv:982,ensp:8194,emsp:8195,thinsp:8201,zwnj:8204,zwj:8205,lrm:8206,rlm:8207,ndash:8211,mdash:8212,lsquo:8216,rsquo:8217,sbquo:8218,ldquo:8220,rdquo:8221,bdquo:8222,dagger:8224,Dagger:8225,bull:8226,hellip:8230,permil:8240,prime:8242,Prime:8243,lsaquo:8249,rsaquo:8250,oline:8254,frasl:8260,euro:8364,image:8465,weierp:8472,real:8476,trade:8482,alefsym:8501,larr:8592,uarr:8593,rarr:8594,darr:8595,harr:8596,crarr:8629,lArr:8656,uArr:8657,rArr:8658,dArr:8659,hArr:8660,forall:8704,part:8706,exist:8707,empty:8709,nabla:8711,isin:8712,notin:8713,ni:8715,prod:8719,sum:8721,minus:8722,lowast:8727,radic:8730,prop:8733,infin:8734,ang:8736,and:8743,or:8744,cap:8745,cup:8746,int:8747,there4:8756,sim:8764,cong:8773,asymp:8776,ne:8800,equiv:8801,le:8804,ge:8805,sub:8834,sup:8835,nsub:8836,sube:8838,supe:8839,oplus:8853,otimes:8855,perp:8869,sdot:8901,lceil:8968,rceil:8969,lfloor:8970,rfloor:8971,lang:9001,rang:9002,loz:9674,spades:9824,clubs:9827,hearts:9829,diams:9830},Object.keys(s.ENTITIES).forEach(function(e){var t=s.ENTITIES[e],t="number"==typeof t?String.fromCharCode(t):t;s.ENTITIES[e]=t}),s.STATE)s.STATE[s.STATE[t]]=t;function I(e,t,r){e[t]&&e[t](r)}function w(e,t,r){e.textNode&&C(e),I(e,t,r)}function C(e){e.textNode=N(e.opt,e.textNode),e.textNode&&I(e,"ontext",e.textNode),e.textNode=""}function N(e,t){return e.trim&&(t=t.trim()),t=e.normalize?t.replace(/\s+/g," "):t}function D(e,t){return C(e),e.trackPosition&&(t+="\nLine: "+e.line+"\nColumn: "+e.column+"\nChar: "+e.c),t=new Error(t),e.error=t,I(e,"onerror",t),e}function M(e){return e.sawRoot&&!e.closedRoot&&O(e,"Unclosed root tag"),e.state!==R.BEGIN&&e.state!==R.BEGIN_WHITESPACE&&e.state!==R.TEXT&&D(e,"Unexpected end"),C(e),e.c="",e.closed=!0,I(e,"onend"),a.call(e,e.strict,e.opt),e}function O(e,t){if("object"!=typeof e||!(e instanceof a))throw new Error("bad call to strictFail");e.strict&&D(e,t)}function P(e,t){var r=e.indexOf(":")<0?["",e]:e.split(":"),n=r[0],r=r[1];return t&&"xmlns"===e&&(n="xmlns",r=""),{prefix:n,local:r}}function L(e){var t,r,n;e.strict||(e.attribName=e.attribName[e.looseCase]()),-1!==e.attribList.indexOf(e.attribName)||e.tag.attributes.hasOwnProperty(e.attribName)||(e.opt.xmlns?(n=(r=P(e.attribName,!0)).prefix,t=r.local,"xmlns"===n&&("xml"===t&&e.attribValue!==g?O(e,"xml: prefix must be bound to "+g+"\nActual: "+e.attribValue):"xmlns"===t&&e.attribValue!==h?O(e,"xmlns: prefix must be bound to "+h+"\nActual: "+e.attribValue):(r=e.tag,n=e.tags[e.tags.length-1]||e,r.ns===n.ns&&(r.ns=Object.create(n.ns)),r.ns[t]=e.attribValue)),e.attribList.push([e.attribName,e.attribValue])):(e.tag.attributes[e.attribName]=e.attribValue,w(e,"onattribute",{name:e.attribName,value:e.attribValue}))),e.attribName=e.attribValue=""}function F(t,e){if(t.opt.xmlns){var r=t.tag,n=P(t.tagName);r.prefix=n.prefix,r.local=n.local,r.uri=r.ns[n.prefix]||"",r.prefix&&!r.uri&&(O(t,"Unbound namespace prefix: "+JSON.stringify(t.tagName)),r.uri=n.prefix);n=t.tags[t.tags.length-1]||t;r.ns&&n.ns!==r.ns&&Object.keys(r.ns).forEach(function(e){w(t,"onopennamespace",{prefix:e,uri:r.ns[e]})});for(var a=0,i=t.attribList.length;a<i;a++){var o=t.attribList[a],s=o[0],l=o[1],u=P(s,!0),c=u.prefix,o=u.local,u=""!==c&&r.ns[c]||"",o={name:s,value:l,prefix:c,local:o,uri:u};c&&"xmlns"!==c&&!u&&(O(t,"Unbound namespace prefix: "+JSON.stringify(c)),o.uri=c),t.tag.attributes[s]=o,w(t,"onattribute",o)}t.attribList.length=0}t.tag.isSelfClosing=!!e,t.sawRoot=!0,t.tags.push(t.tag),w(t,"onopentag",t.tag),e||(t.noscript||"script"!==t.tagName.toLowerCase()?t.state=R.TEXT:t.state=R.SCRIPT,t.tag=null,t.tagName=""),t.attribName=t.attribValue="",t.attribList.length=0}function x(r){if(!r.tagName)return O(r,"Weird empty close tag."),r.textNode+="</>",void(r.state=R.TEXT);if(r.script){if("script"!==r.tagName)return r.script+="</"+r.tagName+">",r.tagName="",void(r.state=R.SCRIPT);w(r,"onscript",r.script),r.script=""}for(var e=r.tags.length,t=r.tagName,n=t=!r.strict?t[r.looseCase]():t;e--;){if(r.tags[e].name===n)break;O(r,"Unexpected close tag")}if(e<0)return O(r,"Unmatched closing tag: "+r.tagName),r.textNode+="</"+r.tagName+">",void(r.state=R.TEXT);r.tagName=t;for(var a=r.tags.length;a-- >e;){var i=r.tag=r.tags.pop();r.tagName=r.tag.name,w(r,"onclosetag",r.tagName);var o,s={};for(o in i.ns)s[o]=i.ns[o];var l=r.tags[r.tags.length-1]||r;r.opt.xmlns&&i.ns!==l.ns&&Object.keys(i.ns).forEach(function(e){var t=i.ns[e];w(r,"onclosenamespace",{prefix:e,uri:t})})}0===e&&(r.closedRoot=!0),r.tagName=r.attribValue=r.attribName="",r.attribList.length=0,r.state=R.TEXT}function j(e,t){"<"===t?(e.state=R.OPEN_WAKA,e.startTagPosition=e.position):b(p,t)&&(O(e,"Non-whitespace before first tag."),e.textNode=t,e.state=R.TEXT)}function k(e,t){var r="";return r=t<e.length?e.charAt(t):r}function r(){var e,t=[],r=-1,n=arguments.length;if(!n)return"";for(var a="";++r<n;){var i=Number(arguments[r]);if(!isFinite(i)||i<0||1114111<i||A(i)!==i)throw RangeError("Invalid code point: "+i);i<=65535?t.push(i):(e=55296+((i-=65536)>>10),i=i%1024+56320,t.push(e,i)),(r+1===n||16384<t.length)&&(a+=S.apply(null,t),t.length=0)}return a}R=s.STATE,String.fromCodePoint||(S=String.fromCharCode,A=Math.floor,Object.defineProperty?Object.defineProperty(String,"fromCodePoint",{value:r,configurable:!0,writable:!0}):String.fromCodePoint=r)}(t)},"./node_modules/stream-browserify/index.js":(e,t,r)=>{e.exports=n;var c=r("./node_modules/events/events.js").EventEmitter;function n(){c.call(this)}r("./node_modules/stream-browserify/node_modules/inherits/inherits_browser.js")(n,c),n.Readable=r("./node_modules/stream-browserify/node_modules/readable-stream/lib/_stream_readable.js"),n.Writable=r("./node_modules/stream-browserify/node_modules/readable-stream/lib/_stream_writable.js"),n.Duplex=r("./node_modules/stream-browserify/node_modules/readable-stream/lib/_stream_duplex.js"),n.Transform=r("./node_modules/stream-browserify/node_modules/readable-stream/lib/_stream_transform.js"),n.PassThrough=r("./node_modules/stream-browserify/node_modules/readable-stream/lib/_stream_passthrough.js"),n.finished=r("./node_modules/stream-browserify/node_modules/readable-stream/lib/internal/streams/end-of-stream.js"),n.pipeline=r("./node_modules/stream-browserify/node_modules/readable-stream/lib/internal/streams/pipeline.js"),(n.Stream=n).prototype.pipe=function(t,e){var r=this;function n(e){t.writable&&!1===t.write(e)&&r.pause&&r.pause()}function a(){r.readable&&r.resume&&r.resume()}r.on("data",n),t.on("drain",a),t._isStdio||e&&!1===e.end||(r.on("end",o),r.on("close",s));var i=!1;function o(){i||(i=!0,t.end())}function s(){i||(i=!0,"function"==typeof t.destroy&&t.destroy())}function l(e){if(u(),0===c.listenerCount(this,"error"))throw e}function u(){r.removeListener("data",n),t.removeListener("drain",a),r.removeListener("end",o),r.removeListener("close",s),r.removeListener("error",l),t.removeListener("error",l),r.removeListener("end",u),r.removeListener("close",u),t.removeListener("close",u)}return r.on("error",l),t.on("error",l),r.on("end",u),r.on("close",u),t.on("close",u),t.emit("pipe",r),t}},"./node_modules/stream-browserify/node_modules/inherits/inherits_browser.js":e=>{"function"==typeof Object.create?e.exports=function(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:e.exports=function(e,t){var r;t&&(e.super_=t,(r=function(){}).prototype=t.prototype,e.prototype=new r,e.prototype.constructor=e)}},"./node_modules/stream-browserify/node_modules/readable-stream/errors-browser.js":e=>{var n={};function t(e,a,t){var r=function(n){var e,t;function r(e,t,r){return n.call(this,(e=e,t=t,r=r,"string"==typeof a?a:a(e,t,r)))||this}return t=n,(e=r).prototype=Object.create(t.prototype),(e.prototype.constructor=e).__proto__=t,r}(t=t||Error);r.prototype.name=t.name,r.prototype.code=e,n[e]=r}function l(e,t){if(Array.isArray(e)){var r=e.length;return e=e.map(function(e){return String(e)}),2<r?"one of ".concat(t," ").concat(e.slice(0,r-1).join(", "),", or ")+e[r-1]:2===r?"one of ".concat(t," ").concat(e[0]," or ").concat(e[1]):"of ".concat(t," ").concat(e[0])}return"of ".concat(t," ").concat(String(e))}t("ERR_INVALID_OPT_VALUE",function(e,t){return'The value "'+t+'" is invalid for option "'+e+'"'},TypeError),t("ERR_INVALID_ARG_TYPE",function(e,t,r){var n,a,i,o,s;return"string"==typeof t&&(o="not ",t.substr(!i||i<0?0:+i,o.length)===o)?(n="must not be",t=t.replace(/^not /,"")):n="must be",i=e,o=" argument",(void 0===s||s>i.length)&&(s=i.length),t=i.substring(s-o.length,s)===o?"The ".concat(e," ").concat(n," ").concat(l(t,"type")):(a=((a="number"!=typeof a?0:a)+(s=".").length>(o=e).length?void 0:-1!==o.indexOf(s,a))?"property":"argument",'The "'.concat(e,'" ').concat(a," ").concat(n," ").concat(l(t,"type"))),t+=". Received type ".concat(typeof r)},TypeError),t("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),t("ERR_METHOD_NOT_IMPLEMENTED",function(e){return"The "+e+" method is not implemented"}),t("ERR_STREAM_PREMATURE_CLOSE","Premature close"),t("ERR_STREAM_DESTROYED",function(e){return"Cannot call "+e+" after a stream was destroyed"}),t("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),t("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),t("ERR_STREAM_WRITE_AFTER_END","write after end"),t("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),t("ERR_UNKNOWN_ENCODING",function(e){return"Unknown encoding: "+e},TypeError),t("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),e.exports.codes=n},"./node_modules/stream-browserify/node_modules/readable-stream/lib/_stream_duplex.js":(e,t,r)=>{var n=Object.keys||function(e){var t,r=[];for(t in e)r.push(t);return r};e.exports=u;var a=r("./node_modules/stream-browserify/node_modules/readable-stream/lib/_stream_readable.js"),i=r("./node_modules/stream-browserify/node_modules/readable-stream/lib/_stream_writable.js");r("./node_modules/stream-browserify/node_modules/inherits/inherits_browser.js")(u,a);for(var o=n(i.prototype),s=0;s<o.length;s++){var l=o[s];u.prototype[l]||(u.prototype[l]=i.prototype[l])}function u(e){if(!(this instanceof u))return new u(e);a.call(this,e),i.call(this,e),this.allowHalfOpen=!0,e&&(!1===e.readable&&(this.readable=!1),!1===e.writable&&(this.writable=!1),!1===e.allowHalfOpen&&(this.allowHalfOpen=!1,this.once("end",c)))}function c(){this._writableState.ended||ae(f,this)}function f(e){e.end()}Object.defineProperty(u.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(u.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(u.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(u.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed&&this._writableState.destroyed)},set:function(e){void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed=e,this._writableState.destroyed=e)}})},"./node_modules/stream-browserify/node_modules/readable-stream/lib/_stream_passthrough.js":(e,t,r)=>{e.exports=a;var n=r("./node_modules/stream-browserify/node_modules/readable-stream/lib/_stream_transform.js");function a(e){if(!(this instanceof a))return new a(e);n.call(this,e)}r("./node_modules/stream-browserify/node_modules/inherits/inherits_browser.js")(a,n),a.prototype._transform=function(e,t,r){r(null,e)}},"./node_modules/stream-browserify/node_modules/readable-stream/lib/_stream_readable.js":(e,t,a)=>{var n;(e.exports=b).ReadableState=T;function p(e,t){return e.listeners(t).length}a("./node_modules/events/events.js").EventEmitter;var i=a("./node_modules/stream-browserify/node_modules/readable-stream/lib/internal/streams/stream-browser.js"),c=a("./node_modules/buffer/index.js").Buffer,f=a.g.Uint8Array||function(){};var o,r,s,l=a("?19e6"),y=l&&l.debuglog?l.debuglog("stream"):function(){},u=a("./node_modules/stream-browserify/node_modules/readable-stream/lib/internal/streams/buffer_list.js"),e=a("./node_modules/stream-browserify/node_modules/readable-stream/lib/internal/streams/destroy.js"),d=a("./node_modules/stream-browserify/node_modules/readable-stream/lib/internal/streams/state.js").getHighWaterMark,l=a("./node_modules/stream-browserify/node_modules/readable-stream/errors-browser.js").codes,g=l.ERR_INVALID_ARG_TYPE,h=l.ERR_STREAM_PUSH_AFTER_EOF,m=l.ERR_METHOD_NOT_IMPLEMENTED,E=l.ERR_STREAM_UNSHIFT_AFTER_END_EVENT;a("./node_modules/stream-browserify/node_modules/inherits/inherits_browser.js")(b,i);var _=e.errorOrDestroy,v=["error","close","destroy","pause","resume"];function T(e,t,r){n=n||a("./node_modules/stream-browserify/node_modules/readable-stream/lib/_stream_duplex.js"),e=e||{},"boolean"!=typeof r&&(r=t instanceof n),this.objectMode=!!e.objectMode,r&&(this.objectMode=this.objectMode||!!e.readableObjectMode),this.highWaterMark=d(this,e,"readableHighWaterMark",r),this.buffer=new u,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=!1!==e.emitClose,this.autoDestroy=!!e.autoDestroy,this.destroyed=!1,this.defaultEncoding=e.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,e.encoding&&(o=o||a("./node_modules/string_decoder/lib/string_decoder.js").StringDecoder,this.decoder=new o(e.encoding),this.encoding=e.encoding)}function b(e){if(n=n||a("./node_modules/stream-browserify/node_modules/readable-stream/lib/_stream_duplex.js"),!(this instanceof b))return new b(e);var t=this instanceof n;this._readableState=new T(e,this,t),this.readable=!0,e&&("function"==typeof e.read&&(this._read=e.read),"function"==typeof e.destroy&&(this._destroy=e.destroy)),i.call(this)}function S(e,t,r,n,a){y("readableAddChunk",t);var i,o,s,l,u=e._readableState;if(null===t)u.reading=!1,o=e,s=u,y("onEofChunk"),s.ended||(!s.decoder||(l=s.decoder.end())&&l.length&&(s.buffer.push(l),s.length+=s.objectMode?1:l.length),s.ended=!0,s.sync?w(o):(s.needReadable=!1,s.emittedReadable||(s.emittedReadable=!0,C(o))));else if(i=!a?function(e,t){var r;(function(e){return c.isBuffer(e)||e instanceof f})(t)||"string"==typeof t||void 0===t||e.objectMode||(r=new g("chunk",["string","Buffer","Uint8Array"],t));return r}(u,t):i)_(e,i);else if(u.objectMode||t&&0<t.length)if("string"==typeof t||u.objectMode||Object.getPrototypeOf(t)===c.prototype||(i=t,t=c.from(i)),n)u.endEmitted?_(e,new E):A(e,u,t,!0);else if(u.ended)_(e,new h);else{if(u.destroyed)return!1;u.reading=!1,u.decoder&&!r?(t=u.decoder.write(t),u.objectMode||0!==t.length?A(e,u,t,!1):N(e,u)):A(e,u,t,!1)}else n||(u.reading=!1,N(e,u));return!u.ended&&(u.length<u.highWaterMark||0===u.length)}function A(e,t,r,n){t.flowing&&0===t.length&&!t.sync?(t.awaitDrain=0,e.emit("data",r)):(t.length+=t.objectMode?1:r.length,n?t.buffer.unshift(r):t.buffer.push(r),t.needReadable&&w(e)),N(e,t)}Object.defineProperty(b.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(e){this._readableState&&(this._readableState.destroyed=e)}}),b.prototype.destroy=e.destroy,b.prototype._undestroy=e.undestroy,b.prototype._destroy=function(e,t){t(e)},b.prototype.push=function(e,t){var r,n=this._readableState;return n.objectMode?r=!0:"string"==typeof e&&((t=t||n.defaultEncoding)!==n.encoding&&(e=c.from(e,t),t=""),r=!0),S(this,e,t,!1,r)},b.prototype.unshift=function(e){return S(this,e,null,!0,!1)},b.prototype.isPaused=function(){return!1===this._readableState.flowing},b.prototype.setEncoding=function(e){var t=new(o=o||a("./node_modules/string_decoder/lib/string_decoder.js").StringDecoder)(e);this._readableState.decoder=t,this._readableState.encoding=this._readableState.decoder.encoding;for(var r=this._readableState.buffer.head,n="";null!==r;)n+=t.write(r.data),r=r.next;return this._readableState.buffer.clear(),""!==n&&this._readableState.buffer.push(n),this._readableState.length=n.length,this};var R=1073741824;function I(e,t){return e<=0||0===t.length&&t.ended?0:t.objectMode?1:e!=e?(t.flowing&&t.length?t.buffer.head.data:t).length:(e>t.highWaterMark&&(t.highWaterMark=(R<=(r=e)?r=R:(r--,r|=r>>>1,r|=r>>>2,r|=r>>>4,r|=r>>>8,r|=r>>>16,r++),r)),e<=t.length?e:t.ended?t.length:(t.needReadable=!0,0));var r}function w(e){var t=e._readableState;y("emitReadable",t.needReadable,t.emittedReadable),t.needReadable=!1,t.emittedReadable||(y("emitReadable",t.flowing),t.emittedReadable=!0,ae(C,e))}function C(e){var t=e._readableState;y("emitReadable_",t.destroyed,t.length,t.ended),t.destroyed||!t.length&&!t.ended||(e.emit("readable"),t.emittedReadable=!1),t.needReadable=!t.flowing&&!t.ended&&t.length<=t.highWaterMark,L(e)}function N(e,t){t.readingMore||(t.readingMore=!0,ae(D,e,t))}function D(e,t){for(;!t.reading&&!t.ended&&(t.length<t.highWaterMark||t.flowing&&0===t.length);){var r=t.length;if(y("maybeReadMore read 0"),e.read(0),r===t.length)break}t.readingMore=!1}function M(e){var t=e._readableState;t.readableListening=0<e.listenerCount("readable"),t.resumeScheduled&&!t.paused?t.flowing=!0:0<e.listenerCount("data")&&e.resume()}function O(e){y("readable nexttick read 0"),e.read(0)}function P(e,t){y("resume",t.reading),t.reading||e.read(0),t.resumeScheduled=!1,e.emit("resume"),L(e),t.flowing&&!t.reading&&e.read(0)}function L(e){var t=e._readableState;for(y("flow",t.flowing);t.flowing&&null!==e.read(););}function F(e,t){return 0===t.length?null:(t.objectMode?r=t.buffer.shift():!e||e>=t.length?(r=t.decoder?t.buffer.join(""):1===t.buffer.length?t.buffer.first():t.buffer.concat(t.length),t.buffer.clear()):r=t.buffer.consume(e,t.decoder),r);var r}function x(e){var t=e._readableState;y("endReadable",t.endEmitted),t.endEmitted||(t.ended=!0,ae(j,t,e))}function j(e,t){y("endReadableNT",e.endEmitted,e.length),e.endEmitted||0!==e.length||(e.endEmitted=!0,t.readable=!1,t.emit("end"),!e.autoDestroy||(!(e=t._writableState)||e.autoDestroy&&e.finished)&&t.destroy())}function k(e,t){for(var r=0,n=e.length;r<n;r++)if(e[r]===t)return r;return-1}b.prototype.read=function(e){y("read",e),e=parseInt(e,10);var t=this._readableState,r=e;if(0!==e&&(t.emittedReadable=!1),0===e&&t.needReadable&&((0!==t.highWaterMark?t.length>=t.highWaterMark:0<t.length)||t.ended))return y("read: emitReadable",t.length,t.ended),(0===t.length&&t.ended?x:w)(this),null;if(0===(e=I(e,t))&&t.ended)return 0===t.length&&x(this),null;var n=t.needReadable;return y("need readable",n),(0===t.length||t.length-e<t.highWaterMark)&&y("length less than watermark",n=!0),t.ended||t.reading?y("reading or ended",n=!1):n&&(y("do read"),t.reading=!0,t.sync=!0,0===t.length&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1,t.reading||(e=I(r,t))),null===(n=0<e?F(e,t):null)?(t.needReadable=t.length<=t.highWaterMark,e=0):(t.length-=e,t.awaitDrain=0),0===t.length&&(t.ended||(t.needReadable=!0),r!==e&&t.ended&&x(this)),null!==n&&this.emit("data",n),n},b.prototype._read=function(e){_(this,new m("_read()"))},b.prototype.pipe=function(r,e){var n=this,a=this._readableState;switch(a.pipesCount){case 0:a.pipes=r;break;case 1:a.pipes=[a.pipes,r];break;default:a.pipes.push(r)}a.pipesCount+=1,y("pipe count=%d opts=%j",a.pipesCount,e);var t=(!e||!1!==e.end)&&r!==ie.stdout&&r!==ie.stderr?o:m;function i(e,t){y("onunpipe"),e===n&&t&&!1===t.hasUnpiped&&(t.hasUnpiped=!0,y("cleanup"),r.removeListener("close",g),r.removeListener("finish",h),r.removeListener("drain",l),r.removeListener("error",d),r.removeListener("unpipe",i),n.removeListener("end",o),n.removeListener("end",m),n.removeListener("data",f),c=!0,!a.awaitDrain||r._writableState&&!r._writableState.needDrain||l())}function o(){y("onend"),r.end()}a.endEmitted?ae(t):n.once("end",t),r.on("unpipe",i);var s,l=(s=n,function(){var e=s._readableState;y("pipeOnDrain",e.awaitDrain),e.awaitDrain&&e.awaitDrain--,0===e.awaitDrain&&p(s,"data")&&(e.flowing=!0,L(s))});r.on("drain",l);var u,c=!1;function f(e){y("ondata");e=r.write(e);y("dest.write",e),!1===e&&((1===a.pipesCount&&a.pipes===r||1<a.pipesCount&&-1!==k(a.pipes,r))&&!c&&(y("false write response, pause",a.awaitDrain),a.awaitDrain++),n.pause())}function d(e){y("onerror",e),m(),r.removeListener("error",d),0===p(r,"error")&&_(r,e)}function g(){r.removeListener("finish",h),m()}function h(){y("onfinish"),r.removeListener("close",g),m()}function m(){y("unpipe"),n.unpipe(r)}return n.on("data",f),u="error",e=d,"function"==typeof(t=r).prependListener?t.prependListener(u,e):t._events&&t._events[u]?Array.isArray(t._events[u])?t._events[u].unshift(e):t._events[u]=[e,t._events[u]]:t.on(u,e),r.once("close",g),r.once("finish",h),r.emit("pipe",n),a.flowing||(y("pipe resume"),n.resume()),r},b.prototype.unpipe=function(e){var t=this._readableState,r={hasUnpiped:!1};if(0===t.pipesCount)return this;if(1===t.pipesCount)return e&&e!==t.pipes||(e=e||t.pipes,t.pipes=null,t.pipesCount=0,t.flowing=!1,e&&e.emit("unpipe",this,r)),this;if(!e){var n=t.pipes,a=t.pipesCount;t.pipes=null,t.pipesCount=0,t.flowing=!1;for(var i=0;i<a;i++)n[i].emit("unpipe",this,{hasUnpiped:!1});return this}var o=k(t.pipes,e);return-1===o||(t.pipes.splice(o,1),--t.pipesCount,1===t.pipesCount&&(t.pipes=t.pipes[0]),e.emit("unpipe",this,r)),this},b.prototype.addListener=b.prototype.on=function(e,t){var r=i.prototype.on.call(this,e,t),t=this._readableState;return"data"===e?(t.readableListening=0<this.listenerCount("readable"),!1!==t.flowing&&this.resume()):"readable"===e&&(t.endEmitted||t.readableListening||(t.readableListening=t.needReadable=!0,t.flowing=!1,t.emittedReadable=!1,y("on readable",t.length,t.reading),t.length?w(this):t.reading||ae(O,this))),r},b.prototype.removeListener=function(e,t){t=i.prototype.removeListener.call(this,e,t);return"readable"===e&&ae(M,this),t},b.prototype.removeAllListeners=function(e){var t=i.prototype.removeAllListeners.apply(this,arguments);return"readable"!==e&&void 0!==e||ae(M,this),t},b.prototype.resume=function(){var e,t,r=this._readableState;return r.flowing||(y("resume"),r.flowing=!r.readableListening,e=this,(t=r).resumeScheduled||(t.resumeScheduled=!0,ae(P,e,t))),r.paused=!1,this},b.prototype.pause=function(){return y("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(y("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this},b.prototype.wrap=function(t){var e,r=this,n=this._readableState,a=!1;for(e in t.on("end",function(){var e;y("wrapped end"),!n.decoder||n.ended||(e=n.decoder.end())&&e.length&&r.push(e),r.push(null)}),t.on("data",function(e){y("wrapped data"),n.decoder&&(e=n.decoder.write(e)),n.objectMode&&null==e||(n.objectMode||e&&e.length)&&(r.push(e)||(a=!0,t.pause()))}),t)void 0===this[e]&&"function"==typeof t[e]&&(this[e]=function(e){return function(){return t[e].apply(t,arguments)}}(e));for(var i=0;i<v.length;i++)t.on(v[i],this.emit.bind(this,v[i]));return this._read=function(e){y("wrapped _read",e),a&&(a=!1,t.resume())},this},"function"==typeof Symbol&&(b.prototype[Symbol.asyncIterator]=function(){return(r=void 0===r?a("./node_modules/stream-browserify/node_modules/readable-stream/lib/internal/streams/async_iterator.js"):r)(this)}),Object.defineProperty(b.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(b.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(b.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(e){this._readableState&&(this._readableState.flowing=e)}}),b._fromList=F,Object.defineProperty(b.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}}),"function"==typeof Symbol&&(b.from=function(e,t){return(s=void 0===s?a("./node_modules/stream-browserify/node_modules/readable-stream/lib/internal/streams/from-browser.js"):s)(b,e,t)})},"./node_modules/stream-browserify/node_modules/readable-stream/lib/_stream_transform.js":(e,t,r)=>{e.exports=l;var e=r("./node_modules/stream-browserify/node_modules/readable-stream/errors-browser.js").codes,n=e.ERR_METHOD_NOT_IMPLEMENTED,a=e.ERR_MULTIPLE_CALLBACK,i=e.ERR_TRANSFORM_ALREADY_TRANSFORMING,o=e.ERR_TRANSFORM_WITH_LENGTH_0,s=r("./node_modules/stream-browserify/node_modules/readable-stream/lib/_stream_duplex.js");function l(e){if(!(this instanceof l))return new l(e);s.call(this,e),this._transformState={afterTransform:function(e,t){var r=this._transformState;r.transforming=!1;var n=r.writecb;if(null===n)return this.emit("error",new a);r.writechunk=null,(r.writecb=null)!=t&&this.push(t),n(e),(e=this._readableState).reading=!1,(e.needReadable||e.length<e.highWaterMark)&&this._read(e.highWaterMark)}.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,e&&("function"==typeof e.transform&&(this._transform=e.transform),"function"==typeof e.flush&&(this._flush=e.flush)),this.on("prefinish",u)}function u(){var r=this;"function"!=typeof this._flush||this._readableState.destroyed?c(this,null,null):this._flush(function(e,t){c(r,e,t)})}function c(e,t,r){if(t)return e.emit("error",t);if(null!=r&&e.push(r),e._writableState.length)throw new o;if(e._transformState.transforming)throw new i;return e.push(null)}r("./node_modules/stream-browserify/node_modules/inherits/inherits_browser.js")(l,s),l.prototype.push=function(e,t){return this._transformState.needTransform=!1,s.prototype.push.call(this,e,t)},l.prototype._transform=function(e,t,r){r(new n("_transform()"))},l.prototype._write=function(e,t,r){var n=this._transformState;n.writecb=r,n.writechunk=e,n.writeencoding=t,n.transforming||(t=this._readableState,(n.needTransform||t.needReadable||t.length<t.highWaterMark)&&this._read(t.highWaterMark))},l.prototype._read=function(e){var t=this._transformState;null===t.writechunk||t.transforming?t.needTransform=!0:(t.transforming=!0,this._transform(t.writechunk,t.writeencoding,t.afterTransform))},l.prototype._destroy=function(e,t){s.prototype._destroy.call(this,e,function(e){t(e)})}},"./node_modules/stream-browserify/node_modules/readable-stream/lib/_stream_writable.js":(e,t,n)=>{function c(e){var t=this;this.next=null,this.entry=null,this.finish=function(){!function(e,t,r){var n=e.entry;for(e.entry=null;n;){var a=n.callback;t.pendingcb--,a(r),n=n.next}t.corkedRequestsFree.next=e}(t,e)}}var a;(e.exports=S).WritableState=b;var r={deprecate:n("./node_modules/util-deprecate/browser.js")},i=n("./node_modules/stream-browserify/node_modules/readable-stream/lib/internal/streams/stream-browser.js"),f=n("./node_modules/buffer/index.js").Buffer,d=n.g.Uint8Array||function(){};var o,s=n("./node_modules/stream-browserify/node_modules/readable-stream/lib/internal/streams/destroy.js"),l=n("./node_modules/stream-browserify/node_modules/readable-stream/lib/internal/streams/state.js").getHighWaterMark,e=n("./node_modules/stream-browserify/node_modules/readable-stream/errors-browser.js").codes,g=e.ERR_INVALID_ARG_TYPE,u=e.ERR_METHOD_NOT_IMPLEMENTED,h=e.ERR_MULTIPLE_CALLBACK,m=e.ERR_STREAM_CANNOT_PIPE,p=e.ERR_STREAM_DESTROYED,y=e.ERR_STREAM_NULL_VALUES,E=e.ERR_STREAM_WRITE_AFTER_END,_=e.ERR_UNKNOWN_ENCODING,v=s.errorOrDestroy;function T(){}function b(e,t,r){a=a||n("./node_modules/stream-browserify/node_modules/readable-stream/lib/_stream_duplex.js"),e=e||{},"boolean"!=typeof r&&(r=t instanceof a),this.objectMode=!!e.objectMode,r&&(this.objectMode=this.objectMode||!!e.writableObjectMode),this.highWaterMark=l(this,e,"writableHighWaterMark",r),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1;r=(this.destroyed=!1)===e.decodeStrings;this.decodeStrings=!r,this.defaultEncoding=e.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(e){!function(e,t){var r=e._writableState,n=r.sync,a=r.writecb;if("function"!=typeof a)throw new h;(function(e){e.writing=!1,e.writecb=null,e.length-=e.writelen,e.writelen=0})(r),t?function(e,t,r,n,a){--t.pendingcb,r?(ae(a,n),ae(N,e,t),e._writableState.errorEmitted=!0,v(e,n)):(a(n),e._writableState.errorEmitted=!0,v(e,n),N(e,t))}(e,r,n,t,a):((t=w(r)||e.destroyed)||r.corked||r.bufferProcessing||!r.bufferedRequest||I(e,r),n?ae(R,e,r,t,a):R(e,r,t,a))}(t,e)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=!1!==e.emitClose,this.autoDestroy=!!e.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new c(this)}function S(e){var t=this instanceof(a=a||n("./node_modules/stream-browserify/node_modules/readable-stream/lib/_stream_duplex.js"));if(!t&&!o.call(S,this))return new S(e);this._writableState=new b(e,this,t),this.writable=!0,e&&("function"==typeof e.write&&(this._write=e.write),"function"==typeof e.writev&&(this._writev=e.writev),"function"==typeof e.destroy&&(this._destroy=e.destroy),"function"==typeof e.final&&(this._final=e.final)),i.call(this)}function A(e,t,r,n,a,i,o){t.writelen=n,t.writecb=o,t.writing=!0,t.sync=!0,t.destroyed?t.onwrite(new p("write")):r?e._writev(a,t.onwrite):e._write(a,i,t.onwrite),t.sync=!1}function R(e,t,r,n){var a;r||(a=e,0===(r=t).length&&r.needDrain&&(r.needDrain=!1,a.emit("drain"))),t.pendingcb--,n(),N(e,t)}function I(e,t){t.bufferProcessing=!0;var r=t.bufferedRequest;if(e._writev&&r&&r.next){var n=t.bufferedRequestCount,a=new Array(n),n=t.corkedRequestsFree;n.entry=r;for(var i=0,o=!0;r;)(a[i]=r).isBuf||(o=!1),r=r.next,i+=1;a.allBuffers=o,A(e,t,!0,t.length,a,"",n.finish),t.pendingcb++,t.lastBufferedRequest=null,n.next?(t.corkedRequestsFree=n.next,n.next=null):t.corkedRequestsFree=new c(t),t.bufferedRequestCount=0}else{for(;r;){var s=r.chunk,l=r.encoding,u=r.callback;if(A(e,t,!1,t.objectMode?1:s.length,s,l,u),r=r.next,t.bufferedRequestCount--,t.writing)break}null===r&&(t.lastBufferedRequest=null)}t.bufferedRequest=r,t.bufferProcessing=!1}function w(e){return e.ending&&0===e.length&&null===e.bufferedRequest&&!e.finished&&!e.writing}function C(t,r){t._final(function(e){r.pendingcb--,e&&v(t,e),r.prefinished=!0,t.emit("prefinish"),N(t,r)})}function N(e,t){var r,n,a=w(t);return a&&(r=e,(n=t).prefinished||n.finalCalled||("function"!=typeof r._final||n.destroyed?(n.prefinished=!0,r.emit("prefinish")):(n.pendingcb++,n.finalCalled=!0,ae(C,r,n))),0===t.pendingcb&&(t.finished=!0,e.emit("finish"),!t.autoDestroy||(!(t=e._readableState)||t.autoDestroy&&t.endEmitted)&&e.destroy())),a}n("./node_modules/stream-browserify/node_modules/inherits/inherits_browser.js")(S,i),b.prototype.getBuffer=function(){for(var e=this.bufferedRequest,t=[];e;)t.push(e),e=e.next;return t},function(){try{Object.defineProperty(b.prototype,"buffer",{get:r.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(e){}}(),"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(o=Function.prototype[Symbol.hasInstance],Object.defineProperty(S,Symbol.hasInstance,{value:function(e){return!!o.call(this,e)||this===S&&(e&&e._writableState instanceof b)}})):o=function(e){return e instanceof this},S.prototype.pipe=function(){v(this,new m)},S.prototype.write=function(e,t,r){var n,a,i,o,s,l,u=this._writableState,c=!1,n=!u.objectMode&&(n=e,f.isBuffer(n)||n instanceof d);return n&&!f.isBuffer(e)&&(a=e,e=f.from(a)),"function"==typeof t&&(r=t,t=null),t=n?"buffer":t||u.defaultEncoding,"function"!=typeof r&&(r=T),u.ending?(o=this,s=r,l=new E,v(o,l),ae(s,l)):(n||(a=this,o=u,s=r,null===(l=e)?i=new y:"string"==typeof l||o.objectMode||(i=new g("chunk",["string","Buffer"],l)),i?(v(a,i),void ae(s,i)):1))&&(u.pendingcb++,c=function(e,t,r,n,a,i){r||(l=function(e,t,r){e.objectMode||!1===e.decodeStrings||"string"!=typeof t||(t=f.from(t,r));return t}(t,n,a),n!==l&&(r=!0,a="buffer",n=l));var o=t.objectMode?1:n.length;t.length+=o;var s=t.length<t.highWaterMark;s||(t.needDrain=!0);{var l;t.writing||t.corked?(l=t.lastBufferedRequest,t.lastBufferedRequest={chunk:n,encoding:a,isBuf:r,callback:i,next:null},l?l.next=t.lastBufferedRequest:t.bufferedRequest=t.lastBufferedRequest,t.bufferedRequestCount+=1):A(e,t,!1,o,n,a,i)}return s}(this,u,n,e,t,r)),c},S.prototype.cork=function(){this._writableState.corked++},S.prototype.uncork=function(){var e=this._writableState;e.corked&&(e.corked--,e.writing||e.corked||e.bufferProcessing||!e.bufferedRequest||I(this,e))},S.prototype.setDefaultEncoding=function(e){if("string"==typeof e&&(e=e.toLowerCase()),!(-1<["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())))throw new _(e);return this._writableState.defaultEncoding=e,this},Object.defineProperty(S.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(S.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),S.prototype._write=function(e,t,r){r(new u("_write()"))},S.prototype._writev=null,S.prototype.end=function(e,t,r){var n=this._writableState;return"function"==typeof e?(r=e,t=e=null):"function"==typeof t&&(r=t,t=null),null!=e&&this.write(e,t),n.corked&&(n.corked=1,this.uncork()),n.ending||(t=this,r=r,(n=n).ending=!0,N(t,n),r&&(n.finished?ae(r):t.once("finish",r)),n.ended=!0,t.writable=!1),this},Object.defineProperty(S.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(S.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(e){this._writableState&&(this._writableState.destroyed=e)}}),S.prototype.destroy=s.destroy,S.prototype._undestroy=s.undestroy,S.prototype._destroy=function(e,t){t(e)}},"./node_modules/stream-browserify/node_modules/readable-stream/lib/internal/streams/async_iterator.js":(e,t,r)=>{function a(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var i=r("./node_modules/stream-browserify/node_modules/readable-stream/lib/internal/streams/end-of-stream.js"),o=Symbol("lastResolve"),s=Symbol("lastReject"),l=Symbol("error"),u=Symbol("ended"),c=Symbol("lastPromise"),f=Symbol("handlePromise"),d=Symbol("stream");function g(e,t){return{value:e,done:t}}function h(e){var t,r=e[o];null===r||null!==(t=e[d].read())&&(e[c]=null,e[o]=null,e[s]=null,r(g(t,!1)))}var n=Object.getPrototypeOf(function(){}),m=Object.setPrototypeOf((a(r={get stream(){return this[d]},next:function(){var r=this,e=this[l];if(null!==e)return Promise.reject(e);if(this[u])return Promise.resolve(g(void 0,!0));if(this[d].destroyed)return new Promise(function(e,t){ae(function(){r[l]?t(r[l]):e(g(void 0,!0))})});var t,n,a,e=this[c];if(e)t=new Promise((n=e,a=this,function(e,t){n.then(function(){a[u]?e(g(void 0,!0)):a[f](e,t)},t)}));else{e=this[d].read();if(null!==e)return Promise.resolve(g(e,!1));t=new Promise(this[f])}return this[c]=t}},Symbol.asyncIterator,function(){return this}),a(r,"return",function(){var e=this;return new Promise(function(t,r){e[d].destroy(null,function(e){e?r(e):t(g(void 0,!0))})})}),r),n);e.exports=function(e){var t,n=Object.create(m,(a(t={},d,{value:e,writable:!0}),a(t,o,{value:null,writable:!0}),a(t,s,{value:null,writable:!0}),a(t,l,{value:null,writable:!0}),a(t,u,{value:e._readableState.endEmitted,writable:!0}),a(t,f,{value:function(e,t){var r=n[d].read();r?(n[c]=null,n[o]=null,n[s]=null,e(g(r,!1))):(n[o]=e,n[s]=t)},writable:!0}),t));return n[c]=null,i(e,function(e){if(e&&"ERR_STREAM_PREMATURE_CLOSE"!==e.code){var t=n[s];return null!==t&&(n[c]=null,n[o]=null,n[s]=null,t(e)),void(n[l]=e)}e=n[o];null!==e&&(n[c]=null,n[o]=null,e(g(void 0,!(n[s]=null)))),n[u]=!0}),e.on("readable",function(e){ae(h,e)}.bind(null,n)),n}},"./node_modules/stream-browserify/node_modules/readable-stream/lib/internal/streams/buffer_list.js":(e,t,r)=>{function i(t,e){var r,n=Object.keys(t);return Object.getOwnPropertySymbols&&(r=Object.getOwnPropertySymbols(t),e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)),n}function a(n){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?i(Object(a),!0).forEach(function(e){var t,r;t=n,e=a[r=e],r in t?Object.defineProperty(t,r,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[r]=e}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(a)):i(Object(a)).forEach(function(e){Object.defineProperty(n,e,Object.getOwnPropertyDescriptor(a,e))})}return n}function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var s=r("./node_modules/buffer/index.js").Buffer,l=r("?3e83").inspect,u=l&&l.custom||"inspect";e.exports=function(){function t(){!function(e){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),this.head=null,this.tail=null,this.length=0}var e,r,n;return e=t,(r=[{key:"push",value:function(e){e={data:e,next:null};0<this.length?this.tail.next=e:this.head=e,this.tail=e,++this.length}},{key:"unshift",value:function(e){e={data:e,next:this.head};0===this.length&&(this.tail=e),this.head=e,++this.length}},{key:"shift",value:function(){if(0!==this.length){var e=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,e}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(e){if(0===this.length)return"";for(var t=this.head,r=""+t.data;t=t.next;)r+=e+t.data;return r}},{key:"concat",value:function(e){if(0===this.length)return s.alloc(0);for(var t,r,n,a=s.allocUnsafe(e>>>0),i=this.head,o=0;i;)t=i.data,r=a,n=o,s.prototype.copy.call(t,r,n),o+=i.data.length,i=i.next;return a}},{key:"consume",value:function(e,t){var r;return e<this.head.data.length?(r=this.head.data.slice(0,e),this.head.data=this.head.data.slice(e)):r=e===this.head.data.length?this.shift():t?this._getString(e):this._getBuffer(e),r}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(e){var t=this.head,r=1,n=t.data;for(e-=n.length;t=t.next;){var a=t.data,i=e>a.length?a.length:e;if(i===a.length?n+=a:n+=a.slice(0,e),0===(e-=i)){i===a.length?(++r,t.next?this.head=t.next:this.head=this.tail=null):(this.head=t).data=a.slice(i);break}++r}return this.length-=r,n}},{key:"_getBuffer",value:function(e){var t=s.allocUnsafe(e),r=this.head,n=1;for(r.data.copy(t),e-=r.data.length;r=r.next;){var a=r.data,i=e>a.length?a.length:e;if(a.copy(t,t.length-e,0,i),0===(e-=i)){i===a.length?(++n,r.next?this.head=r.next:this.head=this.tail=null):(this.head=r).data=a.slice(i);break}++n}return this.length-=n,t}},{key:u,value:function(e,t){return l(this,a({},t,{depth:0,customInspect:!1}))}}])&&o(e.prototype,r),n&&o(e,n),t}()},"./node_modules/stream-browserify/node_modules/readable-stream/lib/internal/streams/destroy.js":e=>{function i(e,t){s(e,t),o(e)}function o(e){e._writableState&&!e._writableState.emitClose||e._readableState&&!e._readableState.emitClose||e.emit("close")}function s(e,t){e.emit("error",t)}e.exports={destroy:function(e,t){var r=this,n=this._readableState&&this._readableState.destroyed,a=this._writableState&&this._writableState.destroyed;return n||a?t?t(e):e&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,ae(s,this,e)):ae(s,this,e)):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(e||null,function(e){!t&&e?r._writableState?r._writableState.errorEmitted?ae(o,r):(r._writableState.errorEmitted=!0,ae(i,r,e)):ae(i,r,e):t?(ae(o,r),t(e)):ae(o,r)})),this},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)},errorOrDestroy:function(e,t){var r=e._readableState,n=e._writableState;r&&r.autoDestroy||n&&n.autoDestroy?e.destroy(t):e.emit("error",t)}}},"./node_modules/stream-browserify/node_modules/readable-stream/lib/internal/streams/end-of-stream.js":(e,t,r)=>{var y=r("./node_modules/stream-browserify/node_modules/readable-stream/errors-browser.js").codes.ERR_STREAM_PREMATURE_CLOSE;function E(){}e.exports=function e(t,r,n){if("function"==typeof r)return e(t,null,r);var a,i;a=n||E,i=!1,n=function(){if(!i){i=!0;for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];a.apply(this,t)}};function o(){t.writable||m()}function s(){p=!(d=!1),g||n.call(t)}function l(e){n.call(t,e)}function u(){var e;return d&&!p?(t._readableState&&t._readableState.ended||(e=new y),n.call(t,e)):g&&!h?(t._writableState&&t._writableState.ended||(e=new y),n.call(t,e)):void 0}function c(){t.req.on("finish",m)}var f,d=(r=r||{}).readable||!1!==r.readable&&t.readable,g=r.writable||!1!==r.writable&&t.writable,h=t._writableState&&t._writableState.finished,m=function(){h=!(g=!1),d||n.call(t)},p=t._readableState&&t._readableState.endEmitted;return(f=t).setHeader&&"function"==typeof f.abort?(t.on("complete",m),t.on("abort",u),t.req?c():t.on("request",c)):g&&!t._writableState&&(t.on("end",o),t.on("close",o)),t.on("end",s),t.on("finish",m),!1!==r.error&&t.on("error",l),t.on("close",u),function(){t.removeListener("complete",m),t.removeListener("abort",u),t.removeListener("request",c),t.req&&t.req.removeListener("finish",m),t.removeListener("end",o),t.removeListener("close",o),t.removeListener("finish",m),t.removeListener("end",s),t.removeListener("error",l),t.removeListener("close",u)}}},"./node_modules/stream-browserify/node_modules/readable-stream/lib/internal/streams/from-browser.js":e=>{e.exports=function(){throw new Error("Readable.from is not available in the browser")}},"./node_modules/stream-browserify/node_modules/readable-stream/lib/internal/streams/pipeline.js":(e,t,l)=>{var u;var r=l("./node_modules/stream-browserify/node_modules/readable-stream/errors-browser.js").codes,s=r.ERR_MISSING_ARGS,c=r.ERR_STREAM_DESTROYED;function f(e){if(e)throw e}function d(r,e,t,n){var a,i;a=n,i=!1;var o=!(n=function(){i||(i=!0,a.apply(void 0,arguments))});r.on("close",function(){o=!0}),(u=void 0===u?l("./node_modules/stream-browserify/node_modules/readable-stream/lib/internal/streams/end-of-stream.js"):u)(r,{readable:e,writable:t},function(e){return e?n(e):(o=!0,void n())});var s=!1;return function(e){var t;if(!o&&!s)return s=!0,(t=r).setHeader&&"function"==typeof t.abort?r.abort():"function"==typeof r.destroy?r.destroy():void n(e||new c("pipe"))}}function g(e){e()}function h(e,t){return e.pipe(t)}e.exports=function(){for(var e=arguments.length,n=new Array(e),t=0;t<e;t++)n[t]=arguments[t];var r,a,i=!(r=n).length||"function"!=typeof r[r.length-1]?f:r.pop();if((n=Array.isArray(n[0])?n[0]:n).length<2)throw new s("streams");var o=n.map(function(e,t){var r=t<n.length-1;return d(e,r,0<t,function(e){a=a||e,e&&o.forEach(g),r||(o.forEach(g),i(a))})});return n.reduce(h)}},"./node_modules/stream-browserify/node_modules/readable-stream/lib/internal/streams/state.js":(e,t,r)=>{var o=r("./node_modules/stream-browserify/node_modules/readable-stream/errors-browser.js").codes.ERR_INVALID_OPT_VALUE;e.exports={getHighWaterMark:function(e,t,r,n){var a,i=(a=n,i=r,null!=(t=t).highWaterMark?t.highWaterMark:a?t[i]:null);if(null==i)return e.objectMode?16:16384;if(!isFinite(i)||Math.floor(i)!==i||i<0)throw new o(n?r:"highWaterMark",i);return Math.floor(i)}}},"./node_modules/stream-browserify/node_modules/readable-stream/lib/internal/streams/stream-browser.js":(e,t,r)=>{e.exports=r("./node_modules/events/events.js").EventEmitter},"./node_modules/string_decoder/lib/string_decoder.js":(e,t,r)=>{var n=r("./node_modules/safe-buffer/index.js").Buffer,a=n.isEncoding||function(e){switch((e=""+e)&&e.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function i(e){var t=function(e){if(!e)return"utf8";for(var t;;)switch(e){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return e;default:if(t)return;e=(""+e).toLowerCase(),t=!0}}(e);if("string"!=typeof t&&(n.isEncoding===a||!a(e)))throw new Error("Unknown encoding: "+e);return t||e}function o(e){var t;switch(this.encoding=i(e),this.encoding){case"utf16le":this.text=u,this.end=c,t=4;break;case"utf8":this.fillLast=l,t=4;break;case"base64":this.text=f,this.end=d,t=3;break;default:return this.write=g,void(this.end=h)}this.lastNeed=0,this.lastTotal=0,this.lastChar=n.allocUnsafe(t)}function s(e){return e<=127?0:e>>5==6?2:e>>4==14?3:e>>3==30?4:e>>6==2?-1:-2}function l(e){var t,r,n=this.lastTotal-this.lastNeed,t=(t=this,128!=(192&(r=e)[0])?(t.lastNeed=0,"�"):1<t.lastNeed&&1<r.length?128!=(192&r[1])?(t.lastNeed=1,"�"):2<t.lastNeed&&2<r.length&&128!=(192&r[2])?(t.lastNeed=2,"�"):void 0:void 0);return void 0!==t?t:this.lastNeed<=e.length?(e.copy(this.lastChar,n,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(e.copy(this.lastChar,n,0,e.length),void(this.lastNeed-=e.length))}function u(e,t){if((e.length-t)%2!=0)return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=e[e.length-1],e.toString("utf16le",t,e.length-1);var r=e.toString("utf16le",t);if(r){t=r.charCodeAt(r.length-1);if(55296<=t&&t<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1],r.slice(0,-1)}return r}function c(e){var t=e&&e.length?this.write(e):"";if(this.lastNeed){e=this.lastTotal-this.lastNeed;return t+this.lastChar.toString("utf16le",0,e)}return t}function f(e,t){var r=(e.length-t)%3;return 0==r?e.toString("base64",t):(this.lastNeed=3-r,this.lastTotal=3,1==r?this.lastChar[0]=e[e.length-1]:(this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1]),e.toString("base64",t,e.length-r))}function d(e){e=e&&e.length?this.write(e):"";return this.lastNeed?e+this.lastChar.toString("base64",0,3-this.lastNeed):e}function g(e){return e.toString(this.encoding)}function h(e){return e&&e.length?this.write(e):""}(t.StringDecoder=o).prototype.write=function(e){if(0===e.length)return"";var t,r;if(this.lastNeed){if(void 0===(t=this.fillLast(e)))return"";r=this.lastNeed,this.lastNeed=0}else r=0;return r<e.length?t?t+this.text(e,r):this.text(e,r):t||""},o.prototype.end=function(e){e=e&&e.length?this.write(e):"";return this.lastNeed?e+"�":e},o.prototype.text=function(e,t){var r=function(e,t,r){var n=t.length-1;if(n<r)return 0;var a=s(t[n]);if(0<=a)return 0<a&&(e.lastNeed=a-1),a;if(--n<r||-2===a)return 0;if(0<=(a=s(t[n])))return 0<a&&(e.lastNeed=a-2),a;if(--n<r||-2===a)return 0;if(0<=(a=s(t[n])))return 0<a&&(2===a?a=0:e.lastNeed=a-3),a;return 0}(this,e,t);if(!this.lastNeed)return e.toString("utf8",t);this.lastTotal=r;r=e.length-(r-this.lastNeed);return e.copy(this.lastChar,0,r),e.toString("utf8",t,r)},o.prototype.fillLast=function(e){if(this.lastNeed<=e.length)return e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,e.length),this.lastNeed-=e.length}},"./node_modules/ua-parser-js/src/ua-parser.js":function(x,j,k){var U;!function(a,f){function e(e){for(var t={},r=0;r<e.length;r++)t[e[r].toUpperCase()]=e[r];return t}function i(e,t){return typeof e==u&&-1!==D(t).indexOf(D(e))}function o(e,t){if(typeof e==u)return e=e.replace(/^\s\s*/,"").replace(/\s\s*$/,""),typeof t==l?e:e.substring(0,255)}function s(e,t){for(var r,n,a,i,o,s=0;s<t.length&&!i;){for(var l=t[s],u=t[s+1],c=r=0;c<l.length&&!i;)if(i=l[c++].exec(e))for(n=0;n<u.length;n++)o=i[++r],typeof(a=u[n])==d&&0<a.length?2===a.length?"function"==typeof a[1]?this[a[0]]=a[1].call(this,o):this[a[0]]=a[1]:3===a.length?"function"!=typeof a[1]||a[1].exec&&a[1].test?this[a[0]]=o?o.replace(a[1],a[2]):f:this[a[0]]=o?a[1].call(this,o,a[2]):f:4===a.length&&(this[a[0]]=o?a[3].call(this,o.replace(a[1],a[2])):f):this[a]=o||f;s+=2}}function t(e,t){for(var r in t)if(typeof t[r]==d&&0<t[r].length){for(var n=0;n<t[r].length;n++)if(i(t[r][n],e))return"?"===r?f:r}else if(i(t[r],e))return"?"===r?f:r;return e}var l="undefined",d="object",u="string",c="model",r="name",n="type",g="vendor",h="version",m="architecture",p="console",y="mobile",E="tablet",_="smarttv",v="wearable",T="Amazon",b="BlackBerry",S="Browser",A="Chrome",R="Firefox",I="Google",w="Microsoft",C="Opera",N="Samsung",D=function(e){return e.toLowerCase()},M={ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"},O={browser:[[/\b(?:crmo|crios)\/([\w\.]+)/i],[h,[r,"Chrome"]],[/edg(?:e|ios|a)?\/([\w\.]+)/i],[h,[r,"Edge"]],[/(opera mini)\/([-\w\.]+)/i,/(opera [mobiletab]{3,6})\b.+version\/([-\w\.]+)/i,/(opera)(?:.+version\/|[\/ ]+)([\w\.]+)/i],[r,h],[/opios[\/ ]+([\w\.]+)/i],[h,[r,C+" Mini"]],[/\bopr\/([\w\.]+)/i],[h,[r,C]],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/ ]?([\w\.]*)/i,/(avant |iemobile|slim)(?:browser)?[\/ ]?([\w\.]*)/i,/(ba?idubrowser)[\/ ]?([\w\.]+)/i,/(?:ms|\()(ie) ([\w\.]+)/i,/(flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs|bowser|quark|qupzilla|falkon|rekonq|puffin|brave|whale|qqbrowserlite|qq)\/([-\w\.]+)/i,/(weibo)__([\d\.]+)/i],[r,h],[/(?:\buc? ?browser|(?:juc.+)ucweb)[\/ ]?([\w\.]+)/i],[h,[r,"UC"+S]],[/\bqbcore\/([\w\.]+)/i],[h,[r,"WeChat(Win) Desktop"]],[/micromessenger\/([\w\.]+)/i],[h,[r,"WeChat"]],[/konqueror\/([\w\.]+)/i],[h,[r,"Konqueror"]],[/trident.+rv[: ]([\w\.]{1,9})\b.+like gecko/i],[h,[r,"IE"]],[/yabrowser\/([\w\.]+)/i],[h,[r,"Yandex"]],[/(avast|avg)\/([\w\.]+)/i],[[r,/(.+)/,"$1 Secure "+S],h],[/\bfocus\/([\w\.]+)/i],[h,[r,R+" Focus"]],[/\bopt\/([\w\.]+)/i],[h,[r,C+" Touch"]],[/coc_coc\w+\/([\w\.]+)/i],[h,[r,"Coc Coc"]],[/dolfin\/([\w\.]+)/i],[h,[r,"Dolphin"]],[/coast\/([\w\.]+)/i],[h,[r,C+" Coast"]],[/miuibrowser\/([\w\.]+)/i],[h,[r,"MIUI "+S]],[/fxios\/([-\w\.]+)/i],[h,[r,R]],[/\bqihu|(qi?ho?o?|360)browser/i],[[r,"360 "+S]],[/(oculus|samsung|sailfish)browser\/([\w\.]+)/i],[[r,/(.+)/,"$1 "+S],h],[/(comodo_dragon)\/([\w\.]+)/i],[[r,/_/g," "],h],[/(electron)\/([\w\.]+) safari/i,/(tesla)(?: qtcarbrowser|\/(20\d\d\.[-\w\.]+))/i,/m?(qqbrowser|baiduboxapp|2345Explorer)[\/ ]?([\w\.]+)/i],[r,h],[/(metasr)[\/ ]?([\w\.]+)/i,/(lbbrowser)/i],[r],[/((?:fban\/fbios|fb_iab\/fb4a)(?!.+fbav)|;fbav\/([\w\.]+);)/i],[[r,"Facebook"],h],[/safari (line)\/([\w\.]+)/i,/\b(line)\/([\w\.]+)\/iab/i,/(chromium|instagram)[\/ ]([-\w\.]+)/i],[r,h],[/\bgsa\/([\w\.]+) .*safari\//i],[h,[r,"GSA"]],[/headlesschrome(?:\/([\w\.]+)| )/i],[h,[r,A+" Headless"]],[/ wv\).+(chrome)\/([\w\.]+)/i],[[r,A+" WebView"],h],[/droid.+ version\/([\w\.]+)\b.+(?:mobile safari|safari)/i],[h,[r,"Android "+S]],[/(chrome|omniweb|arora|[tizenoka]{5} ?browser)\/v?([\w\.]+)/i],[r,h],[/version\/([\w\.]+) .*mobile\/\w+ (safari)/i],[h,[r,"Mobile Safari"]],[/version\/([\w\.]+) .*(mobile ?safari|safari)/i],[h,r],[/webkit.+?(mobile ?safari|safari)(\/[\w\.]+)/i],[r,[h,t,{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}]],[/(webkit|khtml)\/([\w\.]+)/i],[r,h],[/(navigator|netscape\d?)\/([-\w\.]+)/i],[[r,"Netscape"],h],[/mobile vr; rv:([\w\.]+)\).+firefox/i],[h,[r,R+" Reality"]],[/ekiohf.+(flow)\/([\w\.]+)/i,/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo browser|minimo|conkeror|klar)[\/ ]?([\w\.\+]+)/i,/(seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([-\w\.]+)$/i,/(firefox)\/([\w\.]+)/i,/(mozilla)\/([\w\.]+) .+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir|obigo|mosaic|(?:go|ice|up)[\. ]?browser)[-\/ ]?v?([\w\.]+)/i,/(links) \(([\w\.]+)/i],[r,h]],cpu:[[/(?:(amd|x(?:(?:86|64)[-_])?|wow|win)64)[;\)]/i],[[m,"amd64"]],[/(ia32(?=;))/i],[[m,D]],[/((?:i[346]|x)86)[;\)]/i],[[m,"ia32"]],[/\b(aarch64|arm(v?8e?l?|_?64))\b/i],[[m,"arm64"]],[/\b(arm(?:v[67])?ht?n?[fl]p?)\b/i],[[m,"armhf"]],[/windows (ce|mobile); ppc;/i],[[m,"arm"]],[/((?:ppc|powerpc)(?:64)?)(?: mac|;|\))/i],[[m,/ower/,"",D]],[/(sun4\w)[;\)]/i],[[m,"sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|\barm(?=v(?:[1-7]|[5-7]1)l?|;|eabi)|(?=atmel )avr|(?:irix|mips|sparc)(?:64)?\b|pa-risc)/i],[[m,D]]],device:[[/\b(sch-i[89]0\d|shw-m380s|sm-[pt]\w{2,4}|gt-[pn]\d{2,4}|sgh-t8[56]9|nexus 10)/i],[c,[g,N],[n,E]],[/\b((?:s[cgp]h|gt|sm)-\w+|galaxy nexus)/i,/samsung[- ]([-\w]+)/i,/sec-(sgh\w+)/i],[c,[g,N],[n,y]],[/\((ip(?:hone|od)[\w ]*);/i],[c,[g,"Apple"],[n,y]],[/\((ipad);[-\w\),; ]+apple/i,/applecoremedia\/[\w\.]+ \((ipad)/i,/\b(ipad)\d\d?,\d\d?[;\]].+ios/i],[c,[g,"Apple"],[n,E]],[/\b((?:ag[rs][23]?|bah2?|sht?|btv)-a?[lw]\d{2})\b(?!.+d\/s)/i],[c,[g,"Huawei"],[n,E]],[/(?:huawei|honor)([-\w ]+)[;\)]/i,/\b(nexus 6p|\w{2,4}-[atu]?[ln][01259x][012359][an]?)\b(?!.+d\/s)/i],[c,[g,"Huawei"],[n,y]],[/\b(poco[\w ]+)(?: bui|\))/i,/\b; (\w+) build\/hm\1/i,/\b(hm[-_ ]?note?[_ ]?(?:\d\w)?) bui/i,/\b(redmi[\-_ ]?(?:note|k)?[\w_ ]+)(?: bui|\))/i,/\b(mi[-_ ]?(?:a\d|one|one[_ ]plus|note lte|max)?[_ ]?(?:\d?\w?)[_ ]?(?:plus|se|lite)?)(?: bui|\))/i],[[c,/_/g," "],[g,"Xiaomi"],[n,y]],[/\b(mi[-_ ]?(?:pad)(?:[\w_ ]+))(?: bui|\))/i],[[c,/_/g," "],[g,"Xiaomi"],[n,E]],[/; (\w+) bui.+ oppo/i,/\b(cph[12]\d{3}|p(?:af|c[al]|d\w|e[ar])[mt]\d0|x9007|a101op)\b/i],[c,[g,"OPPO"],[n,y]],[/vivo (\w+)(?: bui|\))/i,/\b(v[12]\d{3}\w?[at])(?: bui|;)/i],[c,[g,"Vivo"],[n,y]],[/\b(rmx[12]\d{3})(?: bui|;|\))/i],[c,[g,"Realme"],[n,y]],[/\b(milestone|droid(?:[2-4x]| (?:bionic|x2|pro|razr))?:?( 4g)?)\b[\w ]+build\//i,/\bmot(?:orola)?[- ](\w*)/i,/((?:moto[\w\(\) ]+|xt\d{3,4}|nexus 6)(?= bui|\)))/i],[c,[g,"Motorola"],[n,y]],[/\b(mz60\d|xoom[2 ]{0,2}) build\//i],[c,[g,"Motorola"],[n,E]],[/((?=lg)?[vl]k\-?\d{3}) bui| 3\.[-\w; ]{10}lg?-([06cv9]{3,4})/i],[c,[g,"LG"],[n,E]],[/(lm(?:-?f100[nv]?|-[\w\.]+)(?= bui|\))|nexus [45])/i,/\blg[-e;\/ ]+((?!browser|netcast|android tv)\w+)/i,/\blg-?([\d\w]+) bui/i],[c,[g,"LG"],[n,y]],[/(ideatab[-\w ]+)/i,/lenovo ?(s[56]000[-\w]+|tab(?:[\w ]+)|yt[-\d\w]{6}|tb[-\d\w]{6})/i],[c,[g,"Lenovo"],[n,E]],[/(?:maemo|nokia).*(n900|lumia \d+)/i,/nokia[-_ ]?([-\w\.]*)/i],[[c,/_/g," "],[g,"Nokia"],[n,y]],[/(pixel c)\b/i],[c,[g,I],[n,E]],[/droid.+; (pixel[\daxl ]{0,6})(?: bui|\))/i],[c,[g,I],[n,y]],[/droid.+ ([c-g]\d{4}|so[-gl]\w+|xq-a\w[4-7][12])(?= bui|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[c,[g,"Sony"],[n,y]],[/sony tablet [ps]/i,/\b(?:sony)?sgp\w+(?: bui|\))/i],[[c,"Xperia Tablet"],[g,"Sony"],[n,E]],[/ (kb2005|in20[12]5|be20[12][59])\b/i,/(?:one)?(?:plus)? (a\d0\d\d)(?: b|\))/i],[c,[g,"OnePlus"],[n,y]],[/(alexa)webm/i,/(kf[a-z]{2}wi)( bui|\))/i,/(kf[a-z]+)( bui|\)).+silk\//i],[c,[g,T],[n,E]],[/((?:sd|kf)[0349hijorstuw]+)( bui|\)).+silk\//i],[[c,/(.+)/g,"Fire Phone $1"],[g,T],[n,y]],[/(playbook);[-\w\),; ]+(rim)/i],[c,g,[n,E]],[/\b((?:bb[a-f]|st[hv])100-\d)/i,/\(bb10; (\w+)/i],[c,[g,b],[n,y]],[/(?:\b|asus_)(transfo[prime ]{4,10} \w+|eeepc|slider \w+|nexus 7|padfone|p00[cj])/i],[c,[g,"ASUS"],[n,E]],[/ (z[bes]6[027][012][km][ls]|zenfone \d\w?)\b/i],[c,[g,"ASUS"],[n,y]],[/(nexus 9)/i],[c,[g,"HTC"],[n,E]],[/(htc)[-;_ ]{1,2}([\w ]+(?=\)| bui)|\w+)/i,/(zte)[- ]([\w ]+?)(?: bui|\/|\))/i,/(alcatel|geeksphone|nexian|panasonic|sony)[-_ ]?([-\w]*)/i],[g,[c,/_/g," "],[n,y]],[/droid.+; ([ab][1-7]-?[0178a]\d\d?)/i],[c,[g,"Acer"],[n,E]],[/droid.+; (m[1-5] note) bui/i,/\bmz-([-\w]{2,})/i],[c,[g,"Meizu"],[n,y]],[/\b(sh-?[altvz]?\d\d[a-ekm]?)/i],[c,[g,"Sharp"],[n,y]],[/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron)[-_ ]?([-\w]*)/i,/(hp) ([\w ]+\w)/i,/(asus)-?(\w+)/i,/(microsoft); (lumia[\w ]+)/i,/(lenovo)[-_ ]?([-\w]+)/i,/(jolla)/i,/(oppo) ?([\w ]+) bui/i],[g,c,[n,y]],[/(archos) (gamepad2?)/i,/(hp).+(touchpad(?!.+tablet)|tablet)/i,/(kindle)\/([\w\.]+)/i,/(nook)[\w ]+build\/(\w+)/i,/(dell) (strea[kpr\d ]*[\dko])/i,/(le[- ]+pan)[- ]+(\w{1,9}) bui/i,/(trinity)[- ]*(t\d{3}) bui/i,/(gigaset)[- ]+(q\w{1,9}) bui/i,/(vodafone) ([\w ]+)(?:\)| bui)/i],[g,c,[n,E]],[/(surface duo)/i],[c,[g,w],[n,E]],[/droid [\d\.]+; (fp\du?)(?: b|\))/i],[c,[g,"Fairphone"],[n,y]],[/(u304aa)/i],[c,[g,"AT&T"],[n,y]],[/\bsie-(\w*)/i],[c,[g,"Siemens"],[n,y]],[/\b(rct\w+) b/i],[c,[g,"RCA"],[n,E]],[/\b(venue[\d ]{2,7}) b/i],[c,[g,"Dell"],[n,E]],[/\b(q(?:mv|ta)\w+) b/i],[c,[g,"Verizon"],[n,E]],[/\b(?:barnes[& ]+noble |bn[rt])([\w\+ ]*) b/i],[c,[g,"Barnes & Noble"],[n,E]],[/\b(tm\d{3}\w+) b/i],[c,[g,"NuVision"],[n,E]],[/\b(k88) b/i],[c,[g,"ZTE"],[n,E]],[/\b(nx\d{3}j) b/i],[c,[g,"ZTE"],[n,y]],[/\b(gen\d{3}) b.+49h/i],[c,[g,"Swiss"],[n,y]],[/\b(zur\d{3}) b/i],[c,[g,"Swiss"],[n,E]],[/\b((zeki)?tb.*\b) b/i],[c,[g,"Zeki"],[n,E]],[/\b([yr]\d{2}) b/i,/\b(dragon[- ]+touch |dt)(\w{5}) b/i],[[g,"Dragon Touch"],c,[n,E]],[/\b(ns-?\w{0,9}) b/i],[c,[g,"Insignia"],[n,E]],[/\b((nxa|next)-?\w{0,9}) b/i],[c,[g,"NextBook"],[n,E]],[/\b(xtreme\_)?(v(1[045]|2[015]|[3469]0|7[05])) b/i],[[g,"Voice"],c,[n,y]],[/\b(lvtel\-)?(v1[12]) b/i],[[g,"LvTel"],c,[n,y]],[/\b(ph-1) /i],[c,[g,"Essential"],[n,y]],[/\b(v(100md|700na|7011|917g).*\b) b/i],[c,[g,"Envizen"],[n,E]],[/\b(trio[-\w\. ]+) b/i],[c,[g,"MachSpeed"],[n,E]],[/\btu_(1491) b/i],[c,[g,"Rotor"],[n,E]],[/(shield[\w ]+) b/i],[c,[g,"Nvidia"],[n,E]],[/(sprint) (\w+)/i],[g,c,[n,y]],[/(kin\.[onetw]{3})/i],[[c,/\./g," "],[g,w],[n,y]],[/droid.+; (cc6666?|et5[16]|mc[239][23]x?|vc8[03]x?)\)/i],[c,[g,"Zebra"],[n,E]],[/droid.+; (ec30|ps20|tc[2-8]\d[kx])\)/i],[c,[g,"Zebra"],[n,y]],[/(ouya)/i,/(nintendo) ([wids3utch]+)/i],[g,c,[n,p]],[/droid.+; (shield) bui/i],[c,[g,"Nvidia"],[n,p]],[/(playstation [345portablevi]+)/i],[c,[g,"Sony"],[n,p]],[/\b(xbox(?: one)?(?!; xbox))[\); ]/i],[c,[g,w],[n,p]],[/smart-tv.+(samsung)/i],[g,[n,_]],[/hbbtv.+maple;(\d+)/i],[[c,/^/,"SmartTV"],[g,N],[n,_]],[/(nux; netcast.+smarttv|lg (netcast\.tv-201\d|android tv))/i],[[g,"LG"],[n,_]],[/(apple) ?tv/i],[g,[c,"Apple TV"],[n,_]],[/crkey/i],[[c,A+"cast"],[g,I],[n,_]],[/droid.+aft(\w)( bui|\))/i],[c,[g,T],[n,_]],[/\(dtv[\);].+(aquos)/i],[c,[g,"Sharp"],[n,_]],[/\b(roku)[\dx]*[\)\/]((?:dvp-)?[\d\.]*)/i,/hbbtv\/\d+\.\d+\.\d+ +\([\w ]*; *(\w[^;]*);([^;]*)/i],[[g,o],[c,o],[n,_]],[/\b(android tv|smart[- ]?tv|opera tv|tv; rv:)\b/i],[[n,_]],[/((pebble))app/i],[g,c,[n,v]],[/droid.+; (glass) \d/i],[c,[g,I],[n,v]],[/droid.+; (wt63?0{2,3})\)/i],[c,[g,"Zebra"],[n,v]],[/(quest( 2)?)/i],[c,[g,"Facebook"],[n,v]],[/(tesla)(?: qtcarbrowser|\/[-\w\.]+)/i],[g,[n,"embedded"]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+? mobile safari/i],[c,[n,y]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+?(?! mobile) safari/i],[c,[n,E]],[/\b((tablet|tab)[;\/]|focus\/\d(?!.+mobile))/i],[[n,E]],[/(phone|mobile(?:[;\/]| safari)|pda(?=.+windows ce))/i],[[n,y]],[/(android[-\w\. ]{0,9});.+buil/i],[c,[g,"Generic"]]],engine:[[/windows.+ edge\/([\w\.]+)/i],[h,[r,"EdgeHTML"]],[/webkit\/537\.36.+chrome\/(?!27)([\w\.]+)/i],[h,[r,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna)\/([\w\.]+)/i,/ekioh(flow)\/([\w\.]+)/i,/(khtml|tasman|links)[\/ ]\(?([\w\.]+)/i,/(icab)[\/ ]([23]\.[\d\.]+)/i],[r,h],[/rv\:([\w\.]{1,9})\b.+(gecko)/i],[h,r]],os:[[/microsoft (windows) (vista|xp)/i],[r,h],[/(windows) nt 6\.2; (arm)/i,/(windows (?:phone(?: os)?|mobile))[\/ ]?([\d\.\w ]*)/i,/(windows)[\/ ]?([ntce\d\. ]+\w)(?!.+xbox)/i],[r,[h,t,M]],[/(win(?=3|9|n)|win 9x )([nt\d\.]+)/i],[[r,"Windows"],[h,t,M]],[/ip[honead]{2,4}\b(?:.*os ([\w]+) like mac|; opera)/i,/cfnetwork\/.+darwin/i],[[h,/_/g,"."],[r,"iOS"]],[/(mac os x) ?([\w\. ]*)/i,/(macintosh|mac_powerpc\b)(?!.+haiku)/i],[[r,"Mac OS"],[h,/_/g,"."]],[/droid ([\w\.]+)\b.+(android[- ]x86)/i],[h,r],[/(android|webos|qnx|bada|rim tablet os|maemo|meego|sailfish)[-\/ ]?([\w\.]*)/i,/(blackberry)\w*\/([\w\.]*)/i,/(tizen|kaios)[\/ ]([\w\.]+)/i,/\((series40);/i],[r,h],[/\(bb(10);/i],[h,[r,b]],[/(?:symbian ?os|symbos|s60(?=;)|series60)[-\/ ]?([\w\.]*)/i],[h,[r,"Symbian"]],[/mozilla\/[\d\.]+ \((?:mobile|tablet|tv|mobile; [\w ]+); rv:.+ gecko\/([\w\.]+)/i],[h,[r,R+" OS"]],[/web0s;.+rt(tv)/i,/\b(?:hp)?wos(?:browser)?\/([\w\.]+)/i],[h,[r,"webOS"]],[/crkey\/([\d\.]+)/i],[h,[r,A+"cast"]],[/(cros) [\w]+ ([\w\.]+\w)/i],[[r,"Chromium OS"],h],[/(nintendo|playstation) ([wids345portablevuch]+)/i,/(xbox); +xbox ([^\);]+)/i,/\b(joli|palm)\b ?(?:os)?\/?([\w\.]*)/i,/(mint)[\/\(\) ]?(\w*)/i,/(mageia|vectorlinux)[; ]/i,/([kxln]?ubuntu|debian|suse|opensuse|gentoo|arch(?= linux)|slackware|fedora|mandriva|centos|pclinuxos|red ?hat|zenwalk|linpus|raspbian|plan 9|minix|risc os|contiki|deepin|manjaro|elementary os|sabayon|linspire)(?: gnu\/linux)?(?: enterprise)?(?:[- ]linux)?(?:-gnu)?[-\/ ]?(?!chrom|package)([-\w\.]*)/i,/(hurd|linux) ?([\w\.]*)/i,/(gnu) ?([\w\.]*)/i,/\b([-frentopcghs]{0,5}bsd|dragonfly)[\/ ]?(?!amd|[ix346]{1,2}86)([\w\.]*)/i,/(haiku) (\w+)/i],[r,h],[/(sunos) ?([\w\.\d]*)/i],[[r,"Solaris"],h],[/((?:open)?solaris)[-\/ ]?([\w\.]*)/i,/(aix) ((\d)(?=\.|\)| )[\w\.])*/i,/\b(beos|os\/2|amigaos|morphos|openvms|fuchsia|hp-ux)/i,/(unix) ?([\w\.]*)/i],[r,h]]},P=function(e,t){if(typeof e==d&&(t=e,e=f),!(this instanceof P))return new P(e,t).getResult();var r=e||(typeof a!=l&&a.navigator&&a.navigator.userAgent?a.navigator.userAgent:""),n=t?function(e,t){var r,n={};for(r in e)t[r]&&t[r].length%2==0?n[r]=t[r].concat(e[r]):n[r]=e[r];return n}(O,t):O;return this.getBrowser=function(){var e,t={};return t.name=f,t[h]=f,s.call(t,r,n.browser),t.major=typeof(e=t.version)==u?e.replace(/[^\d\.]/g,"").split(".")[0]:f,t},this.getCPU=function(){var e={};return e[m]=f,s.call(e,r,n.cpu),e},this.getDevice=function(){var e={};return e[g]=f,e[c]=f,e.type=f,s.call(e,r,n.device),e},this.getEngine=function(){var e={};return e.name=f,e[h]=f,s.call(e,r,n.engine),e},this.getOS=function(){var e={};return e.name=f,e[h]=f,s.call(e,r,n.os),e},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return r},this.setUA=function(e){return r=typeof e==u&&255<e.length?o(e,255):e,this},this.setUA(r),this};P.VERSION="1.0.2",P.BROWSER=e([r,h,"major"]),P.CPU=e([m]),P.DEVICE=e([c,g,n,p,y,_,E,v,"embedded"]),P.ENGINE=P.OS=e([r,h]),typeof j!=l?(j=x.exports?x.exports=P:j).UAParser=P:k.amdO?(U=function(){return P}.call(j,k,j,x))===f||(x.exports=U):typeof a!=l&&(a.UAParser=P);var L,F=typeof a!=l&&(a.jQuery||a.Zepto);F&&!F.ua&&(L=new P,F.ua=L.getResult(),F.ua.get=function(){return L.getUA()},F.ua.set=function(e){L.setUA(e);var t,r=L.getResult();for(t in r)F.ua[t]=r[t]})}("object"==typeof window?window:this)},"./node_modules/util-deprecate/browser.js":(e,t,r)=>{function n(e){try{if(!r.g.localStorage)return}catch(e){return}e=r.g.localStorage[e];return null!=e&&"true"===String(e).toLowerCase()}e.exports=function(e,t){if(n("noDeprecation"))return e;var r=!1;return function(){if(!r){if(n("throwDeprecation"))throw new Error(t);n("traceDeprecation")?console.trace(t):console.warn(t),r=!0}return e.apply(this,arguments)}}},"?3e83":()=>{},"?19e6":()=>{},"./node_modules/bcp-47-normalize/lib/defaults.json":e=>{e.exports=JSON.parse('["mni-beng-in","mni-mtei-in","sat-deva-in","sat-olck-in","shi-latn-ma","shi-tfng-ma","vai-latn-lr","vai-vaii-lr","yue-hans-cn","yue-hant-hk","az-arab-ir","az-cyrl-az","az-latn-az","bm-nkoo-ml","bs-cyrl-ba","bs-latn-ba","en-dsrt-us","ff-adlm-gn","ff-latn-sn","ha-arab-ng","hi-latn-in","iu-latn-ca","ks-arab-in","ks-deva-in","mn-mong-cn","ms-arab-my","pa-arab-pk","pa-guru-in","sd-arab-pk","sd-deva-in","sr-cyrl-rs","sr-latn-rs","su-latn-id","uz-arab-af","uz-cyrl-uz","uz-latn-uz","zh-hans-cn","zh-hant-tw","mni-beng","sat-olck","shi-tfng","vai-vaii","yue-hant","az-latn","bs-latn","ff-latn","jbo-001","ks-arab","pa-guru","prg-001","sd-arab","sr-cyrl","su-latn","uz-latn","zh-hans","agq-cm","ar-001","arn-cl","asa-tz","ast-es","bas-cm","bem-zm","bez-tz","bgn-pk","blt-vn","brx-in","bss-cm","byn-er","cad-us","cch-ng","ccp-bd","ceb-ph","cgg-ug","chr-us","cic-us","ckb-iq","dav-ke","dje-ne","doi-in","dsb-de","dua-cm","dyo-sn","ebu-ke","eo-001","ewo-cm","fil-ph","fur-it","gaa-gh","gez-et","gsw-ch","guz-ke","haw-us","hsb-de","ia-001","ife-tg","io-001","jgo-cm","jmc-tz","kab-dz","kaj-ng","kam-ke","kcg-ng","kde-tz","kea-cv","ken-cm","khq-ml","kkj-cm","kln-ke","kok-in","kpe-lr","ksb-tz","ksf-cm","ksh-de","lag-tz","lkt-us","lrc-ir","luo-ke","luy-ke","mai-in","mas-ke","mer-ke","mfe-mu","mgh-mz","mgo-cm","moh-ca","mua-cm","mus-us","myv-ru","mzn-ir","naq-na","nds-de","nmg-cm","nnh-cm","nqo-gn","nso-za","nus-ss","nyn-ug","osa-us","pcm-ng","quc-gt","rof-tz","rwk-tz","sah-ru","saq-ke","sbp-tz","scn-it","sdh-ir","seh-mz","ses-ml","sid-et","sma-se","smj-se","smn-fi","sms-fi","ssy-er","syr-iq","szl-pl","teo-ug","tig-er","trv-tw","trw-pk","twq-ne","tzm-ma","vo-001","vun-tz","wae-ch","wal-et","wbp-au","xog-ug","yav-cm","yi-001","zgh-ma","aa-et","af-za","ak-gh","am-et","an-es","as-in","ba-ru","be-by","bg-bg","bm-ml","bn-bd","bo-cn","br-fr","ca-es","ce-ru","co-fr","cs-cz","cu-ru","cv-ru","cy-gb","da-dk","de-de","dv-mv","dz-bt","ee-gh","el-gr","en-us","es-es","et-ee","eu-es","fa-ir","fi-fi","fo-fo","fr-fr","fy-nl","ga-ie","gd-gb","gl-es","gn-py","gu-in","gv-im","ha-ng","he-il","hi-in","hr-hr","hu-hu","hy-am","id-id","ig-ng","ii-cn","is-is","it-it","iu-ca","ja-jp","jv-id","ka-ge","ki-ke","kk-kz","kl-gl","km-kh","kn-in","ko-kr","ku-tr","kw-gb","ky-kg","lb-lu","lg-ug","ln-cd","lo-la","lt-lt","lu-cd","lv-lv","mg-mg","mi-nz","mk-mk","ml-in","mn-mn","mr-in","ms-my","mt-mt","my-mm","nb-no","nd-zw","ne-np","nl-nl","nn-no","nr-za","nv-us","ny-mw","oc-fr","om-et","or-in","os-ge","pl-pl","ps-af","pt-br","qu-pe","rm-ch","rn-bi","ro-ro","ru-ru","rw-rw","sa-in","sc-it","se-no","sg-cf","si-lk","sk-sk","sl-si","sn-zw","so-so","sq-al","ss-za","st-za","sv-se","sw-tz","ta-in","te-in","tg-tj","th-th","ti-et","tk-tm","tn-za","to-to","tr-tr","ts-za","tt-ru","ug-cn","uk-ua","ur-pk","ve-za","vi-vn","wa-be","wo-sn","xh-za","yo-ng","zu-za"]')},"./node_modules/bcp-47-normalize/lib/fields.json":e=>{e.exports=JSON.parse('[{"from":{"field":"script","value":"qaai"},"to":{"field":"script","value":"zinh"}},{"from":{"field":"region","value":"bu"},"to":{"field":"region","value":"mm"}},{"from":{"field":"region","value":"ct"},"to":{"field":"region","value":"ki"}},{"from":{"field":"region","value":"dd"},"to":{"field":"region","value":"de"}},{"from":{"field":"region","value":"dy"},"to":{"field":"region","value":"bj"}},{"from":{"field":"region","value":"fx"},"to":{"field":"region","value":"fr"}},{"from":{"field":"region","value":"hv"},"to":{"field":"region","value":"bf"}},{"from":{"field":"region","value":"jt"},"to":{"field":"region","value":"um"}},{"from":{"field":"region","value":"mi"},"to":{"field":"region","value":"um"}},{"from":{"field":"region","value":"nh"},"to":{"field":"region","value":"vu"}},{"from":{"field":"region","value":"nq"},"to":{"field":"region","value":"aq"}},{"from":{"field":"region","value":"pu"},"to":{"field":"region","value":"um"}},{"from":{"field":"region","value":"pz"},"to":{"field":"region","value":"pa"}},{"from":{"field":"region","value":"qu"},"to":{"field":"region","value":"eu"}},{"from":{"field":"region","value":"rh"},"to":{"field":"region","value":"zw"}},{"from":{"field":"region","value":"tp"},"to":{"field":"region","value":"tl"}},{"from":{"field":"region","value":"uk"},"to":{"field":"region","value":"gb"}},{"from":{"field":"region","value":"vd"},"to":{"field":"region","value":"vn"}},{"from":{"field":"region","value":"wk"},"to":{"field":"region","value":"um"}},{"from":{"field":"region","value":"yd"},"to":{"field":"region","value":"ye"}},{"from":{"field":"region","value":"zr"},"to":{"field":"region","value":"cd"}},{"from":{"field":"region","value":"230"},"to":{"field":"region","value":"et"}},{"from":{"field":"region","value":"280"},"to":{"field":"region","value":"de"}},{"from":{"field":"region","value":"736"},"to":{"field":"region","value":"sd"}},{"from":{"field":"region","value":"886"},"to":{"field":"region","value":"ye"}},{"from":{"field":"region","value":"958"},"to":{"field":"region","value":"aa"}},{"from":{"field":"region","value":"020"},"to":{"field":"region","value":"ad"}},{"from":{"field":"region","value":"784"},"to":{"field":"region","value":"ae"}},{"from":{"field":"region","value":"004"},"to":{"field":"region","value":"af"}},{"from":{"field":"region","value":"028"},"to":{"field":"region","value":"ag"}},{"from":{"field":"region","value":"660"},"to":{"field":"region","value":"ai"}},{"from":{"field":"region","value":"008"},"to":{"field":"region","value":"al"}},{"from":{"field":"region","value":"051"},"to":{"field":"region","value":"am"}},{"from":{"field":"region","value":"024"},"to":{"field":"region","value":"ao"}},{"from":{"field":"region","value":"010"},"to":{"field":"region","value":"aq"}},{"from":{"field":"region","value":"032"},"to":{"field":"region","value":"ar"}},{"from":{"field":"region","value":"016"},"to":{"field":"region","value":"as"}},{"from":{"field":"region","value":"040"},"to":{"field":"region","value":"at"}},{"from":{"field":"region","value":"036"},"to":{"field":"region","value":"au"}},{"from":{"field":"region","value":"533"},"to":{"field":"region","value":"aw"}},{"from":{"field":"region","value":"248"},"to":{"field":"region","value":"ax"}},{"from":{"field":"region","value":"031"},"to":{"field":"region","value":"az"}},{"from":{"field":"region","value":"070"},"to":{"field":"region","value":"ba"}},{"from":{"field":"region","value":"052"},"to":{"field":"region","value":"bb"}},{"from":{"field":"region","value":"050"},"to":{"field":"region","value":"bd"}},{"from":{"field":"region","value":"056"},"to":{"field":"region","value":"be"}},{"from":{"field":"region","value":"854"},"to":{"field":"region","value":"bf"}},{"from":{"field":"region","value":"100"},"to":{"field":"region","value":"bg"}},{"from":{"field":"region","value":"048"},"to":{"field":"region","value":"bh"}},{"from":{"field":"region","value":"108"},"to":{"field":"region","value":"bi"}},{"from":{"field":"region","value":"204"},"to":{"field":"region","value":"bj"}},{"from":{"field":"region","value":"652"},"to":{"field":"region","value":"bl"}},{"from":{"field":"region","value":"060"},"to":{"field":"region","value":"bm"}},{"from":{"field":"region","value":"096"},"to":{"field":"region","value":"bn"}},{"from":{"field":"region","value":"068"},"to":{"field":"region","value":"bo"}},{"from":{"field":"region","value":"535"},"to":{"field":"region","value":"bq"}},{"from":{"field":"region","value":"076"},"to":{"field":"region","value":"br"}},{"from":{"field":"region","value":"044"},"to":{"field":"region","value":"bs"}},{"from":{"field":"region","value":"064"},"to":{"field":"region","value":"bt"}},{"from":{"field":"region","value":"104"},"to":{"field":"region","value":"mm"}},{"from":{"field":"region","value":"074"},"to":{"field":"region","value":"bv"}},{"from":{"field":"region","value":"072"},"to":{"field":"region","value":"bw"}},{"from":{"field":"region","value":"112"},"to":{"field":"region","value":"by"}},{"from":{"field":"region","value":"084"},"to":{"field":"region","value":"bz"}},{"from":{"field":"region","value":"124"},"to":{"field":"region","value":"ca"}},{"from":{"field":"region","value":"166"},"to":{"field":"region","value":"cc"}},{"from":{"field":"region","value":"180"},"to":{"field":"region","value":"cd"}},{"from":{"field":"region","value":"140"},"to":{"field":"region","value":"cf"}},{"from":{"field":"region","value":"178"},"to":{"field":"region","value":"cg"}},{"from":{"field":"region","value":"756"},"to":{"field":"region","value":"ch"}},{"from":{"field":"region","value":"384"},"to":{"field":"region","value":"ci"}},{"from":{"field":"region","value":"184"},"to":{"field":"region","value":"ck"}},{"from":{"field":"region","value":"152"},"to":{"field":"region","value":"cl"}},{"from":{"field":"region","value":"120"},"to":{"field":"region","value":"cm"}},{"from":{"field":"region","value":"156"},"to":{"field":"region","value":"cn"}},{"from":{"field":"region","value":"170"},"to":{"field":"region","value":"co"}},{"from":{"field":"region","value":"188"},"to":{"field":"region","value":"cr"}},{"from":{"field":"region","value":"192"},"to":{"field":"region","value":"cu"}},{"from":{"field":"region","value":"132"},"to":{"field":"region","value":"cv"}},{"from":{"field":"region","value":"531"},"to":{"field":"region","value":"cw"}},{"from":{"field":"region","value":"162"},"to":{"field":"region","value":"cx"}},{"from":{"field":"region","value":"196"},"to":{"field":"region","value":"cy"}},{"from":{"field":"region","value":"203"},"to":{"field":"region","value":"cz"}},{"from":{"field":"region","value":"278"},"to":{"field":"region","value":"de"}},{"from":{"field":"region","value":"276"},"to":{"field":"region","value":"de"}},{"from":{"field":"region","value":"262"},"to":{"field":"region","value":"dj"}},{"from":{"field":"region","value":"208"},"to":{"field":"region","value":"dk"}},{"from":{"field":"region","value":"212"},"to":{"field":"region","value":"dm"}},{"from":{"field":"region","value":"214"},"to":{"field":"region","value":"do"}},{"from":{"field":"region","value":"012"},"to":{"field":"region","value":"dz"}},{"from":{"field":"region","value":"218"},"to":{"field":"region","value":"ec"}},{"from":{"field":"region","value":"233"},"to":{"field":"region","value":"ee"}},{"from":{"field":"region","value":"818"},"to":{"field":"region","value":"eg"}},{"from":{"field":"region","value":"732"},"to":{"field":"region","value":"eh"}},{"from":{"field":"region","value":"232"},"to":{"field":"region","value":"er"}},{"from":{"field":"region","value":"724"},"to":{"field":"region","value":"es"}},{"from":{"field":"region","value":"231"},"to":{"field":"region","value":"et"}},{"from":{"field":"region","value":"246"},"to":{"field":"region","value":"fi"}},{"from":{"field":"region","value":"242"},"to":{"field":"region","value":"fj"}},{"from":{"field":"region","value":"238"},"to":{"field":"region","value":"fk"}},{"from":{"field":"region","value":"583"},"to":{"field":"region","value":"fm"}},{"from":{"field":"region","value":"234"},"to":{"field":"region","value":"fo"}},{"from":{"field":"region","value":"250"},"to":{"field":"region","value":"fr"}},{"from":{"field":"region","value":"249"},"to":{"field":"region","value":"fr"}},{"from":{"field":"region","value":"266"},"to":{"field":"region","value":"ga"}},{"from":{"field":"region","value":"826"},"to":{"field":"region","value":"gb"}},{"from":{"field":"region","value":"308"},"to":{"field":"region","value":"gd"}},{"from":{"field":"region","value":"268"},"to":{"field":"region","value":"ge"}},{"from":{"field":"region","value":"254"},"to":{"field":"region","value":"gf"}},{"from":{"field":"region","value":"831"},"to":{"field":"region","value":"gg"}},{"from":{"field":"region","value":"288"},"to":{"field":"region","value":"gh"}},{"from":{"field":"region","value":"292"},"to":{"field":"region","value":"gi"}},{"from":{"field":"region","value":"304"},"to":{"field":"region","value":"gl"}},{"from":{"field":"region","value":"270"},"to":{"field":"region","value":"gm"}},{"from":{"field":"region","value":"324"},"to":{"field":"region","value":"gn"}},{"from":{"field":"region","value":"312"},"to":{"field":"region","value":"gp"}},{"from":{"field":"region","value":"226"},"to":{"field":"region","value":"gq"}},{"from":{"field":"region","value":"300"},"to":{"field":"region","value":"gr"}},{"from":{"field":"region","value":"239"},"to":{"field":"region","value":"gs"}},{"from":{"field":"region","value":"320"},"to":{"field":"region","value":"gt"}},{"from":{"field":"region","value":"316"},"to":{"field":"region","value":"gu"}},{"from":{"field":"region","value":"624"},"to":{"field":"region","value":"gw"}},{"from":{"field":"region","value":"328"},"to":{"field":"region","value":"gy"}},{"from":{"field":"region","value":"344"},"to":{"field":"region","value":"hk"}},{"from":{"field":"region","value":"334"},"to":{"field":"region","value":"hm"}},{"from":{"field":"region","value":"340"},"to":{"field":"region","value":"hn"}},{"from":{"field":"region","value":"191"},"to":{"field":"region","value":"hr"}},{"from":{"field":"region","value":"332"},"to":{"field":"region","value":"ht"}},{"from":{"field":"region","value":"348"},"to":{"field":"region","value":"hu"}},{"from":{"field":"region","value":"360"},"to":{"field":"region","value":"id"}},{"from":{"field":"region","value":"372"},"to":{"field":"region","value":"ie"}},{"from":{"field":"region","value":"376"},"to":{"field":"region","value":"il"}},{"from":{"field":"region","value":"833"},"to":{"field":"region","value":"im"}},{"from":{"field":"region","value":"356"},"to":{"field":"region","value":"in"}},{"from":{"field":"region","value":"086"},"to":{"field":"region","value":"io"}},{"from":{"field":"region","value":"368"},"to":{"field":"region","value":"iq"}},{"from":{"field":"region","value":"364"},"to":{"field":"region","value":"ir"}},{"from":{"field":"region","value":"352"},"to":{"field":"region","value":"is"}},{"from":{"field":"region","value":"380"},"to":{"field":"region","value":"it"}},{"from":{"field":"region","value":"832"},"to":{"field":"region","value":"je"}},{"from":{"field":"region","value":"388"},"to":{"field":"region","value":"jm"}},{"from":{"field":"region","value":"400"},"to":{"field":"region","value":"jo"}},{"from":{"field":"region","value":"392"},"to":{"field":"region","value":"jp"}},{"from":{"field":"region","value":"404"},"to":{"field":"region","value":"ke"}},{"from":{"field":"region","value":"417"},"to":{"field":"region","value":"kg"}},{"from":{"field":"region","value":"116"},"to":{"field":"region","value":"kh"}},{"from":{"field":"region","value":"296"},"to":{"field":"region","value":"ki"}},{"from":{"field":"region","value":"174"},"to":{"field":"region","value":"km"}},{"from":{"field":"region","value":"659"},"to":{"field":"region","value":"kn"}},{"from":{"field":"region","value":"408"},"to":{"field":"region","value":"kp"}},{"from":{"field":"region","value":"410"},"to":{"field":"region","value":"kr"}},{"from":{"field":"region","value":"414"},"to":{"field":"region","value":"kw"}},{"from":{"field":"region","value":"136"},"to":{"field":"region","value":"ky"}},{"from":{"field":"region","value":"398"},"to":{"field":"region","value":"kz"}},{"from":{"field":"region","value":"418"},"to":{"field":"region","value":"la"}},{"from":{"field":"region","value":"422"},"to":{"field":"region","value":"lb"}},{"from":{"field":"region","value":"662"},"to":{"field":"region","value":"lc"}},{"from":{"field":"region","value":"438"},"to":{"field":"region","value":"li"}},{"from":{"field":"region","value":"144"},"to":{"field":"region","value":"lk"}},{"from":{"field":"region","value":"430"},"to":{"field":"region","value":"lr"}},{"from":{"field":"region","value":"426"},"to":{"field":"region","value":"ls"}},{"from":{"field":"region","value":"440"},"to":{"field":"region","value":"lt"}},{"from":{"field":"region","value":"442"},"to":{"field":"region","value":"lu"}},{"from":{"field":"region","value":"428"},"to":{"field":"region","value":"lv"}},{"from":{"field":"region","value":"434"},"to":{"field":"region","value":"ly"}},{"from":{"field":"region","value":"504"},"to":{"field":"region","value":"ma"}},{"from":{"field":"region","value":"492"},"to":{"field":"region","value":"mc"}},{"from":{"field":"region","value":"498"},"to":{"field":"region","value":"md"}},{"from":{"field":"region","value":"499"},"to":{"field":"region","value":"me"}},{"from":{"field":"region","value":"663"},"to":{"field":"region","value":"mf"}},{"from":{"field":"region","value":"450"},"to":{"field":"region","value":"mg"}},{"from":{"field":"region","value":"584"},"to":{"field":"region","value":"mh"}},{"from":{"field":"region","value":"807"},"to":{"field":"region","value":"mk"}},{"from":{"field":"region","value":"466"},"to":{"field":"region","value":"ml"}},{"from":{"field":"region","value":"496"},"to":{"field":"region","value":"mn"}},{"from":{"field":"region","value":"446"},"to":{"field":"region","value":"mo"}},{"from":{"field":"region","value":"580"},"to":{"field":"region","value":"mp"}},{"from":{"field":"region","value":"474"},"to":{"field":"region","value":"mq"}},{"from":{"field":"region","value":"478"},"to":{"field":"region","value":"mr"}},{"from":{"field":"region","value":"500"},"to":{"field":"region","value":"ms"}},{"from":{"field":"region","value":"470"},"to":{"field":"region","value":"mt"}},{"from":{"field":"region","value":"480"},"to":{"field":"region","value":"mu"}},{"from":{"field":"region","value":"462"},"to":{"field":"region","value":"mv"}},{"from":{"field":"region","value":"454"},"to":{"field":"region","value":"mw"}},{"from":{"field":"region","value":"484"},"to":{"field":"region","value":"mx"}},{"from":{"field":"region","value":"458"},"to":{"field":"region","value":"my"}},{"from":{"field":"region","value":"508"},"to":{"field":"region","value":"mz"}},{"from":{"field":"region","value":"516"},"to":{"field":"region","value":"na"}},{"from":{"field":"region","value":"540"},"to":{"field":"region","value":"nc"}},{"from":{"field":"region","value":"562"},"to":{"field":"region","value":"ne"}},{"from":{"field":"region","value":"574"},"to":{"field":"region","value":"nf"}},{"from":{"field":"region","value":"566"},"to":{"field":"region","value":"ng"}},{"from":{"field":"region","value":"558"},"to":{"field":"region","value":"ni"}},{"from":{"field":"region","value":"528"},"to":{"field":"region","value":"nl"}},{"from":{"field":"region","value":"578"},"to":{"field":"region","value":"no"}},{"from":{"field":"region","value":"524"},"to":{"field":"region","value":"np"}},{"from":{"field":"region","value":"520"},"to":{"field":"region","value":"nr"}},{"from":{"field":"region","value":"570"},"to":{"field":"region","value":"nu"}},{"from":{"field":"region","value":"554"},"to":{"field":"region","value":"nz"}},{"from":{"field":"region","value":"512"},"to":{"field":"region","value":"om"}},{"from":{"field":"region","value":"591"},"to":{"field":"region","value":"pa"}},{"from":{"field":"region","value":"604"},"to":{"field":"region","value":"pe"}},{"from":{"field":"region","value":"258"},"to":{"field":"region","value":"pf"}},{"from":{"field":"region","value":"598"},"to":{"field":"region","value":"pg"}},{"from":{"field":"region","value":"608"},"to":{"field":"region","value":"ph"}},{"from":{"field":"region","value":"586"},"to":{"field":"region","value":"pk"}},{"from":{"field":"region","value":"616"},"to":{"field":"region","value":"pl"}},{"from":{"field":"region","value":"666"},"to":{"field":"region","value":"pm"}},{"from":{"field":"region","value":"612"},"to":{"field":"region","value":"pn"}},{"from":{"field":"region","value":"630"},"to":{"field":"region","value":"pr"}},{"from":{"field":"region","value":"275"},"to":{"field":"region","value":"ps"}},{"from":{"field":"region","value":"620"},"to":{"field":"region","value":"pt"}},{"from":{"field":"region","value":"585"},"to":{"field":"region","value":"pw"}},{"from":{"field":"region","value":"600"},"to":{"field":"region","value":"py"}},{"from":{"field":"region","value":"634"},"to":{"field":"region","value":"qa"}},{"from":{"field":"region","value":"959"},"to":{"field":"region","value":"qm"}},{"from":{"field":"region","value":"960"},"to":{"field":"region","value":"qn"}},{"from":{"field":"region","value":"962"},"to":{"field":"region","value":"qp"}},{"from":{"field":"region","value":"963"},"to":{"field":"region","value":"qq"}},{"from":{"field":"region","value":"964"},"to":{"field":"region","value":"qr"}},{"from":{"field":"region","value":"965"},"to":{"field":"region","value":"qs"}},{"from":{"field":"region","value":"966"},"to":{"field":"region","value":"qt"}},{"from":{"field":"region","value":"967"},"to":{"field":"region","value":"eu"}},{"from":{"field":"region","value":"968"},"to":{"field":"region","value":"qv"}},{"from":{"field":"region","value":"969"},"to":{"field":"region","value":"qw"}},{"from":{"field":"region","value":"970"},"to":{"field":"region","value":"qx"}},{"from":{"field":"region","value":"971"},"to":{"field":"region","value":"qy"}},{"from":{"field":"region","value":"972"},"to":{"field":"region","value":"qz"}},{"from":{"field":"region","value":"638"},"to":{"field":"region","value":"re"}},{"from":{"field":"region","value":"642"},"to":{"field":"region","value":"ro"}},{"from":{"field":"region","value":"688"},"to":{"field":"region","value":"rs"}},{"from":{"field":"region","value":"643"},"to":{"field":"region","value":"ru"}},{"from":{"field":"region","value":"646"},"to":{"field":"region","value":"rw"}},{"from":{"field":"region","value":"682"},"to":{"field":"region","value":"sa"}},{"from":{"field":"region","value":"090"},"to":{"field":"region","value":"sb"}},{"from":{"field":"region","value":"690"},"to":{"field":"region","value":"sc"}},{"from":{"field":"region","value":"729"},"to":{"field":"region","value":"sd"}},{"from":{"field":"region","value":"752"},"to":{"field":"region","value":"se"}},{"from":{"field":"region","value":"702"},"to":{"field":"region","value":"sg"}},{"from":{"field":"region","value":"654"},"to":{"field":"region","value":"sh"}},{"from":{"field":"region","value":"705"},"to":{"field":"region","value":"si"}},{"from":{"field":"region","value":"744"},"to":{"field":"region","value":"sj"}},{"from":{"field":"region","value":"703"},"to":{"field":"region","value":"sk"}},{"from":{"field":"region","value":"694"},"to":{"field":"region","value":"sl"}},{"from":{"field":"region","value":"674"},"to":{"field":"region","value":"sm"}},{"from":{"field":"region","value":"686"},"to":{"field":"region","value":"sn"}},{"from":{"field":"region","value":"706"},"to":{"field":"region","value":"so"}},{"from":{"field":"region","value":"740"},"to":{"field":"region","value":"sr"}},{"from":{"field":"region","value":"728"},"to":{"field":"region","value":"ss"}},{"from":{"field":"region","value":"678"},"to":{"field":"region","value":"st"}},{"from":{"field":"region","value":"222"},"to":{"field":"region","value":"sv"}},{"from":{"field":"region","value":"534"},"to":{"field":"region","value":"sx"}},{"from":{"field":"region","value":"760"},"to":{"field":"region","value":"sy"}},{"from":{"field":"region","value":"748"},"to":{"field":"region","value":"sz"}},{"from":{"field":"region","value":"796"},"to":{"field":"region","value":"tc"}},{"from":{"field":"region","value":"148"},"to":{"field":"region","value":"td"}},{"from":{"field":"region","value":"260"},"to":{"field":"region","value":"tf"}},{"from":{"field":"region","value":"768"},"to":{"field":"region","value":"tg"}},{"from":{"field":"region","value":"764"},"to":{"field":"region","value":"th"}},{"from":{"field":"region","value":"762"},"to":{"field":"region","value":"tj"}},{"from":{"field":"region","value":"772"},"to":{"field":"region","value":"tk"}},{"from":{"field":"region","value":"626"},"to":{"field":"region","value":"tl"}},{"from":{"field":"region","value":"795"},"to":{"field":"region","value":"tm"}},{"from":{"field":"region","value":"788"},"to":{"field":"region","value":"tn"}},{"from":{"field":"region","value":"776"},"to":{"field":"region","value":"to"}},{"from":{"field":"region","value":"792"},"to":{"field":"region","value":"tr"}},{"from":{"field":"region","value":"780"},"to":{"field":"region","value":"tt"}},{"from":{"field":"region","value":"798"},"to":{"field":"region","value":"tv"}},{"from":{"field":"region","value":"158"},"to":{"field":"region","value":"tw"}},{"from":{"field":"region","value":"834"},"to":{"field":"region","value":"tz"}},{"from":{"field":"region","value":"804"},"to":{"field":"region","value":"ua"}},{"from":{"field":"region","value":"800"},"to":{"field":"region","value":"ug"}},{"from":{"field":"region","value":"581"},"to":{"field":"region","value":"um"}},{"from":{"field":"region","value":"840"},"to":{"field":"region","value":"us"}},{"from":{"field":"region","value":"858"},"to":{"field":"region","value":"uy"}},{"from":{"field":"region","value":"860"},"to":{"field":"region","value":"uz"}},{"from":{"field":"region","value":"336"},"to":{"field":"region","value":"va"}},{"from":{"field":"region","value":"670"},"to":{"field":"region","value":"vc"}},{"from":{"field":"region","value":"862"},"to":{"field":"region","value":"ve"}},{"from":{"field":"region","value":"092"},"to":{"field":"region","value":"vg"}},{"from":{"field":"region","value":"850"},"to":{"field":"region","value":"vi"}},{"from":{"field":"region","value":"704"},"to":{"field":"region","value":"vn"}},{"from":{"field":"region","value":"548"},"to":{"field":"region","value":"vu"}},{"from":{"field":"region","value":"876"},"to":{"field":"region","value":"wf"}},{"from":{"field":"region","value":"882"},"to":{"field":"region","value":"ws"}},{"from":{"field":"region","value":"973"},"to":{"field":"region","value":"xa"}},{"from":{"field":"region","value":"974"},"to":{"field":"region","value":"xb"}},{"from":{"field":"region","value":"975"},"to":{"field":"region","value":"xc"}},{"from":{"field":"region","value":"976"},"to":{"field":"region","value":"xd"}},{"from":{"field":"region","value":"977"},"to":{"field":"region","value":"xe"}},{"from":{"field":"region","value":"978"},"to":{"field":"region","value":"xf"}},{"from":{"field":"region","value":"979"},"to":{"field":"region","value":"xg"}},{"from":{"field":"region","value":"980"},"to":{"field":"region","value":"xh"}},{"from":{"field":"region","value":"981"},"to":{"field":"region","value":"xi"}},{"from":{"field":"region","value":"982"},"to":{"field":"region","value":"xj"}},{"from":{"field":"region","value":"983"},"to":{"field":"region","value":"xk"}},{"from":{"field":"region","value":"984"},"to":{"field":"region","value":"xl"}},{"from":{"field":"region","value":"985"},"to":{"field":"region","value":"xm"}},{"from":{"field":"region","value":"986"},"to":{"field":"region","value":"xn"}},{"from":{"field":"region","value":"987"},"to":{"field":"region","value":"xo"}},{"from":{"field":"region","value":"988"},"to":{"field":"region","value":"xp"}},{"from":{"field":"region","value":"989"},"to":{"field":"region","value":"xq"}},{"from":{"field":"region","value":"990"},"to":{"field":"region","value":"xr"}},{"from":{"field":"region","value":"991"},"to":{"field":"region","value":"xs"}},{"from":{"field":"region","value":"992"},"to":{"field":"region","value":"xt"}},{"from":{"field":"region","value":"993"},"to":{"field":"region","value":"xu"}},{"from":{"field":"region","value":"994"},"to":{"field":"region","value":"xv"}},{"from":{"field":"region","value":"995"},"to":{"field":"region","value":"xw"}},{"from":{"field":"region","value":"996"},"to":{"field":"region","value":"xx"}},{"from":{"field":"region","value":"997"},"to":{"field":"region","value":"xy"}},{"from":{"field":"region","value":"998"},"to":{"field":"region","value":"xz"}},{"from":{"field":"region","value":"720"},"to":{"field":"region","value":"ye"}},{"from":{"field":"region","value":"887"},"to":{"field":"region","value":"ye"}},{"from":{"field":"region","value":"175"},"to":{"field":"region","value":"yt"}},{"from":{"field":"region","value":"710"},"to":{"field":"region","value":"za"}},{"from":{"field":"region","value":"894"},"to":{"field":"region","value":"zm"}},{"from":{"field":"region","value":"716"},"to":{"field":"region","value":"zw"}},{"from":{"field":"region","value":"999"},"to":{"field":"region","value":"zz"}},{"from":{"field":"variants","value":"aaland"},"to":{"field":"region","value":"ax"}},{"from":{"field":"variants","value":"polytoni"},"to":{"field":"variants","value":"polyton"}},{"from":{"field":"variants","value":"heploc"},"to":{"field":"variants","value":"alalc97"}},{"from":{"field":"variants","value":"arevela"},"to":{"field":"language","value":"hy"}},{"from":{"field":"variants","value":"arevmda"},"to":{"field":"language","value":"hyw"}}]')},"./node_modules/bcp-47-normalize/lib/many.json":e=>{e.exports=JSON.parse('{"region":{"172":["ru","am","az","by","ge","kg","kz","md","tj","tm","ua","uz"],"200":["cz","sk"],"530":["cw","sx","bq"],"532":["cw","sx","bq"],"536":["sa","iq"],"582":["fm","mh","mp","pw"],"810":["ru","am","az","by","ee","ge","kz","kg","lv","lt","md","tj","tm","ua","uz"],"830":["je","gg"],"890":["rs","me","si","hr","mk","ba"],"891":["rs","me"],"an":["cw","sx","bq"],"cs":["rs","me"],"fq":["aq","tf"],"nt":["sa","iq"],"pc":["fm","mh","mp","pw"],"su":["ru","am","az","by","ee","ge","kz","kg","lv","lt","md","tj","tm","ua","uz"],"yu":["rs","me"],"062":["034","143"],"ant":["cw","sx","bq"],"scg":["rs","me"],"ntz":["sa","iq"],"sun":["ru","am","az","by","ee","ge","kz","kg","lv","lt","md","tj","tm","ua","uz"],"yug":["rs","me"]}}')},"./node_modules/bcp-47-normalize/lib/matches.json":e=>{e.exports=JSON.parse('[{"from":"in","to":"id"},{"from":"iw","to":"he"},{"from":"ji","to":"yi"},{"from":"jw","to":"jv"},{"from":"mo","to":"ro"},{"from":"scc","to":"sr"},{"from":"scr","to":"hr"},{"from":"aam","to":"aas"},{"from":"adp","to":"dz"},{"from":"aue","to":"ktz"},{"from":"ayx","to":"nun"},{"from":"bgm","to":"bcg"},{"from":"bjd","to":"drl"},{"from":"ccq","to":"rki"},{"from":"cjr","to":"mom"},{"from":"cka","to":"cmr"},{"from":"cmk","to":"xch"},{"from":"coy","to":"pij"},{"from":"cqu","to":"quh"},{"from":"drh","to":"mn"},{"from":"drw","to":"fa-af"},{"from":"gav","to":"dev"},{"from":"gfx","to":"vaj"},{"from":"ggn","to":"gvr"},{"from":"gti","to":"nyc"},{"from":"guv","to":"duz"},{"from":"hrr","to":"jal"},{"from":"ibi","to":"opa"},{"from":"ilw","to":"gal"},{"from":"jeg","to":"oyb"},{"from":"kgc","to":"tdf"},{"from":"kgh","to":"kml"},{"from":"koj","to":"kwv"},{"from":"krm","to":"bmf"},{"from":"ktr","to":"dtp"},{"from":"kvs","to":"gdj"},{"from":"kwq","to":"yam"},{"from":"kxe","to":"tvd"},{"from":"kzj","to":"dtp"},{"from":"kzt","to":"dtp"},{"from":"lii","to":"raq"},{"from":"lmm","to":"rmx"},{"from":"meg","to":"cir"},{"from":"mst","to":"mry"},{"from":"mwj","to":"vaj"},{"from":"myt","to":"mry"},{"from":"nad","to":"xny"},{"from":"ncp","to":"kdz"},{"from":"nnx","to":"ngv"},{"from":"nts","to":"pij"},{"from":"oun","to":"vaj"},{"from":"pcr","to":"adx"},{"from":"pmc","to":"huw"},{"from":"pmu","to":"phr"},{"from":"ppa","to":"bfy"},{"from":"ppr","to":"lcq"},{"from":"pry","to":"prt"},{"from":"puz","to":"pub"},{"from":"sca","to":"hle"},{"from":"skk","to":"oyb"},{"from":"tdu","to":"dtp"},{"from":"thc","to":"tpo"},{"from":"thx","to":"oyb"},{"from":"tie","to":"ras"},{"from":"tkk","to":"twm"},{"from":"tlw","to":"weo"},{"from":"tmp","to":"tyj"},{"from":"tne","to":"kak"},{"from":"tnf","to":"fa-af"},{"from":"tsf","to":"taj"},{"from":"uok","to":"ema"},{"from":"xba","to":"cax"},{"from":"xia","to":"acn"},{"from":"xkh","to":"waw"},{"from":"xsj","to":"suj"},{"from":"ybd","to":"rki"},{"from":"yma","to":"lrr"},{"from":"ymt","to":"mtm"},{"from":"yos","to":"zom"},{"from":"yuu","to":"yug"},{"from":"asd","to":"snz"},{"from":"dit","to":"dif"},{"from":"llo","to":"ngt"},{"from":"myd","to":"aog"},{"from":"nns","to":"nbr"},{"from":"sgn-br","to":"bzs"},{"from":"sgn-co","to":"csn"},{"from":"sgn-de","to":"gsg"},{"from":"sgn-dk","to":"dsl"},{"from":"sgn-fr","to":"fsl"},{"from":"sgn-gb","to":"bfi"},{"from":"sgn-gr","to":"gss"},{"from":"sgn-ie","to":"isg"},{"from":"sgn-it","to":"ise"},{"from":"sgn-jp","to":"jsl"},{"from":"sgn-mx","to":"mfs"},{"from":"sgn-ni","to":"ncs"},{"from":"sgn-nl","to":"dse"},{"from":"sgn-no","to":"nsi"},{"from":"sgn-pt","to":"psr"},{"from":"sgn-se","to":"swl"},{"from":"sgn-us","to":"ase"},{"from":"sgn-za","to":"sfs"},{"from":"no-bokmal","to":"nb"},{"from":"no-nynorsk","to":"nn"},{"from":"aa-saaho","to":"ssy"},{"from":"sh","to":"sr-latn"},{"from":"cnr","to":"sr-me"},{"from":"no","to":"nb"},{"from":"tl","to":"fil"},{"from":"az-az","to":"az-latn-az"},{"from":"bs-ba","to":"bs-latn-ba"},{"from":"ha-latn-gh","to":"ha-gh"},{"from":"ha-latn-ne","to":"ha-ne"},{"from":"ha-latn-ng","to":"ha-ng"},{"from":"kk-cyrl-kz","to":"kk-kz"},{"from":"ky-cyrl-kg","to":"ky-kg"},{"from":"ks-arab-in","to":"ks-in"},{"from":"mn-cyrl-mn","to":"mn-mn"},{"from":"ms-latn-bn","to":"ms-bn"},{"from":"ms-latn-my","to":"ms-my"},{"from":"ms-latn-sg","to":"ms-sg"},{"from":"pa-in","to":"pa-guru-in"},{"from":"pa-pk","to":"pa-arab-pk"},{"from":"shi-ma","to":"shi-tfng-ma"},{"from":"sr-ba","to":"sr-cyrl-ba"},{"from":"sr-me","to":"sr-latn-me"},{"from":"sr-rs","to":"sr-cyrl-rs"},{"from":"sr-xk","to":"sr-cyrl-xk"},{"from":"tzm-latn-ma","to":"tzm-ma"},{"from":"ug-arab-cn","to":"ug-cn"},{"from":"uz-af","to":"uz-arab-af"},{"from":"uz-uz","to":"uz-latn-uz"},{"from":"vai-lr","to":"vai-vaii-lr"},{"from":"yue-cn","to":"yue-hans-cn"},{"from":"yue-hk","to":"yue-hant-hk"},{"from":"zh-cn","to":"zh-hans-cn"},{"from":"zh-hk","to":"zh-hant-hk"},{"from":"zh-mo","to":"zh-hant-mo"},{"from":"zh-sg","to":"zh-hans-sg"},{"from":"zh-tw","to":"zh-hant-tw"},{"from":"aju","to":"jrb"},{"from":"als","to":"sq"},{"from":"arb","to":"ar"},{"from":"ayr","to":"ay"},{"from":"azj","to":"az"},{"from":"bcc","to":"bal"},{"from":"bcl","to":"bik"},{"from":"bxk","to":"luy"},{"from":"bxr","to":"bua"},{"from":"cld","to":"syr"},{"from":"cmn","to":"zh"},{"from":"cwd","to":"cr"},{"from":"dgo","to":"doi"},{"from":"dhd","to":"mwr"},{"from":"dik","to":"din"},{"from":"diq","to":"zza"},{"from":"lbk","to":"bnc"},{"from":"ekk","to":"et"},{"from":"emk","to":"man"},{"from":"esk","to":"ik"},{"from":"fat","to":"ak"},{"from":"fuc","to":"ff"},{"from":"gaz","to":"om"},{"from":"gbo","to":"grb"},{"from":"gno","to":"gon"},{"from":"gug","to":"gn"},{"from":"gya","to":"gba"},{"from":"hdn","to":"hai"},{"from":"hea","to":"hmn"},{"from":"ike","to":"iu"},{"from":"kmr","to":"ku"},{"from":"knc","to":"kr"},{"from":"kng","to":"kg"},{"from":"knn","to":"kok"},{"from":"kpv","to":"kv"},{"from":"lvs","to":"lv"},{"from":"mhr","to":"chm"},{"from":"mup","to":"raj"},{"from":"khk","to":"mn"},{"from":"npi","to":"ne"},{"from":"ojg","to":"oj"},{"from":"ory","to":"or"},{"from":"pbu","to":"ps"},{"from":"pes","to":"fa"},{"from":"plt","to":"mg"},{"from":"pnb","to":"lah"},{"from":"quz","to":"qu"},{"from":"rmy","to":"rom"},{"from":"spy","to":"kln"},{"from":"src","to":"sc"},{"from":"swh","to":"sw"},{"from":"ttq","to":"tmh"},{"from":"tw","to":"ak"},{"from":"umu","to":"del"},{"from":"uzn","to":"uz"},{"from":"xpe","to":"kpe"},{"from":"xsl","to":"den"},{"from":"ydd","to":"yi"},{"from":"zai","to":"zap"},{"from":"zsm","to":"ms"},{"from":"zyb","to":"za"},{"from":"him","to":"srx"},{"from":"mnk","to":"man"},{"from":"bh","to":"bho"},{"from":"prs","to":"fa-af"},{"from":"swc","to":"sw-cd"},{"from":"aar","to":"aa"},{"from":"abk","to":"ab"},{"from":"ave","to":"ae"},{"from":"afr","to":"af"},{"from":"aka","to":"ak"},{"from":"amh","to":"am"},{"from":"arg","to":"an"},{"from":"ara","to":"ar"},{"from":"asm","to":"as"},{"from":"ava","to":"av"},{"from":"aym","to":"ay"},{"from":"aze","to":"az"},{"from":"bak","to":"ba"},{"from":"bel","to":"be"},{"from":"bul","to":"bg"},{"from":"bih","to":"bho"},{"from":"bis","to":"bi"},{"from":"bam","to":"bm"},{"from":"ben","to":"bn"},{"from":"bod","to":"bo"},{"from":"bre","to":"br"},{"from":"bos","to":"bs"},{"from":"cat","to":"ca"},{"from":"che","to":"ce"},{"from":"cha","to":"ch"},{"from":"cos","to":"co"},{"from":"cre","to":"cr"},{"from":"ces","to":"cs"},{"from":"chu","to":"cu"},{"from":"chv","to":"cv"},{"from":"cym","to":"cy"},{"from":"dan","to":"da"},{"from":"deu","to":"de"},{"from":"div","to":"dv"},{"from":"dzo","to":"dz"},{"from":"ewe","to":"ee"},{"from":"ell","to":"el"},{"from":"eng","to":"en"},{"from":"epo","to":"eo"},{"from":"spa","to":"es"},{"from":"est","to":"et"},{"from":"eus","to":"eu"},{"from":"fas","to":"fa"},{"from":"ful","to":"ff"},{"from":"fin","to":"fi"},{"from":"fij","to":"fj"},{"from":"fao","to":"fo"},{"from":"fra","to":"fr"},{"from":"fry","to":"fy"},{"from":"gle","to":"ga"},{"from":"gla","to":"gd"},{"from":"glg","to":"gl"},{"from":"grn","to":"gn"},{"from":"guj","to":"gu"},{"from":"glv","to":"gv"},{"from":"hau","to":"ha"},{"from":"heb","to":"he"},{"from":"hin","to":"hi"},{"from":"hmo","to":"ho"},{"from":"hrv","to":"hr"},{"from":"hat","to":"ht"},{"from":"hun","to":"hu"},{"from":"hye","to":"hy"},{"from":"her","to":"hz"},{"from":"ina","to":"ia"},{"from":"ind","to":"id"},{"from":"ile","to":"ie"},{"from":"ibo","to":"ig"},{"from":"iii","to":"ii"},{"from":"ipk","to":"ik"},{"from":"ido","to":"io"},{"from":"isl","to":"is"},{"from":"ita","to":"it"},{"from":"iku","to":"iu"},{"from":"jpn","to":"ja"},{"from":"jav","to":"jv"},{"from":"kat","to":"ka"},{"from":"kon","to":"kg"},{"from":"kik","to":"ki"},{"from":"kua","to":"kj"},{"from":"kaz","to":"kk"},{"from":"kal","to":"kl"},{"from":"khm","to":"km"},{"from":"kan","to":"kn"},{"from":"kor","to":"ko"},{"from":"kau","to":"kr"},{"from":"kas","to":"ks"},{"from":"kur","to":"ku"},{"from":"kom","to":"kv"},{"from":"cor","to":"kw"},{"from":"kir","to":"ky"},{"from":"lat","to":"la"},{"from":"ltz","to":"lb"},{"from":"lug","to":"lg"},{"from":"lim","to":"li"},{"from":"lin","to":"ln"},{"from":"lao","to":"lo"},{"from":"lit","to":"lt"},{"from":"lub","to":"lu"},{"from":"lav","to":"lv"},{"from":"mlg","to":"mg"},{"from":"mah","to":"mh"},{"from":"mri","to":"mi"},{"from":"mkd","to":"mk"},{"from":"mal","to":"ml"},{"from":"mon","to":"mn"},{"from":"mol","to":"ro"},{"from":"mar","to":"mr"},{"from":"msa","to":"ms"},{"from":"mlt","to":"mt"},{"from":"mya","to":"my"},{"from":"nau","to":"na"},{"from":"nob","to":"nb"},{"from":"nde","to":"nd"},{"from":"nep","to":"ne"},{"from":"ndo","to":"ng"},{"from":"nld","to":"nl"},{"from":"nno","to":"nn"},{"from":"nor","to":"nb"},{"from":"nbl","to":"nr"},{"from":"nav","to":"nv"},{"from":"nya","to":"ny"},{"from":"oci","to":"oc"},{"from":"oji","to":"oj"},{"from":"orm","to":"om"},{"from":"ori","to":"or"},{"from":"oss","to":"os"},{"from":"pan","to":"pa"},{"from":"pli","to":"pi"},{"from":"pol","to":"pl"},{"from":"pus","to":"ps"},{"from":"por","to":"pt"},{"from":"que","to":"qu"},{"from":"roh","to":"rm"},{"from":"run","to":"rn"},{"from":"ron","to":"ro"},{"from":"rus","to":"ru"},{"from":"kin","to":"rw"},{"from":"san","to":"sa"},{"from":"srd","to":"sc"},{"from":"snd","to":"sd"},{"from":"sme","to":"se"},{"from":"sag","to":"sg"},{"from":"hbs","to":"sr-latn"},{"from":"sin","to":"si"},{"from":"slk","to":"sk"},{"from":"slv","to":"sl"},{"from":"smo","to":"sm"},{"from":"sna","to":"sn"},{"from":"som","to":"so"},{"from":"sqi","to":"sq"},{"from":"srp","to":"sr"},{"from":"ssw","to":"ss"},{"from":"sot","to":"st"},{"from":"sun","to":"su"},{"from":"swe","to":"sv"},{"from":"swa","to":"sw"},{"from":"tam","to":"ta"},{"from":"tel","to":"te"},{"from":"tgk","to":"tg"},{"from":"tha","to":"th"},{"from":"tir","to":"ti"},{"from":"tuk","to":"tk"},{"from":"tgl","to":"fil"},{"from":"tsn","to":"tn"},{"from":"ton","to":"to"},{"from":"tur","to":"tr"},{"from":"tso","to":"ts"},{"from":"tat","to":"tt"},{"from":"twi","to":"ak"},{"from":"tah","to":"ty"},{"from":"uig","to":"ug"},{"from":"ukr","to":"uk"},{"from":"urd","to":"ur"},{"from":"uzb","to":"uz"},{"from":"ven","to":"ve"},{"from":"vie","to":"vi"},{"from":"vol","to":"vo"},{"from":"wln","to":"wa"},{"from":"wol","to":"wo"},{"from":"xho","to":"xh"},{"from":"yid","to":"yi"},{"from":"yor","to":"yo"},{"from":"zha","to":"za"},{"from":"zho","to":"zh"},{"from":"zul","to":"zu"},{"from":"alb","to":"sq"},{"from":"arm","to":"hy"},{"from":"baq","to":"eu"},{"from":"bur","to":"my"},{"from":"chi","to":"zh"},{"from":"cze","to":"cs"},{"from":"dut","to":"nl"},{"from":"fre","to":"fr"},{"from":"geo","to":"ka"},{"from":"ger","to":"de"},{"from":"gre","to":"el"},{"from":"ice","to":"is"},{"from":"mac","to":"mk"},{"from":"mao","to":"mi"},{"from":"may","to":"ms"},{"from":"per","to":"fa"},{"from":"rum","to":"ro"},{"from":"slo","to":"sk"},{"from":"tib","to":"bo"},{"from":"wel","to":"cy"}]')},"./node_modules/bcp-47/lib/normalize.json":e=>{e.exports=JSON.parse('{"en-gb-oed":"en-GB-oxendict","i-ami":"ami","i-bnn":"bnn","i-default":null,"i-enochian":null,"i-hak":"hak","i-klingon":"tlh","i-lux":"lb","i-mingo":null,"i-navajo":"nv","i-pwn":"pwn","i-tao":"tao","i-tay":"tay","i-tsu":"tsu","sgn-be-fr":"sfb","sgn-be-nl":"vgt","sgn-ch-de":"sgg","art-lojban":"jbo","cel-gaulish":null,"no-bok":"nb","no-nyn":"nn","zh-guoyu":"cmn","zh-hakka":"hak","zh-min":null,"zh-min-nan":"nan","zh-xiang":"hsn"}')},"./node_modules/bcp-47/lib/regular.json":e=>{e.exports=JSON.parse('["art-lojban","cel-gaulish","no-bok","no-nyn","zh-guoyu","zh-hakka","zh-min","zh-min-nan","zh-xiang"]')}},n={};function l(e){var t=n[e];if(void 0!==t)return t.exports;t=n[e]={exports:{}};return r[e].call(t.exports,t,t.exports,l),t.exports}l.amdO={},l.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return l.d(t,{a:t}),t},l.d=(e,t)=>{for(var r in t)l.o(t,r)&&!l.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},l.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),l.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),l.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var u={};return(()=>{l.r(u),l.d(u,{Debug:()=>i.default,MediaPlayer:()=>e.MediaPlayer,MediaPlayerFactory:()=>a.default,MetricsReporting:()=>r.default,Protection:()=>n.default,default:()=>o,supportsMediaSource:()=>t.supportsMediaSource});var e=l("./index_mediaplayerOnly.js"),t=l("./src/streaming/utils/Capabilities.js"),r=l("./src/streaming/metrics/MetricsReporting.js"),n=l("./src/streaming/protection/Protection.js"),a=l("./src/streaming/MediaPlayerFactory.js"),i=l("./src/core/Debug.js");dashjs.Protection=n.default,dashjs.MetricsReporting=r.default,dashjs.MediaPlayerFactory=a.default,dashjs.Debug=i.default,dashjs.supportsMediaSource=t.supportsMediaSource;const o=dashjs})(),u.default})(),e.exports=t()}(_e={exports:{}}),_e.exports),be=(ve=Te)&&ve.__esModule&&Object.prototype.hasOwnProperty.call(ve,"default")?ve.default:ve;function Se(a,e){var r=a.dash.mediaPlayer,n=r.getTracksFor("audio"),i=a.audioTracks();function o(e){return"dash-audio-"+e}i.length&&e.clearTracks(["audio"]);var s=r.getCurrentTrackFor("audio");n.forEach(function(e){var t,r;if(Array.isArray(e.labels))for(var n=0;n<e.labels.length;n++)if(e.labels[n].lang&&-1!==a.language().indexOf(e.labels[n].lang.toLowerCase())){t=e.labels[n];break}t?r=t.text:Array.isArray(e.labels)&&1===e.labels.length?r=e.labels[0].text:(r=e.lang,e.roles&&e.roles.length&&(r+=" ("+e.roles.join(", ")+")")),i.addTrack(new l.AudioTrack({enabled:e===s,id:o(e.index),kind:e.kind||"main",label:r,language:e.lang}))});function t(){for(var e=0;e<i.length;e++){var t=i[e];t.enabled&&(t=function(e,t){return e.find(function(e){return o(e.index)===t.id})}(n,t),r.setCurrentTrack(t))}}i.addEventListener("change",t),a.dash.mediaPlayer.on(be.MediaPlayer.events.STREAM_TEARDOWN_COMPLETE,function(){i.removeEventListener("change",t)})}function Ae(){return(Ae=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r,n=arguments[t];for(r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function Re(e,t){return(Re=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ie(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function we(a,e,i){var o=[],t=i.map(function(e){var t;if(Array.isArray(e.labels))for(var r=0;r<e.labels.length;r++)if(e.labels[r].lang&&-1!==a.language().indexOf(e.labels[r].lang.toLowerCase())){t=e.labels[r];break}return{dashTrack:e,trackConfig:{label:t?t.text:Array.isArray(e.labels)&&1===e.labels.length?e.labels[0].text:e.lang||e.label,language:e.lang,srclang:e.lang,kind:e.kind}}}).map(function(e){var t=e.trackConfig,e=e.dashTrack;if(e.isTTML&&!a.getChild("TTMLTextTrackDisplay"))return null;t=function(e,t){if(e.mapLangToNewLabel){var r=t.label||"",e=e.mapLangToNewLabel(r.toLowerCase());if(e){r=Ae({},t);return r.label=e,r}}return t}(a,t),t=a.addRemoteTextTrack(t,!1);return o.push({textTrack:t.track,dashTrack:e}),t}).filter(function(e){return null!==e});function r(){for(var e=a.dash.mediaPlayer,r=a.textTracks(),n=-1,t=0;t<r.length;t+=1)!function(e){var t=r[e];"showing"!==t.mode||(e=(e=function(e,t){for(var r=0;r<e.length;r++)if(t(e[r]))return e[r]}(o,function(e){return e.textTrack===t}))?e.dashTrack:null)&&(n=i.indexOf(e))}(t);n!==e.getCurrentTextTrackIndex()&&e.setTextTrack(n)}return a.textTracks().on("change",r),a.dash.mediaPlayer.on(be.MediaPlayer.events.STREAM_TEARDOWN_COMPLETE,function(){a.textTracks().off("change",r)}),r(),t}function Ce(t,e,r){u.VTTCue&&!/\[native code\]/.test(u.VTTCue.toString())&&(u.VTTCue=!1);var n,a=[];function i(e){e.index;e=e.tracks;n.off(be.MediaPlayer.events.TEXT_TRACKS_ADDED,i),a.forEach(t.removeRemoteTextTrack.bind(t)),a=[],e.length&&(a=we(t,0,e))}e.featuresNativeTextTracks?l.log.error("You must pass {html: {nativeCaptions: false}} in the videojs constructor to use text tracks in videojs-contrib-dash"):((n=t.dash.mediaPlayer).on(be.MediaPlayer.events.TEXT_TRACKS_ADDED,i),n.on(be.MediaPlayer.events.CAN_PLAY,function(){n.off(be.MediaPlayer.events.TEXT_TRACKS_ADDED,i)}))}var e=l.getComponent("Component"),Ne="#222",De={monospace:"monospace",sansSerif:"sans-serif",serif:"serif",monospaceSansSerif:'"Andale Mono", "Lucida Console", monospace',monospaceSerif:'"Courier New", monospace',proportionalSansSerif:"sans-serif",proportionalSerif:"serif",casual:'"Comic Sans MS", Impact, fantasy',script:'"Monotype Corsiva", cursive',smallcaps:'"Andale Mono", "Lucida Console", monospace, sans-serif'};function Me(e,t,r){try{e.style[t]=r}catch(e){return}}function Oe(e,t){var r;if(4===e.length)r=e[1]+e[1]+e[2]+e[2]+e[3]+e[3];else{if(7!==e.length)throw new Error("Invalid color code provided, "+e+"; must be formatted as e.g. #f0e or #f604e2.");r=e.slice(1)}return"rgba("+parseInt(r.slice(0,2),16)+","+parseInt(r.slice(2,4),16)+","+parseInt(r.slice(4,6),16)+","+t+")"}e=function(o){var e;function t(e,t,r){for(var n=o.call(this,e,l.mergeOptions(t,{playerOptions:{}}),r)||this,a=e.getChild("TextTrackSettings").$$("select"),i=0;i<a.length;i++)n.on(a[i],"change",n.updateStyle.bind(Ie(n)));return e.dash.mediaPlayer.on(be.MediaPlayer.events.CAPTION_RENDERED,n.updateStyle.bind(Ie(n))),n}r=o,(e=t).prototype=Object.create(r.prototype),Re(e.prototype.constructor=e,r);var r=t.prototype;return r.createEl=function(){var e=o.prototype.createEl.call(this,"div",{className:"vjs-text-track-display-ttml"},{"aria-live":"off","aria-atomic":"true"});return e.style.position="absolute",e.style.left="0",e.style.right="0",e.style.top="0",e.style.bottom="0",e.style.margin="1.5%",e},r.updateStyle=function(e){e=e.captionDiv;if(this.player_.textTrackSettings){var t=this.player_.textTrackSettings.getValues();if(e=e||this.player_.getChild("TTMLTextTrackDisplay").el().firstChild){!function e(t){for(var r in t.style&&(t.style.left=null,t.style.width="100%"),t.children)e(t.children[r])}(e);for(var r=e.getElementsByTagName("span"),n=0;n<r.length;n++){var a,i=r[n];i.parentNode.style.textAlign="center",t.color&&(i.style.color=t.color),t.textOpacity&&Me(i,"color",Oe(t.color||"#fff",t.textOpacity)),t.backgroundColor&&(i.style.backgroundColor=t.backgroundColor),t.backgroundOpacity&&Me(i,"backgroundColor",Oe(t.backgroundColor||"#000",t.backgroundOpacity)),t.windowColor&&(t.windowOpacity?Me(i.parentNode,"backgroundColor",Oe(t.windowColor,t.windowOpacity)):i.parent.style.backgroundColor=t.windowColor),t.edgeStyle&&("dropshadow"===t.edgeStyle?i.style.textShadow="2px 2px 3px #222, 2px 2px 4px #222, 2px 2px 5px "+Ne:"raised"===t.edgeStyle?i.style.textShadow="1px 1px #222, 2px 2px #222, 3px 3px "+Ne:"depressed"===t.edgeStyle?i.style.textShadow="1px 1px #ccc, 0 1px #ccc, -1px -1px #222, 0 -1px "+Ne:"uniform"===t.edgeStyle&&(i.style.textShadow="0 0 4px #222, 0 0 4px #222, 0 0 4px #222, 0 0 4px "+Ne)),t.fontPercent&&1!==t.fontPercent&&(a=u.parseFloat(i.style.fontSize),i.style.fontSize=a*t.fontPercent+"px",i.style.height="auto",i.style.top="auto",i.style.bottom="2px"),t.fontFamily&&"default"!==t.fontFamily&&("small-caps"===t.fontFamily?i.style.fontVariant="small-caps":i.style.fontFamily=De[t.fontFamily])}}}},t}(e);l.registerComponent("TTMLTextTrackDisplay",e);var Pe=function(){function i(t,e,n){var r,a=this;n=n||e.options_,this.player=l(n.playerId),this.player.dash=this.player.dash||{},this.tech_=e,this.el_=e.el(),this.elParent_=this.el_.parentNode,this.hasFiniteDuration_=!1,t.src&&(e.isReady_=!1,i.updateSourceData&&(l.log.warn('updateSourceData has been deprecated. Please switch to using hook("updatesource", callback).'),t=i.updateSourceData(t)),i.hooks("updatesource").forEach(function(e){t=e(t)}),r=t.src,this.keySystemOptions_=i.buildDashJSProtData(t.keySystemOptions),this.player.dash.mediaPlayer=be.MediaPlayer().create(),this.mediaPlayer_=this.player.dash.mediaPlayer,i.useVideoJSDebug&&(l.log.warn('useVideoJSDebug has been deprecated. Please switch to using hook("beforeinitialize", callback).'),i.useVideoJSDebug(this.mediaPlayer_)),i.beforeInitialize&&(l.log.warn('beforeInitialize has been deprecated. Please switch to using hook("beforeinitialize", callback).'),i.beforeInitialize(this.player,this.mediaPlayer_)),i.hooks("beforeinitialize").forEach(function(e){e(a.player,a.mediaPlayer_)}),this.mediaPlayer_.initialize(),this.retriggerError_=function(e){if("capability"===e.error&&"mediasource"===e.event)a.player.error({code:4,message:"The media cannot be played because it requires a feature that your browser does not support."});else if("manifestError"!==e.error||"createParser"!==e.event.id&&"codec"!==e.event.id&&"nostreams"!==e.event.id&&"nostreamscomposed"!==e.event.id&&"parse"!==e.event.id&&"multiplexedrep"!==e.event.id)if("mediasource"===e.error)e.event.match("MEDIA_ERR_ABORTED")?a.player.error({code:1,message:e.event}):e.event.match("MEDIA_ERR_NETWORK")?a.player.error({code:2,message:e.event}):e.event.match("MEDIA_ERR_DECODE")?a.player.error({code:3,message:e.event}):e.event.match("MEDIA_ERR_SRC_NOT_SUPPORTED")?a.player.error({code:4,message:e.event}):e.event.match("MEDIA_ERR_ENCRYPTED")?a.player.error({code:5,message:e.event}):(e.event.match("UNKNOWN"),a.player.error({code:4,message:e.event}));else if("capability"===e.error&&"encryptedmedia"===e.event)a.player.error({code:5,message:"The media cannot be played because it requires encryption features that your browser does not support."});else if("key_session"===e.error)a.player.error({code:5,message:e.event});else if("download"===e.error)a.player.error({code:2,message:"The media playback was aborted because too many consecutive download errors occurred."});else{if("mssError"!==e.error)return;a.player.error({code:3,message:e.event})}else a.player.error({code:4,message:e.event.message});setTimeout(function(){a.mediaPlayer_.reset()},10)},this.mediaPlayer_.on(be.MediaPlayer.events.ERROR,this.retriggerError_),this.getDuration_=function(e){var t=e.data.Period_asArray,r=a.hasFiniteDuration_;e.data.mediaPresentationDuration||t[t.length-1].duration?a.hasFiniteDuration_=!0:a.hasFiniteDuration_=!1,a.hasFiniteDuration_!==r&&a.player.trigger("durationchange")},this.mediaPlayer_.on(be.MediaPlayer.events.MANIFEST_LOADED,this.getDuration_),n.dash&&Object.keys(n.dash).forEach(function(e){var t,r;"useTTML"!==e&&(t="set"+e.charAt(0).toUpperCase()+e.slice(1),r=n.dash[e],a.mediaPlayer_.hasOwnProperty(t)&&(l.log.warn("Using dash options in videojs-contrib-dash without the set prefix has been deprecated. Change '"+e+"' to '"+t+"'"),e=t),a.mediaPlayer_.hasOwnProperty(e)?(Array.isArray(r)||(r=[r]),(t=a.mediaPlayer_)[e].apply(t,r)):l.log.warn("Warning: dash configuration option unrecognized: "+e))}),this.mediaPlayer_.attachView(this.el_),n.dash&&n.dash.useTTML&&(this.ttmlContainer_=this.player.addChild("TTMLTextTrackDisplay"),this.mediaPlayer_.attachTTMLRenderingDiv(this.ttmlContainer_.el())),this.mediaPlayer_.setAutoPlay(!1),function(e,t){e.dash.mediaPlayer.on(be.MediaPlayer.events.PLAYBACK_METADATA_LOADED,Se.bind(null,e,t))}.call(null,this.player,e),Ce.call(null,this.player,e,n),this.mediaPlayer_.setProtectionData(this.keySystemOptions_),this.mediaPlayer_.attachSource(r),this.tech_.triggerReady())}i.buildDashJSProtData=function(e){var t={};if(!e||!Array.isArray(e))return null;for(var r=0;r<e.length;r++){var n=e[r],a=l.mergeOptions({},n.options);a.licenseUrl&&(a.serverURL=a.licenseUrl,delete a.licenseUrl),t[n.name]=a}return t};var e=i.prototype;return e.dispose=function(){this.mediaPlayer_&&(this.mediaPlayer_.off(be.MediaPlayer.events.ERROR,this.retriggerError_),this.mediaPlayer_.off(be.MediaPlayer.events.MANIFEST_LOADED,this.getDuration_),this.mediaPlayer_.reset()),this.player.dash&&delete this.player.dash,this.ttmlContainer_&&(this.ttmlContainer_.dispose(),this.player.removeChild("TTMLTextTrackDisplay"))},e.duration=function(){return this.mediaPlayer_.isDynamic()&&!this.hasFiniteDuration_?1/0:this.mediaPlayer_.duration()},i.hooks=function(e,t){return i.hooks_[e]=i.hooks_[e]||[],t&&(i.hooks_[e]=i.hooks_[e].concat(t)),i.hooks_[e]},i.hook=function(e,t){i.hooks(e,t)},i.removeHook=function(e,t){t=i.hooks(e).indexOf(t);return-1!==t&&(i.hooks_[e]=i.hooks_[e].slice(),i.hooks_[e].splice(t,1),!0)},i}();Pe.hooks_={};return l.DashSourceHandler=function(){return{canHandleSource:function(e){return function(t){t=JSON.parse(JSON.stringify(t)),Pe.updateSourceData&&(l.log.warn('updateSourceData has been deprecated. Please switch to using hook("updatesource", callback).'),t=Pe.updateSourceData(t)),Pe.hooks("updatesource").forEach(function(e){t=e(t)});var e=r.createElement("video");return!(t.keySystemOptions&&!u.navigator.requestMediaKeySystemAccess&&!e.msSetMediaKeys)}(e)?l.DashSourceHandler.canPlayType(e.type)?"probably":/\.mpd/i.test(e.src)?"maybe":"":""},handleSource:function(e,t,r){return new Pe(e,t,r)},canPlayType:function(e){return l.DashSourceHandler.canPlayType(e)}}},l.DashSourceHandler.canPlayType=function(e){return/^application\/dash\+xml/i.test(e)?"probably":""},u.MediaSource&&l.getTech("Html5").registerSourceHandler(l.DashSourceHandler(),0),l.Html5DashJS=Pe});
